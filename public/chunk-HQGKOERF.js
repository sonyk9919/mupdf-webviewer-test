import{a as Gt,c as Qn,k as ws,s as Ls}from"./chunk-PJJ3CU4Q.js";import{$ as ts,$b as us,$c as gr,$d as uo,$f as Rn,$g as Xs,A as An,Ab as ce,Ac as Kn,Ad as eo,Ae as Ne,Af as So,Ai as Jt,Ba as Yn,Bb as j,Bd as to,Be as k,Bf as Io,Bh as Se,Bi as ca,Ca as Ge,Cb as Le,Cc as hi,Cd as Wt,Ce as Ot,Cf as Ms,Ch as Nn,Db as oe,Dc as Ni,Dd as io,De as $e,Df as Ds,Eb as at,Ed as Ts,Ee as Rs,Eh as We,Ei as la,Fa as re,Fc as He,Fd as Ht,Fe as si,Fh as Qs,Fi as pa,Gb as Wi,Gc as _s,Gd as no,Ge as b,Gi as da,H as we,Hc as vt,Hd as As,He as Mi,Hg as dt,I as ri,Ib as T,Id as oo,Ie as S,Ig as Zt,Ih as Ai,Jb as A,Jc as fr,Jd as ro,Je as Tr,K as Et,Ka as l,Ke as fe,La as rs,Lb as ke,Lg as ut,M as w,Mb as $,Md as so,Me as Ns,Mf as xo,Mi as Ei,N as Zr,Na as xt,Nb as ls,Nd as yn,Nf as Ki,O as qr,Oa as m,Od as ao,Oi as ua,Pa as Xt,Pc as fs,Pg as zs,Qa as H,Qb as ps,Qc as gs,Qf as vo,Qg as js,Qh as Zs,R as Hn,Ra as ot,Rb as je,Rh as qs,Sa as Bi,Sb as De,Se as Di,Sf as Be,Sg as Ae,Sh as Js,Si as nn,Tb as Ce,Te as st,Tf as Ee,Tg as Li,Ua as y,Ub as yi,Uc as zi,Ue as Qt,Uf as ze,V as $t,Vb as Ri,Vd as co,Ve as Ar,W as Mt,Wb as En,Wd as lo,We as pt,Wf as Ac,Wg as ft,X as Jr,Xa as B,Xb as _e,Xc as Zn,Xe as Yi,Xg as le,Y as St,Ya as p,Yb as ds,Yc as Sn,Yd as Lt,Ye as K,Yg as $s,Za as Ye,Ze as wi,Zg as Fi,Zh as ea,Zi as on,_ as es,_a as G,_c as mi,_d as po,_e as Ue,_g as Ys,_h as Mo,a as ge,aa as zn,ab as Gi,ac as rt,ad as In,af as Pe,ag as bt,ah as Zi,ai as ta,b as Qe,bf as Ft,bh as Oo,bi as ia,cb as h,ce as ho,cf as Ci,cg as zt,ci as Ie,db as _,de as mo,df as D,e as Tc,eb as x,ec as hs,ef as Xi,f as E,fa as is,fb as ue,fd as Cs,ff as go,fg as yt,fh as bo,ga as jn,gb as he,gd as _i,ge as _o,h as Wn,ha as Tt,hb as bi,he as fo,hg as Qi,hh as yo,ia as $n,ib as M,id as qn,ie as Es,ii as be,j as it,jd as lt,je as Ss,jf as Co,jg as Fs,jh as Ro,ji as mt,k as ui,ka as Ve,kb as ss,kd as fi,ke as Is,kf as ee,kg as a,kh as de,ki as Ct,l as _r,lb as I,le as xs,lf as kt,lg as V,lh as pe,li as Do,ma as ns,mb as d,md as xn,me as vs,mg as ks,nb as as,nd as Ze,ne as Os,nf as To,ng as v,nh as qi,ni as na,oa as Yt,ob as cs,od as wt,oe as Cr,of as Ao,og as Vs,oh as gt,oi as oa,pa as nt,pd as vn,pe as bs,ph as No,q as Z,qa as os,qb as te,qd as Pi,qe as ys,qg as Y,qh as Er,qi as ra,ra as It,rb as ie,rd as On,re as qe,rg as Us,rh as Ji,ri as sa,sb as ne,sg as Ti,sh as ht,tb as Oe,tg as Bs,th as Sr,u as Tn,ua as Te,ub as P,uc as ms,ud as bn,ue as F,ug as Gs,uh as Ir,ui as aa,va as f,vb as L,vc as R,vg as Ws,vh as Po,wa as g,wb as Re,wc as Hi,wd as gi,we as X,wg as Hs,wh as Ks,xa as J,xc as Kt,xd as ji,xf as me,xi as qt,yb as ae,yc as Xn,yd as $i,yf as Eo,yh as xr,yi as en,z as _t,zb as se,zd as Jn,zf as Ps,zh as Q,zi as tn}from"./chunk-6FTJLYMX.js";var ai=function(r){return r.UI_DISPLAY_SETTINGS="UI_DISPLAY_SETTINGS",r.FEATURE_SETTINGS="FEATURE_SETTINGS",r.CONTEXT_MENU_SETTINGS="CONTEXT_MENU_SETTINGS",r.ANNOT_PROPERTY_SETTINGS="ANNOT_PROPERTY_SETTINGS",r}(ai||{});var W=function(r){return r.ROOT="__IGNORED_ROOT",r.EMBEDDED_FILE_VIEW="__IGNORED_EMBEDDED_FILE_VIEW",r.TEXT_SEARCH_VIEW="__IGNORED_TEXT_SEARCH_VIEW",r.REGEX_BUTTON="__IGNORED_REGEX_BUTTON",r.MAIN_TOOLBAR="__IGNORED_MAIN_TOOLBAR",r.MAIN_MENU="__IGNORED_MAIN_MENU",r.DEFAULT_REDACTION_COLOR="__IGNORED_DEFAULT_REDACTION_COLOR",r.SAVE_OPTION="__IGNORED_SAVE_OPTION",r.DEFAULT_VIEW_MODE="__IGNORED_DEFAULT_VIEW_MODE",r.DEFAULT_ZOOM="__IGNORED_DEFAULT_ZOOM",r.DEFAULT_DRAG_MODE="__IGNORED_DEFAULT_DRAG_MODE",r.DEFAULT_VIEWED_DAP_LIST="__IGNORED_DEFAULT_VIEWED_DAP_LIST",r.SHORTCUT="__IGNORED_SHORTCUT",r.RENDERING_OPTION="__IGNORED_RENDERING_OPTION",r.STAMP_DRAWING_GESTURE="__IGNORED_STAMP_DRAWING_GESTURE",r.FRONTEND_API="__IGNORED_FRONTEND_API",r.DEFAULT_CONTINUE_WRITING="__IGNORED_DEFAULT_CONTINUE_WRITING",r.DAP_VIEW="__IGNORED_DAP_VIEW",r.DIALOG="__IGNORED_DIALOG",r.STMAP_DIALOG="__IGNORED_STAMP_DIALOG",r.SIGNATURE_DIALOG="__IGNORED_SIGNATURE_DIALOG",r.PANEL="__IGNORED_PANEL",r.THUMBNAIL_VIEW="__IGNORED_THUMBNAIL_VIEW",r.OUTLINE_VIEW="__IGNORED_OUTLINE_VIEW",r.ETC_UI="__IGNORED_ETC_UI",r.ANNOTATION_CONTROL="__IGNORED_ANNOTATION_CONTROL",r.FORM_CONTROL="__IGNORED_FORM_CONTROL",r.DEFAULT_SCREEN_THEME="__IGNORED_DEFAULT_SCREEN_THEME",r.ANNOTATION_VIEW="__IGNORED_ANNOTATION_VIEW",r}(W||{}),ha=[a.FORM_VIEW_BUTTON,a.SIGNATURE_VIEW_BUTTON,a.ANNOT_TOOLBAR_DRAG_MODE_SELECT_ANNOT,a.CLOUD_ANNOTATION_BUTTON,V.MEASURE_ANNOTATION_BUTTONS,a.LINE_DIMENSION_ANNOTATION_BUTTON,a.POLYLINE_DIMENSION_ANNOTATION_BUTTON,a.POLYGON_DIMENSION_ANNOTATION_BUTTON,a.SIGNATURE_WIDGET_BUTTON,V.FORM_TOOLBAR,a.FORM_TOOLBAR_UNDO_REDO_BUTTON,a.ANNOT_TOOLBAR_DRAG_MODE_SELECT_ANNOT,a.TEXT_FIELD_WIDGET_BUTTON,a.COMBO_BOX_WIDGET_BUTTON,a.LIST_BOX_WIDGET_BUTTON,a.CHECK_BOX_WIDGET_BUTTON,a.RADIO_BUTTON_WIDGET_BUTTON,a.BUTTON_WIDGET_BUTTON,a.RULER_BUTTON,a.WIDGET_HIGHLIGHT_BUTTON,a.FORM_TOOLBAR_ANNOT_PROPERTY_BUTTON,V.PKI_SIGNATURE_TOOLBAR,a.PKI_INSTANT_SIGNATURE_BUTTON,a.PKI_INVISIBLE_SIGNATURE_BUTTON,a.DAP_VIEW_BUTTON,a.PREFERENCES_WIDGET_HIGHLIGHT,a.PREFERENCES_REDACTION_COLOR,W.SIGNATURE_DIALOG,a.SIGN_DIALOG_HISTORY,W.THUMBNAIL_VIEW,a.THUMBNAIL_VIEW_EDIT,V.ANNOT_PROPERTY_VIEW_ATTRIBUTES,a.WIDGET_PROPERTY_OPTION,a.WIDGET_PROPERTY_CALCULATION,a.WIDGET_PROPERTY_ACTION,W.DAP_VIEW,a.DAP_VIEW_TREE,a.DAP_VIEW_TABLE,a.DAP_VIEW_DEFAULT_OPEN,W.DEFAULT_VIEWED_DAP_LIST,a.DAP_VIEW_DEFAULT_VIEW_TREE,a.DAP_VIEW_DEFAULT_VIEW_TABLE,W.FORM_CONTROL,V.RESIZE_AND_MOVE_FORM,a.DELETE_FORM],ma=[a.ORIGINAL_DOWNLOAD_BUTTON,a.USE_SPREADSHEETS_VIEWER],_a=[V.PKI_SIGNATURE_TOOLBAR,a.PKI_INSTANT_SIGNATURE_BUTTON,a.PKI_INVISIBLE_SIGNATURE_BUTTON],fa={key:W.ROOT,children:[{key:W.MAIN_TOOLBAR,children:[{key:W.MAIN_MENU,children:[a.SAVE_BUTTON,a.ORIGINAL_DOWNLOAD_BUTTON,a.PDF_DOWNLOAD_BUTTON,a.PRINT_BUTTON,a.DOCUMENT_INFO_BUTTON,a.SLIDESHOW_BUTTON,a.EBOOK_BUTTON,a.PREFERENCES_BUTTON,a.SCREEN_THEME_MENU,a.SD_INFO_BUTTON]},{key:V.LEFT_SIDE_VIEW_BUTTON,children:[a.THUMBNAIL_VIEW_BUTTON,a.OUTLINE_VIEW_BUTTON,a.ANNOTATION_VIEW_BUTTON,a.REDACTION_VIEW_BUTTON,a.EMBEDDED_FILE_VIEW_BUTTON,a.FORM_VIEW_BUTTON,a.SIGNATURE_VIEW_BUTTON]},a.QUICK_ACTION_BUTTON,a.CAPTURE_MODE_BUTTON,a.SCALE_DROPDOWN,a.FIT_BUTTON,{key:V.VIEW_MODE_BUTTON,children:[a.VIEW_MODE_BUTTON,a.ROTATION_BUTTON]},{key:V.DRAG_MODE_BUTTONS,children:[a.DRAG_MODE_MOVE_BUTTON,a.DRAG_MODE_SELECT_TEXT_BUTTON,a.DRAG_MODE_MAGNIFY_BUTTON]},{key:V.ANNOT_TOOLBAR,children:[a.ANNOT_TOOLBAR_UNDO_REDO_BUTTONS,a.ANNOT_TOOLBAR_DRAG_MODE_SELECT_ANNOT,{key:V.DRAWING_ANNOTATION_BUTTONS,children:[a.INK_ANNOTATION_BUTTON,a.LINE_ANNOTATION_BUTTON,a.SQUARE_ANNOTATION_BUTTON,a.CIRCLE_ANNOTATION_BUTTON,a.POLYGON_ANNOTATION_BUTTON,a.POLYLINE_ANNOTATION_BUTTON,a.CLOUD_ANNOTATION_BUTTON]},a.FREE_TEXT_ANNOTATION_BUTTON,a.FREE_TEXT_CALLOUT_ANNOTATION_BUTTON,a.MEMO_ANNOTATION_BUTTON,{key:V.MEASURE_ANNOTATION_BUTTONS,children:[a.LINE_DIMENSION_ANNOTATION_BUTTON,a.POLYLINE_DIMENSION_ANNOTATION_BUTTON,a.POLYGON_DIMENSION_ANNOTATION_BUTTON]},a.STAMP_ANNOTATION_BUTTON,a.HIGHLIGHT_ANNOTATION_BUTTON,a.STRIKEOUT_ANNOTATION_BUTTON,a.UNDERLINE_ANNOTATION_BUTTON,a.LINK_ANNOTATION_BUTTON,a.ERASER_BUTTON,a.SIGNATURE_WIDGET_BUTTON,a.ANNOT_TOOLBAR_ANNOT_PROPERTY_BUTTON]},{key:V.FORM_TOOLBAR,children:[a.FORM_TOOLBAR_UNDO_REDO_BUTTON,a.FORM_TOOLBAR_DRAG_MODE_SELECT_ANNOT,a.TEXT_FIELD_WIDGET_BUTTON,a.COMBO_BOX_WIDGET_BUTTON,a.LIST_BOX_WIDGET_BUTTON,a.CHECK_BOX_WIDGET_BUTTON,a.RADIO_BUTTON_WIDGET_BUTTON,a.BUTTON_WIDGET_BUTTON,a.RULER_BUTTON,a.WIDGET_HIGHLIGHT_BUTTON,a.FORM_TOOLBAR_ANNOT_PROPERTY_BUTTON]},{key:V.PKI_SIGNATURE_TOOLBAR,children:[a.PKI_INSTANT_SIGNATURE_BUTTON,a.PKI_INVISIBLE_SIGNATURE_BUTTON]},a.DAP_VIEW_BUTTON]},{key:V.FLOATING_NAVIGATION,children:[a.FLOATING_NAVIGATION_AUTO_HIDE,a.PAGE_NAVIGATION,a.MOVE_TO_ADJACENT_PAGE_BUTTON,a.ZOOM_BUTTON,a.QUICK_SEARCH_BUTTON,a.FULL_SEARCH_BUTTON]},{key:W.DIALOG,children:[{key:V.PRINT_DIALOG,children:[a.BROWSER_PRINT,a.PLUGIN_PRINT]},{key:V.DOCUMENT_INFO_DIALOG,children:[a.DOCUMENT_INFO_DESCRIPTION,a.DOCUMENT_INFO_SECURITY]},{key:V.PREFERENCES_DIALOG,children:[a.PREFERENCES_DEFAULT_FIT,a.PREFERENCES_LINK_ACTIVATION,a.PREFERENCES_LANGUAGE,a.PREFERENCES_WIDGET_HIGHLIGHT,a.PREFERENCES_ANNOTATION_AUTHOR,a.PREFERENCES_POPUP_TEXT_SIZE,a.PREFERENCES_CONTINUOUS_ANNOT_WRITING,a.PREFERENCES_REDACTION_COLOR,a.PREFERENCES_DISPLAY_ORIENTATION]},{key:W.STMAP_DIALOG,children:[a.USE_SAMPLE_STAMP_IMAGE,a.UPLOAD_STAMP_IMAGE]},{key:W.SIGNATURE_DIALOG,children:[a.SIGN_DIALOG_HISTORY]}]},{key:W.PANEL,children:[{key:W.THUMBNAIL_VIEW,children:[a.THUMBNAIL_VIEW_EDIT]},{key:W.OUTLINE_VIEW,children:[a.OUTLINE_VIEW_EDIT,a.OUTLINE_VIEW_DEFAULT_EXPAND]},{key:W.ANNOTATION_VIEW,children:[a.ANNOTATION_VIEW_REPLY]},{key:W.EMBEDDED_FILE_VIEW,children:[a.EMBEDDED_FILE_VIEW_EDIT,a.EMBEDDED_FILE_VIEW_DOWNLOAD]},{key:V.ANNOT_PROPERTY_VIEW_ATTRIBUTES,children:[a.WIDGET_PROPERTY_OPTION,a.WIDGET_PROPERTY_CALCULATION,a.WIDGET_PROPERTY_ACTION]},{key:W.TEXT_SEARCH_VIEW,children:[{key:a.TEXT_SEARCH_VIEW_REGEX,children:[W.REGEX_BUTTON]}]},{key:W.DAP_VIEW,children:[a.DAP_VIEW_TREE,a.DAP_VIEW_TABLE,a.DAP_VIEW_DEFAULT_OPEN,{key:W.DEFAULT_VIEWED_DAP_LIST,children:[a.DAP_VIEW_DEFAULT_VIEW_TREE,a.DAP_VIEW_DEFAULT_VIEW_TABLE]}]}]},{key:W.ETC_UI,children:[{key:V.INDICATOR,children:[a.SCALE_INDICATOR,a.MEASURE_INDICATOR,a.PAGE_INDICATOR]},a.HIDE_SAVE_DOWNLOAD_PRINT_IN_MENU,{key:V.ANNOTATION_FLOATING_MENU,children:[a.ANNOT_FLOATING_PROPERTY,a.ANNOT_FLOATING_POPUP_NOTE,a.ANNOT_FLOATING_ADD_RADIO_BUTTON,a.ANNOT_FLOATING_DELETE]}]}]},ga={key:W.ROOT,children:[{key:a.CHANGE_PRIMARY_COLOR,children:[a.PRIMARY_50,a.PRIMARY_70]},{key:W.DEFAULT_SCREEN_THEME,children:[a.SCREEN_THEME_LIGHT,a.SCREEN_THEME_DARK,a.SCREEN_THEME_SYSTEM]},a.WELCOME_PAGE_VISIBLE,a.USE_SPREADSHEETS_VIEWER,{key:W.FRONTEND_API,children:[a.USE_STREAMDOCS_API,a.DELAY_LOADING]},a.PAGE_TITLE,a.WARNING_LEAVE_WITHOUT_SAVE,{key:W.DEFAULT_VIEW_MODE,children:[a.DEFAULT_VIEW_MODE_ONE,a.DEFAULT_VIEW_MODE_ONE_C,a.DEFAULT_VIEW_MODE_TWO,a.DEFAULT_VIEW_MODE_TWO_C,a.DEFAULT_VIEW_MODE_EBOOK]},{key:W.DEFAULT_ZOOM,children:[a.DEFAULT_ZOOM_READ,a.DEFAULT_ZOOM_FIT_WIDTH,a.DEFAULT_ZOOM_FIT_HEIGHT,a.DEFAULT_ZOOM_FIT_PAGE,a.DEFAULT_ZOOM_FIT_ACTUAL_SIZE,a.DEFAULT_ZOOM_MAINTAIN]},{key:W.DEFAULT_DRAG_MODE,children:[a.DEFAULT_DRAG_MODE_SCROLL,a.DEFAULT_DRAG_MODE_TEXT_SELECT,a.DEFAULT_DRAG_MODE_MAGNIFY]},{key:W.DEFAULT_CONTINUE_WRITING,children:[a.DEFAULT_CONTINUE_WRITING_ACTIVE,a.DEFAULT_CONTINUE_WRITING_INACTIVE]},{key:W.DEFAULT_REDACTION_COLOR,children:[a.DEFAULT_REDACTION_OUTLINE_COLOR,a.DEFAULT_REDACTION_INTERIOR_COLOR]},{key:a.USE_CLIENT_RENDERING,children:[a.CLIENT_RENDERING_HYBRID,{key:W.RENDERING_OPTION,children:[a.CLIENT_RENDERING_OPTION_QUALITY_FIRST,a.CLEINT_RENDERING_OPTION_BALANCE,a.CLEINT_RENDERING_OPTION_SPEED_FIRST]},a.CLIENT_RENDERING_MAXIMUM_SCALE,a.CLIENT_RENDERING_PIXELATED]},a.PAGE_TEXT_FOR_SCREEN_READER,{key:W.ANNOTATION_CONTROL,children:[a.RESIZE_ANNOTATION,a.MOVE_ANNOTATION,a.DELETE_ANNOTATION,{key:W.STAMP_DRAWING_GESTURE,children:[a.DRAWING_STAMP_VIA_DRAG,a.DRAWING_STAMP_VIA_CLICK]}]},{key:W.FORM_CONTROL,children:[V.RESIZE_AND_MOVE_FORM,a.DELETE_FORM]},{key:W.SHORTCUT,children:[a.SHORTCUT_COPY_PASTE,a.SHORTCUT_UNDO_REDO,a.SHORTCUT_COPY_TEXT,a.SHORTCUT_PRINT,a.SHORTCUT_QUICK_ACTION]},{key:W.SAVE_OPTION,children:[a.SAVE_OPTION_SPEED_OPTIMIZE,a.SAVE_OPTION_SIZE_OPTIMIZE]},a.AUTO_SAVE,a.COLLECT_STATISTIC_BY_VIEWER]},wo={[W.MAIN_TOOLBAR]:{value:!1,name:"MAIN_TOOLBAR",description:"SETTINGS_MAIN_TOOLBAR_DESCRIPTION"},[W.MAIN_MENU]:{value:!1,name:"MENU",description:"SETTINGS_MENU_DESCRIPTION"},[a.SAVE_BUTTON]:{value:v(a.SAVE_BUTTON),name:"SAVE",description:"SETTINGS_SAVE_DESCRIPTION",tooltip:"SETTINGS_SAVE_TOOLTIP"},[a.ORIGINAL_DOWNLOAD_BUTTON]:{value:v(a.ORIGINAL_DOWNLOAD_BUTTON),name:"ORIGINAL_DOWNLOAD",description:"SETTINGS_DOWNLOAD_ORIGINAL_DESCRIPTION"},[a.PDF_DOWNLOAD_BUTTON]:{value:v(a.PDF_DOWNLOAD_BUTTON),name:"PDF_DOWNLOAD",description:"SETTINGS_DOWNLOAD_PDF_DESCRIPTION"},[a.PRINT_BUTTON]:{value:v(a.PRINT_BUTTON),name:"PRINT",description:"SETTINGS_PRINT_DESCRIPTION"},[a.QUICK_ACTION_BUTTON]:{value:v(a.QUICK_ACTION_BUTTON),name:"QUICK_ACTION",description:"SETTINGS_QUICK_ACTION_DESCRIPTION",icons:["map-magnifier"]},[a.CAPTURE_MODE_BUTTON]:{value:v(a.CAPTURE_MODE_BUTTON),name:"CAPTURE",description:"SETTINGS_CAPTURE_MODE_DESCRIPTION",icons:["capture-tool"]},[a.DOCUMENT_INFO_BUTTON]:{value:v(a.DOCUMENT_INFO_BUTTON),name:"DOC_PROPERTY",description:"SETTINGS_DOC_PROPERTY_DESCRIPTION"},[a.SLIDESHOW_BUTTON]:{value:v(a.SLIDESHOW_BUTTON),name:"SLIDESHOW",description:"SETTINGS_SLIDESHOW_DESCRIPTION"},[a.EBOOK_BUTTON]:{value:v(a.EBOOK_BUTTON),name:"EBOOK",description:"SETTINGS_EBOOK_MODE_DESCRIPTION"},[a.PREFERENCES_BUTTON]:{value:v(a.PREFERENCES_BUTTON),name:"PREFERENCES",description:"SETTINGS_PREFERENCES_DESCRIPTION"},[a.SCREEN_THEME_MENU]:{value:v(a.SCREEN_THEME_MENU),name:"SCREEN_THEME",description:"SETTINGS_SCREEN_THEME_DESCRIPTION"},[a.SD_INFO_BUTTON]:{value:v(a.SD_INFO_BUTTON),name:"SD_INFO",description:"SETTINGS_SD_INFO_DESCRIPTION"},[V.LEFT_SIDE_VIEW_BUTTON]:{value:v(V.LEFT_SIDE_VIEW_BUTTON),name:"LEFT_SIDE_VIEW_BUTTON",description:"SETTINGS_LEFT_SIDE_VIEW_DESCRIPTION"},[a.THUMBNAIL_VIEW_BUTTON]:{value:v(a.THUMBNAIL_VIEW_BUTTON),icons:["list"],name:"THUMBNAIL",description:"SETTINGS_THUMBNAIL_DESCRIPTION"},[a.OUTLINE_VIEW_BUTTON]:{value:v(a.OUTLINE_VIEW_BUTTON),icons:["bookmark"],name:"OUTLINE",description:"SETTINGS_OUTLINE_DESCRIPTION"},[a.ANNOTATION_VIEW_BUTTON]:{value:v(a.ANNOTATION_VIEW_BUTTON),icons:["annotation-list"],name:"ANNOTATION_LIST",description:"SETTINGS_ANNOTATION_LIST_DESCRIPTION"},[a.REDACTION_VIEW_BUTTON]:{value:v(a.REDACTION_VIEW_BUTTON),icons:["redaction2"],name:"REDACT",description:"SETTINGS_REDACTION_DESCRIPTION"},[a.EMBEDDED_FILE_VIEW_BUTTON]:{value:v(a.EMBEDDED_FILE_VIEW_BUTTON),icons:["clip"],name:"EMBEDDED_FILE",description:"SETTINGS_ATTACHMENTS_DESCRIPTION"},[a.FORM_VIEW_BUTTON]:{value:v(a.FORM_VIEW_BUTTON),icons:["formfield"],name:"FORM_TOOL",description:"SETTINGS_FORM_TOOL_DESCRIPTION"},[a.SIGNATURE_VIEW_BUTTON]:{value:v(a.SIGNATURE_VIEW_BUTTON),icons:["sign-list"],name:"SIGN_LIST",description:"SETTINGS_SIGN_LIST_DESCRIPTION"},[a.SCALE_DROPDOWN]:{value:v(a.SCALE_DROPDOWN),name:"EDIT_MAGNIFICATION",description:"SETTINGS_EDIT_MAGNIFICATION_DESCRIPTION"},[a.FIT_BUTTON]:{value:v(a.FIT_BUTTON),icons:["fit-height3","fit-width3"],name:"FIT_TO_HEIGHT_AND_WIDTH",description:"SETTINGS_FIT_TO_HEIGHT_AND_WIDTH_DESCRIPTION"},[V.VIEW_MODE_BUTTON]:{value:v(V.VIEW_MODE_BUTTON),name:"VIEW_MODE_AND_ROTATE",description:"SETTINGS_VIEW_MODE_AND_RORATE_DESCRIPTION"},[a.VIEW_MODE_BUTTON]:{value:v(a.VIEW_MODE_BUTTON),icons:["two-page-continuous3"],name:"VIEW_MODE",description:"SETTINGS_VIEW_MODE_DESCRIPTION"},[a.ROTATION_BUTTON]:{value:v(a.ROTATION_BUTTON),icons:["rotate"],name:"ROTATION",description:"SETTINGS_ROTATION_DESCRIPTION"},[V.DRAG_MODE_BUTTONS]:{value:v(V.DRAG_MODE_BUTTONS),name:"DRAG_MODE",description:"SETTINGS_DRAG_MODE_DESCRIPTION"},[a.DRAG_MODE_MOVE_BUTTON]:{value:v(a.DRAG_MODE_MOVE_BUTTON),icons:["hand"],name:"SCROLL_MODE",description:"SETTINGS_SCROLL_MODE_DESCRIPTION"},[a.DRAG_MODE_SELECT_TEXT_BUTTON]:{value:v(a.DRAG_MODE_SELECT_TEXT_BUTTON),icons:["selection-annotation-text"],name:"SELECT_TEXT",description:"SETTINGS_SELECT_TEXT_DESCRIPTION"},[a.DRAG_MODE_MAGNIFY_BUTTON]:{value:v(a.DRAG_MODE_MAGNIFY_BUTTON),icons:["area-zoom2"],name:"MAGNIFICATION_TOOL",description:"SETTINGS_MAGNIFICATION_TOOL_DESCRIPTION"},[V.ANNOT_TOOLBAR]:{value:v(V.ANNOT_TOOLBAR),name:"TOOL_ANNOT",description:"SETTINGS_TOOL_ANNOT_DESCRIPTION"},[a.ANNOT_TOOLBAR_UNDO_REDO_BUTTONS]:{value:v(a.ANNOT_TOOLBAR_UNDO_REDO_BUTTONS),icons:["undo","redo"],name:"UNDO_REDO",description:"SETTINGS_UNDO_REDO_DESCRIPTION"},[a.ANNOT_TOOLBAR_DRAG_MODE_SELECT_ANNOT]:{value:v(a.ANNOT_TOOLBAR_DRAG_MODE_SELECT_ANNOT),icons:["pointer"],name:"SELECT_ANNOT_TOOL",description:"SETTINGS_SELECT_ANNOT_TOOL_DESCRIPTION"},[V.DRAWING_ANNOTATION_BUTTONS]:{value:v(V.DRAWING_ANNOTATION_BUTTONS),name:"DRAW_ANNOTS_TOOL",description:"SETTINGS_DRAW_ANNOTS_TOOL_DESCRIPTION"},[a.INK_ANNOTATION_BUTTON]:{value:v(a.INK_ANNOTATION_BUTTON),icons:["pen"],name:"INK_TOOL",description:"SETTINGS_INK_TOOL_DESCRIPTION"},[a.LINE_ANNOTATION_BUTTON]:{value:v(a.LINE_ANNOTATION_BUTTON),icons:["line"],name:"LINE_TOOL",description:"SETTINGS_LINE_TOOL_DESCRIPTION"},[a.SQUARE_ANNOTATION_BUTTON]:{value:v(a.SQUARE_ANNOTATION_BUTTON),icons:["square"],name:"SQUARE_TOOL",description:"SETTINGS_SQUARE_TOOL_DESCRIPTION"},[a.CIRCLE_ANNOTATION_BUTTON]:{value:v(a.CIRCLE_ANNOTATION_BUTTON),icons:["circle"],name:"CIRCLE_TOOL",description:"SETTINGS_CIRCLE_TOOL_DESCRIPTION"},[a.POLYGON_ANNOTATION_BUTTON]:{value:v(a.POLYGON_ANNOTATION_BUTTON),icons:["polygon"],name:"POLYGON_TOOL",description:"SETTINGS_POLYGON_TOOL_DESCRIPTION"},[a.POLYLINE_ANNOTATION_BUTTON]:{value:v(a.POLYLINE_ANNOTATION_BUTTON),icons:["polyline"],name:"POLYLINE_TOOL",description:"SETTINGS_POLYLINE_TOOL_DESCRIPTION"},[a.CLOUD_ANNOTATION_BUTTON]:{value:v(a.CLOUD_ANNOTATION_BUTTON),icons:["revisioncloud"],name:"POLYGON_CLOUD_TOOL",description:"SETTINGS_POLYGON_CLOUD_TOOL_DESCRIPTION"},[a.FREE_TEXT_ANNOTATION_BUTTON]:{value:v(a.FREE_TEXT_ANNOTATION_BUTTON),icons:["textbox"],name:"FREE_TEXT_TOOL",description:"SETTINGS_FREE_TEXT_TOOL_DESCRIPTION"},[a.FREE_TEXT_CALLOUT_ANNOTATION_BUTTON]:{value:v(a.FREE_TEXT_CALLOUT_ANNOTATION_BUTTON),icons:["callout2"],name:"FREE_TEXT_CALLOUT_TOOL",description:"SETTINGS_FREE_TEXT_CALLOUT_TOOL_DESCRIPTION"},[a.MEMO_ANNOTATION_BUTTON]:{value:v(a.MEMO_ANNOTATION_BUTTON),icons:["memo3"],name:"TEXT_TOOL",description:"SETTINGS_TEXT_TOOL_DESCRIPTION"},[V.MEASURE_ANNOTATION_BUTTONS]:{value:v(V.MEASURE_ANNOTATION_BUTTONS),name:"MEASUREMENT_TOOLS",description:"SETTINGS_MEASUREMENT_TOOLS_DESCRIPTION"},[a.LINE_DIMENSION_ANNOTATION_BUTTON]:{value:v(a.LINE_DIMENSION_ANNOTATION_BUTTON),icons:["line-measure2"],name:"DISTANCE_TOOL",description:"SETTINGS_DISTANCE_TOOL_DESCRIPTION"},[a.POLYLINE_DIMENSION_ANNOTATION_BUTTON]:{value:v(a.POLYLINE_DIMENSION_ANNOTATION_BUTTON),icons:["polyline-measure2"],name:"PERIMETER_TOOL",description:"SETTINGS_PERIMETER_TOOL_DESCRIPTION"},[a.POLYGON_DIMENSION_ANNOTATION_BUTTON]:{value:v(a.POLYGON_DIMENSION_ANNOTATION_BUTTON),icons:["polygon-measure2"],name:"AREA_TOOL",description:"SETTINGS_AREA_TOOL_DESCRIPTION"},[a.STAMP_ANNOTATION_BUTTON]:{value:v(a.STAMP_ANNOTATION_BUTTON),icons:["stamp2"],name:"STAMP_TOOL",description:"SETTINGS_STAMP_TOOL_DESCRIPTION"},[a.HIGHLIGHT_ANNOTATION_BUTTON]:{value:v(a.HIGHLIGHT_ANNOTATION_BUTTON),icons:["text-highlight"],name:"HIGHLIGHT",description:"SETTINGS_HIGHLIGHT_DESCRIPTION"},[a.STRIKEOUT_ANNOTATION_BUTTON]:{value:v(a.STRIKEOUT_ANNOTATION_BUTTON),icons:["text-strikeout"],name:"STRIKEOUT",description:"SETTINGS_STRIKEOUT_DESCRIPTION"},[a.UNDERLINE_ANNOTATION_BUTTON]:{value:v(a.UNDERLINE_ANNOTATION_BUTTON),icons:["text-underline"],name:"UNDERLINE",description:"SETTINGS_UNDERLINE_DESCRIPTION"},[a.LINK_ANNOTATION_BUTTON]:{value:v(a.LINK_ANNOTATION_BUTTON),icons:["link"],name:"CREATE_LINK",description:"SETTINGS_CREATE_LINK_DESCRIPTION"},[a.ERASER_BUTTON]:{value:v(a.ERASER_BUTTON),icons:["eraser"],name:"ERASER",description:"SETTINGS_ERASER_DESCRIPTION"},[a.SIGNATURE_WIDGET_BUTTON]:{value:v(a.SIGNATURE_WIDGET_BUTTON),icons:["signature"],name:"SIGN",description:"SETTINGS_SIGN_DESCRIPTION"},[a.ANNOT_TOOLBAR_ANNOT_PROPERTY_BUTTON]:{value:v(a.ANNOT_TOOLBAR_ANNOT_PROPERTY_BUTTON),icons:["show-panel"],name:"PROPERTIES_PANEL",description:"SETTINGS_PROPERTIES_PANEL_DESCRIPTION"},[V.FORM_TOOLBAR]:{value:v(V.FORM_TOOLBAR),name:"TOOL_FORM",description:"SETTINGS_TOOL_FORM_DESCRIPTION"},[a.FORM_TOOLBAR_UNDO_REDO_BUTTON]:{value:v(a.FORM_TOOLBAR_UNDO_REDO_BUTTON),icons:["undo","redo"],name:"UNDO_REDO",description:"SETTINGS_UNDO_REDO_DESCRIPTION"},[a.FORM_TOOLBAR_DRAG_MODE_SELECT_ANNOT]:{value:v(a.FORM_TOOLBAR_DRAG_MODE_SELECT_ANNOT),icons:["pointer"],name:"SELECT_ANNOT_TOOL",description:"SETTINGS_SELECT_ANNOT_TOOL_DESCRIPTION"},[a.TEXT_FIELD_WIDGET_BUTTON]:{value:v(a.TEXT_FIELD_WIDGET_BUTTON),icons:["text-field"],name:"TEXT_FIELD",description:"SETTINGS_TEXT_FIELD_DESCRIPTION"},[a.COMBO_BOX_WIDGET_BUTTON]:{value:v(a.COMBO_BOX_WIDGET_BUTTON),icons:["dropdown"],name:"COMBO_BOX",description:"SETTINGS_COMBO_BOX_DESCRIPTION"},[a.LIST_BOX_WIDGET_BUTTON]:{value:v(a.LIST_BOX_WIDGET_BUTTON),icons:["list-box"],name:"LIST_BOX",description:"SETTINGS_LIST_BOX_DESCRIPTION"},[a.CHECK_BOX_WIDGET_BUTTON]:{value:v(a.CHECK_BOX_WIDGET_BUTTON),icons:["check-mark3"],name:"CHECK_BUTTON",description:"SETTINGS_CHECK_BUTTON_DESCRIPTION"},[a.RADIO_BUTTON_WIDGET_BUTTON]:{value:v(a.RADIO_BUTTON_WIDGET_BUTTON),icons:["radio2-checked"],name:"RADIO_BUTTON",description:"SETTINGS_RADIO_BUTTON_DESCRIPTION"},[a.BUTTON_WIDGET_BUTTON]:{value:v(a.BUTTON_WIDGET_BUTTON),icons:["ok"],name:"BUTTON",description:"SETTINGS_BUTTON_DESCRIPTION"},[a.RULER_BUTTON]:{value:v(a.RULER_BUTTON),icons:["ruler-show"],name:"RULER",description:"SETTINGS_FORM_RULER_DESCRIPTION"},[a.WIDGET_HIGHLIGHT_BUTTON]:{value:v(a.WIDGET_HIGHLIGHT_BUTTON),icons:["area-show"],name:"FORM_HIGHLIGHTED",description:"SETTINGS_FORM_HIGHLIGHTED_DESCRIPTION"},[a.FORM_TOOLBAR_ANNOT_PROPERTY_BUTTON]:{value:v(a.FORM_TOOLBAR_ANNOT_PROPERTY_BUTTON),icons:["show-panel"],name:"PROPERTIES_PANEL",description:"SETTINGS_FORM_PROPERTIES_PANEL_DESCRIPTION"},[V.PKI_SIGNATURE_TOOLBAR]:{value:v(V.PKI_SIGNATURE_TOOLBAR),name:"PKI_SIGN",description:"SETTINGS_PKI_SIGN_DESCRIPTION"},[a.PKI_INSTANT_SIGNATURE_BUTTON]:{value:v(a.PKI_INSTANT_SIGNATURE_BUTTON),icons:["signature"],name:"INSTANT_SIGNATURE",description:"SETTINGS_INSTANT_SIGNATURE_DESCRIPTION"},[a.PKI_INVISIBLE_SIGNATURE_BUTTON]:{value:v(a.PKI_INVISIBLE_SIGNATURE_BUTTON),icons:["memo2"],name:"INVISIBLE_SIGNATURE",description:"SETTINGS_INVISIBLE_SIGNATURE_DESCRIPTION"},[a.DAP_VIEW_BUTTON]:{value:v(a.DAP_VIEW_BUTTON),icons:["composite-document"],name:"DAP_VIEW",description:"SETTINGS_DAP_VIEW_DESCRIPTION",deps:[V.DAP_VIEW]},[V.FLOATING_NAVIGATION]:{value:v(V.FLOATING_NAVIGATION),name:"FLOATING_NAVIGATION",description:"SETTINGS_FLOATING_NAVIGATION_DESCRIPTION",excludeDeps:[a.FLOATING_NAVIGATION_AUTO_HIDE]},[a.PAGE_NAVIGATION]:{value:v(a.PAGE_NAVIGATION),name:"MOVE_SPECIFYING_PAGE",description:"SETTINGS_MOVE_SPECIFYING_PAGE_DESCRIPTION"},[a.MOVE_TO_ADJACENT_PAGE_BUTTON]:{value:v(a.MOVE_TO_ADJACENT_PAGE_BUTTON),icons:["previous-symbol2","next-symbol2"],name:"MOVE_TO_ADJACENT_PAGE",description:"SETTINGS_MOVE_TO_ADJACENT_PAGE_DESCRIPTION"},[a.ZOOM_BUTTON]:{value:v(a.ZOOM_BUTTON),icons:["minus","plus"],name:"ZOOM_IN_OUT",description:"SETTINGS_ZOOM_IN_OUT_DESCRIPTION"},[a.QUICK_SEARCH_BUTTON]:{value:v(a.QUICK_SEARCH_BUTTON),icons:["search"],name:"QUICK_SEARCH",description:"SETTINGS_QUICK_SEARCH_DESCRIPTION"},[a.FULL_SEARCH_BUTTON]:{value:v(a.FULL_SEARCH_BUTTON),icons:["extend"],name:"TEXT_SEARCH_VIEW_TITLE",description:"SETTINGS_FULL_SEARCH_DESCRIPTION"},[a.FLOATING_NAVIGATION_AUTO_HIDE]:{value:v(a.FLOATING_NAVIGATION_AUTO_HIDE),name:"FLOATING_NAVIGATION_AUTO_HIDE",description:"SETTINGS_FLOATING_NAVIGATION_AUTO_HIDE_DESCRIPTION",deps:[V.FLOATING_NAVIGATION]},[W.DIALOG]:{value:!1,isDummy:!0,name:"SETTINGS_DIALOG",description:"SETTINGS_DIALOG_DESCRIPTION"},[V.PRINT_DIALOG]:{value:v(V.PRINT_DIALOG),name:"PRINT",description:"SETTINGS_PRINT_DESCRIPTION"},[a.BROWSER_PRINT]:{value:v(a.BROWSER_PRINT),icons:["print"],name:"BROWSER_PRINT",description:"SETTINGS_BROWSER_PRINT_DESCRIPTION"},[a.PLUGIN_PRINT]:{value:v(a.PLUGIN_PRINT),icons:["download"],name:"PLUGIN_PRINT",description:"SETTINGS_PLUGIN_PRINT_DESCRIPTION"},[V.DOCUMENT_INFO_DIALOG]:{value:v(V.DOCUMENT_INFO_DIALOG),name:"DOC_PROPERTY",description:"SETTINGS_DOC_PROPERTY_DESCRIPTION"},[a.DOCUMENT_INFO_DESCRIPTION]:{value:v(a.DOCUMENT_INFO_DESCRIPTION),name:"GENERAL",description:"SETTINGS_DOC_INFO_DESCRIPTION"},[a.DOCUMENT_INFO_SECURITY]:{value:v(a.DOCUMENT_INFO_SECURITY),name:"PERMISSIONS",description:"SETTINGS_PERMISSIONS_DESCRIPTION"},[V.PREFERENCES_DIALOG]:{value:v(V.PREFERENCES_DIALOG),name:"PREFERENCES",description:"SETTINGS_PREFERENCES_DESCRIPTION"},[a.PREFERENCES_DEFAULT_FIT]:{value:v(a.PREFERENCES_DEFAULT_FIT),name:"DEFAULT_ZOOM",description:"SETTINGS_DEFAULT_ZOOM_DESCRIPTION"},[a.PREFERENCES_LINK_ACTIVATION]:{value:v(a.PREFERENCES_LINK_ACTIVATION),name:"LINK_ACTIVATION",description:"SETTINGS_LINK_ACTIVATION_DESCRIPTION"},[a.PREFERENCES_LANGUAGE]:{value:v(a.PREFERENCES_LANGUAGE),name:"LANGUAGE",description:"SETTINGS_LANGUAGE_DESCRIPTION"},[a.PREFERENCES_WIDGET_HIGHLIGHT]:{value:v(a.PREFERENCES_WIDGET_HIGHLIGHT),name:"FORMFIELD_HIGHLIGHTED",description:"SETTINGS_FORMFIELD_HIGHLIGHTED_DESCRIPTION"},[a.PREFERENCES_ANNOTATION_AUTHOR]:{value:v(a.PREFERENCES_ANNOTATION_AUTHOR),name:"ANNOTATION_AUTHOR",description:"SETTINGS_ANNOTATION_AUTHOR_DESCRIPTION"},[a.PREFERENCES_POPUP_TEXT_SIZE]:{value:v(a.PREFERENCES_POPUP_TEXT_SIZE),name:"VIEW_POPUP",description:"SETTINGS_VIEW_POPUP_DESCRIPTION"},[a.PREFERENCES_CONTINUOUS_ANNOT_WRITING]:{value:v(a.PREFERENCES_CONTINUOUS_ANNOT_WRITING),name:"CONTINUOUS_ANNOT_WRITING",description:"SETTINGS_CONTINUOUS_ANNOT_WRITING_DESCRIPTION"},[a.PREFERENCES_REDACTION_COLOR]:{value:v(a.PREFERENCES_REDACTION_COLOR),name:"REDACT_COLOR",description:"SETTINGS_REDACT_COLOR_DESCRIPTION"},[a.PREFERENCES_DISPLAY_ORIENTATION]:{value:v(a.PREFERENCES_DISPLAY_ORIENTATION),name:"VIEWER_DIRECTION",description:"SETTINGS_VIEWER_DIRECTION_DESCRIPTION"},[W.STMAP_DIALOG]:{value:!1,isDummy:!0,name:"STAMP_SELECTION_DIALOG",description:"SETTINGS_STAMP_SELECTION_DIALOG_DESCRIPTION"},[a.USE_SAMPLE_STAMP_IMAGE]:{value:v(a.USE_SAMPLE_STAMP_IMAGE),name:"STAMP_SAMPLE",description:"SETTINGS_STAMP_SAMPLE_DESCRIPTION"},[a.UPLOAD_STAMP_IMAGE]:{value:v(a.UPLOAD_STAMP_IMAGE),name:"STAMP_FILE_ADD",description:"SETTINGS_STAMP_FILE_ADD_DESCRIPTION"},[W.SIGNATURE_DIALOG]:{value:!1,isDummy:!0,name:"SIGNATURE_DRAWING_DIALOG",description:"SETTINGS_SIGNATURE_DIALOG_DESCRIPTION"},[a.SIGN_DIALOG_HISTORY]:{value:v(a.SIGN_DIALOG_HISTORY),name:"SIGN_VIEW_HISTORY",description:"SETTINGS_SIGN_VIEW_HISTORY_DESCRIPTION"},[W.PANEL]:{value:!1,isDummy:!0,name:"PANEL_SETTINGS",description:"SETTINGS_PANEL_DESCRIPTION"},[W.THUMBNAIL_VIEW]:{value:!1,isDummy:!0,name:"THUMBNAIL",description:"SETTINGS_THUMBNAIL_DESCRIPTION"},[a.THUMBNAIL_VIEW_EDIT]:{value:v(a.THUMBNAIL_VIEW_EDIT),name:"EDIT",description:"SETTINGS_PAGE_EDIT_DESCRIPTION"},[W.OUTLINE_VIEW]:{value:!1,isDummy:!0,name:"OUTLINE",description:"SETTINGS_OUTLINE_DESCRIPTION"},[a.OUTLINE_VIEW_EDIT]:{value:v(a.OUTLINE_VIEW_EDIT),name:"ADD_AND_DELETE",description:"SETTINGS_OUTLINE_ADD_AND_DELETE_DESCRIPTION"},[a.OUTLINE_VIEW_DEFAULT_EXPAND]:{value:v(a.OUTLINE_VIEW_DEFAULT_EXPAND),name:"OUTLINE_DEFAULT_EXPAND",description:"SETTINGS_OUTLINE_DEFAULT_EXPAND_DESCRIPTION"},[W.ANNOTATION_VIEW]:{value:!1,isDummy:!0,name:"ANNOTATION_LIST",description:"SETTINGS_ANNOTATION_DESCRIPTION"},[a.ANNOTATION_VIEW_REPLY]:{value:v(a.ANNOTATION_VIEW_REPLY),name:"ANNOTATION_REPLY",description:"SETTINGS_ANNOTATION_REPLY_DESCRIPTION"},[W.EMBEDDED_FILE_VIEW]:{value:!1,isDummy:!0,name:"EMBEDDED_FILE",description:"SETTINGS_ATTACHMENTS_DESCRIPTION"},[a.EMBEDDED_FILE_VIEW_EDIT]:{value:v(a.EMBEDDED_FILE_VIEW_EDIT),name:"ATTACHMENTS_AND_DELETE",description:"SETTINGS_ATTACHMENTS_AND_DELETE_DESCRIPTION"},[a.EMBEDDED_FILE_VIEW_DOWNLOAD]:{value:v(a.EMBEDDED_FILE_VIEW_DOWNLOAD),name:"DOWNLOAD",description:"SETTINGS_ATTACHED_FILE_DOWNLOAD_DESCRIPTION"},[V.ANNOT_PROPERTY_VIEW_ATTRIBUTES]:{value:v(V.ANNOT_PROPERTY_VIEW_ATTRIBUTES),name:"ANNOTATION_PROPERTIES",description:"SETTINGS_PROPERTIES_PANEL_DESCRIPTION"},[a.WIDGET_PROPERTY_OPTION]:{value:v(a.WIDGET_PROPERTY_OPTION),name:"OPTION",description:"SETTINGS_OPTION_DESCRIPTION"},[a.WIDGET_PROPERTY_CALCULATION]:{value:v(a.WIDGET_PROPERTY_CALCULATION),name:"FIELD_PROPERTY_CALCULATE",description:"SETTINGS_FIELD_PROPERTY_CALCULATE_DESCRIPTION"},[a.WIDGET_PROPERTY_ACTION]:{value:v(a.WIDGET_PROPERTY_ACTION),name:"ACTION",description:"SETTINGS_ACTION_DESCRIPTION"},[W.TEXT_SEARCH_VIEW]:{value:!1,isDummy:!0,name:"TEXT_SEARCH_VIEW_TITLE",description:"SETTINGS_FULL_SEARCH_DESCRIPTION"},[a.TEXT_SEARCH_VIEW_REGEX]:{value:v(a.TEXT_SEARCH_VIEW_REGEX),name:"USE_REGEX",description:"SETTINGS_SEARCH_REGEX_DESCRIPTION"},[W.REGEX_BUTTON]:{value:!1,icons:["plus"],name:"ADD_USER_DEFINED_REGEX",description:"",editable:!0},[W.DAP_VIEW]:{value:!1,isDummy:!0,name:"DAP_VIEW",description:"SETTINGS_DAP_VIEW_DESCRIPTION"},[a.DAP_VIEW_TREE]:{value:v(a.DAP_VIEW_TREE),name:"VIEW_AS_TREE",description:"SETTINGS_VIEWED_DAP_LIST_TREE_DESCRIPTION"},[a.DAP_VIEW_TABLE]:{value:v(a.DAP_VIEW_TABLE),name:"VIEW_AS_TABLE",description:"SETTINGS_VIEWED_DAP_LIST_TABLE_DESCRIPTION"},[a.DAP_VIEW_DEFAULT_OPEN]:{value:v(a.DAP_VIEW_DEFAULT_OPEN),name:"DAP_VIEW_DEFAULT_OPEN",description:"SETTINGS_DAP_VIEW_DEFAULT_OPEN_DESCRIPTION",deps:[V.DAP_VIEW,a.DAP_VIEW_BUTTON]},[W.DEFAULT_VIEWED_DAP_LIST]:{value:!1,name:"DEFAULT_VIEWED_DAP_LIST",description:"SETTINGS_DEFAULT_VIEWED_DAP_LIST_DESCRIPTION",isRadio:!0,deps:[a.DAP_VIEW_TREE,a.DAP_VIEW_TABLE]},[a.DAP_VIEW_DEFAULT_VIEW_TREE]:{value:v(a.DAP_VIEW_DEFAULT_VIEW_TREE),name:"VIEW_AS_TREE",description:"SETTINGS_VIEWED_DAP_LIST_TREE_DESCRIPTION",isRadio:!0,deps:[a.DAP_VIEW_TREE,a.DAP_VIEW_TABLE]},[a.DAP_VIEW_DEFAULT_VIEW_TABLE]:{value:v(a.DAP_VIEW_DEFAULT_VIEW_TABLE),name:"VIEW_AS_TABLE",description:"SETTINGS_VIEWED_DAP_LIST_TABLE_DESCRIPTION",isRadio:!0,deps:[a.DAP_VIEW_TREE,a.DAP_VIEW_TABLE]},[W.ETC_UI]:{value:!1,isDummy:!0,name:"ETC",description:"SETTINGS_ETC_DESCRIPTION"},[V.INDICATOR]:{value:v(V.INDICATOR),name:"FUNCTION_GUIDE",description:"SETTINGS_FUNCTION_GUIDE_DESCRIPTION"},[a.SCALE_INDICATOR]:{value:v(a.SCALE_INDICATOR),name:"SCALE_GUIDE",description:"SETTINGS_SCALE_GUIDE_DESCRIPTION"},[a.MEASURE_INDICATOR]:{value:v(a.MEASURE_INDICATOR),name:"MEASURE_GUIDE",description:"SETTINGS_MEASURE_GUIDE_DESCRIPTION"},[a.PAGE_INDICATOR]:{value:v(a.PAGE_INDICATOR),name:"PAGE_GUIDE",description:"SETTINGS_PAGE_GUIDE_DESCRIPTION"},[a.HIDE_SAVE_DOWNLOAD_PRINT_IN_MENU]:{value:v(a.HIDE_SAVE_DOWNLOAD_PRINT_IN_MENU),name:"FILE_MENUS_UI",description:"SETTINGS_FILE_MENUS_UI_DESCRIPTION"},[V.ANNOTATION_FLOATING_MENU]:{value:v(V.ANNOTATION_FLOATING_MENU),name:"ANNOTATION_FLOATING_MENU",description:"SETTINGS_ANNOTATION_FLOATING_MENU_DESCRIPTION"},[a.ANNOT_FLOATING_PROPERTY]:{value:v(a.ANNOT_FLOATING_PROPERTY),icons:["settings"],name:"ANNOTATION_PROPERTIES",description:"SETTINGS_ANNOTATION_FLOATING_PROPERTY_DESCRIPTION"},[a.ANNOT_FLOATING_POPUP_NOTE]:{value:v(a.ANNOT_FLOATING_POPUP_NOTE),icons:["memo2"],name:"ANNOT_FLOATING_POPUP_NOTE",description:"SETTINGS_ANNOTATION_FLOATING_POPUP_NOTE_DESCRIPTION"},[a.ANNOT_FLOATING_ADD_RADIO_BUTTON]:{value:v(a.ANNOT_FLOATING_ADD_RADIO_BUTTON),icons:["plus"],name:"ANNOT_FLOATING_ADD_RADIO_BUTTON",description:"SETTINGS_ANNOTATION_FLOATING_ADD_RADIO_BUTTON_DESCRIPTION"},[a.ANNOT_FLOATING_DELETE]:{value:v(a.ANNOT_FLOATING_DELETE),icons:["trash-can"],name:"DELETE",description:"SETTINGS_ANNOTATION_FLOATING_DELETE_DESCRIPTION"},[a.CHANGE_PRIMARY_COLOR]:{value:v(a.CHANGE_PRIMARY_COLOR),name:"CHANGE_PRIMARY_COLOR",description:"SETTINGS_CHANGE_PRIMARY_COLOR_DESCRIPTION"},[W.DEFAULT_SCREEN_THEME]:{value:!1,name:"SCREEN_THEME",description:"SETTINGS_DEFAULT_SCREEN_THEME_DESCRIPTION",isRadio:!0},[a.SCREEN_THEME_LIGHT]:{value:v(a.SCREEN_THEME_LIGHT),name:"SETTINGS_SCREEN_THEME_LIGHT",description:"SETTINGS_SCREEN_THEME_LIGHT_DESCRIPTION",isRadio:!0},[a.SCREEN_THEME_DARK]:{value:v(a.SCREEN_THEME_DARK),name:"SETTINGS_SCREEN_THEME_DARK",description:"SETTINGS_SCREEN_THEME_DARK_DESCRIPTION",isRadio:!0},[a.SCREEN_THEME_SYSTEM]:{value:v(a.SCREEN_THEME_SYSTEM),name:"SETTINGS_SCREEN_THEME_SYSTEM",description:"SETTINGS_SCREEN_THEME_SYSTEM_DESCRIPTION",isRadio:!0},[a.PRIMARY_50]:{value:v(a.PRIMARY_50),name:"PRIMARY_COLOR_50",description:"SETTINGS_PRIMARY_50_DESCRIPTION",isColorPicker:!0,deps:[a.CHANGE_PRIMARY_COLOR]},[a.PRIMARY_70]:{value:v(a.PRIMARY_70),name:"PRIMARY_COLOR_70",description:"SETTINGS_PRIMARY_70_DESCRIPTION",isColorPicker:!0,deps:[a.CHANGE_PRIMARY_COLOR]},[a.WELCOME_PAGE_VISIBLE]:{value:v(a.WELCOME_PAGE_VISIBLE),name:"WELCOME_PAGE",description:"SETTINGS_WELCOME_PAGE_ACCESS"},[a.USE_SPREADSHEETS_VIEWER]:{value:v(a.USE_SPREADSHEETS_VIEWER),name:"SPREADSHEETS_VIEWER",description:"SETTINGS_SPREADSHEETS_VIEWER_DESCRIPTION"},[W.FRONTEND_API]:{value:!1,name:"FRONTEND_API",description:"SETTINGS_FRONTEND_API_DESCRIPTION"},[a.USE_STREAMDOCS_API]:{value:v(a.USE_STREAMDOCS_API),name:"FRONTEND_API_ALLOW",description:"SETTINGS_FRONTEND_API_ALLOW_DESCRIPTION"},[a.DELAY_LOADING]:{value:v(a.DELAY_LOADING),name:"DELAY_LOADING",description:"SETTINGS_DELAY_LOADING_DESCRIPTION"},[a.PAGE_TITLE]:{value:v(a.PAGE_TITLE),name:"PAGE_TITLE",description:"SETTINGS_PAGE_TITLE_DESCRIPTION",isText:!0},[a.WARNING_LEAVE_WITHOUT_SAVE]:{value:v(a.WARNING_LEAVE_WITHOUT_SAVE),name:"LEAVE_PAGE",description:"SETTINGS_LEAVE_PAGE_DESCRIPTION"},[W.DEFAULT_VIEW_MODE]:{value:v(W.DEFAULT_VIEW_MODE),name:"DEFAULT_VIEW_MODE",description:"SETTINGS_DEFAULT_VIEW_MODE_DESCRIPTION",isRadio:!0},[a.DEFAULT_VIEW_MODE_ONE]:{value:v(a.DEFAULT_VIEW_MODE_ONE),name:"SINGLE_PAGE_VIEW",description:"SETTINGS_VIEW_MODE_ONE_DESCRIPTION",isRadio:!0},[a.DEFAULT_VIEW_MODE_ONE_C]:{value:v(a.DEFAULT_VIEW_MODE_ONE_C),name:"SINGLE_PAGE_CONTINUOUS",description:"SETTINGS_VIEW_MODE_ONE_C_DESCRIPTION",isRadio:!0},[a.DEFAULT_VIEW_MODE_TWO]:{value:v(a.DEFAULT_VIEW_MODE_TWO),name:"TWO_PAGE_VIEW",description:"SETTINGS_VIEW_MODE_TWO_DESCRIPTION",isRadio:!0},[a.DEFAULT_VIEW_MODE_TWO_C]:{value:v(a.DEFAULT_VIEW_MODE_TWO_C),name:"TWO_PAGE_CONTINUOUS",description:"SETTINGS_VIEW_MODE_TWO_C_DESCRIPTION",isRadio:!0},[a.DEFAULT_VIEW_MODE_EBOOK]:{value:v(a.DEFAULT_VIEW_MODE_EBOOK),name:"VIEW_MODE_EBOOK",description:"SETTINGS_VIEW_MODE_EBOOK_DESCRIPTION",isRadio:!0},[W.DEFAULT_ZOOM]:{value:v(W.DEFAULT_ZOOM),name:"DEFAULT_ZOOM",description:"SETTINGS_ADMIN_DEFAULT_ZOOM_DESCRIPTION",isRadio:!0},[a.DEFAULT_ZOOM_READ]:{value:v(a.DEFAULT_ZOOM_READ),name:"FIT_TO_READ",description:"SETTINGS_ZOOM_READ_DESCRIPTION",isRadio:!0},[a.DEFAULT_ZOOM_FIT_WIDTH]:{value:v(a.DEFAULT_ZOOM_FIT_WIDTH),name:"FIT_TO_WIDTH_2",description:"SETTINGS_ZOOM_FIT_WIDTH_DESCRIPTION",isRadio:!0},[a.DEFAULT_ZOOM_FIT_HEIGHT]:{value:v(a.DEFAULT_ZOOM_FIT_HEIGHT),name:"FIT_TO_HEIGHT_2",description:"SETTINGS_ZOOM_FIT_HEIGHT_DESCRIPTION",isRadio:!0},[a.DEFAULT_ZOOM_FIT_PAGE]:{value:v(a.DEFAULT_ZOOM_FIT_PAGE),name:"FIT",description:"SETTINGS_ZOOM_FIT_DESCRIPTION",isRadio:!0},[a.DEFAULT_ZOOM_FIT_ACTUAL_SIZE]:{value:v(a.DEFAULT_ZOOM_FIT_ACTUAL_SIZE),name:"FIT_ACTUAL_SIZE",description:"SETTINGS_ZOOM_FIT_ACTUAL_SIZE_DESCRIPTION",isRadio:!0},[a.DEFAULT_ZOOM_MAINTAIN]:{value:v(a.DEFAULT_ZOOM_MAINTAIN),name:"MAINTAIN",description:"SETTINGS_ZOOM_MAINTAIN_DESCRIPTION",tooltip:"SETTINGS_ZOOM_MAINTAIN_TOOLTIP",isRadio:!0},[W.DEFAULT_DRAG_MODE]:{value:v(W.DEFAULT_DRAG_MODE),name:"DEFAULT_DRAG_MODE",description:"SETTINGS_DEFAULT_DRAG_MODE_DESCRIPTION",isRadio:!0},[a.DEFAULT_DRAG_MODE_SCROLL]:{value:v(a.DEFAULT_DRAG_MODE_SCROLL),name:"SCROLL_MODE",description:"SETTINGS_DRAG_MODE_SCROLL_DESCRIPTION",isRadio:!0},[a.DEFAULT_DRAG_MODE_TEXT_SELECT]:{value:v(a.DEFAULT_DRAG_MODE_TEXT_SELECT),name:"SELECT_TEXT",description:"SETTINGS_DRAG_MODE_TEXT_SELECT_DESCRIPTION",isRadio:!0},[a.DEFAULT_DRAG_MODE_MAGNIFY]:{value:v(a.DEFAULT_DRAG_MODE_MAGNIFY),name:"MAGNIFY_TOOL",description:"SETTINGS_DRAG_MODE_MAGNIFY_DESCRIPTION",isRadio:!0},[W.DEFAULT_CONTINUE_WRITING]:{value:!1,name:"DEFAULT_CONTINUE_WRITING",description:"SETTINGS_DEFAULT_CONTINUE_WRITING_DESCRIPTION",isRadio:!0},[a.DEFAULT_CONTINUE_WRITING_ACTIVE]:{value:v(a.DEFAULT_CONTINUE_WRITING_ACTIVE),name:"ACTIVE",description:"SETTINGS_CONTINUE_WRITING_ACTIVE_DESCRIPTION",isRadio:!0},[a.DEFAULT_CONTINUE_WRITING_INACTIVE]:{value:v(a.DEFAULT_CONTINUE_WRITING_INACTIVE),name:"INACTIVE",description:"SETTINGS_CONTINUE_WRITING_INACTIVE_DESCRIPTION",isRadio:!0},[W.DEFAULT_REDACTION_COLOR]:{value:!1,name:"CHANGE_DEFAULT_REDACTION_COLOR",description:"SETTINGS_REDACTION_COLOR_DESCRIPTION",tooltip:"SETTINGS_REDACTION_COLOR_TOOLTIP",isDummy:!0},[a.DEFAULT_REDACTION_OUTLINE_COLOR]:{value:v(a.DEFAULT_REDACTION_OUTLINE_COLOR),name:"REDACTION_OUTLINE_COLOR",description:"SETTINGS_REDACTION_OUTLINE_COLOR_DESCRIPTION",isColorPicker:!0},[a.DEFAULT_REDACTION_INTERIOR_COLOR]:{value:v(a.DEFAULT_REDACTION_INTERIOR_COLOR),name:"REDACTION_INTERIOR_COLOR",description:"SETTINGS_REDACTION_INTERIOR_COLOR_DESCRIPTION",isColorPicker:!0},[a.USE_CLIENT_RENDERING]:{value:v(a.USE_CLIENT_RENDERING),name:"CLIENT_RENDERING",description:"SETTINGS_CLIENT_RENDERING_DESCRIPTION",tooltip:"SETTINGS_CLIENT_RENDERING_TOOLTIP"},[a.CLIENT_RENDERING_HYBRID]:{value:v(a.CLIENT_RENDERING_HYBRID),name:"HYBRID_MODE",description:"SETTINGS_HYBRID_MODE_DESCRIPTION"},[W.RENDERING_OPTION]:{value:!1,name:"RENDERING_OPTION",description:"SETTINGS_RENDERING_OPTION_DESCRIPTION",tooltip:"SETTINGS_RENDERING_OPTION_TOOLTIP",deps:[a.USE_CLIENT_RENDERING],isRadio:!0},[a.CLIENT_RENDERING_OPTION_QUALITY_FIRST]:{value:v(a.CLIENT_RENDERING_OPTION_QUALITY_FIRST),name:"QUALITY_FIRST",description:"SETTINGS_QUALITY_FIRST_DESCRIPTION",isRadio:!0},[a.CLEINT_RENDERING_OPTION_BALANCE]:{value:v(a.CLEINT_RENDERING_OPTION_BALANCE),name:"BALANCE",description:"SETTINGS_BALANCE_DESCRIPTION",isRadio:!0},[a.CLEINT_RENDERING_OPTION_SPEED_FIRST]:{value:v(a.CLEINT_RENDERING_OPTION_SPEED_FIRST),name:"SPEED_FIRST",description:"SETTINGS_SPEED_FIRST_DESCRIPTION",isRadio:!0},[a.CLIENT_RENDERING_MAXIMUM_SCALE]:{value:v(a.CLIENT_RENDERING_MAXIMUM_SCALE),name:"MAXIMUM_SCALE",description:"SETTINGS_MAXIMUM_SCALE_DESCRIPTION",tooltip:"SETTINGS_MAXIMUM_SCALE_TOOLTIP",deps:[a.USE_CLIENT_RENDERING],isDropDown:!0},[a.CLIENT_RENDERING_PIXELATED]:{value:v(a.CLIENT_RENDERING_PIXELATED),name:"PIXELATED_RENDERING",description:"SETTINGS_PIXELATE_DESCRIPTION"},[a.PAGE_TEXT_FOR_SCREEN_READER]:{value:v(a.PAGE_TEXT_FOR_SCREEN_READER),name:"PAGE_TEXT_FOR_SCREEN_READER",description:"SETTINGS_PAGE_TEXT_FOR_SCREEN_READER_DESCRIPTION"},[W.ANNOTATION_CONTROL]:{value:!1,isDummy:!0,name:"ANNOTATION_CONTROL",description:"SETTINGS_ANNOTATION_CONTROL_DESCRIPTION"},[a.RESIZE_ANNOTATION]:{value:v(a.RESIZE_ANNOTATION),name:"RESIZE",description:"SETTINGS_RESIZE_ANNOTATION_DESCRIPTION"},[a.MOVE_ANNOTATION]:{value:v(a.MOVE_ANNOTATION),name:"MOVE",description:"SETTINGS_MOVE_ANNOTATION_DESCRIPTION"},[a.DELETE_ANNOTATION]:{value:v(a.DELETE_ANNOTATION),name:"DELETE",description:"SETTINGS_REMOVE_ANNOTATION_DESCRIPTION"},[W.STAMP_DRAWING_GESTURE]:{value:!1,name:"STAMP_DRAWING_METHOD",description:"SETTINGS_STAMP_DRAWING_METHOD_DESCRIPTION",isRadio:!0},[a.DRAWING_STAMP_VIA_DRAG]:{value:v(a.DRAWING_STAMP_VIA_DRAG),name:"DRAG_TO_DRAW",description:"SETTINGS_DRAG_TO_DRAW_DESCRIPTION",isRadio:!0},[a.DRAWING_STAMP_VIA_CLICK]:{value:v(a.DRAWING_STAMP_VIA_CLICK),name:"CLICK_TO_DRAW",description:"SETTINGS_CLICK_TO_DRAW_DESCRIPTION",isRadio:!0},[W.FORM_CONTROL]:{value:!1,isDummy:!0,name:"FORM_CONTROL",description:"SETTINGS_FORM_CONTROL_DESCRIPTION"},[V.RESIZE_AND_MOVE_FORM]:{value:v(V.RESIZE_AND_MOVE_FORM),name:"RESIZE_AND_MOVE",description:"SETTINGS_RESIZE_AND_MOVE_FORM_DESCRIPTION"},[a.DELETE_FORM]:{value:v(a.DELETE_FORM),name:"DELETE",description:"SETTINGS_REMOVE_FORM_DESCRIPTION"},[W.SHORTCUT]:{value:v(W.SHORTCUT),name:"SHORTCUT",description:"SETTINGS_SHORTCUT_DESCRIPTION"},[a.SHORTCUT_COPY_PASTE]:{value:v(a.SHORTCUT_COPY_PASTE),name:"SHORTCUT_COPY_PASTE",description:"SETTINGS_SHORTCUT_COPY_PASTE_DESCRIPTION"},[a.SHORTCUT_UNDO_REDO]:{value:v(a.SHORTCUT_UNDO_REDO),name:"SHORTCUT_UNDO_REDO",description:"SETTINGS_SHORTCUT_UNDO_REDO_DESCRIPTION"},[a.SHORTCUT_COPY_TEXT]:{value:v(a.SHORTCUT_COPY_TEXT),name:"SHORTCUT_COPY_TEXT",description:"SETTINGS_SHORTCUT_COPY_TEXT_DESCRIPTION"},[a.SHORTCUT_PRINT]:{value:v(a.SHORTCUT_PRINT),name:"SHORTCUT_PRINT",description:"SETTINGS_SHORTCUT_PRINT_DESCRIPTION"},[a.SHORTCUT_QUICK_ACTION]:{value:v(a.SHORTCUT_PRINT),name:"SHORTCUT_QUICK_ACTION",description:"SETTINGS_SHORTCUT_QUICK_ACTION_DESCRIPTION"},[W.SAVE_OPTION]:{value:v(W.SAVE_OPTION),name:"SAVE_OPTION",description:"SETTINGS_SAVE_OPTION_DESCRIPTION",isRadio:!0},[a.SAVE_OPTION_SPEED_OPTIMIZE]:{value:v(a.SAVE_OPTION_SPEED_OPTIMIZE),name:"SPEED_OPTIMIZE",description:"SETTINGS_SPEED_OPTIMIZE_DESCRIPTION",isRadio:!0},[a.SAVE_OPTION_SIZE_OPTIMIZE]:{value:v(a.SAVE_OPTION_SIZE_OPTIMIZE),name:"SIZE_OPTIMIZE",description:"SETTINGS_SIZE_OPTIMIZE_DESCRIPTION",isRadio:!0},[a.AUTO_SAVE]:{value:v(a.AUTO_SAVE),name:"AUTO_SAVE",description:"SETTINGS_AUTO_SAVE_DESCRIPTION",tooltip:"SETTINGS_AUTO_SAVE_TOOLTIP",warning:{message:"SETTINGS_AUTO_SAVE_WARNING",triggerValue:!0}},[a.COLLECT_STATISTIC_BY_VIEWER]:{value:v(a.COLLECT_STATISTIC_BY_VIEWER),name:"COLLECT_STATISTIC_BY_VIEWER",description:"SETTINGS_COLLECT_STATISTIC_BY_VIEWER"}};var ei=function(r){return r[r.TREE_VIEW=0]="TREE_VIEW",r[r.TABLE_VIEW=1]="TABLE_VIEW",r}(ei||{});var Rt=(()=>{let n=class n{timeOffsetSrc;baseHref;httpClient;productService;signatureSerivce;resetClickSrc=new it;resetClick$=this.resetClickSrc.asObservable();cancelClickSrc=new it;cancelClick$=this.cancelClickSrc.asObservable();configSavedSrc=new it;configSaved$=this.configSavedSrc.asObservable();openWarningModalSrc=new it;openWarningModal$=this.openWarningModalSrc.asObservable();_uiConfigTree;get uiConfigTree(){return typeof this._uiConfigTree>"u"&&(this._uiConfigTree=this.buildConfigTree(fa)),this._uiConfigTree}_featureConfigTree;get featureConfigTree(){return typeof this._featureConfigTree>"u"&&(this._featureConfigTree=this.buildConfigTree(ga)),this._featureConfigTree}t;constrainedConfigs={[a.SAVE_BUTTON]:{fixTo:!1,config:{key:a.AUTO_SAVE,triggerValue:!0}},[a.WARNING_LEAVE_WITHOUT_SAVE]:{fixTo:!0,config:{key:a.AUTO_SAVE,triggerValue:!0}}};radioConfig={[W.DEFAULT_SCREEN_THEME]:{items:[{key:a.SCREEN_THEME_LIGHT,value:"light"},{key:a.SCREEN_THEME_DARK,value:"dark"},{key:a.SCREEN_THEME_SYSTEM,value:"System synchronization"}],value:a.SCREEN_THEME_LIGHT},[W.SAVE_OPTION]:{items:[{key:a.SAVE_OPTION_SPEED_OPTIMIZE,value:null},{key:a.SAVE_OPTION_SIZE_OPTIMIZE,value:null}],value:a.SAVE_OPTION_SPEED_OPTIMIZE},[W.DEFAULT_VIEW_MODE]:{items:[{key:a.DEFAULT_VIEW_MODE_ONE,value:0},{key:a.DEFAULT_VIEW_MODE_ONE_C,value:1},{key:a.DEFAULT_VIEW_MODE_TWO,value:2},{key:a.DEFAULT_VIEW_MODE_TWO_C,value:3},{key:a.DEFAULT_VIEW_MODE_EBOOK,value:4}],value:a.DEFAULT_VIEW_MODE_ONE_C},[W.DEFAULT_ZOOM]:{items:[{key:a.DEFAULT_ZOOM_READ,value:5},{key:a.DEFAULT_ZOOM_FIT_WIDTH,value:0},{key:a.DEFAULT_ZOOM_FIT_HEIGHT,value:1},{key:a.DEFAULT_ZOOM_FIT_PAGE,value:3},{key:a.DEFAULT_ZOOM_FIT_ACTUAL_SIZE,value:4},{key:a.DEFAULT_ZOOM_MAINTAIN,value:7}],value:a.DEFAULT_ZOOM_READ},[W.DEFAULT_DRAG_MODE]:{items:[{key:a.DEFAULT_DRAG_MODE_SCROLL,value:Ae.MOVE},{key:a.DEFAULT_DRAG_MODE_TEXT_SELECT,value:Ae.SELECT_TEXT},{key:a.DEFAULT_DRAG_MODE_MAGNIFY,value:Ae.MAGNIFY},{key:a.DEFAULT_DRAG_MODE_AUTO,value:Ae.AUTO}],value:a.DEFAULT_DRAG_MODE_SCROLL},[W.DEFAULT_CONTINUE_WRITING]:{items:[{key:a.DEFAULT_CONTINUE_WRITING_ACTIVE,value:!0},{key:a.DEFAULT_CONTINUE_WRITING_INACTIVE,value:!1}],value:a.DEFAULT_CONTINUE_WRITING_INACTIVE},[W.DEFAULT_VIEWED_DAP_LIST]:{items:[{key:a.DAP_VIEW_DEFAULT_VIEW_TREE,value:ei.TREE_VIEW},{key:a.DAP_VIEW_DEFAULT_VIEW_TABLE,value:ei.TABLE_VIEW}],value:a.DAP_VIEW_DEFAULT_VIEW_TABLE},[W.RENDERING_OPTION]:{items:[{key:a.CLIENT_RENDERING_OPTION_QUALITY_FIRST,value:vo.QUALITY_FIRST},{key:a.CLEINT_RENDERING_OPTION_BALANCE,value:vo.BALANCE},{key:a.CLEINT_RENDERING_OPTION_SPEED_FIRST,value:vo.SPEED_FIRST}],value:a.CLIENT_RENDERING_OPTION_QUALITY_FIRST},[W.STAMP_DRAWING_GESTURE]:{items:[{key:a.DRAWING_STAMP_VIA_DRAG,value:Ti.DRAG},{key:a.DRAWING_STAMP_VIA_CLICK,value:Ti.CLICK_ONLY}],value:a.DRAWING_STAMP_VIA_DRAG}};pkiSignatureEnabled=!1;constructor(e,t,o,s,c){this.timeOffsetSrc=e,this.baseHref=t,this.httpClient=o,this.productService=s,this.signatureSerivce=c,this.timeOffsetSrc.subscribe({next:u=>this.t=u}),this.signatureSerivce.metadata$.pipe(Mt(1)).subscribe({next:u=>this.pkiSignatureEnabled=!!u.pki.enable})}get standardPresetKeys(){let e=[a.SAVE_BUTTON,a.ORIGINAL_DOWNLOAD_BUTTON,a.PDF_DOWNLOAD_BUTTON,a.PRINT_BUTTON,a.DOCUMENT_INFO_BUTTON,a.SLIDESHOW_BUTTON,a.EBOOK_BUTTON,a.PREFERENCES_BUTTON,a.SCREEN_THEME_MENU,a.SD_INFO_BUTTON,V.LEFT_SIDE_VIEW_BUTTON,a.SCALE_DROPDOWN,a.FIT_BUTTON,V.VIEW_MODE_BUTTON,V.DRAG_MODE_BUTTONS,a.DAP_VIEW_BUTTON,V.ANNOT_TOOLBAR,V.FORM_TOOLBAR,V.ANNOT_PROPERTY_VIEW_ATTRIBUTES,V.FLOATING_NAVIGATION,V.INDICATOR,a.THUMBNAIL_VIEW_EDIT,a.OUTLINE_VIEW_EDIT,a.EMBEDDED_FILE_VIEW_DOWNLOAD,a.EMBEDDED_FILE_VIEW_EDIT,V.DAP_VIEW,a.DAP_VIEW_DEFAULT_OPEN,V.PRINT_DIALOG,V.DOCUMENT_INFO_DIALOG,V.PREFERENCES_DIALOG,V.ANNOTATION_FLOATING_MENU,a.WARNING_LEAVE_WITHOUT_SAVE,a.RESIZE_ANNOTATION,a.MOVE_ANNOTATION,a.DELETE_ANNOTATION,a.USE_SAMPLE_STAMP_IMAGE,a.UPLOAD_STAMP_IMAGE,V.RESIZE_AND_MOVE_FORM,a.DELETE_FORM,a.SIGN_DIALOG_HISTORY,a.SHORTCUT_COPY_PASTE,a.SHORTCUT_COPY_TEXT,a.SHORTCUT_UNDO_REDO],t=[a.AUTO_SAVE,a.PDF_DOWNLOAD_BUTTON,a.OUTLINE_VIEW_DEFAULT_EXPAND,a.HIDE_SAVE_DOWNLOAD_PRINT_IN_MENU,a.USE_CLIENT_RENDERING];return this.productService.isStreamDocsVu&&t.push(a.ORIGINAL_DOWNLOAD_BUTTON),{activateKeys:e,deactivateKeys:t}}get litePresetKeys(){let e=[a.AUTO_SAVE,a.ORIGINAL_DOWNLOAD_BUTTON,a.PDF_DOWNLOAD_BUTTON,a.PRINT_BUTTON,a.DOCUMENT_INFO_BUTTON,a.SLIDESHOW_BUTTON,a.EBOOK_BUTTON,a.PREFERENCES_BUTTON,a.SCREEN_THEME_MENU,a.SD_INFO_BUTTON,a.THUMBNAIL_VIEW_BUTTON,a.OUTLINE_VIEW_BUTTON,a.ANNOTATION_VIEW_BUTTON,a.REDACTION_VIEW_BUTTON,a.EMBEDDED_FILE_VIEW_BUTTON,a.SCALE_DROPDOWN,a.FIT_BUTTON,V.VIEW_MODE_BUTTON,V.DRAG_MODE_BUTTONS,a.DAP_VIEW_BUTTON,V.ANNOT_TOOLBAR,V.ANNOT_PROPERTY_VIEW_ATTRIBUTES,V.FLOATING_NAVIGATION,V.INDICATOR,a.THUMBNAIL_VIEW_EDIT,a.OUTLINE_VIEW_EDIT,a.EMBEDDED_FILE_VIEW_DOWNLOAD,a.EMBEDDED_FILE_VIEW_EDIT,V.DAP_VIEW,a.DAP_VIEW_DEFAULT_OPEN,V.PRINT_DIALOG,V.DOCUMENT_INFO_DIALOG,V.PREFERENCES_DIALOG,V.ANNOTATION_FLOATING_MENU,a.USE_CLIENT_RENDERING,a.CLIENT_RENDERING_HYBRID,a.CLIENT_RENDERING_PIXELATED,a.CLIENT_RENDERING_OPTION_QUALITY_FIRST,a.WARNING_LEAVE_WITHOUT_SAVE,a.RESIZE_ANNOTATION,a.MOVE_ANNOTATION,a.DELETE_ANNOTATION,a.USE_SAMPLE_STAMP_IMAGE,a.UPLOAD_STAMP_IMAGE,V.RESIZE_AND_MOVE_FORM,a.DELETE_FORM,a.SIGN_DIALOG_HISTORY,a.SHORTCUT_COPY_PASTE,a.SHORTCUT_COPY_TEXT,a.SHORTCUT_UNDO_REDO],t=[a.SAVE_BUTTON,a.PDF_DOWNLOAD_BUTTON,a.FORM_VIEW_BUTTON,a.SIGNATURE_VIEW_BUTTON,V.FORM_TOOLBAR,a.OUTLINE_VIEW_DEFAULT_EXPAND,a.CLEINT_RENDERING_OPTION_BALANCE,a.CLEINT_RENDERING_OPTION_SPEED_FIRST];return this.productService.isStreamDocsVu&&t.push(a.ORIGINAL_DOWNLOAD_BUTTON),{activateKeys:e,deactivateKeys:t}}isMergedRuntimeEnvKey(e){return Qt.hasDefinedProp(ks,e)}isIgnoredKey(e){return Object.values(W).some(t=>e===t)}publishResetClick(){this.resetClickSrc.next()}publishCancelClick(){this.resetClickSrc.next()}publishConfigSaved(){this.configSavedSrc.next()}getViewConfigs(){return this.httpClient.get(`${this.baseHref}v4/preference/view`,{observe:"response",responseType:"text"}).pipe(Tt(e=>Ns.c2NzkzMzg2(e,this.t)),_t(e=>{if(e.body===null)throw new gs("No response body received.");return JSON.parse(e.body)}))}postViewConfig(e){return this.httpClient.post(`${this.baseHref}v4/preference/view`,e)}buildConfigTree(e,t=-1){if(typeof e=="string"){let c=wo[e];if(!S.isDefined(c)&&e!==W.ROOT)throw new He(`No configuration description found for the key '${e}'.`);let u=Qe(ge({},c),{key:e,depth:t});return u.formControl=new Ze(u.value),{data:u,expanded:e===W.ROOT,parent:null,children:[]}}let o=this.buildConfigTree(e.key,t),s=e.children.reduce((c,u)=>{let C=this.buildConfigTree(u,t+1);return this.productService.isStreamDocsVu&&ha.includes(C.data.key)||this.productService.isStreamDocs&&ma.includes(C.data.key)||!this.pkiSignatureEnabled&&_a.includes(C.data.key)?c:[...c,C]},[]);return s.forEach(c=>c.parent=o),o.children=s,o}getStampImage(){let e=new XMLHttpRequest;e.open("GET","assets/images/stamp/stamp2.png",!0),e.responseType="arraybuffer",e.onload=()=>{if(e.status===200){let t=new Blob([e.response],{type:"image/png"}),o=new FileReader;o.onload=()=>{if(typeof o.result!="string")return;let s=o.result.split(",")[1];zt[F.STAMP].attributes.appearance={type:"image",data:s,format:"png",height:220,width:220}},o.readAsDataURL(t)}},e.send()}modifyConfigsByProductType(e,t){let o=t?"StreamDocs":"StreamDocs Vu!";e.some(c=>c.key===a.PAGE_TITLE)||e.push({key:a.PAGE_TITLE,value:`"${o}"`});let s=e.find(c=>c.key===a.CONTEXT_MENU_TOOLS_IN_USE);if(s!==void 0){let u=JSON.parse(s.value).filter(C=>{let N=["REDACTION","SELECT_ANNOT_TOOL"].map(O=>O.toString());return t||Qt.hasDefinedProp(C,"id")&&!N.includes(C.id)});s.value=JSON.stringify(u)}}fireOpenWarningModal(e){this.openWarningModalSrc.next(e)}};E(n,"\u0275fac",function(t){return new(t||n)(It(js),It(ps),It(hs),It(Ki),It(nn))}),E(n,"\u0275prov",Yt({token:n,factory:n.\u0275fac}));let r=n;return r})();function Sc(r,n){if(r&1){let i=M();ue(0),h(1,"sd-configs-item",11),I("onRegexDialogConfirm",function(t){f(i);let o=d(2);return g(o.confirmRegex(t))})("onRegexDelete",function(){let t=f(i).$implicit,o=d(2);return g(o.deleteConfig(t))})("onToggle",function(){let t=f(i).$implicit,o=d(2);return g(o.toggleConfig(t))})("onRadioModelChange",function(){let t=f(i).$implicit,o=d(2);return g(o.changeRadioConfig(t))})("onColorModelChange",function(){let t=f(i).$implicit,o=d(2);return g(o.changeColorConfig(t))})("onDropDownModelChange",function(){let t=f(i).$implicit,o=d(2);return g(o.changeDropDownConfig(t))})("onTextModelChange",function(){let t=f(i).$implicit,o=d(2);return g(o.changeTextConfig(t))}),_(),he()}if(r&2){let i=n.$implicit;l(),p("item",i)("formControl",i.data.formControl)}}function Ic(r,n){if(r&1&&(ue(0),y(1,Sc,2,2,"ng-container",10),he()),r&2){let i=d();l(),p("eTreeFrom",i.selectedConfigTree)}}function xc(r,n){r&1&&x(0,"sd-context-menu-config")}function vc(r,n){r&1&&x(0,"sd-annot-property-config")}function Oc(r,n){r&1&&(h(0,"div",15),x(1,"i",16),_())}function bc(r,n){r&1&&(h(0,"div",15),x(1,"i",16),_())}function yc(r,n){if(r&1){let i=M();ue(0),h(1,"button",12),I("click",function(){f(i);let t=d();return g(t.onClickUIMode(!1))}),y(2,Oc,2,0,"div",13),P(3),T(4,"translate"),_(),h(5,"button",14),I("click",function(){f(i);let t=d();return g(t.onClickUIMode(!0))}),y(6,bc,2,0,"div",13),P(7),T(8,"translate"),_(),he()}if(r&2){let i=d();l(2),p("ngIf",i.isLiteUIPreset),l(),Re(" ",A(4,4,"LITE_UI")," "),l(3),p("ngIf",i.isStandardUIPreset),l(),Re(" ",A(8,6,"STANDARD_UI")," ")}}function Rc(r,n){if(r&1){let i=M();h(0,"button",17),I("click",function(){f(i);let t=d();return g(t.onResetButtonClick())}),x(1,"i",18),P(2),T(3,"translate"),_()}r&2&&(l(2),Re(" ",A(3,1,"RESET_CONTEXT_MENU"),""))}var Aa=(()=>{let n=class n{configsService;subs;toastService;changeDetectorRef;translatePipe;formBuilder;dialogService;productService;modalService;i18nService;get TabItem(){return ai}tabItems=[ai.UI_DISPLAY_SETTINGS,ai.FEATURE_SETTINGS,ai.CONTEXT_MENU_SETTINGS,ai.ANNOT_PROPERTY_SETTINGS];selectedTab=this.tabItems[0];selectedConfigTree=void 0;fetchError=!1;isLoading=!1;formChanged=!1;excludeRecursionListForLoad=[{key:a.CHANGE_PRIMARY_COLOR,value:[!1]},{key:a.THUMBNAIL_VIEW_BUTTON,value:[!0]},{key:a.OUTLINE_VIEW_BUTTON,value:[!0]},{key:a.TEXT_SEARCH_VIEW_REGEX,value:[!0]},{key:a.USE_CLIENT_RENDERING,value:[!0]},{key:V.FLOATING_NAVIGATION,value:[!1]}];dropDownItem=[{key:a.CLIENT_RENDERING_MAXIMUM_SCALE,options:[{label:"400%",value:400},{label:"500%",value:500},{label:"600%",value:600},{label:"700%",value:700},{label:"800%",value:800}]}];constructor(e,t,o,s,c,u,C,N,O,U){this.configsService=e,this.subs=t,this.toastService=o,this.changeDetectorRef=s,this.translatePipe=c,this.formBuilder=u,this.dialogService=C,this.productService=N,this.modalService=O,this.i18nService=U,this.selectedConfigTree=this.configsService.uiConfigTree}ngOnInit(){this.isLoading=!0,this.fetchConfigs(),this.subs.push(this.dialogService.dialogEvent$.pipe(w(e=>e.dialogType===Gt.WARNING&&e.action==="confirm"),Ve(()=>this.configsService.publishCancelClick())).subscribe({next:()=>{fe.runAsync(()=>this.dialogService.closeCurrentActiveDialog()),this.formChanged=!1,Y.clear(),this.fetchConfigs()}}),this.dialogService.dialogEvent$.pipe(w(e=>this.isUIModeDialog(e.dialogType)&&e.action==="confirm")).subscribe({next:e=>{let t=e.dialogType===Gt.STANDARD_UI_MODE;this.getConfigPresets(t).forEach(({node:o,value:s})=>{this.setConfigValue(o,s),this.setChildrenValue(o,s)}),this.saveConfig(),this.dialogService.closeCurrentActiveDialog()}}),this.configsService.openWarningModal$.subscribe({next:e=>this.modalService.createCommonModal({type:Rn.WARN,content:e.content,confirmButton:!0,cancelButton:!0}).addOnDisposeListener(e.onDispose)}))}getConfigPresets(e){let t=e?this.configsService.standardPresetKeys:this.configsService.litePresetKeys;return[...t.activateKeys.map(o=>({node:this.findConfig(o),value:!0})),...t.deactivateKeys.map(o=>({node:this.findConfig(o),value:!1}))].filter(o=>S.isDefined(o.node))}get isStandardUIPreset(){let e=!0;return this.configsService.standardPresetKeys.activateKeys.forEach(t=>{Y.get(t)||(e=!1)}),this.configsService.standardPresetKeys.deactivateKeys.forEach(t=>{Y.get(t)&&(e=!1)}),e}get isLiteUIPreset(){let e=!0;return this.configsService.litePresetKeys.activateKeys.forEach(t=>{Y.get(t)||(e=!1)}),this.configsService.litePresetKeys.deactivateKeys.forEach(t=>{Y.get(t)&&(e=!1)}),e}isUIModeDialog(e){return e===Gt.STANDARD_UI_MODE||e===Gt.LITE_UI_MODE}onTabChange(e){switch(this.selectedTab=e,e){case ai.UI_DISPLAY_SETTINGS:this.selectedConfigTree=this.configsService.uiConfigTree;break;case ai.FEATURE_SETTINGS:this.selectedConfigTree=this.configsService.featureConfigTree;break;default:{this.selectedConfigTree=null;break}}}onClickUIMode(e){this.dialogService.toggleDialogVisibility(e?Gt.STANDARD_UI_MODE:Gt.LITE_UI_MODE,!0,{size:{width:336,height:this.i18nService.language==="ko"?263:295},title:this.translatePipe.transform(`${e?"STANDARD_UI":"LITE_UI"}`),description:this.translatePipe.transform(`${e?"STANDARD_UI_DESCRIPTION":"LITE_UI_DESCRIPTION"}`)})}onResetButtonClick(){this.configsService.publishResetClick()}toggleConfig(e){this.formChanged=!0,this.setConfigValue(e,e.data.value),this.setChildrenValue(e,e.data.value),this.changeParentToggleButton(e)}applyConstraint(e){Object.keys(this.configsService.constrainedConfigs).forEach(t=>{let o=this.configsService.constrainedConfigs[t];if(!(o.config.key===e.data.key))return;let c=this.findConfig(t),u=e.data.value===o.config.triggerValue;if(!c.data.isDummy)if(u)if(c.data.isRadio)if(o.fixTo)c.parent.children.forEach(C=>C.data.disable=!0),this.changeRadioConfig(c);else{c.data.disable=!0,c.data.formControl.setValue(!1);let C=c.parent.children.filter(N=>N.data.key!==c.data.key)[0];this.changeRadioConfig(C)}else c.data.disable=!0,this.setConfigValue(c,o.fixTo);else c.data.isRadio&&o.fixTo?c.parent.children.forEach(C=>C.data.disable=!1):c.data.disable=!1})}changeRadioConfig(e){this.formChanged=!0;let o=e.parent.children.filter(s=>s.data.key!==e.data.key);this.configsService.radioConfig=Object.keys(this.configsService.radioConfig).reduce((s,c)=>(c!==e.parent.data.key||(s[c].value=e.data.key),s),ge({},this.configsService.radioConfig)),o.forEach(s=>{Y.set(s.data.key,!1),s.data.formControl.setValue(!1)}),this.setConfigValue(e,!0)}changeColorConfig(e){this.formChanged=!0,this.setConfigValue(e,e.data.value)}changeDropDownConfig(e){e.data.options.includes(e.data.value)&&(this.formChanged=!0,this.setConfigValue(e,e.data.value))}changeTextConfig(e){this.formChanged=!0;let t=this.productService.productType;if(typeof e.data.value=="string"&&!e.data.value.length){Y.set(e.data.key,t);return}this.setConfigValue(e,e.data.value)}confirmRegex(e){let t=this.findConfig(a.TEXT_SEARCH_VIEW_REGEX),o;if(e.type==="create"&&t.children.find(C=>C.data.name===e.values.title)){this.toastService.create({icon:"failed",content:this.translatePipe.transform("DUPLICATED_REGEX_NAME")});return}this.formChanged=!0;let s=this.getNewRegexItemConfig(t,e.values.title,e.values.content,!0);if(e.type==="edit"){let C=t.children.find(N=>N.data.name===e.values.id);o=t.children.findIndex(N=>C.data.name===N.data.name),this.deleteConfig(C)}let c=typeof o=="number"?o:t.children.length-1;t.children.splice(c,0,s);let u={name:s.data.name,regex:s.data.description,value:s.data.value};this.addEnvRegexItem(u,o)}cancel(){this.dialogService.toggleDialogVisibility(Gt.WARNING,!0,{size:{width:336,height:280},title:this.translatePipe.transform("CANCEL"),description:this.translatePipe.transform("RESET_CONFIG")})}saveConfig(){this.isLoading=!0;let e=Y.entries().map(t=>({key:t.key,value:JSON.stringify(t.value)}));this.subs.set("save",this.configsService.postViewConfig(e).subscribe({next:()=>{this.isLoading=!1,this.formChanged=!1,this.toastService.create({icon:"success",content:this.translatePipe.transform("SUCCESS_SAVE_CHANGES")}),this.fetchConfigs(),this.changeDetectorRef.markForCheck(),this.configsService.publishConfigSaved()},error:()=>{this.isLoading=!1,this.changeDetectorRef.markForCheck()}}))}deleteConfig(e){this.formChanged=!0,this.deleteEnvRegexItem(e.data.name);let t=this.findConfig(a.TEXT_SEARCH_VIEW_REGEX);t.children=t.children.filter(o=>o.data.name!==e.data.name)}changeParentToggleButton(e){if(!e.parent||e.parent.data.key===W.ROOT||e.data.isDropDown||e.data.isText||e.data.isColorPicker||e.data.isRadio||e.parent.data.isDummy||e.parent.data.isRadio)return;let t=e.parent.children.filter(o=>!e.parent.data.excludeDeps?.includes(o.data.key)).some(o=>o.data.value);this.configsService.isMergedRuntimeEnvKey(e.parent.data.key)||this.configsService.isIgnoredKey(e.parent.data.key)?e.parent.data.formControl.setValue(t):this.setConfigValue(e.parent,t),this.changeParentToggleButton(e.parent)}setChildrenValue(e,t){e.children.forEach(o=>{!o.data.isRadio&&!o.data.isDropDown&&!o.data.isColorPicker&&!o.data.isText&&!o.data.disable&&(o.data.formControl.setValue(t),this.setConfigValue(o,t)),this.setChildrenValue(o,t)})}assignValueDepth(e){if(!e)return;let t=(o,s)=>{s.map((c,u)=>{let C;if(c.isFirst=u===0,c.isLast=u===s.length-1,c.data.key===a.REGEX_EXPRESSION_JSON?C=Y.get(c.data.key).find(N=>N.name===c.data.name).value:C=Y.get(c.data.key),c.data.isDropDown){let N=this.dropDownItem.find(O=>O.key===c.data.key);c.data.options=N.options}if(c.data.isDropDown){let N=this.dropDownItem.find(O=>O.key===c.data.key);c.data.options=N.options}if(c.data.disable||(c.data.formControl.setValue(C),c.data.value=C,this.applyConstraint(c)),c.data.key===a.TEXT_SEARCH_VIEW_REGEX){let O=Y.get(a.REGEX_EXPRESSION_JSON).map(U=>this.getNewRegexItemConfig(c,U.name,U.regex,U.value));c.children=[...O,c.children.pop()]}return c.children.length>0&&(t(o+1,c.children),this.isExcludeRecursion(c,this.excludeRecursionListForLoad)||c.data.formControl.setValue(c.children.filter(N=>!N.data.isRadio&&!N.data.isDropDown).some(N=>N.data.value))),c})};t(0,e.children)}fetchConfigs(){this.subs.set("fetchConfigs",this.configsService.getViewConfigs().subscribe({next:e=>{this.configsService.modifyConfigsByProductType(e,this.productService.isStreamDocs),this.fetchError=!1,e.forEach(t=>{let o=t.key;Y.set(o,JSON.parse(t.value)),this.configsService.radioConfig=Object.keys(this.configsService.radioConfig).reduce((s,c)=>(this.configsService.radioConfig[c].items.some(u=>u.key===o)&&JSON.parse(t.value)&&(s[c].value=o),s),ge({},this.configsService.radioConfig))}),Us.apply(),this.assignValueDepth(this.configsService.uiConfigTree),this.assignValueDepth(this.configsService.featureConfigTree),this.isLoading=!1,this.changeDetectorRef.markForCheck()},error:()=>{this.fetchError=!0,this.isLoading=!1,this.toastService.create({icon:"failed",content:this.translatePipe.transform("FAILED_TO_FETCH_DATA")}),this.changeDetectorRef.markForCheck()}}))}findConfig(e){let t=o=>{for(let s of o){if(s.data.key===e)return s;let c=t(s.children);if(c)return c}return null};return t([this.configsService.uiConfigTree,this.configsService.featureConfigTree])}deleteEnvRegexItem(e){let t=Y.get(a.REGEX_EXPRESSION_JSON),o=t.indexOf(t.find(s=>s.name===e));o>-1&&(t.splice(o,1),Y.set(a.REGEX_EXPRESSION_JSON,t))}addEnvRegexItem(e,t){let o=Y.get(a.REGEX_EXPRESSION_JSON);typeof t=="number"?o.splice(t,0,e):o=[...o,e],Y.set(a.REGEX_EXPRESSION_JSON,o)}setConfigValue(e,t){if(!(!e||this.configsService.isIgnoredKey(e.data.key))){if(e.data.key===a.REGEX_EXPRESSION_JSON){let o=Y.get(a.REGEX_EXPRESSION_JSON),s=o.find(c=>c.name===e.data.name);s.value=t,Y.set(a.REGEX_EXPRESSION_JSON,o);return}e.data.formControl.setValue(t),Y.set(e.data.key,t),this.applyConstraint(e)}}isExcludeRecursion(e,t){return e.data.key?t.some(o=>o.key===e.data.key&&o.value.some(s=>s===e.data.value)):!1}getNewRegexItemConfig(e,t,o,s){return{data:{key:a.REGEX_EXPRESSION_JSON,value:s,name:t,description:o,depth:2,editable:!0,formControl:this.formBuilder.control(s)},expanded:!1,parent:e,children:[]}}};E(n,"\u0275fac",function(t){return new(t||n)(m(Rt),m(R),m(Ds),m($),m(ee),m(gi),m(Qn),m(Ki),m(bt),m(Co))}),E(n,"\u0275cmp",H({type:n,selectors:[["sd-configs"]],standalone:!1,features:[j([R])],decls:18,vars:18,consts:[[3,"selectedTabChange","tabItems","selectedTab"],[3,"fetchError","isLoading"],[3,"ngSwitch"],[4,"ngSwitchDefault"],[4,"ngSwitchCase"],[1,"container"],[4,"ngIf"],["class","ep-button reset","size","small","color","white",3,"click",4,"ngIf"],["size","small","color","white",1,"ep-button","cancel",3,"click"],["size","small","color","primary",1,"ep-button",3,"click"],[4,"eTree","eTreeFrom"],[3,"onRegexDialogConfirm","onRegexDelete","onToggle","onRadioModelChange","onColorModelChange","onDropDownModelChange","onTextModelChange","item","formControl"],["size","small","color","white",1,"ep-button","lite",3,"click"],["class","check-container",4,"ngIf"],["size","small","color","white",1,"ep-button","standard",3,"click"],[1,"check-container"],[1,"papycon","papycon-check-mark5"],["size","small","color","white",1,"ep-button","reset",3,"click"],[1,"papycon","papycon-redo"]],template:function(t,o){t&1&&(h(0,"h1"),P(1),T(2,"translate"),_(),h(3,"e-tab-panel",0),I("selectedTabChange",function(c){return o.onTabChange(c)}),h(4,"sd-card",1),ue(5,2),y(6,Ic,2,1,"ng-container",3)(7,xc,1,0,"sd-context-menu-config",4)(8,vc,1,0,"sd-annot-property-config",4),he(),h(9,"footer",5),y(10,yc,9,8,"ng-container",6)(11,Rc,4,3,"button",7),h(12,"button",8),I("click",function(){return o.cancel()}),P(13),T(14,"translate"),_(),h(15,"button",9),I("click",function(){return o.saveConfig()}),P(16),T(17,"translate"),_()()()()),t&2&&(l(),L(A(2,12,"SETTINGS")),l(2),p("tabItems",o.tabItems)("selectedTab",o.selectedTab),l(),p("fetchError",o.fetchError)("isLoading",o.isLoading),l(),p("ngSwitch",o.selectedTab),l(2),p("ngSwitchCase",o.TabItem.CONTEXT_MENU_SETTINGS),l(),p("ngSwitchCase",o.TabItem.ANNOT_PROPERTY_SETTINGS),l(2),p("ngIf",o.selectedTab===o.TabItem.UI_DISPLAY_SETTINGS||o.selectedTab===o.TabItem.FEATURE_SETTINGS),l(),p("ngIf",o.selectedTab===o.TabItem.CONTEXT_MENU_SETTINGS),l(2),L(A(14,14,"CANCEL")),l(3),L(A(17,16,"SAVE_CHANGES")))},styles:["[_nghost-%COMP%]{min-width:766px}.horizontal-division-line[_ngcontent-%COMP%]{width:calc(100% + 60px);height:1px;background-color:#dadada;position:relative;top:1px;left:-30px}sd-card[_ngcontent-%COMP%]{flex-direction:column;border-radius:0 0 4px 4px;border:solid 1px #DADADA;border-top:none;background-color:#fff;padding:0;box-sizing:border-box}e-tab-panel[_ngcontent-%COMP%]{display:inline-block;min-width:706px;border:none;margin-top:0}e-tab-panel[_ngcontent-%COMP%]   sd-card[_ngcontent-%COMP%]{flex:auto}footer.container[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;padding:40px 36px 24px 30px;margin-top:auto;border-top:solid 1px #DADADA}footer.container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] + button[_ngcontent-%COMP%]{margin-left:12px}footer.container[_ngcontent-%COMP%]   button.standard[_ngcontent-%COMP%], footer.container[_ngcontent-%COMP%]   button.lite[_ngcontent-%COMP%]{min-width:112px;display:flex;flex-direction:row;align-items:center;justify-content:center;padding:0 12px}footer.container[_ngcontent-%COMP%]   button.standard[_ngcontent-%COMP%]   .check-container[_ngcontent-%COMP%], footer.container[_ngcontent-%COMP%]   button.lite[_ngcontent-%COMP%]   .check-container[_ngcontent-%COMP%]{width:26px;height:26px;margin-right:2px}footer.container[_ngcontent-%COMP%]   button.standard[_ngcontent-%COMP%]   .check-container[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], footer.container[_ngcontent-%COMP%]   button.lite[_ngcontent-%COMP%]   .check-container[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin:auto;color:#363636;font-size:19px}footer.container[_ngcontent-%COMP%]   button.standard[_ngcontent-%COMP%]{margin-right:auto}footer.container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-child.reset{margin-right:auto}footer.container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-child.cancel{margin-left:auto}"],changeDetection:0}));let r=n;return r})();var Ea=(()=>{let n=class n{dialogService;translatePipe;constructor(e,t){this.dialogService=e,this.translatePipe=t}canDeactivate(e){return e.formChanged?(this.dialogService.toggleDialogVisibility(Gt.WARNING,!0,{size:{width:336,height:280},title:this.translatePipe.transform("CANCEL"),description:this.translatePipe.transform("CHANGES_NOT_SAVED")}),this.dialogService.dialogEvent$.pipe(w(t=>t.dialogType===Gt.WARNING),ts(),_t(t=>(t.action==="confirm"&&this.dialogService.closeCurrentActiveDialog(),t.action==="confirm")))):!0}};E(n,"\u0275fac",function(t){return new(t||n)(It(Qn),It(ee))}),E(n,"\u0275prov",Yt({token:n,factory:n.\u0275fac}));let r=n;return r})();var Sa=(()=>{let n=class n{differs;templateRef;viewContainerRef;_eTreeFrom;set eTreeFrom(e){this._eTreeFrom=e,this.resolveFlattened(),this.ngForDirective.ngForOf=this.flattened}flattened=[];ngForDirective;constructor(e,t,o){this.differs=e,this.templateRef=t,this.viewContainerRef=o,this.ngForDirective=new De(this.viewContainerRef,this.templateRef,this.differs)}ngDoCheck(){this.resolveFlattened(),this.ngForDirective.ngDoCheck()}resolveFlattened(){this.flattened.splice(0,this.flattened.length,...this.flatten(this._eTreeFrom).slice(1))}flatten(e){return e.children.length===0||!e.expanded?[e]:[e].concat(...e.children.map(t=>this.flatten(t)))}};E(n,"\u0275fac",function(t){return new(t||n)(m(ls),m(rs),m(Xt))}),E(n,"\u0275dir",Bi({type:n,selectors:[["","eTree",""]],inputs:{eTreeFrom:"eTreeFrom"},standalone:!1}));let r=n;return r})();var Ia=(()=>{let n=class n{};E(n,"\u0275fac",function(t){return new(t||n)}),E(n,"\u0275mod",ot({type:n})),E(n,"\u0275inj",nt({imports:[rt]}));let r=n;return r})();var ti={vertical:{decrease:new Set(["Down","ArrowDown"]),increase:new Set(["Up","ArrowUp"])},horizontal:{decrease:new Set(["Left","ArrowLeft"]),increase:new Set(["Right","ArrowRight"])}};ti.all={decrease:new Set([...ti.vertical.decrease,...ti.horizontal.decrease]),increase:new Set([...ti.vertical.increase,...ti.horizontal.increase])};var Mn=(()=>{let n=class n{static numberOf(e,t=1){let o=0;return typeof e=="string"&&!isNaN(o=Number(e))?o:typeof e=="number"?e:(console.warn("value is NaN",e),t)}set puInputStep(e){e?typeof e=="string"?this.stepKeys=ti[e]||ti.vertical:e.increase instanceof Set&&e.decrease instanceof Set?this.stepKeys=e:(console.warn("Unsupported type",e),this.stepKeys=ti.vertical):this.stepKeys=ti.vertical}set puStep(e){this.step=n.numberOf(e)}set puAlterStep(e){this.alternativeStep=n.numberOf(e)}puStepDisabled=!1;puStepApply=new Ge;step=1;alternativeStep=10;stepKeys=ti.vertical;emit(e){if(this.puStepDisabled)return;let t=this.stepKeys.decrease.has(e.key);if(!t&&!this.stepKeys.increase.has(e.key))return;e.preventDefault(),e.stopPropagation();let o=(e.shiftKey?this.alternativeStep:this.step)*(t?-1:1);this.puStepApply.emit(o)}};E(n,"\u0275fac",function(t){return new(t||n)}),E(n,"\u0275dir",Bi({type:n,selectors:[["","puInputStep",""]],hostBindings:function(t,o){t&1&&I("keydown",function(c){return o.emit(c)})},inputs:{puInputStep:"puInputStep",puStep:"puStep",puAlterStep:"puAlterStep",puStepDisabled:"puStepDisabled"},outputs:{puStepApply:"puStepApply"},standalone:!1}));let r=n;return r})();var Lo=(()=>{let n=class n{};E(n,"\u0275fac",function(t){return new(t||n)}),E(n,"\u0275mod",ot({type:n})),E(n,"\u0275inj",nt({imports:[rt]}));let r=n;return r})();var Pc=["itemRef"];function Mc(r,n){r&1&&x(0,"i",4)}function Dc(r,n){if(r&1&&(h(0,"div",2,0)(2,"span"),P(3),_(),y(4,Mc,1,0,"i",3),_()),r&2){let i=n.$implicit,e=n.last;l(3),L(i),l(),p("ngIf",!e)}}var va=(()=>{let n=class n{elementRef;renderer;store$;changeDetectorRef;subscriptionService;list;itemRef;rightSideViewSize;constructor(e,t,o,s,c){this.elementRef=e,this.renderer=t,this.store$=o,this.changeDetectorRef=s,this.subscriptionService=c}ngOnInit(){this.subscriptionService.push(this.store$.pipe(le("rightSideViewSize")).subscribe({next:e=>{this.rightSideViewSize=e,this.itemRef?.length>0&&(this.itemRef.forEach(t=>{this.renderer.setStyle(t.nativeElement,"width","auto")}),this.setEllipsis()),this.changeDetectorRef.markForCheck()}}))}ngAfterViewInit(){this.setEllipsis()}setEllipsis(){let e=Pe.nativeWindow.getComputedStyle(this.elementRef.nativeElement).padding.split(" ").filter((O,U)=>U%2===1).map(O=>parseInt(O)).reduce((O,U)=>O+U,0),t=this.rightSideViewSize-e,o=this.itemRef.reduce((O,U)=>O+U.nativeElement.offsetWidth,0);if(o<t)return;let s=this.itemRef.toArray().slice(1,this.itemRef.length-1),c=this.rightSideViewSize/(5*s.length),u=o-t,C=0;s.forEach(O=>{C+=Math.max(O.nativeElement.offsetWidth-u,O.nativeElement.offsetWidth-c),this.renderer.setStyle(O.nativeElement,"width",`${Math.max(O.nativeElement.offsetWidth-u,c)}px`)});let N=this.itemRef.last.nativeElement;this.renderer.setStyle(N,"width",`${N.offsetWidth-(u-C)}px`)}};E(n,"\u0275fac",function(t){return new(t||n)(m(re),m(xt),m(me),m($),m(R))}),E(n,"\u0275cmp",H({type:n,selectors:[["sd-breadcrumb"]],viewQuery:function(t,o){if(t&1&&te(Pc,5),t&2){let s;ie(s=ne())&&(o.itemRef=s)}},inputs:{list:"list"},standalone:!1,features:[j([R])],decls:1,vars:1,consts:[["itemRef",""],["class","breadcrumb-item",4,"ngFor","ngForOf"],[1,"breadcrumb-item"],["class","papycon papycon-next-symbol2",4,"ngIf"],[1,"papycon","papycon-next-symbol2"]],template:function(t,o){t&1&&y(0,Dc,5,2,"div",1),t&2&&p("ngForOf",o.list)},dependencies:[De,Ce],styles:["[_nghost-%COMP%]{font-size:14px;line-height:24px;font-family:NotoSans-Regular,sans-serif;padding:12px 12px 8px 16px;color:var(--mono-70);display:flex}.breadcrumb-item[_ngcontent-%COMP%]{display:flex;align-items:center}.breadcrumb-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.breadcrumb-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{font-family:NotoSans-Medium,sans-serif;color:var(--mono-99)}.breadcrumb-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:9px;padding:0 8px;color:#415073}"],changeDetection:0}));let r=n;return r})();var Oa=(()=>{let n=class n{};E(n,"\u0275fac",function(t){return new(t||n)}),E(n,"\u0275mod",ot({type:n})),E(n,"\u0275inj",nt({imports:[rt]}));let r=n;return r})();function Lc(r,n){if(r&1){let i=M();h(0,"div",14),I("click",function(){let t=f(i).index,o=d();return g(o.onItemSelect(t))}),P(1),_()}if(r&2){let i=n.$implicit,e=n.index,t=d();p("ngClass",t.getOptionClass(e)),l(),L(i[1])}}var sn=class sn{ngControl;changeDetectorRef;subscriptionService;store$;toastService;fb;translatePipe;selectedIndexChange=new Ge;newOptionForm;disabled=!1;selectedIndex=-1;list=[];isSmallWidthScreen=Pe.isSmallWidth();get isDisable(){return this.disabled||this.list?.length===0||!this.list?.[this.selectedIndex]}screenTheme;get isDarkMode(){return this.screenTheme==="light"?!1:this.screenTheme==="dark"||window.matchMedia("(prefers-color-scheme: dark)")?.matches}onChange;constructor(n,i,e,t,o,s,c){this.ngControl=n,this.changeDetectorRef=i,this.subscriptionService=e,this.store$=t,this.toastService=o,this.fb=s,this.translatePipe=c,this.ngControl&&(this.ngControl.valueAccessor=this),this.newOptionForm=this.fb.group({name:this.fb.nonNullable.control(""),value:this.fb.nonNullable.control("")},{validators:[u=>{let C=u.value;return C.name.length>0&&C.value.length>0?null:{length:!0}}]})}ngOnInit(){this.subscriptionService.push(this.store$.pipe(Be("screenTheme")).subscribe({next:n=>{this.screenTheme=n,this.changeDetectorRef.markForCheck()}}))}writeValue(n){this.list=n.map(i=>typeof i=="string"?[i,i]:i),this.changeDetectorRef.markForCheck()}registerOnChange(n){this.onChange=n}registerOnTouched(){}setDisabledState(n){this.disabled=n,this.newOptionForm[n?"disable":"enable"](),this.changeDetectorRef.markForCheck()}getOptionClass(n){return{disabled:this.disabled,selected:n===this.selectedIndex}}onItemSelect(n){let[i,e]=this.list[n];this.list.length!==0&&(this.selectedIndex===n?(this.selectedIndex=-1,this.newOptionForm.reset()):(this.selectedIndex=n,this.newOptionForm.reset({name:e,value:i})),this.selectedIndexChange.emit(this.selectedIndex))}onDeleteButtonClick(){let n=[];try{n=this.deleteItem(this.list)}catch(i){if(i instanceof Error){this.toastService.create({toastStyle:dt.FAILURE,content:this.translatePipe.transform(i.message)});return}}this.writeValue(n),this.onChange(n)}onAddButtonClick(){let n=this.newOptionForm.getRawValue(),i=[];try{i=this.addItem(this.list,n)}catch(e){if(e instanceof Error){this.toastService.create({toastStyle:dt.FAILURE,content:this.translatePipe.transform(e.message)});return}}this.writeValue(i),this.onChange(i),this.newOptionForm.reset()}onItemMove(n){this.list.length!==0&&(n&&this.list.length>this.selectedIndex+1&&(this.list=this.moveItemFromArray(this.list,this.selectedIndex,this.selectedIndex+1),this.selectedIndex=this.selectedIndex+1),!n&&this.selectedIndex-1>=0&&(this.list=this.moveItemFromArray(this.list,this.selectedIndex,this.selectedIndex-1),this.selectedIndex=this.selectedIndex-1),this.selectedIndexChange.emit(this.selectedIndex),this.onChange(this.list))}deleteItem(n){if(n.length===0)return n;if(!n.some((i,e)=>this.selectedIndex===e))throw new Error("NO_SELECTED_ITEM");return n.filter((i,e)=>this.selectedIndex!==e)}addItem(n,i){if(this.list.some(t=>i.value===t[0]))throw new Error("COMBO_LIST_VALUE_DUPLICATION_ERROR");if(this.list.some(t=>i.name===t[1]))throw new Error("COMBO_LIST_NAME_DUPLICATION_ERROR");let e=[i.value,i.name];return[...n,e]}moveItemFromArray(n,i,e){let t=[...n],o=t[i];return t[i]=t[e],t[e]=o,t}};E(sn,"\u0275fac",function(i){return new(i||sn)(m(qn,10),m($),m(R),m(me),m(Zt),m(gi),m(ee))}),E(sn,"\u0275cmp",H({type:sn,selectors:[["sd-annot-property-option"]],outputs:{selectedIndexChange:"selectedIndexChange"},standalone:!1,features:[j([R])],decls:31,vars:53,consts:[[3,"formGroup"],[1,"property-title"],["formControlName","name",3,"size","ariaLabel"],["formControlName","value",3,"size","ariaLabel"],["color","primary",1,"ep-button",3,"click","disabled"],["tabindex","0",1,"property-title"],[1,"list-container"],[1,"list"],["tabindex","0",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"buttons"],["size","tiny","color","grey",1,"ep-button",3,"click","disabled"],[1,"papycon","papycon-up-symbol"],[1,"papycon","papycon-down-symbol"],[1,"papycon","papycon-trash-can"],["tabindex","0",3,"click","ngClass"]],template:function(i,e){i&1&&(ue(0,0),h(1,"span",1),P(2),T(3,"translate"),_(),x(4,"pu-input",2),T(5,"translate"),h(6,"span",1),P(7),T(8,"translate"),_(),x(9,"pu-input",3),T(10,"translate"),h(11,"button",4),T(12,"translate"),I("click",function(){return e.onAddButtonClick()}),P(13),T(14,"translate"),_(),he(),h(15,"span",5),P(16),T(17,"translate"),_(),h(18,"div",6)(19,"div",7),y(20,Lc,2,2,"div",8),_(),h(21,"nav",9)(22,"button",10),T(23,"translate"),I("click",function(){return e.onItemMove(!1)}),x(24,"i",11),_(),h(25,"button",10),T(26,"translate"),I("click",function(){return e.onItemMove(!0)}),x(27,"i",12),_(),h(28,"button",10),T(29,"translate"),I("click",function(){return e.onDeleteButtonClick()}),x(30,"i",13),_()()()),i&2&&(p("formGroup",e.newOptionForm),l(),G("disabled",e.disabled),l(),L(A(3,33,"ITEM")),l(2),p("size",e.isSmallWidthScreen?"small":"tiny")("ariaLabel",A(5,35,"ITEM")),l(2),G("disabled",e.disabled),l(),L(A(8,37,"EXPORT_VALUE")),l(2),p("size",e.isSmallWidthScreen?"small":"tiny")("ariaLabel",A(10,39,"EXPORT_VALUE")),l(2),G("dark",e.isDarkMode),p("disabled",e.disabled||e.newOptionForm.invalid),B("size",e.isSmallWidthScreen?"small":"tiny")("aria-label",A(12,41,"ADD")),l(2),L(A(14,43,"ADD")),l(2),G("disabled",e.disabled),l(),L(A(17,45,"ITEM_LIST")),l(4),p("ngForOf",e.list),l(2),G("dark",e.isDarkMode),p("disabled",e.isDisable||e.selectedIndex===0),B("aria-label",A(23,47,"MOVE_UP")),l(3),G("dark",e.isDarkMode),p("disabled",e.isDisable||e.selectedIndex===e.list.length-1),B("aria-label",A(26,49,"MOVE_DOWN")),l(3),G("dark",e.isDarkMode),p("disabled",e.isDisable),B("aria-label",A(29,51,"REMOVE")))},styles:["[_nghost-%COMP%]{display:flex;width:100%;height:100%;flex-direction:column}.property-title[_ngcontent-%COMP%]{font-size:12px;line-height:20px;font-family:NotoSans-Medium,sans-serif;color:var(--mono-70);margin-top:4px;margin-bottom:2px}.property-title.disabled[_ngcontent-%COMP%]{opacity:.5;-webkit-user-select:none;user-select:none}pu-input[_ngcontent-%COMP%]{margin-bottom:8px}.list-container[_ngcontent-%COMP%]{width:100%;height:100%;overflow:hidden}.list[_ngcontent-%COMP%]{display:block;overflow:auto;height:170px;width:100%;box-sizing:border-box;padding:4px 0;border-radius:2px;border:1px solid var(--mono-30);outline:none;-webkit-appearance:none;appearance:none}.list[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{font-size:13px;line-height:22px;font-family:NotoSans-Regular,sans-serif;color:var(--mono-70);display:flex;width:100%;height:30px;align-items:center;box-sizing:border-box;padding:0 11px;-webkit-appearance:none;appearance:none;outline:none}.list[_ngcontent-%COMP%]   div.selected[_ngcontent-%COMP%]{color:var(--mono-99);background-color:var(--mono-30)}.list[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:not(.disabled):hover{background-color:var(--mono-30)}.buttons[_ngcontent-%COMP%]{display:flex;width:100%;margin-top:8px}.buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}.buttons[_ngcontent-%COMP%]   button.dark[_ngcontent-%COMP%]{color:var(--mono-99);background-color:var(--mono-50)}.buttons[_ngcontent-%COMP%]   button.dark[_ngcontent-%COMP%]:disabled{color:var(--font-disable);background-color:var(--mono-30)}.buttons[_ngcontent-%COMP%]   button.dark[_ngcontent-%COMP%]:not(:disabled):hover{background-color:#9f9f9f}.buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] + button[_ngcontent-%COMP%]{margin-left:12px}.dark[_ngcontent-%COMP%]{color:var(--mono-00)}.dark[_ngcontent-%COMP%]:disabled{background-color:#946516}"],changeDetection:0}));var Ii=sn;Z([Se(Q.annotPropertyOption.changeOption)],Ii.prototype,"onDeleteButtonClick",null);Z([Se(Q.annotPropertyOption.changeOption)],Ii.prototype,"onAddButtonClick",null);Z([Se(Q.annotPropertyOption.changeOption)],Ii.prototype,"onItemMove",null);var Or=Tc(Ac());var ko=(()=>{let n=class n{modalService;portalRef;subscriptionService;elementRef;store$;changeDetectorRef;templateName;screenTheme;get isDarkMode(){return this.screenTheme==="light"?!1:this.screenTheme==="dark"||window.matchMedia("(prefers-color-scheme: dark)")?.matches}constructor(e,t,o,s,c,u){this.modalService=e,this.portalRef=t,this.subscriptionService=o,this.elementRef=s,this.store$=c,this.changeDetectorRef=u}ngOnInit(){this.subscriptionService.push(this.store$.pipe(Be("screenTheme")).subscribe({next:e=>{this.screenTheme=e,this.changeDetectorRef.markForCheck()}}),we(window,"keydown",{capture:!0}).pipe(w(e=>e.key==="Escape"),w(()=>this.modalService.lastModal===this.portalRef)).subscribe({next:()=>this.onButtonClick(!1)})),this.elementRef.nativeElement.parentElement.style.minWidth="400px"}onButtonClick(e){this.portalRef.dispose(e?this.templateName:void 0)}};E(n,"\u0275fac",function(t){return new(t||n)(m(Xn),m(Kt),m(R),m(re),m(me),m($))}),E(n,"\u0275cmp",H({type:n,selectors:[["sd-add-template-modal"]],standalone:!1,features:[j([R])],decls:18,vars:27,consts:[[1,"title"],[3,"ngModelChange","ariaLabel","ngModel"],["size","small","color","white",1,"ep-button","cancel",3,"click"],["color","primary","size","small",1,"ep-button","confirm",3,"click","disabled"]],template:function(t,o){t&1&&(h(0,"h3"),P(1),T(2,"translate"),_(),h(3,"main")(4,"span",0),P(5),T(6,"translate"),_(),h(7,"pu-input",1),T(8,"translate"),ce("ngModelChange",function(c){return se(o.templateName,c)||(o.templateName=c),c}),_()(),h(9,"footer")(10,"button",2),T(11,"translate"),I("click",function(){return o.onButtonClick(!1)}),P(12),T(13,"translate"),_(),h(14,"button",3),T(15,"translate"),I("click",function(){return o.onButtonClick(!0)}),P(16),T(17,"translate"),_()()),t&2&&(l(),L(A(2,13,"ADD_TEMPLATE")),l(4),L(A(6,15,"TITLE")),l(2),p("ariaLabel",A(8,17,"TITLE")),ae("ngModel",o.templateName),l(3),G("dark",o.isDarkMode),B("aria-label",A(11,19,"CANCEL")),l(2),L(A(13,21,"CANCEL")),l(2),G("dark",o.isDarkMode),p("disabled",!o.templateName),B("aria-label",A(15,23,"OK")),l(2),L(A(17,25,"OK")))},styles:["h3[_ngcontent-%COMP%]{font-size:20px;line-height:28px;font-family:NotoSans-Medium,sans-serif;color:var(--mono-99);margin:8px 0}main[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-top:24px}main[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:12px;line-height:20px;font-family:NotoSans-Regular,sans-serif;color:var(--mono-70)}main[_ngcontent-%COMP%]   pu-input[_ngcontent-%COMP%]{font-size:14px;line-height:24px;height:40px}footer[_ngcontent-%COMP%]{text-align:right;margin-top:20px}footer[_ngcontent-%COMP%]   button.cancel.dark[_ngcontent-%COMP%]{color:var(--mono-90);border-color:var(--mono-30);background-color:var(--mono-30)}footer[_ngcontent-%COMP%]   button.cancel.dark[_ngcontent-%COMP%]:hover{color:#d7d7d7;border-color:#474747;background-color:#474747}footer[_ngcontent-%COMP%]   button.confirm.dark[_ngcontent-%COMP%]{color:var(--mono-00)}footer[_ngcontent-%COMP%]   button.confirm.dark[_ngcontent-%COMP%]:disabled{background-color:#946516}footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] + button[_ngcontent-%COMP%]{margin-left:12px}"],changeDetection:0}));let r=n;return r})();var kc=["scriptTemplateInput"];function Vc(r,n){if(r&1){let i=M();h(0,"p",8),I("click",function(t){f(i);let o=d().$implicit,s=d();return g(s.startEditScriptTemplate(t,o))}),P(1),_()}if(r&2){let i=d().$implicit;l(),L(i.name)}}function Uc(r,n){if(r&1){let i=M();h(0,"pu-input",9,0),T(2,"translate"),ce("ngModelChange",function(t){f(i);let o=d(2);return se(o.editInputValue,t)||(o.editInputValue=t),g(t)}),I("keydown.enter",function(){f(i);let t=d().$implicit,o=d();return o.modifyScriptTemplate(t),g(o.editId=null)}),_()}if(r&2){let i=d(2);p("useClearButton",!0)("autofocus",!0)("ariaLabel",A(2,4,"TEMPLATE_TITLE")),ae("ngModel",i.editInputValue)}}function Bc(r,n){if(r&1){let i=M();h(0,"div",10),I("click",function(){f(i);let t=d().$implicit,o=d();return g(o.deleteScriptTemplate(t))}),x(1,"i",11),_()}}function Gc(r,n){if(r&1){let i=M();h(0,"li",4),I("click",function(){let t=f(i).$implicit,o=d();return g(o.selectScriptTemplate(t))})("mouseenter",function(){let t=f(i).$implicit,o=d();return g(o.hoverId=t.id)})("mouseleave",function(){f(i);let t=d();return g(t.hoverId=null)}),y(1,Vc,2,1,"p",5)(2,Uc,3,6,"pu-input",6)(3,Bc,2,0,"div",7),_()}if(r&2){let i=n.$implicit,e=d();G("selected",i.id===(e.selectedTemplate==null?null:e.selectedTemplate.id))("dark",e.isDarkMode),l(),p("ngIf",e.editId!==i.id),l(),p("ngIf",e.editId===i.id),l(),p("ngIf",i.id===e.hoverId)}}var Vo=(()=>{let n=class n{modalService;portalRef;subscriptionService;elementRef;translatePipe;pdfDataService;toastService;changeDetectorRef;store$;templates;editId;hoverId;editInputValue;selectedTemplate;scriptTemplateInput;screenTheme;get isDarkMode(){return this.screenTheme==="light"?!1:this.screenTheme==="dark"||window.matchMedia("(prefers-color-scheme: dark)")?.matches}constructor(e,t,o,s,c,u,C,N,O){this.modalService=e,this.portalRef=t,this.subscriptionService=o,this.elementRef=s,this.translatePipe=c,this.pdfDataService=u,this.toastService=C,this.changeDetectorRef=N,this.store$=O}fetchScriptTemplate(){return this.pdfDataService.getScriptTemplates().pipe(Ve(e=>{this.templates=e}))}ngOnInit(){this.subscriptionService.push(this.store$.pipe(Be("screenTheme")).subscribe({next:e=>{this.screenTheme=e,this.changeDetectorRef.markForCheck()}}),this.fetchScriptTemplate().subscribe({next:()=>this.changeDetectorRef.markForCheck(),error:e=>{this.toastService.create({toastStyle:dt.FAILURE,header:this.translatePipe.transform("FAILED_TO_LOAD_TEMPLATE"),content:e}),this.onButtonClick(!1)}}),we(window,"keydown",{capture:!0}).pipe(w(e=>e.key==="Escape"),w(()=>this.modalService.lastModal===this.portalRef)).subscribe({next:()=>this.onButtonClick(!1)})),this.elementRef.nativeElement.parentElement.style.minWidth="460px"}onButtonClick(e){this.portalRef.dispose(e?this.selectedTemplate.body:void 0)}selectScriptTemplate(e){this.selectedTemplate?.id!==e.id&&(this.selectedTemplate!==void 0&&this.editId===this.selectedTemplate?.id&&this.modifyScriptTemplate(this.selectedTemplate),this.selectedTemplate=e,this.editId=null)}modifyScriptTemplate(e){this.subscriptionService.push(this.pdfDataService.putScriptTemplates(e.id,{name:this.editInputValue,description:e.description,body:e.body}).pipe(Tt(()=>this.fetchScriptTemplate())).subscribe({next:()=>this.changeDetectorRef.markForCheck(),error:()=>{this.toastService.create({toastStyle:dt.FAILURE,content:this.translatePipe.transform("ERROR_PAGES_500")})}}))}startEditScriptTemplate(e,t){this.selectedTemplate?.id===t.id&&(e.stopPropagation(),this.editId=t.id,this.editInputValue=t.name,ri(0).subscribe(()=>{this.scriptTemplateInput.inputElementRef.nativeElement.select()}))}deleteScriptTemplate(e){this.subscriptionService.push(this.pdfDataService.deleteScriptTemplates(e.id).pipe(Tt(()=>this.fetchScriptTemplate())).subscribe({next:()=>{this.toastService.create({toastStyle:dt.SUCCESS,content:this.translatePipe.transform("SUCCESS_DELETE_TEMPLATE")}),this.changeDetectorRef.markForCheck()},error:()=>{this.toastService.create({toastStyle:dt.FAILURE,content:this.translatePipe.transform("ERROR_PAGES_500")})}}))}};E(n,"\u0275fac",function(t){return new(t||n)(m(Xn),m(Kt),m(R),m(re),m(ee),m(bo),m(Zt),m($),m(me))}),E(n,"\u0275cmp",H({type:n,selectors:[["sd-view-template-modal"]],viewQuery:function(t,o){if(t&1&&te(kc,5),t&2){let s;ie(s=ne())&&(o.scriptTemplateInput=s.first)}},standalone:!1,features:[j([R])],decls:12,vars:13,consts:[["scriptTemplateInput",""],[1,"papycon","papycon-chevron3-left",3,"click"],[3,"selected","dark","click","mouseenter","mouseleave",4,"ngFor","ngForOf"],["color","primary","size","small",1,"ep-button",3,"click","disabled"],[3,"click","mouseenter","mouseleave"],[3,"click",4,"ngIf"],[3,"useClearButton","autofocus","ariaLabel","ngModel","ngModelChange","keydown.enter",4,"ngIf"],["class","delete-button",3,"click",4,"ngIf"],[3,"click"],[3,"ngModelChange","keydown.enter","useClearButton","autofocus","ariaLabel","ngModel"],[1,"delete-button",3,"click"],[1,"papycon","papycon-minus2"]],template:function(t,o){t&1&&(h(0,"h3")(1,"i",1),I("click",function(){return o.onButtonClick(!1)}),_(),P(2),T(3,"translate"),_(),h(4,"main")(5,"ul"),y(6,Gc,4,7,"li",2),_()(),h(7,"footer")(8,"button",3),T(9,"translate"),I("click",function(){return o.onButtonClick(!0)}),P(10),T(11,"translate"),_()()),t&2&&(l(2),Re(" ",A(3,7,"VIEW_TEMPLATE"),`
`),l(4),p("ngForOf",o.templates),l(2),G("dark",o.isDarkMode),p("disabled",!o.selectedTemplate),B("aria-label",A(9,9,"ACTIVE")),l(2),L(A(11,11,"ACTIVE")))},styles:["h3[_ngcontent-%COMP%]{font-size:20px;line-height:28px;font-family:NotoSans-Medium,sans-serif;color:var(--mono-99);margin:8px 0 20px}h3[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:16px;line-height:30px;cursor:pointer}main[_ngcontent-%COMP%]{display:flex;flex-direction:column}main[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{width:412px;height:483px;box-sizing:border-box;margin:0;padding:0;border-radius:4px;border:solid 1.2px var(--mono-30);background-color:#dadada1a;overflow:auto}main[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:14px;line-height:24px;height:40px;position:relative;box-sizing:border-box;display:flex;align-items:center;cursor:pointer}main[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(2n){background-color:var(--mono-10)}main[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li.selected[_ngcontent-%COMP%]{border:solid 1.2px var(--primary-50)}main[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li.selected[_ngcontent-%COMP%]:not(.dark){background-color:rgba(var(--primary-50-rgb),.08)}main[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{max-width:348px;padding-left:8px;margin:0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}main[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   pu-input[_ngcontent-%COMP%]{width:348px;margin:0 0 0 8px}main[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .delete-button[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:22px;height:22px;font-size:16px;position:absolute;top:8px;right:13px;cursor:pointer}footer[_ngcontent-%COMP%]{text-align:right;margin-top:20px}footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}footer[_ngcontent-%COMP%]   button.dark[_ngcontent-%COMP%]{color:var(--mono-00)}footer[_ngcontent-%COMP%]   button.dark[_ngcontent-%COMP%]:disabled{background-color:#946516}footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] + button[_ngcontent-%COMP%]{margin-left:12px}"],changeDetection:0}));let r=n;return r})();var Wc=["customScriptTextareaRef"],Hc=()=>({standalone:!0});function zc(r,n){if(r&1&&x(0,"i"),r&2){let i=d(2);Gi(i.customScriptValidation.icon)}}function jc(r,n){if(r&1&&(h(0,"section",22)(1,"span",23),P(2),_()()),r&2){let i=d(2);l(2),L(i.customScriptValidation.rightSideMsg)}}function $c(r,n){if(r&1&&(ue(0),h(1,"section",17),y(2,zc,1,2,"i",18),h(3,"span",19),P(4),_()(),x(5,"div",20),y(6,jc,3,1,"section",21),he()),r&2){let i=d();l(2),p("ngIf",i.customScriptValidation.icon),l(),p("title",i.customScriptValidation.msg),l(),L(i.customScriptValidation.msg),l(2),p("ngIf",i.customScriptValidation.rightSideMsg)}}function Yc(r,n){r&1&&x(0,"div",24)}var Uo=function(r){return r[r.ADD=0]="ADD",r[r.VIEW=1]="VIEW",r}(Uo||{}),an=class an{tempCustomScript;modalService;toastService;portalRef;subscriptionService;elementRef;changeDetectorRef;translatePipe;annotSelectedService;acroFormService;scriptService;pdfDataService;store$;customScriptTextareaRef;customScriptValidation;isSmallWidthScreen=Pe.isSmallWidth();customScriptRowNumber=S.EMPTY_STRING;customScript=S.EMPTY_STRING;get TemplateModalType(){return Uo}scriptValidateSubject=new it;scriptCursorColumn=1;scriptCursorRow=1;screenTheme;get isDarkMode(){return this.screenTheme==="light"?!1:this.screenTheme==="dark"||window.matchMedia("(prefers-color-scheme: dark)")?.matches}constructor(n,i,e,t,o,s,c,u,C,N,O,U,z){this.tempCustomScript=n,this.modalService=i,this.toastService=e,this.portalRef=t,this.subscriptionService=o,this.elementRef=s,this.changeDetectorRef=c,this.translatePipe=u,this.annotSelectedService=C,this.acroFormService=N,this.scriptService=O,this.pdfDataService=U,this.store$=z}ngOnInit(){this.customScript=this.tempCustomScript,this.subscriptionService.push(this.store$.pipe(Be("screenTheme")).subscribe({next:n=>{this.screenTheme=n,this.changeDetectorRef.markForCheck()}}),Pe.windowResize$.subscribe(()=>{this.isSmallWidthScreen=Pe.isSmallWidth(),this.changeDetectorRef.markForCheck()}),this.scriptValidateSubject.pipe($t(500)).subscribe(()=>{if(this.annotSelectedService.length===0)return;let n=this.annotSelectedService.selectedComponents[0].data;if(b.isWidget(n)){let i=this.acroFormService.getAcroField(n.attributes.Parent),e=this.scriptService.validate(i,this.customScript);this.customScriptValidation={class:e?"error":null,icon:e?"papycon papycon-exclamation-mark":null,msg:e?e.message:this.translatePipe.transform("SCRIPT_HAS_NO_ERROR"),rightSideMsg:e?.lineNumber?`Ln ${e.lineNumber.toString(10)}`:null},this.changeDetectorRef.markForCheck()}}),we(window,"keydown",{capture:!0}).pipe(w(n=>n.key==="Escape"),w(()=>this.modalService.lastModal===this.portalRef)).subscribe({next:()=>this.onButtonClick(!1)})),this.elementRef.nativeElement.parentElement.style.minWidth="460px"}ngAfterViewInit(){this.customScriptValidation=null,this.scriptValidateSubject.next()}onButtonClick(n){this.portalRef.dispose(n?this.customScript:void 0)}onScriptKeyup(n){this.determineCursorPosition(n.target)}onScriptInput(n){this.determineCursorPosition(n.target),this.customScriptValidation=null,this.scriptValidateSubject.next()}onScriptMouseEvent(n){this.determineCursorPosition(n.target)}getCursorPositionString(){let n=this.translatePipe.transform("CURSOR_ROW"),i=this.translatePipe.transform("CURSOR_COL");return`${n} ${this.scriptCursorRow}, ${i} ${this.scriptCursorColumn}`}moveCustomScriptLine(){let n=Number(this.customScriptRowNumber);if(isNaN(n)||!this.customScriptTextareaRef)return;let i=this.customScriptTextareaRef.nativeElement,e=i.value,t=-1;for(;--n>0;){let o=e.indexOf(`
`,t+1);if(o===-1)break;t=o}this.customScriptRowNumber="",i.selectionStart=t+1,i.selectionEnd=t+1,this.determineCursorPosition(i),i.focus()}openTemplateHelper(n){switch(n){case Uo.VIEW:this.modalService.createModal(Vo,S.EMPTY_STRING).addOnDisposeListener(i=>{S.isDefined(i)&&(this.customScript=i,this.scriptValidateSubject.next())});break;case Uo.ADD:this.modalService.createModal(ko,S.EMPTY_STRING).addOnDisposeListener(i=>{S.isDefined(i)&&this.addScriptTemplate(i)});break}}addScriptTemplate(n){this.subscriptionService.push(this.pdfDataService.postScriptTemplate(n,"",this.customScript).subscribe({next:()=>{this.toastService.create({toastStyle:dt.SUCCESS,content:this.translatePipe.transform("SUCCESS_ADD_TEMPLATE")})},error:()=>{this.toastService.create({toastStyle:dt.FAILURE,content:this.translatePipe.transform("ERROR_PAGES_500")})}}))}determineCursorPosition(n){let i=n.value,e=n.selectionStart,t=1,o=-1,s=i.indexOf(`
`);for(;s!==-1&&s<e;)t++,o=s,s=i.indexOf(`
`,s+1);this.scriptCursorColumn=e-o,this.scriptCursorRow=t}};E(an,"\u0275fac",function(i){return new(i||an)(m(Hi),m(bt),m(Zt),m(Kt),m(R),m(re),m($),m(ee),m(Ct),m(gt),m(qt),m(bo),m(me))}),E(an,"\u0275cmp",H({type:an,selectors:[["sd-template-modal"]],viewQuery:function(i,e){if(i&1&&te(Wc,5),i&2){let t;ie(t=ne())&&(e.customScriptTextareaRef=t.first)}},standalone:!1,features:[j([R])],decls:43,vars:63,consts:[["customScriptTextareaRef",""],[3,"ngModelChange","input","keyup","mousedown","mouseup","ngModel"],[1,"row-info"],[1,"flex","align-center"],[3,"submit"],[3,"ngModelChange","ngModelOptions","size","ariaLabel","ngModel"],["color","white",1,"ep-button",3,"click"],[1,"script-validation-message",3,"ngClass"],[4,"ngIf"],["class","spin-loader",4,"ngIf"],[1,"save-script-container"],["size","small","color","white",1,"ep-button",3,"click","disabled"],[1,"papycon","papycon-plus3"],["size","small","color","white",1,"ep-button",3,"click"],[1,"papycon","papycon-list2"],["size","small","color","white",1,"ep-button","cancel",3,"click"],["color","primary","size","small",1,"ep-button","confirm",3,"click","disabled"],[1,"left"],[3,"class",4,"ngIf"],[1,"message",3,"title"],[1,"background"],["class","right",4,"ngIf"],[1,"right"],[1,"rightside-message"],[1,"spin-loader"]],template:function(i,e){if(i&1){let t=M();h(0,"h3"),P(1),T(2,"translate"),_(),h(3,"main")(4,"textarea",1,0),ce("ngModelChange",function(s){return f(t),se(e.customScript,s)||(e.customScript=s),g(s)}),I("input",function(s){return f(t),g(e.onScriptInput(s))})("keyup",function(s){return f(t),g(e.onScriptKeyup(s))})("mousedown",function(s){return f(t),g(e.onScriptMouseEvent(s))})("mouseup",function(s){return f(t),g(e.onScriptMouseEvent(s))}),_(),h(6,"nav",2)(7,"span"),P(8),_(),h(9,"div",3)(10,"span"),P(11),T(12,"translate"),_(),h(13,"form",4),I("submit",function(){return f(t),g(e.moveCustomScriptLine())}),h(14,"pu-input",5),T(15,"translate"),ce("ngModelChange",function(s){return f(t),se(e.customScriptRowNumber,s)||(e.customScriptRowNumber=s),g(s)}),_()(),h(16,"button",6),T(17,"translate"),I("click",function(){return f(t),g(e.moveCustomScriptLine())}),P(18),T(19,"translate"),_()()(),h(20,"div",7),y(21,$c,7,4,"ng-container",8)(22,Yc,1,0,"div",9),_(),h(23,"section",10)(24,"button",11),T(25,"translate"),I("click",function(){return f(t),g(e.openTemplateHelper(e.TemplateModalType.ADD))}),x(26,"i",12),P(27),T(28,"translate"),_(),h(29,"button",13),T(30,"translate"),I("click",function(){return f(t),g(e.openTemplateHelper(e.TemplateModalType.VIEW))}),x(31,"i",14),P(32),T(33,"translate"),_()()(),h(34,"footer")(35,"button",15),T(36,"translate"),I("click",function(){return f(t),g(e.onButtonClick(!1))}),P(37),T(38,"translate"),_(),h(39,"button",16),T(40,"translate"),I("click",function(){return f(t),g(e.onButtonClick(!0))}),P(41),T(42,"translate"),_()()}i&2&&(l(),L(A(2,36,"CUSTOM_CALCULATION_SCRIPT")),l(3),G("dark",e.isDarkMode),ae("ngModel",e.customScript),l(4),L(e.getCursorPositionString()),l(3),Re("",A(12,38,"COLUMN_NUMBER")," :"),l(3),p("ngModelOptions",oe(62,Hc))("size",e.isSmallWidthScreen?"small":"tiny")("ariaLabel",A(15,40,"COLUMN_NUMBER")),ae("ngModel",e.customScriptRowNumber),l(2),G("dark",e.isDarkMode),B("size",e.isSmallWidthScreen?"small":"tiny")("aria-label",A(17,42,"MOVE")),l(2),L(A(19,44,"MOVE")),l(2),p("ngClass",e.customScriptValidation==null?null:e.customScriptValidation.class),l(),p("ngIf",e.customScriptValidation),l(),p("ngIf",!e.customScriptValidation),l(2),G("dark",e.isDarkMode),p("disabled",!e.customScript),B("aria-label",A(25,46,"ADD_TEMPLATE")),l(3),Re(" ",A(28,48,"ADD_TEMPLATE")," "),l(2),G("dark",e.isDarkMode),B("aria-label",A(30,50,"VIEW_TEMPLATE")),l(3),Re(" ",A(33,52,"VIEW_TEMPLATE")," "),l(3),G("dark",e.isDarkMode),B("aria-label",A(36,54,"CANCEL")),l(2),L(A(38,56,"CANCEL")),l(2),G("dark",e.isDarkMode),p("disabled",!e.customScriptValidation||(e.customScriptValidation==null?null:e.customScriptValidation.class)==="error"),B("aria-label",A(40,58,"OK")),l(2),L(A(42,60,"OK")))},styles:["h3[_ngcontent-%COMP%]{font-size:20px;line-height:28px;font-family:NotoSans-Medium,sans-serif;color:var(--mono-99);margin:8px 0 12px}main[_ngcontent-%COMP%]{display:flex;flex-direction:column}main[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{font-family:Consolas;width:100%;height:260px;margin-bottom:12px;padding:8px 4px;box-sizing:border-box;border-radius:2px;border:1px solid var(--mono-30);color:var(--mono-90);background-color:var(--input-background);resize:none;outline:none;caret-color:var(--primary-50)}main[_ngcontent-%COMP%]   textarea.dark[_ngcontent-%COMP%]{border:1px solid var(--mono-00)}main[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{border:1px solid var(--primary-50)}main[_ngcontent-%COMP%]   .row-info[_ngcontent-%COMP%]{font-size:12px;line-height:20px;font-family:NotoSans-Regular,sans-serif;color:var(--mono-70);display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}main[_ngcontent-%COMP%]   .row-info[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;align-items:center}main[_ngcontent-%COMP%]   .row-info[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   button.dark[_ngcontent-%COMP%]{color:var(--mono-90);background-color:var(--mono-30);border-color:var(--mono-30)}main[_ngcontent-%COMP%]   .row-info[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   button.dark[_ngcontent-%COMP%]:hover{color:#d7d7d7}main[_ngcontent-%COMP%]   .row-info[_ngcontent-%COMP%]   pu-input[_ngcontent-%COMP%]{width:88px;margin:0 12px}main[_ngcontent-%COMP%]   .script-validation-message[_ngcontent-%COMP%]{font-size:12px;line-height:20px;font-family:NotoSans-Regular,sans-serif;color:var(--mono-70);position:relative;display:flex;height:32px;align-items:center;justify-content:space-between;padding:12px 12px 0;border-top:1px solid var(--mono-30);margin-bottom:24px;white-space:nowrap}main[_ngcontent-%COMP%]   .script-validation-message[_ngcontent-%COMP%]   .background[_ngcontent-%COMP%]{position:absolute;height:calc(100% - 12px);top:12px;left:0;width:100%;z-index:1}main[_ngcontent-%COMP%]   .script-validation-message[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{opacity:.5}main[_ngcontent-%COMP%]   .script-validation-message.error[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{opacity:1}main[_ngcontent-%COMP%]   .script-validation-message.error[_ngcontent-%COMP%]   .background[_ngcontent-%COMP%]{background-color:var(--exception);opacity:.08}main[_ngcontent-%COMP%]   .script-validation-message.error[_ngcontent-%COMP%]   section[_ngcontent-%COMP%]{display:flex;align-items:center}main[_ngcontent-%COMP%]   .script-validation-message.error[_ngcontent-%COMP%]   section.left[_ngcontent-%COMP%]{overflow:hidden}main[_ngcontent-%COMP%]   .script-validation-message.error[_ngcontent-%COMP%]   section.right[_ngcontent-%COMP%]{margin-left:8px}main[_ngcontent-%COMP%]   .script-validation-message.error[_ngcontent-%COMP%]   .papycon[_ngcontent-%COMP%]{color:var(--exception);margin-right:4px;z-index:2}main[_ngcontent-%COMP%]   .script-validation-message.error[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{z-index:2;overflow:hidden;text-overflow:ellipsis;-webkit-user-select:all;user-select:all}main[_ngcontent-%COMP%]   .script-validation-message[_ngcontent-%COMP%]   .spin-loader[_ngcontent-%COMP%]{width:18px;height:18px;border-width:2px}main[_ngcontent-%COMP%]   .save-script-container[_ngcontent-%COMP%]{display:flex;flex-direction:column}main[_ngcontent-%COMP%]   .save-script-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{position:relative}main[_ngcontent-%COMP%]   .save-script-container[_ngcontent-%COMP%]   button.dark[_ngcontent-%COMP%]{color:var(--mono-90);background-color:var(--mono-30);border-color:var(--mono-30)}main[_ngcontent-%COMP%]   .save-script-container[_ngcontent-%COMP%]   button.dark[_ngcontent-%COMP%]:disabled{color:var(--font-disable);background-color:var(--mono-30)}main[_ngcontent-%COMP%]   .save-script-container[_ngcontent-%COMP%]   button.dark[_ngcontent-%COMP%]:not(:disabled):hover{color:#d7d7d7}main[_ngcontent-%COMP%]   .save-script-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] + button[_ngcontent-%COMP%]{margin-top:12px;margin-left:0}main[_ngcontent-%COMP%]   .save-script-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{position:absolute;left:15px}footer[_ngcontent-%COMP%]{text-align:right;margin-top:40px}footer[_ngcontent-%COMP%]   button.dark.confirm[_ngcontent-%COMP%]{color:var(--mono-00);background-color:var(--primary-50)}footer[_ngcontent-%COMP%]   button.dark.confirm[_ngcontent-%COMP%]:disabled{background-color:#946516}footer[_ngcontent-%COMP%]   button.dark.confirm[_ngcontent-%COMP%]:hover{background-color:var(--primary-50-hover)}footer[_ngcontent-%COMP%]   button.dark.cancel[_ngcontent-%COMP%]{color:var(--mono-90);background-color:var(--mono-30);border-color:var(--mono-30)}footer[_ngcontent-%COMP%]   button.dark.cancel[_ngcontent-%COMP%]:hover{color:#d7d7d7;border-color:#474747;background-color:#474747}footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] + button[_ngcontent-%COMP%]{margin-left:12px}"],changeDetection:0}));var ci=an;Z([Se(Q.templateModalComp.onButtonClick)],ci.prototype,"onButtonClick",null);var Xc=()=>["F"],ba=()=>["opacity"],ya=()=>["FillColor"],yr=()=>["StrokeColor"],Kc=()=>["width"],Ra=()=>["FontSize"],Na=()=>["FontColor"],Pa=()=>["Measure"],Qc=()=>["FT"],Zc=()=>["borderStyle","style"],qc=()=>["LE"],Ma=()=>["LL"],Da=()=>["LLE"],wa=()=>["AP_N"],La=()=>["Opt"],Jc=()=>["Parent","AA","C"];function el(r,n){if(r&1){let i=M();h(0,"section",16)(1,"div")(2,"span"),P(3,"X"),_(),h(4,"pu-input-value",17),T(5,"translate"),I("mousedown",function(t){f(i);let o=d();return g(o.preventDragging(t))}),_()(),h(6,"div")(7,"span"),P(8,"Y"),_(),h(9,"pu-input-value",17),T(10,"translate"),I("mousedown",function(t){f(i);let o=d();return g(o.preventDragging(t))}),_()(),h(11,"div")(12,"span"),P(13),T(14,"translate"),_(),h(15,"pu-input-value",17),T(16,"translate"),I("mousedown",function(t){f(i);let o=d();return g(o.preventDragging(t))}),_()(),h(17,"div")(18,"span"),P(19),T(20,"translate"),_(),h(21,"pu-input-value",18),T(22,"translate"),I("puStepApply",function(t){f(i);let o=d();return g(o.heightAsLocaleUnit=o.heightAsLocaleUnit+t)}),_()()()}if(r&2){let i=d();l(2),G("disabled",i.someAnnotsLocked()||!i.isAlignable()||i.isSelectedNothing),l(2),p("width",100)("suffix",i.convertedUnit)("formControl",i.annotPositionXFormControl)("ariaLabel",A(5,26,"X_AXIS")),l(3),G("disabled",i.someAnnotsLocked()||!i.isAlignable()||i.isSelectedNothing),l(2),p("width",100)("suffix",i.convertedUnit)("formControl",i.annotPositionYFormControl)("ariaLabel",A(10,28,"Y_AXIS")),l(3),G("disabled",i.someAnnotsLocked()||!i.isAdjustable()||i.isSelectedNothing),l(),L(A(14,30,"WIDTH")),l(2),p("width",100)("suffix",i.convertedUnit)("formControl",i.annotWidthFormControl)("ariaLabel",A(16,32,"WIDTH")),l(3),G("disabled",i.someAnnotsLocked()||!i.isAdjustable()||i.isSelectedNothing),l(),L(A(20,34,"HEIGHT")),l(2),p("width",100)("suffix",i.convertedUnit)("formControl",i.annotHeightFormControl)("ariaLabel",A(22,36,"HEIGHT"))}}function tl(r,n){r&1&&(h(0,"section",19)(1,"span"),P(2),T(3,"translate"),_()()),r&2&&(l(2),L(A(3,1,"PLEASE_SELECT_ANNOTATION")))}function il(r,n){if(r&1){let i=M();h(0,"div",25),I("click",function(){let t=f(i).$implicit,o=d(2);return g(o.activatedTabKey=t)}),h(1,"div",26),P(2),_(),x(3,"div",27)(4,"div",28),_()}if(r&2){let i=n.$implicit,e=d(2);G("active",e.activatedTabKey===i),l(2),L(e.tabLabels[i]),l(2),p("ngClass",e.setClassOfMiddleBorder)}}function nl(r,n){if(r&1&&x(0,"div",29),r&2){let i=n.$implicit,e=d(2);Ye("width",e.tabBottomBorderWidth(i)),p("ngClass",i==="GENERAL"?"left":"right")}}function ol(r,n){if(r&1&&(h(0,"nav",20)(1,"nav",21),y(2,il,5,4,"div",22),_(),h(3,"div",23),y(4,nl,1,3,"div",24),_()()),r&2){let i=d();l(2),p("ngForOf",i.tabKeys),l(2),p("ngForOf",i.tabKeys)}}function rl(r,n){if(r&1&&(h(0,"span",37),P(1),T(2,"translate"),_()),r&2){let i=d(2);G("disabled",i.someAnnotsLocked()),l(),L(A(2,3,i.isFormField()?"NAME":"AUTHOR"))}}function sl(r,n){if(r&1){let i=M();h(0,"pu-input",38),T(1,"translate"),T(2,"translate"),I("blur",function(){f(i);let t=d(2);return g(t.updateAnnotTitle())})("keydown.enter",function(){f(i);let t=d(2);return g(t.updateAnnotTitle())}),_()}if(r&2){let i=d(2);p("size",i.isSmallWidthScreen?"small":"tiny")("formControl",i.annotTitleFormControl)("placeholder",A(1,4,"ENTER_THE_AUTHOR_NAME"))("ariaLabel",A(2,6,"ENTER_THE_AUTHOR_NAME"))}}function al(r,n){if(r&1){let i=M();h(0,"pu-checkbox",39),T(1,"translate"),ce("ngModelChange",function(t){f(i);let o=d(2);return se(o.readOnly,t)||(o.readOnly=t),g(t)}),_()}if(r&2){let i=d(2);p("disableFocus",!0)("disabled",i.someAnnotsLocked())("label",A(1,4,"READONLY")),ae("ngModel",i.readOnly)}}function cl(r,n){if(r&1){let i=M();h(0,"pu-checkbox",39),T(1,"translate"),ce("ngModelChange",function(t){f(i);let o=d(2);return se(o.required,t)||(o.required=t),g(t)}),_()}if(r&2){let i=d(2);p("disableFocus",!0)("disabled",i.someAnnotsLocked())("label",A(1,4,"REQUIRED")),ae("ngModel",i.required)}}function ll(r,n){if(r&1){let i=M();h(0,"pu-checkbox",40),T(1,"translate"),ce("ngModelChange",function(t){f(i);let o=d(2);return se(o.lock,t)||(o.lock=t),g(t)}),_()}if(r&2){let i=d(2);p("disableFocus",!0)("label",A(1,3,"LOCK")),ae("ngModel",i.lock)}}function pl(r,n){if(r&1){let i=M();ue(0),h(1,"div",46)(2,"span",47),P(3),T(4,"translate"),_(),h(5,"span",48),P(6),_()(),h(7,"form",49),I("ngSubmit",function(){f(i);let t=d(4);return g(t.opacityAsPercentage=t.opacityAsPercentageFormControl.value)}),h(8,"pu-slider",50),T(9,"translate"),ce("ngModelChange",function(t){f(i);let o=d(4);return se(o.opacity,t)||(o.opacity=t),g(t)}),I("puStepApply",function(t){f(i);let o=d(4);return g(o.opacityAsPercentage=((o.opacity+t)*100).toFixed(0))}),_(),h(10,"pu-input",51),T(11,"translate"),I("blur",function(){f(i);let t=d(4);return g(t.opacityAsPercentage=t.opacityAsPercentageFormControl.value)}),_()(),he()}if(r&2){let i=d(4);l(2),G("disabled",i.someAnnotsLocked()),l(),L(A(4,15,"OPACITY")),l(3),Re("",i.opacityAsPercentage," %"),l(2),p("min",0)("max",1)("step",.01)("puInputStep","all")("disabled",i.someAnnotsLocked())("puStep",.01)("puAlterStep",.1),ae("ngModel",i.opacity),B("aria-label",A(9,17,"OPACITY")),l(2),p("formControl",i.opacityAsPercentageFormControl)("ariaLabel",A(11,19,"OPACITY"))}}function dl(r,n){if(r&1){let i=M();h(0,"div",52)(1,"span",47),P(2),T(3,"translate"),_(),h(4,"div",53)(5,"div",54),T(6,"translate"),I("click",function(){f(i);let t=d(4);return g(t.onColorTabColorClick(t.ColorTabColor.FILL_COLOR))}),_()()()}if(r&2){let i=d(4);l(),G("disabled",i.someAnnotsLocked()),l(),L(A(3,10,i.fillColorTitle)),l(2),G("disabled",i.someAnnotsLocked())("selected",i.selectedColorTabColor===i.ColorTabColor.FILL_COLOR),l(),Ye("background",i.fillColor===null?i.transparentBackground:i.fillColor),B("aria-label",A(6,12,i.fillColorTitle))}}function ul(r,n){if(r&1){let i=M();h(0,"div",52)(1,"span",47),P(2),T(3,"translate"),_(),h(4,"div",53)(5,"div",54),T(6,"translate"),I("click",function(){f(i);let t=d(4);return g(t.onColorTabColorClick(t.ColorTabColor.STROKE_COLOR))}),_()()()}if(r&2){let i=d(4);l(),G("disabled",i.someAnnotsLocked()),l(),L(A(3,10,i.strokeColorTitle)),l(2),G("disabled",i.someAnnotsLocked())("selected",i.selectedColorTabColor===i.ColorTabColor.STROKE_COLOR),l(),Ye("background",i.strokeColor===null?i.transparentBackground:i.strokeColor),B("aria-label",A(6,12,i.strokeColorTitle))}}function hl(r,n){if(r&1){let i=M();h(0,"pu-color-palette",55),T(1,"translate"),T(2,"translate"),ce("ngModelChange",function(t){f(i);let o=d(4);return se(o.activatedColorTabColor,t)||(o.activatedColorTabColor=t),g(t)}),_()}if(r&2){let i=d(4);p("nullable",i.selectedColorTabColor===i.ColorTabColor.STROKE_COLOR?i.isCommonFieldAttribute(oe(9,Qc)):i.isCommonAnnotAttribute(oe(10,yr)))("customColorLabel",A(1,5,"CUSTOM_COLOR"))("defaultColorLabel",A(2,7,"DEFAULT_COLOR"))("defaultColorPanelExpandedd",!0),ae("ngModel",i.activatedColorTabColor)}}function ml(r,n){if(r&1&&(h(0,"section",42),y(1,pl,12,21,"ng-container",15),h(2,"div",43),y(3,dl,7,14,"div",44)(4,ul,7,14,"div",44),_(),y(5,hl,3,11,"pu-color-palette",45),_()),r&2){let i=d(3);l(),p("ngIf",i.isCommonAnnotAttribute(oe(4,ba))),l(2),p("ngIf",i.isCommonAnnotAttribute(oe(5,ya))&&!i.includeRedaction()),l(),p("ngIf",i.isCommonAnnotAttribute(oe(6,yr))&&!i.includeRedaction()),l(),p("ngIf",i.selectedColorTabColor!==null)}}function _l(r,n){if(r&1&&(h(0,"pu-accordion-tab",41),T(1,"translate"),y(2,ml,6,7,"ng-template",null,0,ke),_()),r&2){let i=Oe(3);p("contentTemplate",i)("selected",!0)("header",A(1,4,"COLOR"))("borderHidden",!0)}}function fl(r,n){if(r&1){let i=M();ue(0),h(1,"div",46)(2,"span",47),P(3),T(4,"translate"),_(),h(5,"span",48),P(6),_()(),h(7,"form",49),I("ngSubmit",function(){f(i);let t=d(4);return g(t.stringStrokeWidth=t.stringStrokeWidthFormControl.value+"")}),h(8,"pu-slider",56),T(9,"translate"),ce("ngModelChange",function(t){f(i);let o=d(4);return se(o.strokeWidth,t)||(o.strokeWidth=t),g(t)}),I("puStepApply",function(t){f(i);let o=d(4);return g(o.stringStrokeWidth=o.strokeWidth+(t>0?1:-1)+"")}),_(),h(10,"pu-input",51),T(11,"translate"),I("blur",function(){f(i);let t=d(4);return g(t.stringStrokeWidth=t.stringStrokeWidthFormControl.value+"")}),_()(),he()}if(r&2){let i=d(4);l(2),G("disabled",i.someAnnotsLocked()),l(),L(A(4,12,"THICKNESS")),l(3),Re("",i.stringStrokeWidth," pt"),l(2),p("puInputStep","all")("disabled",i.someAnnotsLocked())("max",i.maximumStrokeWidth)("min",i.MinimumStrokeWidth),ae("ngModel",i.strokeWidth),B("aria-label",A(9,14,"THICKNESS")),l(2),p("formControl",i.stringStrokeWidthFormControl)("ariaLabel",A(11,16,"THICKNESS"))}}function gl(r,n){if(r&1){let i=M();ue(0),h(1,"span",37),P(2),T(3,"translate"),_(),h(4,"pu-dropdown",57),T(5,"translate"),ce("ngModelChange",function(t){f(i);let o=d(4);return se(o.selectedBorderStyle,t)||(o.selectedBorderStyle=t),g(t)}),I("mousedown",function(t){f(i);let o=d(4);return g(o.preventDragging(t))}),_(),he()}if(r&2){let i=d(4);l(),G("disabled",i.someAnnotsLocked()),l(),L(A(3,9,"STYLE")),l(2),p("disabled",i.someAnnotsLocked())("isImageLabel",!0)("options",i.borderStyleOptions)("expandAriaLabel",A(5,11,"EXPAND"))("size",i.isSmallWidthScreen?"small":"tiny"),ae("ngModel",i.selectedBorderStyle)}}function Cl(r,n){if(r&1){let i=M();ue(0),h(1,"span",37),P(2),T(3,"translate"),_(),h(4,"pu-dropdown",58),ce("ngModelChange",function(t){f(i);let o=d(5);return se(o.selectedEndLinecap,t)||(o.selectedEndLinecap=t),g(t)}),I("mousedown",function(t){f(i);let o=d(5);return g(o.preventDragging(t))}),_(),he()}if(r&2){let i=d(5);l(),G("disabled",i.someAnnotsLocked()),l(),L(A(3,8,"END")),l(2),p("disabled",i.someAnnotsLocked())("isImageLabel",!0)("options",i.endLinecapOptions)("size",i.isSmallWidthScreen?"small":"tiny"),ae("ngModel",i.selectedEndLinecap)}}function Tl(r,n){if(r&1){let i=M();ue(0),h(1,"span",37),P(2),T(3,"translate"),_(),h(4,"pu-dropdown",58),ce("ngModelChange",function(t){f(i);let o=d(4);return se(o.selectedStartLinecap,t)||(o.selectedStartLinecap=t),g(t)}),I("mousedown",function(t){f(i);let o=d(4);return g(o.preventDragging(t))}),_(),y(5,Cl,5,10,"ng-container",15),he()}if(r&2){let i=d(4);l(),G("disabled",i.someAnnotsLocked()),l(),L(A(3,9,"START")),l(2),p("disabled",i.someAnnotsLocked())("isImageLabel",!0)("options",i.startLinecapOptions)("size",i.isSmallWidthScreen?"small":"tiny"),ae("ngModel",i.selectedStartLinecap),l(),p("ngIf",!i.includeFreeTextCallout())}}function Al(r,n){if(r&1&&(h(0,"section",42),y(1,fl,12,18,"ng-container",15)(2,gl,6,13,"ng-container",15)(3,Tl,6,11,"ng-container",15),_()),r&2){let i=d(3);l(),p("ngIf",!i.isCommonAnnotAttribute(oe(3,Pa))),l(),p("ngIf",i.isCommonAnnotAttribute(oe(4,Zc))&&!i.includePolygonCloud()&&!i.includeInk()),l(),p("ngIf",i.isCommonAnnotAttribute(oe(5,qc)))}}function El(r,n){if(r&1&&(h(0,"pu-accordion-tab",41),T(1,"translate"),y(2,Al,4,6,"ng-template",null,1,ke),_()),r&2){let i=Oe(3);p("contentTemplate",i)("selected",!0)("header",A(1,4,"LINE"))("borderHidden",!0)}}function Sl(r,n){if(r&1){let i=M();h(0,"div",43)(1,"div",60)(2,"span",37),P(3),T(4,"translate"),_(),h(5,"pu-dropdown",61),T(6,"translate"),ce("ngModelChange",function(t){f(i);let o=d(4);return se(o.selectedFont,t)||(o.selectedFont=t),g(t)}),_()(),h(7,"div",60)(8,"span",37),P(9),T(10,"translate"),_(),h(11,"pu-dropdown",62),T(12,"translate"),ce("ngModelChange",function(t){f(i);let o=d(4);return se(o.selectedFontSize,t)||(o.selectedFontSize=t),g(t)}),_()()()}if(r&2){let i=d(4);l(2),G("disabled",i.someAnnotsLocked()),l(),L(A(4,18,"STYLE")),l(2),p("disabled",i.someAnnotsLocked())("size",i.isSmallWidthScreen?"small":"tiny")("options",i.fontOptions)("expandAriaLabel",A(6,20,"EXPAND"))("boxWidth",186),ae("ngModel",i.selectedFont),l(3),G("disabled",i.someAnnotsLocked()),l(),L(A(10,22,"SIZE")),l(2),p("disabled",i.someAnnotsLocked())("editable",!0)("expandAriaLabel",A(12,24,"EXPAND"))("size",i.isSmallWidthScreen?"small":"tiny")("options",i.fontsizeOptions),ae("ngModel",i.selectedFontSize)}}function Il(r,n){if(r&1){let i=M();h(0,"pu-color-palette",64),T(1,"translate"),T(2,"translate"),ce("ngModelChange",function(t){f(i);let o=d(5);return se(o.activatedFontTabColor,t)||(o.activatedFontTabColor=t),g(t)}),_()}if(r&2){let i=d(5);p("customColorLabel",A(1,4,"CUSTOM_COLOR"))("defaultColorLabel",A(2,6,"DEFAULT_COLOR"))("defaultColorPanelExpandedd",!0),ae("ngModel",i.activatedFontTabColor)}}function xl(r,n){if(r&1){let i=M();ue(0),h(1,"span",47),P(2),T(3,"translate"),_(),h(4,"div",53)(5,"div",54),T(6,"translate"),I("click",function(){f(i);let t=d(4);return g(t.onFontTabColorClick(t.FontTabColor.FONT_COLOR))}),_()(),y(7,Il,3,8,"pu-color-palette",63),he()}if(r&2){let i=d(4);l(),G("disabled",i.someAnnotsLocked()),l(),L(A(3,11,"COLOR")),l(2),G("disabled",i.someAnnotsLocked())("selected",i.selectedFontTabColor===i.FontTabColor.FONT_COLOR),l(),Ye("background",i.fontColor===null?i.transparentBackground:i.fontColor),B("aria-label",A(6,13,"COLOR")),l(2),p("ngIf",i.selectedFontTabColor!==null)}}function vl(r,n){if(r&1){let i=M();ue(0),h(1,"span",37),P(2),T(3,"translate"),_(),h(4,"div",65)(5,"button",66),T(6,"translate"),I("click",function(){f(i);let t=d(4);return g(t.textAlign="left")}),x(7,"i",67),_(),h(8,"button",66),T(9,"translate"),I("click",function(){f(i);let t=d(4);return g(t.textAlign="center")}),x(10,"i",68),_(),h(11,"button",66),T(12,"translate"),I("click",function(){f(i);let t=d(4);return g(t.textAlign="right")}),x(13,"i",69),_()(),he()}if(r&2){let i=d(4);l(),G("disabled",i.someAnnotsLocked()),l(),L(A(3,24,"TEXT_ALIGN")),l(3),G("dark",i.isDarkMode)("active",i.textAlign==="left"),p("disabled",i.someAnnotsLocked()),B("aria-label",A(6,26,"LEFT_ALIGN"))("color",i.getTextAlignButtonColor("left")),l(3),G("dark",i.isDarkMode)("active",i.textAlign==="center"),p("disabled",i.someAnnotsLocked()),B("aria-label",A(9,28,"CENTER_ALIGN"))("color",i.getTextAlignButtonColor("center")),l(3),G("dark",i.isDarkMode)("active",i.textAlign==="right"),p("disabled",i.someAnnotsLocked()),B("aria-label",A(12,30,"RIGHT_ALIGN"))("color",i.getTextAlignButtonColor("right"))}}function Ol(r,n){if(r&1&&(h(0,"section",42),y(1,Sl,13,26,"div",59)(2,xl,8,15,"ng-container",15)(3,vl,14,32,"ng-container",15),_()),r&2){let i=d(3);l(),p("ngIf",i.isCommonAnnotAttribute(oe(3,Ra))),l(),p("ngIf",i.isCommonAnnotAttribute(oe(4,Na))),l(),p("ngIf",i.isTextField())}}function bl(r,n){if(r&1&&(h(0,"pu-accordion-tab",41),T(1,"translate"),y(2,Ol,4,5,"ng-template",null,2,ke),_()),r&2){let i=Oe(3);p("contentTemplate",i)("selected",!0)("header",A(1,4,"TEXT_PROP"))("borderHidden",!0)}}function yl(r,n){if(r&1){let i=M();h(0,"div",75)(1,"pu-input-value",76),T(2,"translate"),I("puStepApply",function(t){f(i);let o=d(5);return g(o.measureLength=o.fixRange(o.measureLength+t,0))})("mousedown",function(t){f(i);let o=d(5);return g(o.preventDragging(t))}),_(),h(3,"span",77),P(4),T(5,"translate"),_()()}if(r&2){let i=d(5);l(),p("width",70)("formControl",i.measureLengthFormControl)("puStepDisabled",i.isNaN(i.measureLength))("height",i.isSmallWidthScreen?40:30)("min",void 0)("ariaLabel",A(2,9,"LENGTH")),l(2),G("disabled",i.someAnnotsLocked()),l(),L(A(5,11,"LENGTH"))}}function Rl(r,n){if(r&1){let i=M();h(0,"div",75)(1,"pu-input-value",78),T(2,"translate"),I("puStepApply",function(t){f(i);let o=d(5);return g(o.measureExtend=o.fixRange(o.measureExtend+t,0))})("mousedown",function(t){f(i);let o=d(5);return g(o.preventDragging(t))}),_(),h(3,"span",77),P(4),T(5,"translate"),_()()}if(r&2){let i=d(5);l(),p("width",70)("formControl",i.measureExtendFormControl)("puStepDisabled",i.isNaN(i.measureExtend))("height",i.isSmallWidthScreen?40:30)("ariaLabel",A(2,8,"EXTENSION")),l(2),G("disabled",i.someAnnotsLocked()),l(),L(A(5,10,"EXTENSION"))}}function Nl(r,n){if(r&1&&(ue(0),h(1,"span",47),P(2),T(3,"translate"),_(),h(4,"div",43),y(5,yl,6,13,"div",74)(6,Rl,6,12,"div",74),_(),he()),r&2){let i=d(4);l(),G("disabled",i.someAnnotsLocked()),l(),L(A(3,5,"LEADER_LINE")),l(3),p("ngIf",i.isCommonAnnotAttribute(oe(7,Ma))),l(),p("ngIf",i.isCommonAnnotAttribute(oe(8,Da)))}}function Pl(r,n){if(r&1){let i=M();h(0,"section",42),y(1,Nl,7,9,"ng-container",15),h(2,"span",47),P(3),T(4,"translate"),_(),h(5,"div",70)(6,"pu-input",71),T(7,"translate"),ce("ngModelChange",function(t){f(i);let o=d(3);return se(o.measureInputRatio,t)||(o.measureInputRatio=t),g(t)}),I("ngModelChange",function(){f(i);let t=d(3);return g(t.onChangeMeasure())}),_(),h(8,"pu-dropdown",72),ce("ngModelChange",function(t){f(i);let o=d(3);return se(o.selectedMeasureInputUnit,t)||(o.selectedMeasureInputUnit=t),g(t)}),I("ngModelChange",function(){f(i);let t=d(3);return g(t.onChangeMeasure())}),_(),x(9,"div",73),h(10,"pu-input",71),T(11,"translate"),ce("ngModelChange",function(t){f(i);let o=d(3);return se(o.measureOutputRatio,t)||(o.measureOutputRatio=t),g(t)}),I("ngModelChange",function(){f(i);let t=d(3);return g(t.onChangeMeasure())}),_(),h(12,"pu-dropdown",72),ce("ngModelChange",function(t){f(i);let o=d(3);return se(o.selectedMeasureOutputUnit,t)||(o.selectedMeasureOutputUnit=t),g(t)}),I("ngModelChange",function(){f(i);let t=d(3);return g(t.onChangeMeasure())}),_()()()}if(r&2){let i=d(3);l(),p("ngIf",i.isCommonAnnotAttribute(oe(28,Ma))||i.isCommonAnnotAttribute(oe(29,Da))),l(),G("disabled",i.someAnnotsLocked()),l(),L(A(4,22,"RATIO")),l(3),p("autoResize",!0)("disabled",i.someAnnotsLocked())("size",i.isSmallWidthScreen?"small":"tiny")("ariaLabel",A(7,24,"RATIO")),ae("ngModel",i.measureInputRatio),l(2),p("disabled",i.someAnnotsLocked())("options",i.measureInputUnitOpts)("size",i.isSmallWidthScreen?"small":"tiny"),ae("ngModel",i.selectedMeasureInputUnit),l(2),p("autoResize",!0)("disabled",i.someAnnotsLocked())("size",i.isSmallWidthScreen?"small":"tiny")("ariaLabel",A(11,26,"RATIO")),ae("ngModel",i.measureOutputRatio),l(2),p("disabled",i.someAnnotsLocked())("options",i.measureOutputUnitOpts)("size",i.isSmallWidthScreen?"small":"tiny"),ae("ngModel",i.selectedMeasureOutputUnit)}}function Ml(r,n){if(r&1&&(h(0,"pu-accordion-tab",41),T(1,"translate"),y(2,Pl,13,30,"ng-template",null,3,ke),_()),r&2){let i=Oe(3);p("contentTemplate",i)("selected",!0)("header",A(1,4,"MEASURE"))("borderHidden",!0)}}function Dl(r,n){if(r&1&&(ue(0),h(1,"section",30),y(2,rl,3,5,"span",31)(3,sl,3,8,"pu-input",32),h(4,"div",33),y(5,al,2,6,"pu-checkbox",34)(6,cl,2,6,"pu-checkbox",34)(7,ll,2,5,"pu-checkbox",35),_()(),h(8,"pu-accordion"),y(9,_l,4,6,"pu-accordion-tab",36)(10,El,4,6,"pu-accordion-tab",36)(11,bl,4,6,"pu-accordion-tab",36)(12,Ml,4,6,"pu-accordion-tab",36),_(),he()),r&2){let i=d();l(2),p("ngIf",!i.isDefaultProperty),l(),p("ngIf",!i.isDefaultProperty),l(2),p("ngIf",i.isFormField()),l(),p("ngIf",i.isFormField()),l(),p("ngIf",i.isCommonAnnotAttribute(oe(11,Xc))),l(),G("show-border",!i.isDefaultProperty||i.isFormField()),l(),p("ngIf",i.isCommonAnnotAttribute(oe(12,ba))||i.isCommonAnnotAttribute(oe(13,ya))||i.isCommonAnnotAttribute(oe(14,yr))),l(),p("ngIf",i.isCommonAnnotAttribute(oe(15,Kc))&&i.strokeWidth>0&&!i.includeRedaction()),l(),p("ngIf",(i.isCommonAnnotAttribute(oe(16,Ra))||i.isCommonAnnotAttribute(oe(17,Na)))&&!i.isCheckable()&&!i.includeSignature()||i.isTextField()),l(),p("ngIf",i.isCommonAnnotAttribute(oe(18,Pa)))}}function wl(r,n){if(r&1){let i=M();ue(0),h(1,"div",81),x(2,"div",82),_(),h(3,"span",47),P(4),T(5,"translate"),_(),h(6,"pu-dropdown",83),ce("ngModelChange",function(t){f(i);let o=d(4);return se(o.selectedCheckableOption,t)||(o.selectedCheckableOption=t),g(t)}),_(),he()}if(r&2){let i=d(4);l(2),p("ngStyle",i.checkablePreviewStyle()),l(2),L(A(5,5,"BOX_STYLE")),l(2),p("disabled",i.someAnnotsLocked())("options",i.checkableOptions),ae("ngModel",i.selectedCheckableOption)}}function Ll(r,n){if(r&1){let i=M();ue(0),h(1,"span",47),P(2),T(3,"translate"),_(),h(4,"pu-input",84),T(5,"translate"),ce("ngModelChange",function(t){f(i);let o=d(4);return se(o.caption,t)||(o.caption=t),g(t)}),_(),he()}if(r&2){let i=d(4);l(),G("disabled",i.someAnnotsLocked()),l(),L(A(3,5,"LABEL")),l(2),p("ariaLabel",A(5,7,"LABEL")),ae("ngModel",i.caption)}}function Fl(r,n){if(r&1){let i=M();ue(0),h(1,"pu-checkbox",85),T(2,"translate"),ce("ngModelChange",function(t){f(i);let o=d(4);return se(o.multiline,t)||(o.multiline=t),g(t)}),_(),he()}if(r&2){let i=d(4);l(),p("disabled",i.someAnnotsLocked())("disableFocus",!0)("label",A(2,4,"MULTILINE")),ae("ngModel",i.multiline)}}function kl(r,n){if(r&1){let i=M();ue(0),h(1,"span",47),P(2),T(3,"translate"),_(),h(4,"pu-input",86),T(5,"translate"),ce("ngModelChange",function(t){f(i);let o=d(4);return se(o.AP_N_exportValue,t)||(o.AP_N_exportValue=t),g(t)}),_(),he()}if(r&2){let i=d(4);l(),G("disabled",i.someAnnotsLocked()),l(),L(A(3,7,i.isRadioButton()?"RADIO_BUTTON_CHOICE":"EXPORT_VALUE")),l(2),p("disabled",i.someAnnotsLocked())("size",i.isSmallWidthScreen?"small":"tiny")("ariaLabel",A(5,9,"RADIO_BUTTON_CHOICE")),ae("ngModel",i.AP_N_exportValue)}}function Vl(r,n){if(r&1){let i=M();ue(0),h(1,"sd-annot-property-option",87),I("selectedIndexChange",function(t){f(i);let o=d(4);return g(o.setSelection(t))}),_(),he()}if(r&2){let i=d(4);l(),p("formControl",i.annotPropertyOptionFormControl)}}function Ul(r,n){if(r&1&&(h(0,"section",42),y(1,wl,7,7,"ng-container",15)(2,Ll,6,9,"ng-container",15)(3,Fl,3,6,"ng-container",15)(4,kl,6,11,"ng-container",15)(5,Vl,2,1,"ng-container",15),_()),r&2){let i=d(3);l(),p("ngIf",i.isCheckable()),l(),p("ngIf",i.isPushButton()),l(),p("ngIf",i.isTextField()),l(),p("ngIf",i.isCommonAnnotAttribute(oe(5,wa))),l(),p("ngIf",i.isCommonFieldAttribute(oe(6,La)))}}function Bl(r,n){if(r&1&&(h(0,"pu-accordion-tab",41),T(1,"translate"),y(2,Ul,6,7,"ng-template",null,4,ke),_()),r&2){let i=Oe(3);p("contentTemplate",i)("selected",!0)("header",A(1,4,"OPTION"))("borderHidden",!0)}}function Gl(r,n){if(r&1){let i=M();h(0,"div",108)(1,"pu-checkbox",109),ce("ngModelChange",function(t){let o=f(i).$implicit;return se(o.checked,t)||(o.checked=t),g(t)}),_()()}if(r&2){let i=n.$implicit,e=d(4);l(),p("disabled",e.calculationCategory!=="predefined"||e.someAnnotsLocked())("label",i.T)("disableFocus",!0),ae("ngModel",i.checked)}}function Wl(r,n){if(r&1){let i=M();h(0,"section",89)(1,"pu-radio-button",90),T(2,"translate"),ce("ngModelChange",function(t){f(i);let o=d(3);return se(o.calculationCategory,t)||(o.calculationCategory=t),g(t)}),_(),h(3,"div",91)(4,"pu-radio-button",92),T(5,"translate"),ce("ngModelChange",function(t){f(i);let o=d(3);return se(o.calculationCategory,t)||(o.calculationCategory=t),g(t)}),_(),h(6,"pu-dropdown",93),T(7,"translate"),ce("ngModelChange",function(t){f(i);let o=d(3);return se(o.selectedPredefinedCalculation,t)||(o.selectedPredefinedCalculation=t),g(t)}),I("ngModelChange",function(){f(i);let t=d(3);return g(t.updatePredefinedCalculation())}),_(),h(8,"span",94),P(9),T(10,"translate"),_()(),h(11,"article",95)(12,"pu-input",96),T(13,"translate"),T(14,"translate"),ce("ngModelChange",function(t){f(i);let o=d(3);return se(o.tempAcroFieldListFilter,t)||(o.tempAcroFieldListFilter=t),g(t)}),_(),h(15,"nav",97)(16,"pu-checkbox",98),T(17,"translate"),I("ngModelChange",function(t){f(i);let o=d(3);return g(t?o.selectAllField():o.deselectAllField())}),_()(),h(18,"div",99),y(19,Gl,2,4,"div",100),_(),h(20,"aside",101),I("click",function(){f(i);let t=d(3);return g(t.toggleFieldSelectListExpend())}),x(21,"i",102),_()(),h(22,"div",103)(23,"button",104),T(24,"translate"),I("click",function(){f(i);let t=d(3);return g(t.confirmFieldSelectChange())}),P(25),T(26,"translate"),_()(),h(27,"pu-radio-button",105),T(28,"translate"),ce("ngModelChange",function(t){f(i);let o=d(3);return se(o.calculationCategory,t)||(o.calculationCategory=t),g(t)}),_(),h(29,"div",106),P(30),_(),h(31,"div",107)(32,"button",104),T(33,"translate"),I("click",function(){f(i);let t=d(3);return g(t.openCustomScriptDialog())}),P(34),T(35,"translate"),_()()()}if(r&2){let i=d(3);l(),p("disabled",i.someAnnotsLocked())("label",A(2,42,"VALUE_IS_NOT_CALCULATED")),ae("ngModel",i.calculationCategory),l(3),p("disabled",i.someAnnotsLocked())("label",A(5,44,"VALUE_IS_PREDEFINED_CALCULATION_PREFIX")),ae("ngModel",i.calculationCategory),l(2),p("disabled",i.calculationCategory!=="predefined"||i.someAnnotsLocked())("options",i.predefinedCalculationOptions)("size",i.isSmallWidthScreen?"small":"tiny")("expandAriaLabel",A(7,46,"EXPAND")),ae("ngModel",i.selectedPredefinedCalculation),l(2),G("disabled",i.someAnnotsLocked()),l(),L(A(10,48,"VALUE_IS_PREDEFINED_CALCULATION_SUFFIX")),l(3),p("placeholder",A(13,50,"ENTER_HERE"))("useClearButton",!0)("disabled",i.calculationCategory!=="predefined"||i.someAnnotsLocked())("ariaLabel",A(14,52,"ENTER_HERE")),ae("ngModel",i.tempAcroFieldListFilter),l(4),p("label",A(17,54,"SELECT_ALL"))("disableFocus",!0)("disabled",i.calculationCategory!=="predefined"||i.someAnnotsLocked())("ngModel",i.isAllFieldSelected()),l(2),p("@selectFileList",i.fieldSelectStatus),l(),p("ngForOf",i.filteredTempAcroFieldList),l(2),p("ngClass",i.getSelectCalFieldListClass()),l(2),G("dark",i.isDarkMode),p("disabled",i.calculationCategory!=="predefined"||i.someAnnotsLocked()||!i.isSelectedCalFields()),B("size",i.isSmallWidthScreen?"small":"tiny")("aria-label",A(24,56,"SELECT")),l(2),L(A(26,58,"SELECT")),l(2),p("disabled",i.someAnnotsLocked())("label",A(28,60,"CUSTOM_CALCULATION_SCRIPT")),ae("ngModel",i.calculationCategory),l(3),L(i.customScript),l(2),G("dark",i.isDarkMode),p("disabled",i.calculationCategory!=="custom"||i.someAnnotsLocked()),B("size",i.isSmallWidthScreen?"small":"tiny")("aria-label",A(33,62,"EDIT")),l(2),L(A(35,64,"EDIT"))}}function Hl(r,n){if(r&1&&(h(0,"pu-accordion-tab",88),T(1,"translate"),y(2,Wl,36,66,"ng-template",null,5,ke),_()),r&2){let i=Oe(3);p("borderHidden",!0)("contentTemplate",i)("header",A(1,4,"FIELD_PROPERTY_CALCULATE"))("selected",!0)}}function zl(r,n){if(r&1){let i=M();h(0,"section",110)(1,"div",42)(2,"span",37),P(3),T(4,"translate"),_(),h(5,"sd-widget-action-list",111),ce("actionTriggerChange",function(t){f(i);let o=d(3);return se(o.selectedActionTrigger,t)||(o.selectedActionTrigger=t),g(t)})("actionIndexChange",function(t){f(i);let o=d(3);return se(o.selectedActionIndex,t)||(o.selectedActionIndex=t),g(t)}),_(),h(6,"div",112)(7,"button",113),T(8,"translate"),I("click",function(){f(i);let t=d(3);return g(t.onEditActionClick())}),x(9,"i",114),_(),h(10,"button",113),T(11,"translate"),I("click",function(){f(i);let t=d(3);return g(t.onRemoveActionClick())}),x(12,"i",115),_()()(),h(13,"div",42)(14,"span",37),P(15),T(16,"translate"),_(),x(17,"pu-dropdown",116),T(18,"translate"),_(),h(19,"div",117)(20,"button",118),T(21,"translate"),I("click",function(t){f(i);let o=d(3);return g(o.onAddActionClick(t))}),P(22),T(23,"translate"),_()()()}if(r&2){let i=d(3);l(2),G("disabled",i.someAnnotsLocked()),l(),L(A(4,25,"ACTION_LIST")),l(2),p("actionTriggerMap",i.actionTriggerMap),ae("actionTrigger",i.selectedActionTrigger)("actionIndex",i.selectedActionIndex),l(2),G("dark",i.isDarkMode),p("disabled",i.selectedActionIndex===null),B("aria-label",A(8,27,"EDIT")),l(3),G("dark",i.isDarkMode),p("disabled",i.selectedActionIndex===null),B("aria-label",A(11,29,"REMOVE")),l(4),G("disabled",i.someAnnotsLocked()),l(),L(A(16,31,"EXECUTE")),l(2),p("expandAriaLabel",A(18,33,"EXPAND"))("formControl",i.actionTriggerFormControl)("options",i.actionOptions),l(3),G("dark",i.isDarkMode),B("size",i.isSmallWidthScreen?"small":"tiny")("aria-label",A(21,35,"ADD")),l(2),L(A(23,37,"ADD"))}}function jl(r,n){if(r&1&&(h(0,"pu-accordion-tab",88),T(1,"translate"),y(2,zl,24,39,"ng-template",null,6,ke),_()),r&2){let i=Oe(3);p("borderHidden",!0)("contentTemplate",i)("header",A(1,4,"ACTION"))("selected",!0)}}function $l(r,n){if(r&1&&(ue(0),h(1,"pu-accordion",79),y(2,Bl,4,6,"pu-accordion-tab",36)(3,Hl,4,6,"pu-accordion-tab",80)(4,jl,4,6,"pu-accordion-tab",80),_(),he()),r&2){let i=d();l(2),p("ngIf",i.runtimeEnv.get(i.RuntimeEnvKey.WIDGET_PROPERTY_OPTION)&&!i.isDefaultProperty&&(i.isTextField()||i.isPushButton()||i.isCommonAnnotAttribute(oe(3,wa))||i.isCommonFieldAttribute(oe(4,La)))),l(),p("ngIf",i.runtimeEnv.get(i.RuntimeEnvKey.WIDGET_PROPERTY_CALCULATION)&&i.isTextField()&&i.isCommonAnnotAttribute(oe(5,Jc))),l(),p("ngIf",i.runtimeEnv.get(i.RuntimeEnvKey.WIDGET_PROPERTY_ACTION)&&i.isFormField()&&i.selectedComps.length<2)}}var ki=function(r){return r[r.HORIZONTAL_LEFT=0]="HORIZONTAL_LEFT",r[r.HORIZONTAL_CENTER=1]="HORIZONTAL_CENTER",r[r.HORIZONTAL_RIGHT=2]="HORIZONTAL_RIGHT",r[r.VERTICAL_TOP=3]="VERTICAL_TOP",r[r.VERTICAL_CENTER=4]="VERTICAL_CENTER",r[r.VERTICAL_BOTTOM=5]="VERTICAL_BOTTOM",r}(ki||{}),cn=function(r){return r[r.CALCULATION=0]="CALCULATION",r[r.ACTION=1]="ACTION",r}(cn||{}),ii=function(r){return r.OPEN="open",r.CLOSE="close",r}(ii||{}),vr={[F.INK]:"INK_TOOL",[F.LINE]:"LINE_TOOL",[F.SQUARE]:"SQUARE_TOOL",[F.CIRCLE]:"CIRCLE_TOOL",[F.POLYGON]:"POLYGON_TOOL",[F.POLYLINE]:"POLYLINE_TOOL",[F.CLOUD]:"POLYGON_CLOUD_TOOL",[F.TEXT_FREE]:"FREE_TEXT_TOOL",[F.TEXT_CALLOUT]:"FREE_TEXT_CALLOUT_TOOL",[F.TEXT_POPUP]:"TEXT_TOOL",[F.LINE_DIMENSION]:"DISTANCE_TOOL",[F.POLYLINE_DIMENSION]:"PERIMETER_TOOL",[F.POLYGON_DIMENSION]:"AREA_TOOL",[F.STAMP]:"STAMP_TOOL",[F.HIGHLIGHT]:"HIGHLIGHT",[F.UNDERLINE]:"UNDERLINE",[F.STRIKE]:"STRIKEOUT",[F.LINK]:"CREATE_LINK",[F.ERASER]:"ERASER",[F.SIGNATURE]:"SIGN",[F.TEXT_FIELD]:"TEXT_FIELD",[F.COMBO_BOX]:"COMBO_BOX",[F.LIST_BOX]:"LIST_BOX",[F.CHECK_BUTTON]:"CHECK_BUTTON",[F.RADIO_BUTTON]:"RADIO_BUTTON",[F.BUTTON]:"BUTTON",[F.REDACTION]:"REDACTION"},Dn={Circle:"CIRCLE_TOOL",FreeText:"FREE_TEXT_TOOL",Highlight:"HIGHLIGHT",Ink:"INK_TOOL",Line:"LINE_TOOL",Link:"CREATE_LINK",PolyLine:"POLYLINE_TOOL",Polygon:"POLYGON_TOOL",Square:"SQUARE_TOOL",Stamp:"STAMP_TOOL",StrikeOut:"STRIKEOUT",Text:"TEXT_TOOL",Underline:"UNDERLINE",Redact:"REDACTION",Sig:"SIGN",Tx:"TEXT_FIELD",Cx:"COMBO_BOX",Lx:"LIST_BOX",Cb:"CHECK_BUTTON",Rb:"RADIO_BUTTON",Btn:"BUTTON",FreeTextCallout:"FREE_TEXT_CALLOUT_TOOL",PolygonCloud:"POLYGON_CLOUD_TOOL",LineDimension:"DISTANCE_TOOL",PolyLineDimension:"PERIMETER_TOOL",PolygonDimension:"AREA_TOOL"},ln=class ln{contentService;changeDetectorRef;acroFormService;annotService;annotSelectedService;toastService;pageService;scriptService;subscriptionService;modalService;store$;translatePipe;unitPipe;defaultAnnotService;get RuntimeEnvKey(){return a}get MergedRuntimeEnvKey(){return V}get runtimeEnv(){return Y}get ColorTabColor(){return Ft}get FontTabColor(){return Ci}get fontsizeOptions(){return D.fontsizeOptions}MinimumStrokeWidth=1;maximumStrokeWidth;tabLabels=void 0;get tabKeys(){return Object.keys(this.tabLabels)}borderStyleOptions=[];startLinecapOptions=[];endLinecapOptions=[];measureInputUnitOpts=[];measureOutputUnitOpts=[];fontOptions=[];customFontSizeOption=null;selectionInfo;language="ko";activatedTabKey="GENERAL";selectedColorTabColor=null;selectedFontTabColor=null;get convertedUnit(){return this.unitPipe.transform(K.MILLIMETER)}get selectedMeasureInputUnit(){return this.measureInputUnitOpts.find(n=>n.value===this.measureInputUnitKey)}set selectedMeasureInputUnit(n){this.measureInputUnitKey=n.value}measureInputUnitKey;measureInputRatio=1;get selectedMeasureOutputUnit(){return this.measureOutputUnitOpts.find(n=>n.value===this.measureOutputUnitName)}set selectedMeasureOutputUnit(n){this.measureOutputUnitName=n.value}get selectedCheckableOption(){return this.checkableOptions.find(n=>n.value===this.commonAttributes.MK.CA)}set selectedCheckableOption(n){this.commonAttributes.MK.CA=n.value,this.modifyAttributesChanges(["MK","CA"],n.value)}measureOutputUnitName;measureOutputRatio=1;checkableOptions=[];predefinedCalculationOptions=[];selectedImagePathMap={4:"check",l:"circle",8:"cross",u:"diamond",n:"square",H:"star"};get selectedPredefinedCalculation(){return this.predefinedCalculationOptions.find(n=>n.value===this.currentPredefinedCalculation)}set selectedPredefinedCalculation(n){this.currentPredefinedCalculation=n.value}currentPredefinedCalculation;acroFieldList=[];tempAcroFieldList=[];tempAcroFieldListFilter="";get filteredTempAcroFieldList(){return this.tempAcroFieldList.filter(({T:n})=>n.includes(this.tempAcroFieldListFilter))}fieldSelectStatus=ii.CLOSE;customScript=S.EMPTY_STRING;isSmallWidthScreen=Pe.isSmallWidth();opacityAsPercentageFormControl=new Ze;stringStrokeWidthFormControl=new Ze;annotTitleFormControl=new Ze;annotPropertyOptionFormControl=new Ze;annotPositionXFormControl=new Ze;annotPositionYFormControl=new Ze;annotWidthFormControl=new Ze;annotHeightFormControl=new Ze;measureLengthFormControl=new Ze;measureExtendFormControl=new Ze;unalignableFilters=[b.isTextMarkup];unadjustableFilters=[b.isTextMarkup,b.isLine,b.isPolyLine,b.isPolygon,b.isPolygonCloud,b.isFreeTextCallout,b.isText];optionalAttributeMap={Square:{borderStyle:{style:"solid",dashPattern:void 0},InteriorColor:null},Circle:{borderStyle:{style:"solid",dashPattern:void 0},InteriorColor:null},Line:{borderStyle:{style:"solid",dashPattern:void 0},LE:["None","None"],InteriorColor:null},Polygon:{borderStyle:{style:"solid",dashPattern:void 0},InteriorColor:null},PolyLine:{borderStyle:{style:"solid",dashPattern:void 0},LE:["None","None"],InteriorColor:null},FreeText:{borderStyle:{style:"solid",dashPattern:void 0},color:null},FreeTextCallout:{borderStyle:{style:"solid",dashPattern:void 0},color:null,LE:["None"]},Widget:{MK:{borderColor:null,backgroundColor:null},Parent:{V:"",AA:{C:{S:null}}},width:null}};commonAttributes={};attributeProxyMapper=null;_calculationCategory;actionOptions=[];actionTriggerMap;selectedActionTrigger;selectedActionIndex;actionTriggerFormControl=new Ze;pdfPages;selectedAnnotTool=null;get selectedAnnotToolName(){if(this.selectedComps.length>0){let n=this.selectedComps[this.selectedComps.length-1];if(b.isWidget(n.data)&&n.acroField)return Dn[n.acroField.FT];if(!b.isWidget(n.data))return n.data.IT?Dn[n.data.IT]:Dn[n.data.type]}return this.selectedAnnotTool?vr[this.selectedAnnotTool]:"ANNOTATION_PROPERTIES"}get selectedComps(){return this.selectionInfo?.selectedComps??[]}get annotTitle(){return this.commonAttributes.Parent?.hasOwnProperty("T")?this.commonAttributes.Parent.T:(this.commonAttributes.T===void 0&&(this.commonAttributes.T=""),this.commonAttributes.T)}get selectedStartLinecap(){return this.startLinecapOptions.find(n=>n.value===this.startLinecap)}set selectedStartLinecap(n){this.startLinecap=n.value}get startLinecap(){return this.commonAttributes.LE===void 0&&(this.commonAttributes.LE=[]),this.commonAttributes.LE[0]}set startLinecap(n){this.commonAttributes.LE[0]=n,this.modifyAttributesChanges(["LE"],this.commonAttributes.LE)}get selectedEndLinecap(){return this.endLinecapOptions.find(n=>n.value===this.endLinecap)}set selectedEndLinecap(n){this.endLinecap=n.value}get endLinecap(){return this.commonAttributes.LE===void 0&&(this.commonAttributes.LE=[]),this.commonAttributes.LE[1]}set endLinecap(n){this.commonAttributes.LE[1]=n,this.modifyAttributesChanges(["LE"],this.commonAttributes.LE)}get readOnly(){return this.commonAttributes.Parent.Ff===void 0&&(this.commonAttributes.Parent.Ff=0),qe.get(this.commonAttributes.Parent.Ff,0)}set readOnly(n){this.commonAttributes.Parent.Ff=qe.set(this.commonAttributes.Parent.Ff,0,n),this.commonAttributes.Ff!==void 0&&(this.commonAttributes.Ff=this.commonAttributes.Parent.Ff,this.modifyAttributesChanges(["Ff"],{bitIndex:0,set:n})),this.modifyFieldsChanges(["Ff"],{bitIndex:0,set:n})}get required(){return this.commonAttributes.Parent.Ff===void 0&&(this.commonAttributes.Parent.Ff=0),qe.get(this.commonAttributes.Parent.Ff,1)}set required(n){this.commonAttributes.Parent.Ff=qe.set(this.commonAttributes.Parent.Ff,1,n),this.commonAttributes.Ff!==void 0&&(this.commonAttributes.Ff=this.commonAttributes.Parent.Ff,this.modifyAttributesChanges(["Ff"],{bitIndex:1,set:n})),this.modifyFieldsChanges(["Ff"],{bitIndex:1,set:n})}get multiline(){return this.commonAttributes.Parent.Ff===void 0&&(this.commonAttributes.Parent.Ff=0),qe.get(this.commonAttributes.Parent.Ff,12)}set multiline(n){this.commonAttributes.Parent.Ff=qe.set(this.commonAttributes.Parent.Ff,12,n),this.commonAttributes.Ff!==void 0&&(this.commonAttributes.Ff=this.commonAttributes.Parent.Ff,this.modifyAttributesChanges(["Ff"],{bitIndex:12,set:n})),this.modifyFieldsChanges(["Ff"],{bitIndex:12,set:n})}get lock(){return this.commonAttributes.F===void 0&&(this.commonAttributes.F=0),qe.get(this.commonAttributes.F,7)}set lock(n){this.commonAttributes.F=qe.set(this.commonAttributes.F,7,n),this.modifyAttributesChanges(["F"],{bitIndex:7,set:n})}get activatedColorTabColor(){switch(this.selectedColorTabColor){case Ft.FILL_COLOR:return this.fillColor;case Ft.STROKE_COLOR:return this.strokeColor;default:return null}}set activatedColorTabColor(n){switch(this.selectedColorTabColor){case Ft.FILL_COLOR:this.fillColor=n;break;case Ft.STROKE_COLOR:this.strokeColor=n;break;default:break}}get fillColor(){return this.commonAttributes.FillColor===void 0&&(this.commonAttributes.FillColor="#ffffff"),this.commonAttributes.FillColor}set fillColor(n){this.commonAttributes.FillColor=n,this.modifyAttributesChanges(["FillColor"],this.commonAttributes.FillColor)}get fillColorTitle(){return this.selectedAnnotToolName===vr[F.REDACTION]||this.selectedAnnotToolName===Dn.Redact?"REDACTED_AREA_FILL":"FILL"}get strokeColor(){return this.commonAttributes.StrokeColor===void 0&&(this.commonAttributes.StrokeColor="#ffffff"),this.commonAttributes.StrokeColor}set strokeColor(n){n===null?this.strokeWidth=null:(Number.isNaN(Number(this.strokeWidth))||this.strokeWidth<=0)&&(this.strokeWidth=1),this.commonAttributes.StrokeColor=n,this.modifyAttributesChanges(["StrokeColor"],this.commonAttributes.StrokeColor)}get strokeColorTitle(){return this.selectedAnnotToolName===vr[F.REDACTION]||this.selectedAnnotToolName===Dn.Redact?"REDACTION_OUTLINE":"STROKE"}get opacity(){return this.commonAttributes.opacity}set opacity(n){this.commonAttributes.opacity=n,this.modifyAttributesChanges(["opacity"],this.commonAttributes.opacity),this.opacityAsPercentageFormControl.setValue(this.opacityAsPercentage)}get opacityAsPercentage(){return`${this.opacity&&Math.floor(this.opacity*100)}`}set opacityAsPercentage(n){let i=Number.parseInt(n);if(Number.isNaN(i)){this.opacityAsPercentageFormControl.setValue(this.opacityAsPercentage);return}this.opacity=Math.min(Math.max(i/100,0),1)}get setClassOfMiddleBorder(){return{"left-tab":this.activatedTabKey==="GENERAL","right-tab":this.activatedTabKey==="ATTRIBUTES"}}get selectedBorderStyle(){return this.borderStyleOptions.find(n=>{let i=n.value.style===this.borderStyle.style,e=n.value.dashPattern,t=this.borderStyle.dashPattern;if(i){if(Array.isArray(e)&&Array.isArray(t))return e.every((o,s)=>o===t[s]);if(!Array.isArray(e)&&!Array.isArray(t))return!0}return!1})}set selectedBorderStyle(n){this.borderStyle=n.value}get borderStyle(){return this.commonAttributes.borderStyle===void 0&&(this.commonAttributes.borderStyle={style:"solid",dashPattern:[]}),this.commonAttributes.borderStyle}set borderStyle(n){this.commonAttributes.borderStyle.style=n.style,this.commonAttributes.borderStyle.dashPattern=n.dashPattern,this.modifyAttributesChanges(["borderStyle"],this.commonAttributes.borderStyle)}get strokeWidth(){return this.commonAttributes.width}set strokeWidth(n){this.commonAttributes.width=n,this.modifyAttributesChanges(["width"],this.commonAttributes.width),this.stringStrokeWidthFormControl.setValue(this.commonAttributes.width)}get stringStrokeWidth(){return`${this.commonAttributes.width}`}set stringStrokeWidth(n){let i=Number.parseInt(n);if(Number.isNaN(i)){this.stringStrokeWidthFormControl.setValue(this.strokeWidth);return}this.strokeWidth=Math.min(Math.max(i,this.MinimumStrokeWidth),this.maximumStrokeWidth)}get caption(){return this.commonAttributes.MK===void 0&&(this.commonAttributes.MK={CA:""}),this.commonAttributes.MK.CA===void 0&&(this.commonAttributes.MK.CA=""),this.commonAttributes.MK.CA}set caption(n){this.commonAttributes.MK.CA=n,this.modifyAttributesChanges(["MK","CA"],this.commonAttributes.MK.CA)}get selectedFontSize(){let n=D.fontsizeOptions.find(i=>i.value===this.fontSize);return S.isDefined(n)?n:S.isDefined(this.customFontSizeOption)&&this.customFontSizeOption.value===this.fontSize?this.customFontSizeOption:S.isDefined(this.fontSize)?(this.customFontSizeOption={label:this.fontSize.toString(),value:this.fontSize},this.customFontSizeOption):null}set selectedFontSize(n){let i=Number(n.value);Number.isNaN(i)||(this.fontSize=i)}get fontSize(){return this.commonAttributes.FontSize===void 0&&(this.commonAttributes.FontSize=null),this.commonAttributes.FontSize}set fontSize(n){this.commonAttributes.fontSize=n,this.modifyAttributesChanges(["FontSize"],this.commonAttributes.fontSize)}get selectedFont(){return this.fontOptions.find(n=>n.value===this.fontName)}set selectedFont(n){this.fontName=n.value}get fontName(){return this.commonAttributes.FontName===void 0&&(this.commonAttributes.FontName=null),this.commonAttributes.FontName}set fontName(n){this.commonAttributes.fontName=n,this.modifyAttributesChanges(["FontName"],this.commonAttributes.fontName)}get activatedFontTabColor(){switch(this.selectedFontTabColor){case Ci.FONT_COLOR:return this.fontColor;default:return null}}set activatedFontTabColor(n){switch(this.selectedFontTabColor){case Ci.FONT_COLOR:this.fontColor=n;break;default:break}}get fontColor(){return this.commonAttributes.FontColor===void 0&&(this.commonAttributes.FontColor="#ffffff"),this.commonAttributes.FontColor}set fontColor(n){this.commonAttributes.FontColor=n,this.modifyAttributesChanges(["FontColor"],this.commonAttributes.FontColor)}get measureLength(){return this.commonAttributes.LL===void 0&&(this.commonAttributes.LL=0),this.commonAttributes.LL}set measureLength(n){this.resizeLeaderLine("LL",n)}get measureExtend(){return this.commonAttributes.LLE===void 0&&(this.commonAttributes.LLE=0),this.commonAttributes.LLE}set measureExtend(n){this.resizeLeaderLine("LLE",n)}get widthAsLocaleUnit(){if(!this.commonAttributes.rect)return 0;let n=this.selectedComps[0].data.attributes.rect.right-this.selectedComps[0].data.attributes.rect.left;if(this.isCommonSize(n,void 0))return this.unitPipe.isRegionUS()?this.unitPipe.convertToImperial(K.POINT,n):Ue.convert(K.POINT,K.MILLIMETER,n)}set widthAsLocaleUnit(n){let i;this.unitPipe.isRegionUS()?i=Ue.convert(wi[K.MILLIMETER],K.POINT,n):i=Ue.convert(K.MILLIMETER,K.POINT,n),this.selectedComps.forEach(e=>{this.resizeRect(e.data,i,void 0),this.annotService.dispatchModify(e.data)})}get heightAsLocaleUnit(){if(!this.commonAttributes.rect)return 0;let n=this.selectedComps[0].data.attributes.rect.top-this.selectedComps[0].data.attributes.rect.bottom;if(this.isCommonSize(void 0,n))return this.unitPipe.isRegionUS()?this.unitPipe.convertToImperial(K.POINT,n):Ue.convert(K.POINT,K.MILLIMETER,n)}set heightAsLocaleUnit(n){let i;this.unitPipe.isRegionUS()?i=Ue.convert(wi[K.MILLIMETER],K.POINT,n):i=Ue.convert(K.MILLIMETER,K.POINT,n),this.selectedComps.forEach(e=>{this.resizeRect(e.data,void 0,i),this.annotService.dispatchModify(e.data)})}get xAsLocaleUnit(){return this.commonAttributes.rect?this.unitPipe.isRegionUS()?this.unitPipe.convertToImperial(K.POINT,this.commonAttributes.rect.left):Ue.convert(K.POINT,K.MILLIMETER,this.commonAttributes.rect.left):0}set xAsLocaleUnit(n){let i;this.unitPipe.isRegionUS()?i=Ue.convert(wi[K.MILLIMETER],K.POINT,n):i=Ue.convert(K.MILLIMETER,K.POINT,n),this.selectedComps.forEach(e=>{this.annotService.moveAnnotRectAbsolutely(e,Number(i.toFixed(3)),void 0,void 0,this.commonAttributes),this.changeDetectorRef.detectChanges(),this.annotService.dispatchModify(e.data)})}get yAsLocaleUnit(){return this.commonAttributes.rect?this.unitPipe.isRegionUS()?this.unitPipe.convertToImperial(K.POINT,this.commonAttributes.rect.bottom):Ue.convert(K.POINT,K.MILLIMETER,this.commonAttributes.rect.bottom):0}set yAsLocaleUnit(n){let i;this.unitPipe.isRegionUS()?i=Ue.convert(wi[K.MILLIMETER],K.POINT,n):i=Ue.convert(K.MILLIMETER,K.POINT,n),this.selectedComps.forEach(e=>{this.annotService.moveAnnotRectAbsolutely(e,void 0,Number(i.toFixed(3)),void 0,this.commonAttributes),this.changeDetectorRef.detectChanges(),this.annotService.dispatchModify(e.data)})}get textAlign(){return this.commonAttributes.alignment}set textAlign(n){this.commonAttributes.alignment=n,this.modifyAttributesChanges(["alignment"],this.commonAttributes.alignment)}get AP_N_exportValue(){let n="";return this.commonAttributes.AP_N===void 0||this.commonAttributes.AP_N.forEach(i=>{i.toLowerCase()!=="off"&&(n=i)}),n}set AP_N_exportValue(n){this.commonAttributes.AP_N[this.commonAttributes.AP_N[0].toLowerCase()==="off"?1:0]=n,this.modifyAttributesChanges(["AP_N"],this.commonAttributes.AP_N)}get opt(){return this.commonAttributes.Parent.Opt}set opt(n){this.commonAttributes.Parent.Opt=n,this.modifyFieldsChanges(["Opt"],this.commonAttributes.Parent.Opt)}get additionalActionCalculate(){return this.commonAttributes.Parent.AA.C}set additionalActionCalculate(n){this.commonAttributes.Parent.AA.C=n,this.modifyFieldsChanges(["AA","C"],this.commonAttributes.Parent.AA.C)}get calculationCategory(){return this._calculationCategory}set calculationCategory(n){switch(n){case"none":this.additionalActionCalculate=null;break;case"predefined":let i=this.acroFieldList.filter(e=>e.checked).map(e=>`"${e.T}"`).join(",");this.additionalActionCalculate={S:"JavaScript",JS:`AFSimple_Calculate("${this.currentPredefinedCalculation}", new Array(${i}));`};break;case"custom":this.additionalActionCalculate={S:"JavaScript",JS:this.customScript};break;default:break}this._calculationCategory=n,this._calculationCategory!=="none"&&this.scriptService.executeAll(this.acroFormService.acroFields)}get isSelectedNothing(){return this.annotSelectedService.length===0}commonRectChanges=new it;commonMeasureChanges=new it;screenTheme;get isDarkMode(){return this.screenTheme==="light"?!1:this.screenTheme==="dark"||window.matchMedia("(prefers-color-scheme: dark)")?.matches}get transparentBackground(){return D.getTransparentBackground()}constructor(n,i,e,t,o,s,c,u,C,N,O,U,z,Me){this.contentService=n,this.changeDetectorRef=i,this.acroFormService=e,this.annotService=t,this.annotSelectedService=o,this.toastService=s,this.pageService=c,this.scriptService=u,this.subscriptionService=C,this.modalService=N,this.store$=O,this.translatePipe=U,this.unitPipe=z,this.defaultAnnotService=Me,this.tabLabels=Object.freeze({GENERAL:this.translatePipe.transform("GENERAL"),ATTRIBUTES:this.translatePipe.transform("ATTRIBUTES")}),this.checkableOptions=[{label:this.translatePipe.transform("CHECKABLE_CHECK"),value:"4"},{label:this.translatePipe.transform("CHECKABLE_CIRCLE"),value:"l"},{label:this.translatePipe.transform("CHECKABLE_CROSS"),value:"8"},{label:this.translatePipe.transform("CHECKABLE_DIAMOND"),value:"u"},{label:this.translatePipe.transform("CHECKABLE_SQUARE"),value:"n"},{label:this.translatePipe.transform("CHECKABLE_STAR"),value:"H"}],this.predefinedCalculationOptions=[{label:this.translatePipe.transform("CALCULATION_SUM"),value:"SUM"},{label:this.translatePipe.transform("CALCULATION_PRODUCT"),value:"PRD"},{label:this.translatePipe.transform("CALCULATION_AVERAGE"),value:"AVG"},{label:this.translatePipe.transform("CALCULATION_MINIMUM"),value:"MIN"},{label:this.translatePipe.transform("CALCULATION_MAXIMUM"),value:"MAX"}],this.actionOptions=[{label:this.translatePipe.transform("EXECUTE_JAVASCRIPT"),value:"JavaScript"}],this.currentPredefinedCalculation=this.predefinedCalculationOptions[0].value}ngOnInit(){this.attributeProxyMapper=new No,this.initDropdownOptions(),this.initSubscriptions(),this.initMeasureUnits()}ngOnDestroy(){this.attributeProxyMapper=null}onCloseButtonClick(){this.store$.dispatch(ft.set({key:"rightSideViewVisible",value:!1}))}someAnnotsLocked(){return this.annotSelectedService.selectedComponents.some(n=>qe.get(n.data.attributes.F,7))}onColorTabColorClick(n){this.someAnnotsLocked()||(this.selectedColorTabColor=this.selectedColorTabColor===n?null:n)}onFontTabColorClick(n){this.someAnnotsLocked()||(this.selectedFontTabColor=this.selectedFontTabColor===n?null:n)}isFormField(){return this.commonAttributes.Parent}isTextField(){return this.isFormField()&&this.commonAttributes.Parent.FT==="Tx"}isRadioButton(){return this.isFormField()&&this.commonAttributes.Parent.FT==="Rb"}isComboBox(){return this.isFormField()&&this.commonAttributes.Parent.FT==="Cx"}isPushButton(){return this.isFormField()&&this.commonAttributes.Parent.FT==="Btn"}includeInk(){return this.selectedComps.some(n=>b.isInk(n.data))}includeRedaction(){return this.selectedComps.some(n=>b.isRedact(n.data))}includeFreeTextCallout(){return this.annotSelectedService.selectedComponents.some(n=>b.isFreeTextCallout(n.data))}includeSignature(){return this.annotSelectedService.selectedComponents.some(n=>b.isSignatureWidget(n.data,this.acroFormService.acroFields||{}))}includePolygonCloud(){return this.annotSelectedService.selectedComponents.some(n=>b.isPolygonCloud(n.data))}isAvailableTab(n){switch(n){case"GENERAL":return!0;case"ATTRIBUTES":return Y.get(V.ANNOT_PROPERTY_VIEW_ATTRIBUTES)&&!this.annotSelectedService.selectedComponents.some(i=>!b.isWidget(i.data)||b.isSignatureWidget(i.data,this.acroFormService.acroFields));default:return!1}}tabBottomBorderWidth(n){return this.activatedTabKey===n?"0":"calc(50% - 2px)"}setSelection(n){let i=this.commonAttributes.Parent.Opt.length-1,e=i<n?i:n;this.commonAttributes.Parent.V=this.getVfromOpt(this.opt[e]),this.modifyFieldsChanges(["V"],this.commonAttributes.Parent.V),this.commonAttributes.Parent.I=[e],this.modifyFieldsChanges(["I"],this.commonAttributes.Parent.I)}getVfromOpt(n){return typeof n=="string"?n:n?n[0]:null}isCommonAnnotAttribute(n){let i=this.commonAttributes;return n.every(e=>i.hasOwnProperty(e)?(i=i[e],!0):!1)}getTextAlignButtonColor(n){return n===this.textAlign?"white":"dark"}isCheckable(){return this.commonAttributes.Parent&&(this.commonAttributes.Parent.FT==="Rb"||this.commonAttributes.Parent.FT==="Cb")}isCommonFieldAttribute(n){let i=["Parent"];return this.isCommonAnnotAttribute(i.concat(n))}isAlignable(){return this.selectedComps.every(n=>this.unalignableFilters.every(i=>!i(n.data))&&!n.data.attributes.quadPoints&&(b.isWidget(n.data)&&Y.get(a.FORM_MOVE)||!b.isWidget(n.data)&&Y.get(a.MOVE_ANNOTATION)))}isAdjustable(){return this.selectedComps.every(n=>this.unadjustableFilters.every(i=>!i(n.data))&&!n.data.attributes.quadPoints&&(b.isWidget(n.data)&&Y.get(a.FORM_RESIZE)||!b.isWidget(n.data)&&Y.get(a.RESIZE_ANNOTATION)))}get Measure(){return this.commonAttributes.Measure}set Measure(n){this.commonAttributes.Measure=n,this.modifyAttributesChanges(["Measure"],this.commonAttributes.Measure)}preventDragging(n){n.stopPropagation()}align(n){let i=1/0,e=-1/0,t=1/0,o=-1/0;this.selectedComps.forEach(s=>{let c=s.data.attributes.rect;i=Math.min(i,c.left),e=Math.max(e,c.right),t=Math.min(t,c.bottom),o=Math.max(o,c.top)}),this.selectedComps.forEach(s=>{let c=s.data.attributes.rect;switch(n){case ki.HORIZONTAL_LEFT:this.moveRect(s.data,i-c.left,0);break;case ki.HORIZONTAL_CENTER:this.moveRect(s.data,(e+i)/2-(c.right+c.left)/2,0);break;case ki.HORIZONTAL_RIGHT:this.moveRect(s.data,e-c.right,0);break;case ki.VERTICAL_TOP:this.moveRect(s.data,0,o-c.top);break;case ki.VERTICAL_CENTER:this.moveRect(s.data,0,(o+t)/2-(c.top+c.bottom)/2);break;case ki.VERTICAL_BOTTOM:this.moveRect(s.data,0,t-c.bottom);break;default:break}this.annotService.dispatchModify(s.data)})}onChangeMeasure(){this.measureOutputRatio.toString()===""&&(this.measureOutputRatio=0),this.measureInputRatio.toString()===""&&(this.measureInputRatio=0);let n=this.Measure;n.X[0].C=Ue.convert(K.POINT,this.measureInputUnitKey,this.measureOutputRatio/this.measureInputRatio),n.X[0].U=this.measureOutputUnitName,n.R=`${this.measureInputRatio} ${this.measureInputUnitKey} = ${this.measureOutputRatio} ${this.measureOutputUnitName}`,this.Measure=n}get isDefaultProperty(){return this.selectionInfo.selectedComps.length===1&&this.selectionInfo.selectedComps[0].data.oid===null}updatePredefinedCalculation(){this.calculationCategory="predefined"}openCustomScriptDialog(){this.modalService.createModal(ci,this.customScript).addOnDisposeListener(n=>{S.isDefined(n)&&this.confirmCustomScriptChange(cn.CALCULATION,n)})}updateAnnotTitle(){let n=this.annotTitleFormControl.value;if(this.commonAttributes.Parent?.hasOwnProperty("T")){if(this.commonAttributes.Parent.T===n)return;this.commonAttributes.Parent.T=n,this.modifyFieldsChanges(["T"],this.commonAttributes.Parent.T)}else{if(this.commonAttributes.T===n)return;this.commonAttributes.T=n,this.modifyAttributesChanges(["T"],this.commonAttributes.T)}}isAllFieldSelected(){return this.filteredTempAcroFieldList.length>0&&this.filteredTempAcroFieldList.every(n=>n.checked)}selectAllField(){this.filteredTempAcroFieldList.forEach(n=>n.checked=!0)}deselectAllField(){this.tempAcroFieldList.forEach(n=>n.checked=!1)}confirmFieldSelectChange(){this.acroFieldList=this.tempAcroFieldList,this.calculationCategory="predefined",this.toastService.create({toastStyle:dt.SUCCESS,content:this.translatePipe.transform("APPLY_CALCULATION_SUCCESSFULLY")})}confirmCustomScriptChange(n,i){switch(n){case cn.CALCULATION:this.customScript=i,this.calculationCategory="custom";break;case cn.ACTION:this.selectedActionTrigger==="U"&&(this.commonAttributes.type="JavaScript",this.modifyAttributesChanges(["type"],this.commonAttributes.type),this.commonAttributes.JS=i,this.modifyAttributesChanges(["JS"],this.commonAttributes.JS),this.initAction());break;default:break}}checkablePreviewStyle(){let n=this.getIsCheckBox()?Ji.checkbox:Ji.radio;return{"background-image":this.selectedCheckableOption?`url('data:image/svg+xml;base64,${n[this.selectedImagePathMap[this.selectedCheckableOption.value]]}')`:null}}onEditActionClick(){this.modalService.createModal(ci,this.actionTriggerMap.get(this.selectedActionTrigger)[this.selectedActionIndex]).addOnDisposeListener(n=>{S.isDefined(n)&&this.confirmCustomScriptChange(cn.ACTION,n)})}onRemoveActionClick(){this.selectedActionTrigger==="U"&&(this.commonAttributes.JS=null,this.modifyAttributesChanges(["JS"],this.commonAttributes.JS),this.commonAttributes.type=null,this.modifyAttributesChanges(["type"],this.commonAttributes.type)),this.initAction()}onAddActionClick(n){if(n.stopPropagation(),!this.selectedActionTrigger){this.toastService.create({toastStyle:dt.NOTIFICATION,content:this.translatePipe.transform("SELECT_TRIGGER")});return}let i=this.actionTriggerMap.get(this.selectedActionTrigger);if(S.isDefined(i)&&i.length>0){this.toastService.create({toastStyle:dt.NOTIFICATION,content:this.translatePipe.transform("ONLY_ONE_ACTION_IN_ONE_TRIGGER")});return}switch(this.actionTriggerFormControl.value.value){case"JavaScript":this.modalService.createModal(ci,S.EMPTY_STRING).addOnDisposeListener(e=>{S.isDefined(e)&&this.confirmCustomScriptChange(cn.ACTION,e)});break;default:break}}toggleFieldSelectListExpend(){this.fieldSelectStatus=this.fieldSelectStatus===ii.CLOSE?ii.OPEN:ii.CLOSE}isSelectedCalFields(){return this.tempAcroFieldList.some(n=>n.checked)}getSelectCalFieldListClass(){return`papycon-chevron2-${this.fieldSelectStatus===ii.OPEN?"up":"down"}`}fixRange(n,i=-1/0,e=1/0){return Math.min(Math.max(n,i),e)}isNaN(n){return Number.isNaN(n)}getIsCheckBox(){return this.selectedComps.every(n=>b.isCheckBox(n.data,this.acroFormService.acroFields))}moveRect(n,i,e){let t=n.attributes.rect;if(t.left+=i,t.right+=i,t.bottom+=e,t.top+=e,b.isInk(n)&&n.attributes.inkList.forEach(o=>{o.forEach(s=>{s.x+=i,s.y+=e})}),(b.isPolygon(n)||b.isPolygonCloud(n)||b.isPolyLine(n))&&n.attributes.vertices.forEach(o=>{o.x+=i,o.y+=e}),b.isFreeTextCallout(n)){let{textRect:o,vertices:s}=n.attributes;o.left+=i,o.right+=i,o.bottom+=e,o.top+=e,s.forEach(c=>{c.x+=i,c.y+=e})}if(b.isLine(n)){let{coordinates:o}=n.attributes;o.sp.x+=i,o.sp.y+=e,o.ep.x+=i,o.ep.y+=e}}resizeRect(n,i,e,t){let o=n.attributes.rect,s=this.pdfPages[n.attributes.pageIdx],c=1,u=1;if(i!==void 0){let C=i;C<Ne.annotation.resizeLimit.width&&(C=Ne.annotation.resizeLimit.width),!t&&C>s.bbox.w-(o.left-s.bbox.x)&&(C=s.bbox.w-(o.left-s.bbox.x)),c=C/(o.right-o.left),o.right=o.left+C}if(e!==void 0){let C=e;C<Ne.annotation.resizeLimit.height&&(C=Ne.annotation.resizeLimit.height),!t&&C>s.bbox.h-(o.bottom-s.bbox.y)&&(C=s.bbox.h-(o.bottom-s.bbox.y)),u=C/(o.top-o.bottom),o.top=o.bottom+C}if(b.isInk(n)){let{inkList:C}=n.attributes;C.forEach(N=>{N.forEach(O=>{c&&(O.x=(O.x-o.left)*c+o.left),u&&(O.y=(O.y-o.bottom)*u+o.bottom)})})}}initMeasureUnits(){let n={[K.POINT]:"UNIT_POINT",[K.INCH]:"UNIT_INCH",[K.MILLIMETER]:"UNIT_MILLIMETER",[K.CENTIMETER]:"UNIT_CENTIMETER",[K.PICA]:"UNIT_PICA"},i={[K.POINT]:"UNIT_POINT",[K.INCH]:"UNIT_INCH",[K.MILLIMETER]:"UNIT_MILLIMETER",[K.CENTIMETER]:"UNIT_CENTIMETER",[K.PICA]:"UNIT_PICA",[K.FEET]:"UNIT_FEET",[K.YARD]:"UNIT_YARD",[K.METER]:"UNIT_METER",[K.KILOMETER]:"UNIT_KILOMETER",[K.MILE]:"UNIT_MILE"};Object.keys(n).forEach(e=>{this.measureInputUnitOpts.push({label:e,value:e})}),Object.keys(i).forEach(e=>{this.measureOutputUnitOpts.push({label:e,value:e})}),this.setMeasureProperties()}setMeasureProperties(){let n=this.unitPipe.transform(K.MILLIMETER),i=this.measureInputUnitOpts.findIndex(o=>o.value===n),e=this.measureInputUnitOpts.findIndex(o=>o.value===n);if(this.measureInputUnitKey=this.measureInputUnitOpts[i].value,this.measureOutputUnitName=this.measureOutputUnitOpts[e].value,this.measureOutputRatio=1,this.measureInputRatio=this.measureOutputRatio,this.Measure===void 0)return;let t=/([^ ]+) +([^ ]+) += +([^ ]+) +([^ ]+)/.exec(this.Measure.R);t!==null&&(this.measureInputRatio=parseFloat(t[1]),this.measureInputUnitKey=t[2],this.measureOutputRatio=parseFloat(t[3]),this.measureOutputUnitName=t[4])}initDropdownOptions(){this.startLinecapOptions.splice(0),this.endLinecapOptions.splice(0),this.borderStyleOptions.splice(0),(this.isDarkMode?Ot.darkModeLinecapList:Ot.linecapList).forEach(n=>{[this.startLinecapOptions,this.endLinecapOptions].forEach(i=>{i.push({label:n.label,value:n.value})})}),(this.isDarkMode?Ot.darkModeBorderStyleList:Ot.borderStyleList).forEach(n=>{this.borderStyleOptions.push({label:n.label,value:n.value})})}initSubscriptions(){this.subscriptionService.push(this.commonRectChanges.pipe(zn(),w(([n,i])=>n.left===i.left&&n.bottom===i.bottom&&n.top===i.top&&n.right===i.right),_t(n=>n[1]),Ve(()=>{this.changeDetectorRef.markForCheck(),this.commonAttributes.rect.right-=1e-4,this.commonAttributes.rect.top-=1e-4}),Jr(0),Ve(n=>{this.changeDetectorRef.markForCheck(),this.commonAttributes.rect.right=n.right,this.commonAttributes.rect.top=n.top})).subscribe(),this.commonRectChanges.pipe(St(),Ve(()=>{this.annotPositionXFormControl.setValue(this.xAsLocaleUnit,{emitEvent:!1}),this.annotPositionYFormControl.setValue(this.yAsLocaleUnit,{emitEvent:!1}),this.annotWidthFormControl.setValue(this.widthAsLocaleUnit,{emitEvent:!1}),this.annotHeightFormControl.setValue(this.heightAsLocaleUnit,{emitEvent:!1})})).subscribe(),this.commonMeasureChanges.pipe(St(),Ve(n=>{this.measureLengthFormControl.setValue(n.LL,{emitEvent:!1}),this.measureExtendFormControl.setValue(n.LLE,{emitEvent:!1})})).subscribe(),this.annotSelectedService.selectionInfoChange$.subscribe({next:()=>{this.initVariable(),this.update()}}),Et(this.annotSelectedService.selectionInfo$.pipe(Ve(n=>this.selectionInfo=n)),this.acroFormService.acroFields$,this.contentService.fieldEvent$,this.contentService.annotEvent$.pipe(w(S.isDefined),w(n=>n?.sdEventType===pe.UPDATE&&n.annot&&this.selectedComps?.findIndex(i=>i.data.oid===n.annot.oid)>-1)),this.contentService.annotListEvent$.pipe(w(S.isDefined),w(n=>n.sdEventType===pe.UPDATE),_t(n=>n.annot),w(S.isDefined),w(n=>this.selectedComps.findIndex(i=>i.data.oid===n.oid)>-1))).pipe($t(0)).subscribe({next:()=>this.update()}),this.store$.pipe(Be("screenTheme")).subscribe({next:n=>{this.screenTheme=n,this.initDropdownOptions(),this.changeDetectorRef.markForCheck()}}),this.store$.pipe(Be("language")).subscribe({next:n=>{this.language=n}}),this.store$.pipe(Zi()).subscribe({next:n=>{this.selectedAnnotTool=n}}),this.contentService.fontsResponse$.subscribe({next:n=>{this.fontOptions.splice(0),n.fontList.forEach(i=>{this.fontOptions.push({label:i.label[D.LANGUAGE_ID_MAP[this.language]]||i.label[0]||i.name,value:i.name,available:!0})}),this.fontOptions=this.fontOptions.slice().filter(i=>i.available),this.fontOptions=D.generateUnavailableFontOption(this.fontOptions,this.fontName,this.translatePipe),this.changeDetectorRef.markForCheck()}}),this.pageService.pdfPages$.subscribe({next:n=>this.pdfPages=n}),Pe.windowResize$.subscribe({next:()=>{this.isSmallWidthScreen=Pe.isSmallWidth(),this.changeDetectorRef.markForCheck()}}),this.acroFormService.titleRollback$.subscribe({next:n=>{this.commonAttributes.Parent.T=n,this.annotTitleFormControl.setValue(this.commonAttributes.Parent.T,{emitEvent:!1})}}),this.annotPropertyOptionFormControl.valueChanges.subscribe({next:n=>this.opt=n}),this.annotPositionXFormControl.valueChanges.pipe(St()).subscribe({next:n=>{this.annotPositionXFormControl.disabled||(this.xAsLocaleUnit=n)}}),this.annotPositionYFormControl.valueChanges.pipe(St()).subscribe({next:n=>{this.annotPositionYFormControl.disabled||(this.yAsLocaleUnit=n)}}),this.annotWidthFormControl.valueChanges.pipe(St()).subscribe({next:n=>{this.annotWidthFormControl.disabled||(this.widthAsLocaleUnit=n)}}),this.annotHeightFormControl.valueChanges.pipe(St()).subscribe({next:n=>{this.annotHeightFormControl.disabled||(this.heightAsLocaleUnit=n)}}),this.measureLengthFormControl.valueChanges.pipe(w(n=>n!==null),St()).subscribe({next:n=>this.measureLength=n}),this.measureExtendFormControl.valueChanges.pipe(w(n=>n!==null),St()).subscribe({next:n=>this.measureExtend=n}))}isCommonSize(n,i){return this.selectedComps.every(e=>(n?(e.data.attributes.rect.right-e.data.attributes.rect.left).toFixed(3)===n.toFixed(3):!0)&&(i?(e.data.attributes.rect.top-e.data.attributes.rect.bottom).toFixed(3)===i.toFixed(3):!0))}update(){this.selectionInfo&&this.acroFormService.isAcroFieldsInitialized()&&(this.changeDetectorRef.markForCheck(),this.isSelectedNothing?this.commonAttributes={}:(this.setMaximumStrokeWidth(),this.findAllCommonAttribute(),this.correctBitMaskAttribute(),this.updateFontSizeOptions(),this.fontOptions=this.fontOptions.filter(n=>n.available),this.fontOptions=D.generateUnavailableFontOption(this.fontOptions,this.fontName,this.translatePipe),this.validateActivatedTab(),this.initAction(),(this.isTextField()||this.isComboBox())&&(this.initAcroFieldList(),this.determineCalculationCategory())),this.tempAcroFieldList=S.deepClone(this.acroFieldList),this.changeDetectorRef.markForCheck(),Qt.hasDefinedProp(this.commonAttributes,"rect")&&S.isDefined(this.commonAttributes.rect)&&Object.values(this.commonAttributes.rect).every(n=>!Number.isNaN(n))&&this.commonRectChanges.next(ge({},this.commonAttributes.rect)),(this.commonAttributes.LL||this.commonAttributes.LLE)&&this.commonMeasureChanges.next({LL:this.commonAttributes.LL,LLE:this.commonAttributes.LLE}))}setMaximumStrokeWidth(){this.maximumStrokeWidth=this.annotSelectedService.selectedComponents.find(n=>n.data.type==="Line"&&n.data.IT==="LineDimension")?6:12}modifyFieldsChanges(n,i){this.selectedComps.forEach(e=>{let t=this.acroFormService.modifyByAnnot(e.data,n,i);if(n.includes("T")&&(this.annotService.putModel(e.data,"modify"),this.contentService.fireAnnotListEvent({from:"AnnotComponent",sdEventType:pe.UPDATE,pageIdx:e.data.attributes.pageIdx,annot:e.data})),!t.isSuccess){t.showToast(this.toastService,this.translatePipe);return}})}modifyAttributesChanges(n,i){let e=(t,o,s)=>{let c=this.annotService.modifyAttribute(t,o,s);if(!c.isSuccess){c.showToast(this.toastService,this.translatePipe);return}};if(this.isDefaultProperty){let t=this.selectedComps[0].data,o=k.getAnnotID(t),s=t.type,c=this.attributeProxyMapper?.getUnflattenedKey(s,n[0])??n;this.defaultAnnotService.saveChange(o,c,i)}this.selectedComps.forEach(t=>{if(t.data.attributes[n[0]]!==i){if(this.isCheckable()&&(n.find(o=>o==="width"||o==="FillColor"||o==="StrokeColor")||n[0]==="MK"&&n[1]==="CA")){let o=t.data.attributes,s=o.rect.right-o.rect.left,c=o.rect.top-o.rect.bottom,u=(n[0]==="MK"&&n[1]==="CA"?i:o.MK?.CA)||(b.isRadioWidget(t.data,this.acroFormService.acroFields)?"l":"4"),C=n[0]==="FillColor"?i:o.MK?.backgroundColor,N=n[0]==="StrokeColor"?i:o.MK?.borderColor,O=n[0]==="width"?i:o.width;Zr(Tr.imageToDataURI(Er[this.getIsCheckBox()?"Cb":"Rb"][u],s,c,C,N,O),Tr.imageToDataURI(Er[this.getIsCheckBox()?"Cb":"Rb"].unchecked,s,c,C,N,O)).subscribe({next:U=>{let z=[{data:U[1].replace("data:image/png;base64,",""),format:"png",state:"Off",type:"image",scaleType:"stretch"},{data:U[0].replace("data:image/png;base64,",""),format:"png",state:o.appearance.find(Me=>Me.state!=="Off").state,type:"image",scaleType:"stretch"}];e(t.data,["appearance"],z)}})}e(t.data,n,i)}})}isSameValueArray(n,i){return Array.isArray(n)&&Array.isArray(i)&&n.length===i.length&&n.every((e,t)=>e!==i[t])}restoreOptionalAttributeAndParent(n){let i=S.deepClone(n);return b.isWidget(i)&&i.attributes.Parent&&typeof i.attributes.Parent=="number"&&this.acroFormService.getAcroField(i.attributes.Parent)&&(i.attributes.Parent=this.acroFormService.getAcroField(i.attributes.Parent)),n.IT&&this.optionalAttributeMap[n.IT]?i.attributes=(0,Or.default)(this.optionalAttributeMap[n.IT],i.attributes,{arrayMerge:(e,t)=>t}):this.optionalAttributeMap[n.type]&&(i.attributes=(0,Or.default)(this.optionalAttributeMap[n.type],i.attributes,{arrayMerge:(e,t)=>t})),b.isSignatureWidget(i,this.acroFormService.acroFields)&&(i.attributes.Parent.Ff=i.attributes.Ff),i}findAllCommonAttribute(){this.commonAttributes={};let n=this.selectedComps[0],i=this.selectedComps.slice(1),e=this.restoreOptionalAttributeAndParent(n.data);for(let t in e.attributes){let o=i.map(s=>this.restoreOptionalAttributeAndParent(s.data));this.findCommonValue(e.type,[],t,e.attributes,o)}this.annotTitleFormControl.setValue(this.annotTitle),this.opacityAsPercentageFormControl.setValue(this.opacityAsPercentage),this.stringStrokeWidthFormControl.setValue(this.commonAttributes.width),this.actionTriggerFormControl.setValue(this.actionOptions[0]),this.commonAttributes.Parent?.Opt&&this.annotPropertyOptionFormControl.setValue(this.commonAttributes.Parent.Opt,{emitEvent:!1}),this.someAnnotsLocked()||!this.isAlignable()||this.isSelectedNothing?(this.annotPositionXFormControl.disable({emitEvent:!1}),this.annotPositionYFormControl.disable({emitEvent:!1})):(this.annotPositionXFormControl.enable({emitEvent:!1}),this.annotPositionYFormControl.enable({emitEvent:!1})),this.someAnnotsLocked()||!this.isAdjustable()||this.isSelectedNothing?(this.annotWidthFormControl.disable({emitEvent:!1}),this.annotHeightFormControl.disable({emitEvent:!1})):(this.annotWidthFormControl.enable({emitEvent:!1}),this.annotHeightFormControl.enable({emitEvent:!1})),this.someAnnotsLocked()?(this.annotTitleFormControl.disable(),this.opacityAsPercentageFormControl.disable(),this.stringStrokeWidthFormControl.disable(),this.actionTriggerFormControl.disable(),this.annotPropertyOptionFormControl.disable({emitEvent:!1}),this.measureLengthFormControl.disable(),this.measureExtendFormControl.disable()):(this.annotTitleFormControl.enable(),this.opacityAsPercentageFormControl.enable(),this.stringStrokeWidthFormControl.enable(),this.actionTriggerFormControl.enable(),this.annotPropertyOptionFormControl.enable({emitEvent:!1}),this.measureLengthFormControl.enable({emitEvent:!1}),this.measureExtendFormControl.enable({emitEvent:!1}))}findCommonValue(n,i,e,t,o){if(typeof t[e]=="object"&&t[e]!==null&&!Array.isArray(t[e]))for(let s in t[e])this.findCommonValue(n,i.concat(e),s,t[e],o);else{let s=i.concat(e),c=this.attributeProxyMapper.getFlattenedKey(n,s),u=o.map(O=>this.checkAttribute(c||s,t[e],O)),C=u.every(O=>O.has),N=u.every(O=>O.same);if(C){let O=this.commonAttributes;c===null&&i.forEach(U=>{O[U]||(O[U]={}),O=O[U]}),N?typeof t[e]=="object"?O[c===null?e:c]=S.deepClone(t[e]):O[c===null?e:c]=t[e]:O[c===null?e:c]=void 0}}}checkAttribute(n,i,e){let t=n;if(typeof t=="string"&&(t=this.attributeProxyMapper.getUnflattenedKey(e.type,t),t===null))return console.debug(`Fail to unflatten key. (Type: ${e.type}, Key: ${n})`),{has:!1,same:!1};let o=e.attributes,s=t.every(c=>typeof o=="object"&&o!==null&&o.hasOwnProperty(c)?(o=o[c],!0):!1);return{has:s,same:s&&typeof i==typeof o&&(Array.isArray(i)?this.isSameValueArray(i,o):i===o)}}correctBitMaskAttribute(){if(this.commonAttributes.hasOwnProperty("F")&&(this.commonAttributes.F=this.selectedComps[0].data.attributes.F,this.selectedComps.slice(1).forEach(n=>{this.commonAttributes.F&=n.data.attributes.F})),this.commonAttributes.Parent?.hasOwnProperty("Ff")){let n=this.selectedComps.map(i=>this.restoreOptionalAttributeAndParent(i.data));this.commonAttributes.Parent.Ff=n[0].attributes.Parent.Ff,n.slice(1).forEach(i=>{this.commonAttributes.Parent.Ff&=i.attributes.Parent.Ff})}}updateFontSizeOptions(){let n=D.fontsizeOptions.findIndex(e=>e.value===0),i=this.selectedComps.every(e=>b.isTextField(e.data,this.acroFormService.acroFields));i&&n<0?D.fontsizeOptions.unshift({label:"Auto",value:0}):!i&&n>-1&&D.fontsizeOptions.splice(n,1)}initAcroFieldList(){this.acroFieldList.splice(0);let{acroFields:n}=this.acroFormService;for(let i in n)Number.isNaN(Number(i))||this.acroFieldList.push({T:n[i].T,checked:!1})}determineCalculationCategory(){this.customScript=S.EMPTY_STRING;let n=this.additionalActionCalculate;if(n===null){this._calculationCategory="none";return}else if(!n||n.S!=="JavaScript"){this._calculationCategory=n.S===null?"none":void 0;return}if(this.predefinedCalculationOptions.some(e=>{let o=new RegExp(`\\s*AFSimple_Calculate\\("${e.value}",\\s*new\\s+Array\\s*\\(([^;]*)\\)\\);\\s*`).exec(n.JS);return o?(o[1].split(",").map(c=>c.replace(/^\s*"(.*)"\s*$/,"$1")).forEach(c=>{this.acroFieldList.some(u=>u.T===c?(u.checked=!0,!0):!1)}),this.currentPredefinedCalculation=e.value,!0):!1})){this._calculationCategory="predefined";return}this.customScript=n.JS,this._calculationCategory="custom"}validateActivatedTab(){this.isAvailableTab(this.activatedTabKey)||(this.activatedTabKey="GENERAL")}initAction(){this.actionTriggerMap=new Map,this.isFormField()&&(this.actionTriggerMap.set("U",this.commonAttributes.JS?[this.commonAttributes.JS]:[]),this.commonAttributes.AA)}initVariable(){this.selectedColorTabColor=null,this.selectedFontTabColor=null,this.measureInputRatio=1,this.measureOutputRatio=1,this.selectedActionTrigger=null,this.selectedActionIndex=null}resizeLeaderLine(n,i){if(this.isDefaultProperty){let e=this.selectedComps[0].data;if(!b.isLineDimension(e))return;e.attributes[n]=i,this.defaultAnnotService.saveChange(e.type,[n],i),this.annotService.dispatchModify(e);return}this.selectedComps.forEach(e=>{if(!b.isLineDimension(e.data))return;e.data.attributes[n]=i,e.fitBox&&e.fitBox();let t=e.data.attributes.rect,o=this.pdfPages[e.data.attributes.pageIdx].bbox;o.x<t.left&&t.right<o.w+o.x&&o.y<t.bottom&&t.top<o.h+o.y&&(this.commonAttributes[n]=S.deepClone(i)),this.annotService.modifyAttribute(e.data,[n],this.commonAttributes[n])})}};E(ln,"\u0275fac",function(i){return new(i||ln)(m(de),m($),m(gt),m(Ie),m(Ct),m(Zt),m(ut),m(qt),m(R),m(bt),m(me),m(ee),m(Ai),m(Vs))}),E(ln,"\u0275cmp",H({type:ln,selectors:[["sd-annot-property-view"]],standalone:!1,features:[j([R])],decls:14,vars:15,consts:[["colorContentRef",""],["lineContentRef",""],["textContentRef",""],["measureContentRef",""],["optionContentRef",""],["calculateContentRef",""],["actionContentRef",""],[1,"header"],["tabindex","0"],[1,"ep-button",3,"click","title"],[1,"papycon","papycon-cross"],[1,"scrollbar-container"],["class","position-and-size",4,"ngIf"],["class","empty-message",4,"ngIf"],["class","tabs",4,"ngIf"],[4,"ngIf"],[1,"position-and-size"],[3,"mousedown","width","puInputStep","suffix","formControl","ariaLabel"],[3,"puStepApply","width","puInputStep","suffix","formControl","ariaLabel"],[1,"empty-message"],[1,"tabs"],[1,"horizontal-container"],["class","tab",3,"active","click",4,"ngFor","ngForOf"],[1,"bottom-border"],["class","border",3,"ngClass","width",4,"ngFor","ngForOf"],[1,"tab",3,"click"],["tabindex","0",1,"tab-name"],[1,"top-border"],[1,"middle-border",3,"ngClass"],[1,"border",3,"ngClass"],[1,"default-attributes"],["class","property-title","tabindex","0",3,"disabled",4,"ngIf"],[3,"size","formControl","placeholder","ariaLabel","blur","keydown.enter",4,"ngIf"],[1,"flag-attributes"],[3,"disableFocus","disabled","label","ngModel","ngModelChange",4,"ngIf"],[3,"disableFocus","label","ngModel","ngModelChange",4,"ngIf"],[3,"contentTemplate","selected","header","borderHidden",4,"ngIf"],["tabindex","0",1,"property-title"],[3,"blur","keydown.enter","size","formControl","placeholder","ariaLabel"],[3,"ngModelChange","disableFocus","disabled","label","ngModel"],[3,"ngModelChange","disableFocus","label","ngModel"],[3,"contentTemplate","selected","header","borderHidden"],[1,"flex","column"],[1,"flex"],["class","flex column color-property",4,"ngIf"],[3,"nullable","customColorLabel","defaultColorLabel","defaultColorPanelExpandedd","ngModel","ngModelChange",4,"ngIf"],[1,"flex","space-between"],[1,"property-title"],[1,"slider-value"],[1,"flex","align-center","space-between",3,"ngSubmit"],["tabindex","0","name","opacity",3,"ngModelChange","puStepApply","min","max","step","puInputStep","disabled","puStep","puAlterStep","ngModel"],["size","tiny",1,"slider-input",3,"blur","formControl","ariaLabel"],[1,"flex","column","color-property"],[1,"color-picker-container"],["tabindex","0",1,"color-rect",3,"click"],[3,"ngModelChange","nullable","customColorLabel","defaultColorLabel","defaultColorPanelExpandedd","ngModel"],["name","strokeWidth","tabindex","0",3,"ngModelChange","puStepApply","puInputStep","disabled","max","min","ngModel"],[3,"ngModelChange","mousedown","disabled","isImageLabel","options","expandAriaLabel","size","ngModel"],[3,"ngModelChange","mousedown","disabled","isImageLabel","options","size","ngModel"],["class","flex",4,"ngIf"],[1,"flex","column","font-property"],[1,"font-dropdown",3,"ngModelChange","disabled","size","options","expandAriaLabel","boxWidth","ngModel"],[1,"font-size-dropdown",3,"ngModelChange","disabled","editable","expandAriaLabel","size","options","ngModel"],[3,"customColorLabel","defaultColorLabel","defaultColorPanelExpandedd","ngModel","ngModelChange",4,"ngIf"],[3,"ngModelChange","customColorLabel","defaultColorLabel","defaultColorPanelExpandedd","ngModel"],[1,"flex","text-align-buttons"],[1,"ep-text-button",3,"click","disabled"],[1,"papycon","papycon-text-align-left"],[1,"papycon","papycon-text-align-center"],[1,"papycon","papycon-text-align-right"],[1,"flex","align-center"],[1,"no-margin",3,"ngModelChange","autoResize","disabled","size","ariaLabel","ngModel"],[1,"measure-unit-dropdown","no-margin",3,"ngModelChange","disabled","options","size","ngModel"],[1,"equal-sign"],["class","flex column measure-property",4,"ngIf"],[1,"flex","column","measure-property"],[1,"no-margin",3,"puStepApply","mousedown","width","formControl","puInputStep","puStepDisabled","height","min","ariaLabel"],[1,"property-sub-title"],[1,"no-margin",3,"puStepApply","mousedown","width","formControl","puInputStep","puStepDisabled","height","ariaLabel"],[1,"no-border","no-margin"],[3,"borderHidden","contentTemplate","header","selected",4,"ngIf"],[1,"checkable-image-preview-container"],[1,"checkable-image-preview",3,"ngStyle"],[3,"ngModelChange","disabled","options","ngModel"],[3,"ngModelChange","ariaLabel","ngModel"],[3,"ngModelChange","disabled","disableFocus","label","ngModel"],[3,"ngModelChange","disabled","size","ariaLabel","ngModel"],[3,"selectedIndexChange","formControl"],[3,"borderHidden","contentTemplate","header","selected"],[1,"flex","column","calculate-tab"],["value","none",3,"ngModelChange","disabled","label","ngModel"],[1,"row","align-center"],["value","predefined",3,"ngModelChange","disabled","label","ngModel"],[1,"no-margin","calculation-dropdown",3,"ngModelChange","disabled","options","size","expandAriaLabel","ngModel"],[1,"property-sub-title","no-margin"],[1,"field-select"],["size","small",1,"input",3,"ngModelChange","placeholder","useClearButton","disabled","ariaLabel","ngModel"],[1,"select-all-checkbox-container"],[3,"ngModelChange","label","disableFocus","disabled","ngModel"],[1,"field-list"],["class","field",4,"ngFor","ngForOf"],[3,"click"],[1,"papycon",3,"ngClass"],[1,"select"],["color","grey",1,"ep-button",3,"click","disabled"],["value","custom",3,"ngModelChange","disabled","label","ngModel"],[1,"script-container"],[1,"edit"],[1,"field"],[3,"ngModelChange","disabled","label","disableFocus","ngModel"],[1,"flex","column","action-tab"],["tabindex","0",3,"actionTriggerChange","actionIndexChange","actionTriggerMap","actionTrigger","actionIndex"],[1,"widget-action-control"],["color","grey","size","tiny",1,"ep-button",3,"click","disabled"],[1,"papycon","papycon-pencil"],[1,"papycon","papycon-trash-can"],[3,"expandAriaLabel","formControl","options"],[1,"add"],["color","primary",1,"ep-button",3,"click"]],template:function(i,e){i&1&&(h(0,"div",7)(1,"div",8),P(2),T(3,"translate"),_(),h(4,"button",9),T(5,"translate"),T(6,"translate"),I("click",function(){return e.onCloseButtonClick()}),x(7,"i",10),_()(),h(8,"section",11),y(9,el,23,38,"section",12)(10,tl,4,3,"section",13)(11,ol,5,2,"nav",14)(12,Dl,13,19,"ng-container",15)(13,$l,5,6,"ng-container",15),_()),i&2&&(l(2),L(A(3,9,e.selectedAnnotToolName)),l(2),p("title",A(5,11,"CLOSE")),B("color",e.isDarkMode?"dark":"white")("aria-label",A(6,13,"CLOSE")),l(5),p("ngIf",!e.isSelectedNothing&&!e.isDefaultProperty),l(),p("ngIf",e.isSelectedNothing),l(),p("ngIf",!e.isSelectedNothing&&!e.isDefaultProperty&&e.isAvailableTab("ATTRIBUTES")),l(),p("ngIf",!e.isSelectedNothing&&(e.activatedTabKey==="GENERAL"||e.isSmallWidthScreen)),l(),p("ngIf",e.runtimeEnv.get(e.MergedRuntimeEnvKey.ANNOT_PROPERTY_VIEW_ATTRIBUTES)&&!e.isSelectedNothing&&(e.activatedTabKey==="ATTRIBUTES"||e.isSmallWidthScreen)))},styles:['[_nghost-%COMP%]{position:relative;display:flex;height:100%;flex-direction:column;overflow:hidden}.header[_ngcontent-%COMP%]{font-size:16px;line-height:26px;font-family:NotoSans-Medium,sans-serif;color:var(--mono-99);background-color:var(--mono-00);display:flex;align-items:center;justify-content:space-between;flex:0 0 58px;padding:0 12px}.header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:4px 8px;border:1px solid var(--mono-30)}.header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   .papycon[_ngcontent-%COMP%]{font-size:22px}.editor[_ngcontent-%COMP%], .editor-header[_ngcontent-%COMP%], .editor-buttons[_ngcontent-%COMP%], .editor-footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;flex:0 0 40px;padding:0 15px;border-bottom:1px solid var(--mono-30);background:var(--mono-10)}.editor[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .editor-header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .editor-buttons[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .editor-footer[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:13px;line-height:22px;font-family:NotoSans-Medium,sans-serif;color:var(--mono-70)}.editor.flex-end[_ngcontent-%COMP%], .editor-header.flex-end[_ngcontent-%COMP%], .editor-buttons.flex-end[_ngcontent-%COMP%], .editor-footer.flex-end[_ngcontent-%COMP%]{justify-content:flex-end}.editor-buttons[_ngcontent-%COMP%]{flex:0 0 48px;background:var(--mono-00)}.message[_ngcontent-%COMP%]{font-size:13px;line-height:22px;font-family:NotoSans-Regular,sans-serif;color:var(--mono-70);background-color:var(--mono-00);width:100%;height:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center}.message[_ngcontent-%COMP%]   .papycon[_ngcontent-%COMP%]{font-size:38px}.message[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-top:10px}.loading-footer[_ngcontent-%COMP%]{font-size:13px;line-height:22px;font-family:NotoSans-Regular,sans-serif;color:var(--mono-99);background-color:var(--mono-00);bottom:0;padding:10px 0;width:100%;font-size:12px;text-align:center;border-top:1px solid var(--mono-30)}.flex[_ngcontent-%COMP%]{display:flex}.flex.column[_ngcontent-%COMP%]{flex-direction:column}.flex.align-center[_ngcontent-%COMP%]{align-items:center}.flex.space-between[_ngcontent-%COMP%]{justify-content:space-between}.scrollbar-container[_ngcontent-%COMP%]{position:relative;height:100%;overflow-x:hidden;overflow-y:auto;flex-shrink:1;-webkit-overflow-scrolling:touch}.position-and-size[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:8px 16px;margin:14px 12px 0}.position-and-size[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;line-height:20px;font-family:NotoSans-Medium,sans-serif;color:var(--mono-70)}.position-and-size[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   span.disabled[_ngcontent-%COMP%]{opacity:.5}.position-and-size[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   pu-input-value[_ngcontent-%COMP%]{width:100%;margin:0}.empty-message[_ngcontent-%COMP%]{color:var(--mono-70);width:80%;position:absolute;left:50%;top:50%;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;transform:translate(-50%,-50%)}.empty-message[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:13px;line-height:22px;font-family:NotoSans-Regular,sans-serif;margin-top:16px}.tabs[_ngcontent-%COMP%]{display:flex;width:100%;height:43px;flex-direction:column;align-items:center;margin-top:24px}.tabs[_ngcontent-%COMP%]   .horizontal-container[_ngcontent-%COMP%]{display:flex;justify-content:space-around;width:100%}.tabs[_ngcontent-%COMP%]   .tab[_ngcontent-%COMP%]{position:relative;flex:1;width:100%;height:39px;background-color:var(--mono-10);cursor:pointer;-webkit-tap-highlight-color:transparent}.tabs[_ngcontent-%COMP%]   .tab[_ngcontent-%COMP%]:hover{background-color:var(--mono-30)}.tabs[_ngcontent-%COMP%]   .tab[_ngcontent-%COMP%]:active{background-color:var(--mono-50)}.tabs[_ngcontent-%COMP%]   .tab[_ngcontent-%COMP%]   .tab-name[_ngcontent-%COMP%]{font-size:14px;line-height:24px;font-family:NotoSans-Medium,sans-serif;color:var(--mono-70);position:absolute;display:flex;width:100%;height:100%;top:0;left:0;justify-content:center;align-items:center;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.tabs[_ngcontent-%COMP%]   .tab[_ngcontent-%COMP%]   .middle-border[_ngcontent-%COMP%]{width:100%;height:35px;box-sizing:border-box}.tabs[_ngcontent-%COMP%]   .tab.active[_ngcontent-%COMP%]{background-color:var(--mono-00)}.tabs[_ngcontent-%COMP%]   .tab.active[_ngcontent-%COMP%]   .tab-name[_ngcontent-%COMP%]{color:var(--primary-70)}.tabs[_ngcontent-%COMP%]   .tab.active[_ngcontent-%COMP%]   .top-border[_ngcontent-%COMP%]{width:100%;height:4px;box-sizing:border-box;border:1px solid var(--mono-30);border-bottom:none;border-top-left-radius:4px;border-top-right-radius:4px}.tabs[_ngcontent-%COMP%]   .tab.active[_ngcontent-%COMP%]   .middle-border.left-tab[_ngcontent-%COMP%]{border-right:1px solid var(--mono-30)}.tabs[_ngcontent-%COMP%]   .tab.active[_ngcontent-%COMP%]   .middle-border.right-tab[_ngcontent-%COMP%]{border-left:1px solid var(--mono-30)}.tabs[_ngcontent-%COMP%]   .bottom-border[_ngcontent-%COMP%]{position:relative;display:flex;width:calc(100% + 2px);height:4px;justify-content:space-between;margin-top:-1px}.tabs[_ngcontent-%COMP%]   .bottom-border[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]{height:100%;border-top:1px solid var(--mono-30)}.tabs[_ngcontent-%COMP%]   .bottom-border[_ngcontent-%COMP%]   .border.left[_ngcontent-%COMP%]{border-left:1px solid var(--mono-30);border-radius:4px 0}.tabs[_ngcontent-%COMP%]   .bottom-border[_ngcontent-%COMP%]   .border.right[_ngcontent-%COMP%]{border-right:1px solid var(--mono-30);border-radius:0 4px}.checkable-image-preview-container[_ngcontent-%COMP%]{width:100%;height:50px;border:2px;background-color:var(--mono-10);margin-bottom:12px;display:flex;justify-content:center;align-items:center}.checkable-image-preview-container[_ngcontent-%COMP%]   .checkable-image-preview[_ngcontent-%COMP%]{width:26px;height:26px;background-repeat:no-repeat}.property-title[_ngcontent-%COMP%]{font-size:12px;line-height:20px;font-family:NotoSans-Medium,sans-serif;margin-bottom:2px;color:var(--mono-70)}.property-title.disabled[_ngcontent-%COMP%]{opacity:.5;-webkit-user-select:none;user-select:none}.property-sub-title[_ngcontent-%COMP%]{font-size:12px;line-height:20px;font-family:NotoSans-Regular,sans-serif;color:var(--mono-70);margin:2px 0}.property-sub-title.disabled[_ngcontent-%COMP%]{opacity:.5;-webkit-user-select:none;user-select:none}.property-sub-title.no-margin[_ngcontent-%COMP%]{margin:0}.default-attributes[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:12px 12px 0}.default-attributes[_ngcontent-%COMP%]   pu-input[_ngcontent-%COMP%]{margin-bottom:8px}.default-attributes[_ngcontent-%COMP%]   .flag-attributes[_ngcontent-%COMP%]   pu-checkbox[_ngcontent-%COMP%]:not(:last-child){margin-right:8px}.position-and-size[_ngcontent-%COMP%] + .default-attributes[_ngcontent-%COMP%]{margin-top:16px}pu-accordion.show-border[_ngcontent-%COMP%]{border-top:1px solid var(--mono-30);margin-top:12px}pu-accordion[_ngcontent-%COMP%]:last-child{padding-bottom:12px}pu-accordion.no-margin[_ngcontent-%COMP%]{margin:0}pu-accordion.no-border[_ngcontent-%COMP%]{border:none}pu-accordion-tab[_ngcontent-%COMP%]{border-bottom:1px solid var(--mono-30)}pu-accordion-tab[_ngcontent-%COMP%]   section[_ngcontent-%COMP%]{padding:0 12px}pu-accordion-tab[_ngcontent-%COMP%]   section[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]   button.dark[_ngcontent-%COMP%]{color:var(--mono-00)}pu-accordion-tab[_ngcontent-%COMP%]   section[_ngcontent-%COMP%]   .edit[_ngcontent-%COMP%]   button.dark[_ngcontent-%COMP%], pu-accordion-tab[_ngcontent-%COMP%]   section[_ngcontent-%COMP%]   .select[_ngcontent-%COMP%]   button.dark[_ngcontent-%COMP%]{color:var(--mono-99);background-color:var(--mono-50)}pu-accordion-tab[_ngcontent-%COMP%]   section[_ngcontent-%COMP%]   .edit[_ngcontent-%COMP%]   button.dark[_ngcontent-%COMP%]:disabled, pu-accordion-tab[_ngcontent-%COMP%]   section[_ngcontent-%COMP%]   .select[_ngcontent-%COMP%]   button.dark[_ngcontent-%COMP%]:disabled{color:var(--font-disable);background-color:var(--mono-30)}pu-accordion-tab[_ngcontent-%COMP%]   section[_ngcontent-%COMP%]   .edit[_ngcontent-%COMP%]   button.dark[_ngcontent-%COMP%]:not(:disabled):hover, pu-accordion-tab[_ngcontent-%COMP%]   section[_ngcontent-%COMP%]   .select[_ngcontent-%COMP%]   button.dark[_ngcontent-%COMP%]:not(:disabled):hover{background-color:#9f9f9f}pu-accordion-tab[_ngcontent-%COMP%]   section[_ngcontent-%COMP%]:after{content:"";display:block;width:100%;height:12px}pu-accordion-tab[_ngcontent-%COMP%]   .no-border[_ngcontent-%COMP%]{border:none}pu-dropdown[_ngcontent-%COMP%], pu-input[_ngcontent-%COMP%], pu-input-value[_ngcontent-%COMP%], pu-slider[_ngcontent-%COMP%]{margin-bottom:8px}pu-dropdown.no-margin[_ngcontent-%COMP%], pu-input.no-margin[_ngcontent-%COMP%], pu-input-value.no-margin[_ngcontent-%COMP%], pu-slider.no-margin[_ngcontent-%COMP%]{margin-bottom:0}pu-slider[_ngcontent-%COMP%]{flex-shrink:1;width:97%}.slider-value[_ngcontent-%COMP%]{font-size:13px;line-height:22px;font-family:NotoSans-Regular,sans-serif;color:var(--mono-99);display:none}.slider-input[_ngcontent-%COMP%]{width:38px;margin-left:16px;flex-shrink:0}.color-property[_ngcontent-%COMP%], .measure-property[_ngcontent-%COMP%]{margin-left:8px}.color-property[_ngcontent-%COMP%]:first-child, .measure-property[_ngcontent-%COMP%]:first-child{margin-left:0}.font-property[_ngcontent-%COMP%]{margin-left:12px}.font-property[_ngcontent-%COMP%]:first-child{margin-left:0}.font-property[_ngcontent-%COMP%]   .font-dropdown[_ngcontent-%COMP%]{width:124px}.font-property[_ngcontent-%COMP%]   .font-size-dropdown[_ngcontent-%COMP%]{width:80px}.text-align-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:32px;height:32px}.text-align-buttons[_ngcontent-%COMP%]   button.dark[_ngcontent-%COMP%]{color:var(--mono-90)}.text-align-buttons[_ngcontent-%COMP%]   button.dark.active[_ngcontent-%COMP%]{color:var(--mono-00)}.text-align-buttons[_ngcontent-%COMP%]   button.dark[_ngcontent-%COMP%]:not(.active):hover{color:#d7d7d7}.text-align-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] + button[_ngcontent-%COMP%]{margin-left:4px}.text-align-buttons[_ngcontent-%COMP%]   button[color=white][_ngcontent-%COMP%]{background-color:var(--primary-50)}.text-align-buttons[_ngcontent-%COMP%]   button[color=white][_ngcontent-%COMP%]:focus{border-color:var(--mono-00)}.equal-sign[_ngcontent-%COMP%]{width:12px;height:10px;box-sizing:border-box;border-top:2px solid var(--mono-50);border-bottom:2px solid var(--mono-50);margin:0 8px}.calculate-tab[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{width:100%;display:flex;white-space:nowrap;align-items:center;justify-content:space-between}.calculate-tab[_ngcontent-%COMP%]   pu-radio-button[_ngcontent-%COMP%]{width:auto;margin:10px 0}.calculate-tab[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:4px auto 0 0}.calculate-tab[_ngcontent-%COMP%]   .script-container[_ngcontent-%COMP%]{color:var(--mono-70);font-family:Consolas;font-size:12px;width:100%;height:60px;border:1px solid var(--mono-30);padding:6px;box-sizing:border-box;white-space:pre;overflow:auto}.action-tab[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}.color-picker-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;cursor:pointer;border:1px solid var(--mono-30);border-radius:2px;box-sizing:border-box;padding:3px;margin-top:2px;width:30px;height:30px}.color-picker-container.disabled[_ngcontent-%COMP%]{opacity:.5;pointer-events:none;-webkit-user-select:none;user-select:none}.color-picker-container.selected[_ngcontent-%COMP%]{background-color:rgba(var(--primary-50),.08);border:1px solid var(--primary-50);box-shadow:0 0 6px 0 var(--primary-50)}.color-picker-container[_ngcontent-%COMP%]   .color-rect[_ngcontent-%COMP%]{width:22px;height:22px;border-radius:2px;background-size:cover}.field-select[_ngcontent-%COMP%]{position:relative;display:flex;width:100%;height:100%;flex-direction:column}.field-select[_ngcontent-%COMP%]   aside[_ngcontent-%COMP%]{height:17px;border:solid 1px var(--mono-30);background-color:var(--mono-10);font-size:8px;display:flex;justify-content:center;align-items:center;cursor:pointer}.field-select[_ngcontent-%COMP%]   aside[_ngcontent-%COMP%]   .papycon[_ngcontent-%COMP%]{font-size:12px}.field-select[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]{margin-top:15px;margin-bottom:0}.field-select[_ngcontent-%COMP%]   .select-all-checkbox-container[_ngcontent-%COMP%]{display:flex;width:100%;height:40px;align-items:center;box-sizing:border-box;border-top:1px solid var(--mono-30);border-bottom:1px solid var(--mono-30);padding:0 16px;margin-top:12px;background-color:var(--mono-10);flex-shrink:0}.field-select[_ngcontent-%COMP%]   .field-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;height:137px;padding:0 16px;box-sizing:border-box;overflow:auto}.field-select[_ngcontent-%COMP%]   .field-list[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;height:34px;flex-shrink:0}.field-select[_ngcontent-%COMP%]   .field-list[_ngcontent-%COMP%]   .field[_ngcontent-%COMP%]   pu-checkbox[_ngcontent-%COMP%]{width:100%;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.widget-action-control[_ngcontent-%COMP%]{display:flex;margin-top:12px}.widget-action-control[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;font-size:17px}.widget-action-control[_ngcontent-%COMP%]   button.dark[_ngcontent-%COMP%]{color:var(--mono-99);background-color:var(--mono-50)}.widget-action-control[_ngcontent-%COMP%]   button.dark[_ngcontent-%COMP%]:disabled{color:var(--font-disable);background-color:var(--mono-30)}.widget-action-control[_ngcontent-%COMP%]   button.dark[_ngcontent-%COMP%]:not(:disabled):hover{background-color:#9f9f9f}.widget-action-control[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] + button[_ngcontent-%COMP%]{margin-left:8px}@media screen and (max-width: 577px){.header[_ngcontent-%COMP%]{display:flex;padding-left:16px}.flag-attributes[_ngcontent-%COMP%]{display:flex;flex-direction:column}.align-buttons[_ngcontent-%COMP%], .position-and-size[_ngcontent-%COMP%], .tabs[_ngcontent-%COMP%]{display:none}.default-attributes[_ngcontent-%COMP%]{padding:0 16px}pu-accordion-tab[_ngcontent-%COMP%]   section[_ngcontent-%COMP%]{padding:0 16px}.property-title[_ngcontent-%COMP%]{font-size:13px;line-height:22px}.slider-value[_ngcontent-%COMP%]{display:inline}.slider-input[_ngcontent-%COMP%]{display:none}}.measure-unit-dropdown[_ngcontent-%COMP%]{width:64px}.calculation-dropdown[_ngcontent-%COMP%]{width:70px}'],data:{animation:[Zn("selectFileList",[gr(ii.OPEN,mi({height:"300px"})),gr(ii.CLOSE,mi({height:"137px"})),In(`${ii.OPEN} <=> ${ii.CLOSE}`,Sn(Xi.timingFunctions.CUBIC_EASE_IN_OUT))])]},changeDetection:0}));var ye=ln;Z([We(Q.annotPropertyViewComp.selectedCheckableOption)],ye.prototype,"selectedCheckableOption",null);Z([We(Q.annotPropertyViewComp.selectedStartLinecap)],ye.prototype,"selectedStartLinecap",null);Z([We(Q.annotPropertyViewComp.selectedEndLinecap)],ye.prototype,"selectedEndLinecap",null);Z([We(Q.annotPropertyViewComp.readonly)],ye.prototype,"readOnly",null);Z([We(Q.annotPropertyViewComp.required)],ye.prototype,"required",null);Z([We(Q.annotPropertyViewComp.multiline)],ye.prototype,"multiline",null);Z([We(Q.annotPropertyViewComp.lock)],ye.prototype,"lock",null);Z([We(Q.annotPropertyViewComp.fillColor)],ye.prototype,"fillColor",null);Z([We(Q.annotPropertyViewComp.strokeColor)],ye.prototype,"strokeColor",null);Z([We(Q.annotPropertyViewComp.opacity,1e3)],ye.prototype,"opacity",null);Z([We(Q.annotPropertyViewComp.selectedBorderStyle)],ye.prototype,"selectedBorderStyle",null);Z([We(Q.annotPropertyViewComp.strokeWidth,1e3)],ye.prototype,"strokeWidth",null);Z([We(Q.annotPropertyViewComp.selectedFontSize)],ye.prototype,"selectedFontSize",null);Z([We(Q.annotPropertyViewComp.selectedFont)],ye.prototype,"selectedFont",null);Z([We(Q.annotPropertyViewComp.fontColor)],ye.prototype,"fontColor",null);Z([We(Q.annotPropertyViewComp.measureLength)],ye.prototype,"measureLength",null);Z([We(Q.annotPropertyViewComp.measureExtend)],ye.prototype,"measureExtend",null);Z([We(Q.annotPropertyViewComp.changeSize)],ye.prototype,"widthAsLocaleUnit",null);Z([We(Q.annotPropertyViewComp.changeSize)],ye.prototype,"heightAsLocaleUnit",null);Z([We(Q.annotPropertyViewComp.changePoint)],ye.prototype,"xAsLocaleUnit",null);Z([We(Q.annotPropertyViewComp.changePoint)],ye.prototype,"yAsLocaleUnit",null);Z([We(Q.annotPropertyViewComp.textAlign)],ye.prototype,"textAlign",null);Z([We(Q.annotPropertyViewComp.AP_N_exportValue,1e3)],ye.prototype,"AP_N_exportValue",null);Z([We(Q.annotPropertyViewComp.calculationCategory)],ye.prototype,"calculationCategory",null);Z([Se(Q.annotPropertyViewComp.onChangeMeasure,1e3)],ye.prototype,"onChangeMeasure",null);Z([Se(Q.annotPropertyViewComp.updateAnnotTitle)],ye.prototype,"updateAnnotTitle",null);Z([Se(Q.annotPropertyViewComp.modifyAttributesChanges)],ye.prototype,"modifyAttributesChanges",null);var Xl=["labelRef"],Kl=r=>({content:r});function Ql(r,n){if(r&1&&(h(0,"th",10),P(1),_()),r&2){let i=n.$implicit,e=d(4);p("ngStyle",e.getDefaultHeaderStyles(i.styles)),l(),L(i.title)}}function Zl(r,n){if(r&1&&(x(0,"th",8),y(1,Ql,2,2,"th",9)),r&2){let i=d(3);l(),p("ngForOf",i.table.headers)}}function ql(r,n){if(r&1&&x(0,"i",14),r&2){let i=d(2).$implicit;p("tooltip",at(1,Kl,i.errorMessage))}}function Jl(r,n){if(r&1&&(h(0,"td",10)(1,"div",12,0),P(3),_(),y(4,ql,1,3,"i",13),_()),r&2){let i=n.$implicit,e=n.index,t=d().$implicit,o=d(3);p("ngStyle",o.includeErrorDocs?o.stylesWhenError:o.getDefaultHeaderStyles(i.styles)),l(),Ye("color",t.errorMessage&&"#E4002B"),l(2),Re(" ",t.contents[e]," "),l(),p("ngIf",t.errorMessage)}}function ep(r,n){if(r&1){let i=M();h(0,"td")(1,"pu-checkbox",11),I("ngModelChange",function(t){let o=f(i).$implicit,s=d(3);return g(s.setTableRowCheckedState(o,t))}),_()(),y(2,Jl,5,5,"td",9)}if(r&2){let i=n.$implicit,e=d(3);l(),p("triState",!0)("disabled",e.isEbookMode)("ngModel",e.getTableRowCheckedState(i)),l(),p("ngForOf",e.table.headers)}}function tp(r,n){if(r&1){let i=M();h(0,"pu-table",5),I("rowSelect",function(t){f(i);let o=d(2);return g(o.onSelectRow(t))}),y(1,Zl,2,1,"ng-template",6)(2,ep,3,4,"ng-template",7),_()}if(r&2){let i=d(2);p("data",i.table.rows)}}function ip(r,n){if(r&1&&(ue(0),x(1,"sd-breadcrumb",3),y(2,tp,3,1,"pu-table",4),he()),r&2){let i=d();l(),p("list",i.titles),l(),p("ngIf",i.table)}}function np(r,n){if(r&1){let i=M();h(0,"sd-dap-table",15),I("documentSelect",function(t){f(i);let o=d();return g(o.onDocumentSelect(t))}),_()}if(r&2){let i=d();p("table",i.selectedChildTable)("isEbookMode",i.isEbookMode)("titles",i.selectedChildTitles)("dapCategory",i.dapCategory)}}var Bo=(()=>{let n=class n{dapService;renderer;loggingService;table;isEbookMode;dapCategory;toastNotificationSubject;includeErrorDocs;titles;documentSelect=new Ge;labelRef;selectedChildTable;selectedChildTitles;stylesWhenError;constructor(e,t,o){this.dapService=e,this.renderer=t,this.loggingService=o}ngAfterViewInit(){this.includeErrorDocs&&(this.renderer.setStyle(this.labelRef.nativeElement,"white-space","nowrap"),this.stylesWhenError={display:"flex","flex-direction":"row","align-items":"center",height:"inherit"})}getDefaultHeaderStyles(e){let t={};for(let o in e)t[o]=e[o];return t}onSelectRow(e){e.child?(this.selectedChildTable=this.dapCategory.tables[e.child],this.selectedChildTitles=this.titles.concat(e.child),this.documentSelect.emit({refId:Number(this.selectedChildTable?.rows[0]?.link?.refId)})):S.isDefined(e?.link?.refId)?(this.selectedChildTable=null,this.documentSelect.emit({refId:Number(e.link.refId)})):this.loggingService.common("warn",Ee.INVALID,"row")}onDocumentSelect(e){this.documentSelect.emit(e)}setTableRowCheckedState(e,t){this.dapService.setTableRowCheckedState(e,t)}getTableRowCheckedState(e){return e.child?this.dapCategory.tables[e.child].rows.reduce((t,o)=>{let s=this.getTableRowCheckedState(o);return t===void 0||s===t?s:Wt.PARTIAL},Wt.FALSE):this.dapService.getStateContainer(e).state}};E(n,"\u0275fac",function(t){return new(t||n)(m(Do),m(xt),m(ze))}),E(n,"\u0275cmp",H({type:n,selectors:[["sd-dap-table"]],viewQuery:function(t,o){if(t&1&&te(Xl,5),t&2){let s;ie(s=ne())&&(o.labelRef=s.first)}},inputs:{table:"table",isEbookMode:"isEbookMode",dapCategory:"dapCategory",toastNotificationSubject:"toastNotificationSubject",includeErrorDocs:"includeErrorDocs",titles:"titles"},outputs:{documentSelect:"documentSelect"},standalone:!1,decls:2,vars:2,consts:[["labelRef",""],[4,"ngIf"],[3,"table","isEbookMode","titles","dapCategory","documentSelect",4,"ngIf"],[3,"list"],[3,"data","rowSelect",4,"ngIf"],[3,"rowSelect","data"],["puRowDef","header"],["puRowDef","body"],["width","10%"],[3,"ngStyle",4,"ngFor","ngForOf"],[3,"ngStyle"],[1,"checkbox",3,"ngModelChange","triState","disabled","ngModel"],[1,"label"],["class","papycon papycon-questionmark tooltip-icon",3,"tooltip",4,"ngIf"],[1,"papycon","papycon-questionmark","tooltip-icon",3,"tooltip"],[3,"documentSelect","table","isEbookMode","titles","dapCategory"]],template:function(t,o){t&1&&y(0,ip,3,2,"ng-container",1)(1,np,1,4,"sd-dap-table",2),t&2&&(p("ngIf",o.table&&o.dapCategory&&o.isEbookMode!==void 0),l(),p("ngIf",o.selectedChildTable))},styles:["pu-table[_ngcontent-%COMP%]{border-bottom:1px solid #DADADA}.checkbox[_ngcontent-%COMP%]{margin-top:5px}.tooltip-icon[_ngcontent-%COMP%]{color:var(--mono-70);margin-left:4px;font-size:18px;line-height:22px;cursor:pointer}.label[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden}"]}));let r=n;return r})();var Rr=r=>({content:r}),op=r=>[r];function rp(r,n){if(r&1){let i=M();h(0,"nav",10)(1,"button",11),T(2,"translate"),T(3,"translate"),T(4,"translate"),I("click",function(){f(i);let t=d();return g(t.changeMode(t.DapViewMode.TREE_VIEW))}),x(5,"i",12),_(),h(6,"button",11),T(7,"translate"),T(8,"translate"),T(9,"translate"),I("click",function(){f(i);let t=d();return g(t.changeMode(t.DapViewMode.TABLE_VIEW))}),x(10,"i",13),_()()}if(r&2){let i=d();l(),G("active",i.currentDapViewMode===i.DapViewMode.TREE_VIEW),p("title",A(2,12,"VIEW_AS_TREE"))("tooltip",at(24,Rr,A(3,14,"VIEW_AS_TREE"))),B("color",i.isDarkMode?"white":"dark")("aria-label",A(4,16,"VIEW_AS_TREE")),l(5),G("active",i.currentDapViewMode===i.DapViewMode.TABLE_VIEW),p("title",A(7,18,"VIEW_AS_TABLE"))("tooltip",at(26,Rr,A(8,20,"VIEW_AS_TABLE"))),B("color",i.isDarkMode?"white":"dark")("aria-label",A(9,22,"VIEW_AS_TABLE"))}}function sp(r,n){if(r&1){let i=M();h(0,"div")(1,"pu-tree",14),I("checkedChange",function(t){f(i);let o=d();return g(o.onTreeCheckedChange(t))})("selectedChange",function(t){f(i);let o=d();return g(o.onTreeSelectedChange(t))}),_()()}if(r&2){let i=d(),e=Oe(18);l(),p("checkbox",!0)("disableCheckbox",i.isEbookMode)("rootNode",i.categoryRoot)("tooltipTemplate",e)}}function ap(r,n){if(r&1){let i=M();h(0,"div")(1,"sd-dap-table",15),T(2,"translate"),I("documentSelect",function(t){f(i);let o=d();return g(o.onDocumentSelect(t))}),_()()}if(r&2){let i=d();l(),p("table",i.currentTable)("isEbookMode",i.isEbookMode)("dapCategory",i.dapCategory)("includeErrorDocs",i.includeErrorDocs)("titles",at(7,op,A(2,5,"LIST")))}}function cp(r,n){if(r&1&&x(0,"i",16),r&2){let i=n.$implicit;p("tooltip",at(1,Rr,i))}}var Nr=(()=>{let n=class n{changeDetectorRef;contentService;dapService;pageService;subscriptionService;store$;configsService;documentService;translatePipe;screenTheme;get isDarkMode(){return this.screenTheme==="light"?!1:this.screenTheme==="dark"||window.matchMedia("(prefers-color-scheme: dark)")?.matches}get DapViewMode(){return ei}get viewMode(){return this._viewMode}set viewMode(e){this._viewMode=e}get isEbookMode(){return this.viewMode===4}pdfDoc;currentDapViewMode=ei.TREE_VIEW;categoryRoot;currentTableName;allChecked=!1;dapCategory;_viewMode;get currentTable(){return!this.dapCategory||!this.currentTableName?null:this.dapCategory.tables[this.currentTableName]}pageDescriptions;pdfPages;includeErrorDocs=!1;documentCount=0;categoryCount=0;isTreeViewVisible=Y.get(a.DAP_VIEW_TREE);isTableViewVisible=Y.get(a.DAP_VIEW_TABLE);get CountTitle(){return this.categoryCount>0?this.translatePipe.transform("DAP_CATEGORY_COUNT",this.categoryCount):this.translatePipe.transform("DAP_DOCUMENT_COUNT",this.documentCount)}constructor(e,t,o,s,c,u,C,N,O){this.changeDetectorRef=e,this.contentService=t,this.dapService=o,this.pageService=s,this.subscriptionService=c,this.store$=u,this.configsService=C,this.documentService=N,this.translatePipe=O}ngOnInit(){this.initializeSetting(),this.subscriptionService.push(this.store$.pipe(Be("screenTheme")).subscribe({next:e=>{this.screenTheme=e,this.changeDetectorRef.markForCheck()}})),this.dapService.stateChange$.subscribe({next:()=>{this.syncTreeNodeFromRow(),this.changeDetectorRef.markForCheck()}}),this.store$.pipe(le("viewMode")).subscribe({next:e=>{this.viewMode=e,this.changeDetectorRef.markForCheck()}})}ngOnChanges(){this.initSubscriptions()}changeMode(e){this.currentDapViewMode=e}onClickClose(){this.store$.dispatch(ft.set({key:"rightSideViewVisible",value:!1}))}onTreeSelectedChange(e){let t=e[e.length-1].children;if(t.length>0){this.moveToRef(Number(t[0].data));return}this.moveToRef(Number(e[e.length-1].data))}onTreeCheckedChange(e){if(e.checked===Wt.PARTIAL)return;let t=e.node.descendants.filter(o=>o.children.length===0);(t.length>0?t:[e.node]).forEach(o=>{this.dapService.setDisabledState(Number(o.data),e.checked===Wt.FALSE),o.data&&(this.dapService.getStateContainer(o.data).state=e.checked)}),this.dapService.publishStateChange({check:e.checked}),this.syncTreeNodeFromRow()}selectAll(){let e=this.allChecked?Wt.FALSE:Wt.TRUE;this.currentTable&&this.currentDapViewMode===ei.TABLE_VIEW?this.currentTable.rows.forEach(t=>{this.dapService.setTableRowCheckedState(t,e)}):this.onTreeCheckedChange({node:this.categoryRoot,checked:e})}onDocumentSelect(e){this.moveToRef(e.refId)}computeAllCheckedFlag(){this.allChecked=this.categoryRoot.descendants.every(e=>e.checked===Wt.TRUE)}initSubscriptions(){this.subscriptionService.push(An([this.documentService.pageDescriptions$.pipe(w(S.isDefined)),this.documentService.dapCategory$]).subscribe({next:([e,t])=>{this.pageDescriptions=e,this.dapCategory=Object.keys(t).length>0?t:this.dapService.createDefaultDapCategory(this.pageDescriptions);let o={};e.forEach(u=>{let C=u.refId;o[C]||(o[C]=!0)});let s={};Object.keys(this.dapCategory.tables).forEach(u=>{this.dapCategory.tables[u].rows.forEach(C=>{let N=C.link?.refId;!S.isDefined(N)||s[N]||(s[N]=!0)})});let c=Object.keys(s).length;if(this.documentCount=Object.keys(o).length,this.categoryCount=Object.keys(this.dapCategory.tables).filter(u=>u!==this.dapCategory.root).length,this.documentCount!==c&&console.debug(this.translatePipe.transform("DIFFERENT_DOCUMENT_COUNT_IN_DAP"),{PageDescriptions:this.documentCount,Category:c}),!S.isDefined(this.dapCategory.tables[this.dapCategory.root])){console.error(this.translatePipe.transform("NO_ROOT_TABLE_NAME_IN_LIST"));return}this.processDapInfo(),this.computeAllCheckedFlag(),this.changeDetectorRef.markForCheck()}}),this.pageService.pdfPages$.subscribe({next:e=>this.pdfPages=e}))}moveToRef(e){if(this.dapService.isDisabled(e))return;let t=this.pdfPages?.find(s=>this.dapService.getPageRefId(s)===e);if(t===void 0)return;let o=t.i+1;this.contentService.requestViewChange({pageNo:o})}processDapInfo(){let e=this.dapCategory.tables[this.dapCategory.root];this.categoryRoot=new Cr,this.processTable(e,this.categoryRoot),this.currentTableName=this.dapCategory.root}processTable(e,t){let o=[],s=e.rows[0].contents.length-e.headers.length;if(s>0)for(let c=0;c<s;++c)e.headers.push({title:"",styles:{}});return e.rows.forEach(c=>{let u=new Cr;if(u.label=c.contents.join(" "),u.checked=Wt.TRUE,c.errorMessage&&(this.includeErrorDocs=!0,u.tooltipMessage=c.errorMessage,u.labelColor="#E4002B"),c.child){let C=this.processTable(this.dapCategory.tables[c.child],u);o.push(...C)}else if(c.link?.refId){let C=this.pageDescriptions.map((N,O)=>N.refId===Number(c.link?.refId)?O:null).filter(N=>N);u.data=c.link.refId,o.push(...C),this.dapService.isDisabled(Number(c.link.refId))&&(u.checked=Wt.FALSE)}t.push(u)}),o}syncTreeNodeFromRow(){let e=this.categoryRoot.descendants.filter(t=>t.children.length===0);for(let t of e)t.data&&(t.checked=this.dapService.getStateContainer(t.data).state);this.computeAllCheckedFlag()}initializeSetting(){if(!Y.get(V.DAP_VIEW)){if(this.pageDescriptions=this.documentService.dapInfo.pageDescriptions,Object.keys(this.dapCategory).length===0&&(this.dapCategory=this.dapService.createDefaultDapCategory(this.pageDescriptions)),!S.isDefined(this.dapCategory.tables[this.dapCategory.root])){console.error(this.translatePipe.transform("NO_ROOT_TABLE_NAME_IN_LIST"));return}this.processDapInfo(),this.computeAllCheckedFlag(),this.changeDetectorRef.markForCheck()}if(this.isTreeViewVisible!==this.isTableViewVisible){this.currentDapViewMode=this.isTreeViewVisible?ei.TREE_VIEW:ei.TABLE_VIEW;return}this.configsService.radioConfig[W.DEFAULT_VIEWED_DAP_LIST]?.items.forEach(t=>{Y.get(t.key)&&(this.currentDapViewMode=t.value)})}};E(n,"\u0275fac",function(t){return new(t||n)(m($),m(de),m(Do),m(ut),m(R),m(me),m(Rt),m(mt),m(ee))}),E(n,"\u0275cmp",H({type:n,selectors:[["sd-dap-view"]],inputs:{pdfDoc:"pdfDoc"},standalone:!1,features:[j([R,{provide:Kn,useValue:new ui(300)}]),Te],decls:19,vars:19,consts:[["tooltipTemplate",""],[1,"header"],["size","tiny",1,"ep-button",3,"click","title"],[1,"papycon","papycon-cross"],["class","tabs",4,"ngIf"],[1,"editor"],[3,"ngModelChange","label","ngModel","disabled"],[1,"count-title"],[1,"model-container"],[4,"ngIf"],[1,"tabs"],[1,"ep-text-button",3,"click","title","tooltip"],[1,"papycon","papycon-list2"],[1,"papycon","papycon-vertical-split"],[3,"checkedChange","selectedChange","checkbox","disableCheckbox","rootNode","tooltipTemplate"],[3,"documentSelect","table","isEbookMode","dapCategory","includeErrorDocs","titles"],[1,"papycon","papycon-questionmark","tooltip-icon",3,"tooltip"]],template:function(t,o){if(t&1){let s=M();h(0,"div",1)(1,"div"),P(2),T(3,"translate"),_(),h(4,"button",2),T(5,"translate"),T(6,"translate"),I("click",function(){return f(s),g(o.onClickClose())}),x(7,"i",3),_()(),y(8,rp,11,28,"nav",4),h(9,"nav",5)(10,"pu-checkbox",6),T(11,"translate"),I("ngModelChange",function(){return f(s),g(o.selectAll())}),_(),h(12,"span",7),P(13),_()(),h(14,"div",8),y(15,sp,2,4,"div",9)(16,ap,3,9,"div",9),_(),y(17,cp,1,3,"ng-template",null,0,ke)}t&2&&(l(2),L(A(3,11,"DAP_DOCUMENT")),l(2),p("title",A(5,13,"CLOSE")),B("color",o.isDarkMode?"dark":"white")("aria-label",A(6,15,"CLOSE")),l(4),p("ngIf",o.isTreeViewVisible&&o.isTableViewVisible),l(2),p("label",A(11,17,"SELECT_ALL"))("ngModel",o.allChecked)("disabled",o.isEbookMode),l(3),L(o.CountTitle),l(2),p("ngIf",o.currentDapViewMode===o.DapViewMode.TREE_VIEW),l(),p("ngIf",o.currentDapViewMode===o.DapViewMode.TABLE_VIEW&&o.currentTable&&o.dapCategory))},styles:['[_nghost-%COMP%]{position:relative;display:flex;height:100%;flex-direction:column;overflow:hidden}.header[_ngcontent-%COMP%]{font-size:16px;line-height:26px;font-family:NotoSans-Medium,sans-serif;color:var(--mono-99);background-color:var(--mono-00);display:flex;align-items:center;justify-content:space-between;flex:0 0 58px;padding:0 12px}.header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:4px 8px;border:1px solid var(--mono-30)}.header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   .papycon[_ngcontent-%COMP%]{font-size:22px}.editor[_ngcontent-%COMP%], .editor-header[_ngcontent-%COMP%], .editor-buttons[_ngcontent-%COMP%], .editor-footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;flex:0 0 40px;padding:0 15px;border-bottom:1px solid var(--mono-30);background:var(--mono-10)}.editor[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .editor-header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .editor-buttons[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .editor-footer[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:13px;line-height:22px;font-family:NotoSans-Medium,sans-serif;color:var(--mono-70)}.editor.flex-end[_ngcontent-%COMP%], .editor-header.flex-end[_ngcontent-%COMP%], .editor-buttons.flex-end[_ngcontent-%COMP%], .editor-footer.flex-end[_ngcontent-%COMP%]{justify-content:flex-end}.editor-buttons[_ngcontent-%COMP%]{flex:0 0 48px;background:var(--mono-00)}.message[_ngcontent-%COMP%]{font-size:13px;line-height:22px;font-family:NotoSans-Regular,sans-serif;color:var(--mono-70);background-color:var(--mono-00);width:100%;height:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center}.message[_ngcontent-%COMP%]   .papycon[_ngcontent-%COMP%]{font-size:38px}.message[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-top:10px}.loading-footer[_ngcontent-%COMP%]{font-size:13px;line-height:22px;font-family:NotoSans-Regular,sans-serif;color:var(--mono-99);background-color:var(--mono-00);bottom:0;padding:10px 0;width:100%;font-size:12px;text-align:center;border-top:1px solid var(--mono-30)}.tabs[_ngcontent-%COMP%]{display:flex;width:100%;height:50px;align-items:center;justify-content:space-around;box-sizing:border-box;padding:0 16px;border-bottom:1px solid var(--mono-30)}.tabs[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{position:relative;display:flex;width:124px;height:100%;align-items:center;justify-content:center}.tabs[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]:after{content:"";position:absolute;left:0;bottom:1px;width:100%;height:4px;border-radius:2px;background-color:var(--primary-50)}.editor[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding-left:16px;padding-right:12px}.editor[_ngcontent-%COMP%]   .count-title[_ngcontent-%COMP%]{font-size:13px;line-height:22px;font-family:NotoSans-Regular,sans-serif;color:var(--mono-70)}.model-container[_ngcontent-%COMP%]{height:calc(100% - 119px);overflow-y:auto;overflow-x:hidden}.tooltip-icon[_ngcontent-%COMP%]{margin-left:4px;font-size:18px;line-height:22px;cursor:pointer;color:var(--mono-90)}'],changeDetection:0}));let r=n;return r})();function lp(r,n){if(r&1){let i=M();h(0,"div",2),I("mousedown",function(t){f(i);let o=d();return g(o.onResizerDown(t))}),_()}if(r&2){let i=d();G("disabled",i.isAnnotPropertyView())}}function pp(r,n){if(r&1&&x(0,"sd-dap-view",6),r&2){let i=d(2);p("pdfDoc",i.pdfDoc)}}function dp(r,n){if(r&1&&x(0,"sd-text-search-view",6),r&2){let i=d(2);p("pdfDoc",i.pdfDoc)}}function up(r,n){r&1&&x(0,"sd-annot-property-view")}function hp(r,n){if(r&1&&(h(0,"div",3),y(1,pp,1,1,"sd-dap-view",4)(2,dp,1,1,"sd-text-search-view",4)(3,up,1,0,"sd-annot-property-view",5),_()),r&2){let i=d();l(),p("ngIf",i.rightSideViewMode===i.RightSideViewMode.DAP&&i.isDAP),l(),p("ngIf",i.rightSideViewMode===i.RightSideViewMode.TextSearch&&i.hasSearchTextPermission),l(),p("ngIf",i.rightSideViewMode===i.RightSideViewMode.AnnotProperty)}}var Fa=(()=>{let n=class n{resizerService;changeDetectorRef;documentService;subscriptionService;store$;get RightSideViewMode(){return Li}pdfDoc;get hostStyleWidth(){return Pe.isSmallWidth()?"100%":D.pixelOf(this.rightSideViewSize)}rightSideViewConf=Ne.rightSideView;resizeable=this.rightSideViewConf.resizeable;rightSideViewMode;rightSideViewSize;lastRightSideViewSize;resizerStartSize;get hasSearchTextPermission(){return this.documentService.checkAuthority(be.SEARCH_TEXT)}constructor(e,t,o,s,c){this.resizerService=e,this.changeDetectorRef=t,this.documentService=o,this.subscriptionService=s,this.store$=c}ngOnInit(){this.initSubscriptions()}ngOnDestroy(){this.store$.dispatch(ft.storeLastRightSideViewSize({viewMode:this.rightSideViewMode,size:this.rightSideViewSize}))}isAnnotPropertyView(){return this.rightSideViewMode===Li.AnnotProperty}onResizerDown(e){if(this.isAnnotPropertyView())return;let t=this.resizerService.createResizer(e,o=>this.resize(o,t),"col-resizing");t&&(this.resizerStartSize=Number(this.rightSideViewSize))}get isDAP(){return this.documentService.isDAP}initSubscriptions(){this.subscriptionService.push(this.store$.pipe(le("rightSideViewSize")).subscribe({next:e=>this.rightSideViewSize=e}),this.store$.pipe(le("lastRightSideViewSize")).subscribe({next:e=>this.lastRightSideViewSize=e}),this.store$.pipe(le("rightSideViewMode")).subscribe({next:e=>{this.rightSideViewMode&&this.store$.dispatch(ft.storeLastRightSideViewSize({viewMode:this.rightSideViewMode,size:this.rightSideViewSize})),this.rightSideViewMode=e,this.rightSideViewSize=this.lastRightSideViewSize[this.rightSideViewMode],this.changeDetectorRef.detectChanges()}}))}resize(e,t){let o=D.navWidth,s=D.toggleButtonWidth,c=2,u=D.canSideViewBeDisplayed(!1,!0,0,Ne.rightSideView.maxSize),C=Math.max(Ne.rightSideView.minSize,Math.min(this.resizerStartSize+(t.startPosX-e.clientX),Ne.rightSideView.maxSize));if(this.changeDetectorRef.markForCheck(),!u){this.store$.dispatch(ft.set({key:"rightSideViewSize",value:Math.min(C,Pe.width-(o+s*c+5))}));return}this.store$.dispatch(ft.set({key:"rightSideViewSize",value:C}))}};E(n,"\u0275fac",function(t){return new(t||n)(m(ua),m($),m(mt),m(R),m(me))}),E(n,"\u0275cmp",H({type:n,selectors:[["sd-right-side-view"]],hostVars:2,hostBindings:function(t,o){t&2&&Ye("width",o.hostStyleWidth)},inputs:{pdfDoc:"pdfDoc"},standalone:!1,features:[j([R])],decls:3,vars:2,consts:[["class","resizer",3,"disabled","mousedown",4,"ngIf"],["class","side-contents",4,"ngIf"],[1,"resizer",3,"mousedown"],[1,"side-contents"],[3,"pdfDoc",4,"ngIf"],[4,"ngIf"],[3,"pdfDoc"]],template:function(t,o){t&1&&(y(0,lp,1,2,"div",0),h(1,"section"),y(2,hp,4,3,"div",1),_()),t&2&&(p("ngIf",o.resizeable),l(2),p("ngIf",o.pdfDoc))},styles:["[_nghost-%COMP%]{height:100%;display:block}.resizer[_ngcontent-%COMP%]{width:12px;height:calc(100% - 20px);top:10px;left:-6px;position:absolute;box-sizing:border-box;margin:0;padding:0;cursor:col-resize;z-index:1}.resizer.disabled[_ngcontent-%COMP%]{cursor:default}section[_ngcontent-%COMP%]{width:100%;height:100%;overflow:hidden;position:relative;border-left:1px solid var(--mono-30)}.side-contents[_ngcontent-%COMP%]{width:100%;height:100%;margin:0;padding:0;display:block;background-color:var(--mono-00)}@media screen and (max-width: 577px){.resizer[_ngcontent-%COMP%]{display:none}}"],changeDetection:0}));let r=n;return r})();var Gg=(()=>{let n=class n{};E(n,"\u0275fac",function(t){return new(t||n)}),E(n,"\u0275mod",ot({type:n})),E(n,"\u0275inj",nt({imports:[Oa,rt,ji,kt,Lo,to,Ts,ro,so,ao,oo,lo,mo,fo,Is,ys,$i,zs,pa,da]}));let r=n;return r})();Le(ko,[lt,wt,Ht],[ee]);Le(Ii,[je,De,lt,fi,Ht,On,bn],[ee]);Le(ye,[je,De,Ce,_e,vn,lt,fi,wt,xn,Mn,eo,Jn,io,no,yn,Ht,co,ho,_o,Pi,la,Ii],[ee]);Le(Bo,[va,De,Ce,_e,lt,wt,io,Es,Ss,hi,Bo],[]);Le(Nr,[Ce,lt,wt,io,bs,hi,Bo],[ee]);Le(Fa,[Ce,ca,ye,Nr],[]);Le(ci,[je,Ce,vn,_i,lt,fi,wt,xn,Ht],[ee]);Le(Vo,[De,Ce,lt,wt,Ht],[ee]);var Vt=(()=>{let n=class n{translatePipe;documentService;emitCustomMenuSrc=new it;emitCustomMenu$=this.emitCustomMenuSrc.asObservable();contextMenuStatusSrc=new ui(!1);contextMenuStatus$=this.contextMenuStatusSrc.asObservable();contextMenu=[];menuAuthorityMap;hidableMenus={};constructor(e,t){this.translatePipe=e,this.documentService=t,this.contextMenu=[{items:Y.get(a.CONTEXT_MENU_TOOLS_IN_USE)}]}getExportableEvents(){return[{type:"customContextMenuExecute",subject:this.emitCustomMenu$.pipe(_t(e=>({customEventId:e.customEventId,textData:e.textData,menuPosition:e.menuPosition})))}]}publishContextMenuStatus(e){this.contextMenuStatusSrc.next(e)}emitCustomMenuEvent(e){this.emitCustomMenuSrc.next(e)}create(e){return this.menuAuthorityMap={SAVE:this.checkAuthority(be.SAVE_DOCUMENT),PRINT:this.checkAuthority(be.PRINT_DOCUMENT),DOWNLOAD:this.checkAuthority(be.DOWNLOAD_DOCUMENT),HIGHLIGHT:this.checkAuthority(be.DRAW_ANNOTATION),UNDERLINE:this.checkAuthority(be.DRAW_ANNOTATION),STRIKEOUT:this.checkAuthority(be.DRAW_ANNOTATION),SEARCH:this.checkAuthority(be.SEARCH_TEXT),COPY:this.checkAuthority(be.COPY_TEXT),CREATE_LINK:this.checkAuthority(be.DRAW_ANNOTATION),REDACTION:this.checkAuthority(be.DRAW_REDACTION)},[{items:this.menusOf(e)}]}menusOf(e){return this.contextMenu[0].items.filter(t=>t.id===void 0||!t.data?.isDefaultTool||this.menuAuthorityMap[t.id]!==!1).map(t=>this.menuOf(e,t))}menuOf(e,t){let o,s;t.data?.eventId||t.type==="category"||t.type==="line"?(o=t.label,s=t.subLabel):(o=this.translatePipe.transform(typeof t.label=="string"?t.label:t.label()),s=typeof t.subLabel=="string"?t.subLabel:t.subLabel?.());let c={id:t.id,type:t.type,icon:t.label==="SLIDESHOW"&&e.isFullScreen?"papycon papycon-collapse":t.icon,label:o,subLabel:s,command:()=>{if(t.data?.eventId)return e.execute("CUSTOM_EVENT",t.data?.eventId);if(t.id)return e.execute(t.id);throw new He("The menu item must have either an id to execute a command.")}};return t.data?.isTextTool&&!e.textParam&&Object.assign(c,{disabled:!0}),c}checkAuthority(e){return this.documentService.checkAuthority(e)}};E(n,"\u0275fac",function(t){return new(t||n)(It(ee),It(mt))}),E(n,"\u0275prov",Yt({token:n,factory:n.\u0275fac}));let r=n;return r})();var Va,Ua,Ba,Ga,Wa,Ha,za,_p=["puMenuComp"],_0=(()=>{let n=class n{contentService;annotService;sdContextMenuService;changeDetectorRef;dialogService;downloadService;changeService;selectTextService;documentService;pageService;elementRef;subscriptionService;viewerService;store$;translatePipe;loggingService;customUIService;eventInfo;isClickOnGrayArea=!1;menuComp;menus;styles={transform:"translate(0, 10000px)",width:"155px",visibility:D.STYLE_VISIBILITY_HIDDEN,left:"0",top:"0",maxHeight:"308px",overflow:"auto"};preferences=null;pageCount=0;currentPageNo=0;scale=0;degree=0;isFullScreen=!1;textParam=null;clickedPage=null;commands=new ni(this);constructor(e,t,o,s,c,u,C,N,O,U,z,Me,Bt,Oi,ur,hr,mr){this.contentService=e,this.annotService=t,this.sdContextMenuService=o,this.changeDetectorRef=s,this.dialogService=c,this.downloadService=u,this.changeService=C,this.selectTextService=N,this.documentService=O,this.pageService=U,this.elementRef=z,this.subscriptionService=Me,this.viewerService=Bt,this.store$=Oi,this.translatePipe=ur,this.loggingService=hr,this.customUIService=mr}ngOnInit(){this.subscriptionService.push(we(this.elementRef.nativeElement,"wheel",{passive:!0}).subscribe({next:e=>{e.stopPropagation()}}),this.store$.pipe(Be()).subscribe({next:e=>this.preferences=e}),this.store$.pipe(le("degree")).subscribe({next:e=>this.degree=e}),this.store$.pipe(le("pageCount")).subscribe({next:e=>this.pageCount=e}),this.store$.pipe(le("currentPageNo")).subscribe({next:e=>{this.currentPageNo=e,this.close()}}),this.store$.pipe(le("scale")).subscribe({next:e=>{this.scale=e,this.changeDetectorRef.detectChanges()}}),this.selectTextService.publishSelectedText$.subscribe({next:e=>{this.textParam=e}}),Pe.fullScreenState$.subscribe({next:e=>{this.isFullScreen=e,this.changeDetectorRef.markForCheck()}}),this.documentService.authorityUpdate$.subscribe({next:()=>{this.buildMenu(),this.changeDetectorRef.markForCheck()}}),this.pageService.clickedPage$.subscribe({next:e=>this.clickedPage=e}),this.store$.pipe($s([Ei.CONTEXT_MENU_HIGHLIGHT,Ei.CONTEXT_MENU_STRIKEOUT,Ei.CONTEXT_MENU_UNDERLINE,Ei.CONTEXT_MENU_COPY,Ei.CONTEXT_MENU_SEARCH,Ei.CONTEXT_MENU_CREATE_LINK,Ei.CONTEXT_MENU_REDACTION])).subscribe({next:e=>{this.sdContextMenuService.hidableMenus=ge(ge({},this.sdContextMenuService.hidableMenus),e),this.buildMenu(),this.changeDetectorRef.markForCheck()}}),this.customUIService.customContextMenuUI$.pipe(Ve(()=>this.buildMenu())).subscribe({next:e=>{let t=e.filter(s=>s.position==="FIRST").map(s=>this.buildCustomContextMenu(s)),o=e.filter(s=>s.position==="LAST").map(s=>this.buildCustomContextMenu(s));this.menus[0].items=[...t,...this.menus[0].items,...o]}}))}ngAfterViewInit(){ri(0).pipe(w(()=>this.menus[0].items.length>0),Ve(()=>this.menuComp.openMenu()),Tt(()=>ri(0))).subscribe({next:()=>this.buildStyles()})}onClickCustomMenu(e){let t=this.clickedPage;this.sdContextMenuService.emitCustomMenuEvent({customEventId:e,textData:this.generateExternalTextData(),menuPosition:{pdfPageIndex:t?t.i:null,pdfPageX:t?this.eventInfo.offsetX:null,pdfPageY:t?t.bbox.h-this.eventInfo.offsetY:null,clientX:this.eventInfo.clientX,clientY:this.eventInfo.clientY}}),this.selectTextService.publishSelectedText(null),this.pageService.publishPage(null)}close(e){e&&(e.stopPropagation(),e.target.nodeName==="SD-CONTEXTMENU"&&this.selectTextService.publishSelectedText(null))}generateExternalTextData(){if(!this.textParam)return;let e=this.textParam.textBox,t=this.textParam.comp.data.slice(e.startIndex.li,e.endIndex.li+1).map(o=>({text:o.text,rects:o.rect}));return t.length>0&&(t.length===1?(t[0].text=t[0].text.slice(e.startIndex.ti,e.endIndex.ti+1),t[0].rects=t[0].rects.slice(e.startIndex.ti,e.endIndex.ti+1)):(t[0].text=t[0].text.slice(e.startIndex.ti),t[0].rects=t[0].rects.slice(e.startIndex.ti),t[t.length-1].text=t[t.length-1].text.slice(0,e.endIndex.ti+1),t[t.length-1].rects=t[t.length-1].rects.slice(0,e.endIndex.ti+1))),t}buildMenu(){let e=Object.keys(this.sdContextMenuService.hidableMenus).filter(t=>this.sdContextMenuService.hidableMenus[t]);this.menus=this.sdContextMenuService.create(this.commands),e.length&&e.forEach(t=>{t.includes("CONTEXT_MENU")&&this.menus.forEach(o=>{o.items=o.items.filter(s=>s.id!==t.substring(t.indexOf(".")+1,t.length))})})}buildStyles(){if(!this.textParam&&!this.elementRef.nativeElement.parentElement||this.changeDetectorRef.destroyed)return;let e=this.getAbsolutlyPosition();return this.styles.transform=`translate(${e.x}px, ${e.y}px)`,this.styles.visibility=null,D.bindLayoutOrder(this.styles,D.LayoutOrder.CONTEXT_MENU),this.changeDetectorRef.markForCheck(),this.styles}getAbsolutlyPosition(){let e=Pe.isMobile()&&this.textParam?this.textParam.finishEvt:this.eventInfo,t=this.elementRef.nativeElement.parentElement?.getBoundingClientRect();if(!S.isDefined(t))throw new vt("Content view parent element is not defined.");let o={x:e.pageX-t.left,y:e.pageY-t.top},s=155,c=30,u=10,C=10,N=o.x+s;N>t.width&&(o.x-=N-t.width+C);let O=this.menus[0].items.length,U=o.y+O*c+u;return U>t.height&&(o.y-=U-t.height+C),o}buildCustomContextMenu(e){return{label:e.label??"",icon:e.icon,command:t=>{if(!e.onclick){this.loggingService.common("warn",Ee.NOT_EXIST,"onclick property");return}if(!t){this.loggingService.common("warn",Ee.NOT_EXIST,"event");return}let o=this.getAbsolutlyPosition(),s={pdfPageIndex:this.isClickOnGrayArea?null:this.clickedPage.i,pdfPageX:this.isClickOnGrayArea?null:o.x,pdfPageY:this.isClickOnGrayArea?null:o.y,clientX:this.eventInfo.clientX,clientY:this.eventInfo.clientY},c=this.generateExternalTextData();c?e.onclick(Ar.simplifyMouseEvent(t),s,c):e.onclick(Ar.simplifyMouseEvent(t),s),this.selectTextService.publishSelectedText(null)}}}};E(n,"\u0275fac",function(t){return new(t||n)(m(de),m(Ie),m(Vt),m($),m(Qs),m(aa),m(na),m(Jt),m(mt),m(ut),m(re),m(R),m(on),m(me),m(ee),m(ze),m(sa))}),E(n,"\u0275cmp",H({type:n,selectors:[["sd-contextmenu"]],viewQuery:function(t,o){if(t&1&&te(_p,7),t&2){let s;ie(s=ne())&&(o.menuComp=s.first)}},hostBindings:function(t,o){t&1&&I("click",function(c){return o.close(c)})},inputs:{eventInfo:"eventInfo",isClickOnGrayArea:"isClickOnGrayArea"},standalone:!1,features:[j([R])],decls:2,vars:2,consts:[["puMenuComp",""],[3,"menus","ngStyle"]],template:function(t,o){t&1&&x(0,"pu-menu",1,0),t&2&&p("menus",o.menus)("ngStyle",o.styles)},dependencies:[_e,po],styles:["[_nghost-%COMP%]{position:absolute;height:100%;left:0;top:0;display:block}pu-menu[_ngcontent-%COMP%]{overscroll-behavior:contain}"],changeDetection:0}));let r=n;return r})(),ni=class{comp;constructor(n){this.comp=n}get isFullScreen(){return this.comp.isFullScreen}get textParam(){return this.comp.textParam}get annotService(){return this.comp.annotService}get contentService(){return this.comp.contentService}execute(n,i){if(!this[n]){this.comp.loggingService.common("warn",Ee.NOT_EXIST,`context menu command[${n}]`);return}i?this.comp.documentService.waitForConvPDF(this[n].bind(this,i)):this.comp.documentService.waitForConvPDF(this[n].bind(this)),this.comp.selectTextService.publishSelectedText(null)}createAnnot(n){if(!this.textParam)throw new He("The text parameter is required.");let{startEvt:i,page:e}=this.textParam,t=this.annotService.createAnnot(n,e,{x:i.offsetX,y:i.offsetY}),o=new tn(i,this.textParam.comp,!1,!1);o.renderer=new en(o,t[0]),o.renderer.clear=()=>{},o.textBox=this.textParam.textBox,o.render(),o.destroy(),k.fitTextMarkupBox(t[0]),t.forEach(c=>{if(!c){this.comp.loggingService.common("warn",Ee.NOT_EXIST,this.comp.translatePipe.transform("ANNOTATION"));return}this.annotService.putModel(c)});let s={from:"AnnotComponent",sdEventType:pe.CREATE,pageIdx:e.i,annot:t[0]};this.contentService.fireAnnotEvent(s),this.contentService.fireAnnotListEvent(s),this.comp.selectTextService.publishSelectedText(null)}createLink(){if(!this.textParam)throw new He("The text parameter is required.");let{startEvt:n,page:i}=this.textParam,e=this.annotService.createAnnot(F.LINK,i,{x:n.offsetX,y:n.offsetY}),t=new tn(n,this.textParam.comp,!1,!1);t.renderer=new en(t,e[0]),t.renderer.clear=()=>{},t.textBox=this.textParam.textBox,t.render(),t.destroy(),k.fitTextMarkupBox(e[0]),this.contentService.publishEnableLinkCreationDialog(e[0]),this.comp.selectTextService.publishSelectedText(null)}CUSTOM_EVENT(n){this.comp.onClickCustomMenu(n)}[Va="HIGHLIGHT"](){this.createAnnot(F.HIGHLIGHT)}[Ua="STRIKEOUT"](){this.createAnnot(F.STRIKE)}[Ba="UNDERLINE"](){this.createAnnot(F.UNDERLINE)}[Ga="CREATE_LINK"](){this.createLink()}[Wa="COPY"](){if(!this.textParam)throw new He("The text parameter is required.");this.textParam.text&&Pe.copyToClipboard(this.textParam.text)}[Ha="SEARCH"](){if(!this.textParam)throw new He("The text parameter is required.");if(!this.textParam.text)return;let n=this.textParam;this.comp.store$.dispatch(ft.set({key:"rightSideViewVisible",value:!0})),this.comp.store$.dispatch(ft.set({key:"rightSideViewMode",value:Li.TextSearch})),setTimeout(()=>this.contentService.searchSelectingKeyword(n.text.slice(0,Ne.textSearchLengthLimit)))}[za="REDACTION"](){if(!this.textParam)throw new He("The text parameter is required.");let{startEvt:n,page:i}=this.textParam,e=this.annotService.createAnnot(F.HIGHLIGHT,i,{x:n.offsetX,y:n.offsetY})[0];e.attributes.quadPoints=[];let t=new tn(n,this.textParam.comp,!1,!1);t.renderer=new en(t,e),t.renderer.clear=()=>{},t.textBox=this.textParam.textBox,t.render(),t.destroy(),e.attributes.quadPoints.forEach(o=>{let s=this.annotService.createAnnot(F.REDACTION,i,{x:n.offsetX,y:n.offsetY})[0];s.attributes.rect={top:Math.max(...o.map(u=>u.y)),right:Math.max(...o.map(u=>u.x)),bottom:Math.min(...o.map(u=>u.y)),left:Math.min(...o.map(u=>u.x))},this.annotService.putModel(s);let c={from:"AnnotComponent",sdEventType:pe.CREATE,pageIdx:i.i,annot:s};this.contentService.fireAnnotEvent(c),this.contentService.fireAnnotListEvent(c)}),this.comp.selectTextService.publishSelectedText(null)}SLIDESHOW(){this.comp.viewerService.setSlideshow()}SAVE(){this.comp.changeService.saveDocument()}GO_TO_FIRST_PAGE(){this.movePage(0)}GO_TO_LAST_PAGE(){this.movePage(this.comp.pageCount)}GO_TO_PREVIOUS_PAGE(){this.movePage(this.comp.currentPageNo-1)}GO_TO_NEXT_PAGE(){this.movePage(this.comp.currentPageNo+1)}ZOOM_IN(){this.setZoom(10,!0)}ZOOM_OUT(){this.setZoom(-10,!0)}MATCH_HEIGHT(){this.contentService.requestViewChange({fitMode:1})}MATCH_WIDTH(){this.contentService.requestViewChange({fitMode:0})}FIT(){this.contentService.requestViewChange({fitMode:3})}FIT_TO_ACTUAL_SIZE(){this.contentService.requestViewChange({fitMode:4})}ROTATE_CW(){this.setDocumentRotation(-90)}ROTATE_CCW(){this.setDocumentRotation(90)}SELECT_ANNOT_TOOL(){this.setDragMode(Ae.SELECT_ANNOT)}SELECT_TEXT(){this.setDragMode(Ae.SELECT_TEXT)}SCROLL_MODE(){this.setDragMode(Ae.MOVE)}PRINT(){this.comp.dialogService.toggleDialogVisibility(Ks.PRINT,!0)}DOWNLOAD(){this.comp.downloadService.downloadDocument()}movePage(n){this.contentService.requestViewChange({pageNo:n})}setZoom(n,i=!1){let e=this.comp.scale+n;typeof e!="number"||!isFinite(e)||isNaN(e)||(this.contentService.requestViewChange({scale:e,checkScale:i}),this.comp.changeDetectorRef.markForCheck())}setDocumentRotation(n){this.contentService.requestViewChange({degree:this.comp.degree-n})}setDragMode(n){this.comp.store$.dispatch(ft.set({key:"dragMode",value:n})),this.comp.store$.dispatch(Fi.unselectTool()),this.annotService.closeEditor()}};Z([Se(Q.contextMenuComp.highlight)],ni.prototype,Va,null);Z([Se(Q.contextMenuComp.strikeout)],ni.prototype,Ua,null);Z([Se(Q.contextMenuComp.underline)],ni.prototype,Ba,null);Z([Se(Q.contextMenuComp.createLink)],ni.prototype,Ga,null);Z([Se(Q.contextMenuComp.copy)],ni.prototype,Wa,null);Z([Se(Q.contextMenuComp.search)],ni.prototype,Ha,null);Z([Se(Q.contextMenuComp.redaction)],ni.prototype,za,null);var x0=(()=>{let n=class n{};E(n,"\u0275fac",function(t){return new(t||n)}),E(n,"\u0275mod",ot({type:n})),E(n,"\u0275inj",nt({providers:[Vt],imports:[rt,kt,uo]}));let r=n;return r})();var Dr=class{_value;get value(){return this._value}constructor(n=0){this._value=n}next(){return++this._value}},fp=new Dr,li={create:To("[GuideLine] Create GuideLine",Ao()),update:To("[GuideLine] Update GuideLine",Ao()),remove:To("[GuideLine] Remove GuideLine",Ao())},gp=Ms({pages:{}},Io(li.create,(r,n)=>{let{pageIndex:i,guideLine:e}=n.payload,t=r.pages[i]??{lines:[],selected:-1},o=Qe(ge({},e),{id:fp.next()});return Qe(ge({},r),{pages:Qe(ge({},r.pages),{[i]:{lines:Qe(ge({},t.lines),{[o.id]:o}),selected:o.id}})})}),Io(li.update,(r,n)=>{let{pageIndex:i,guideLine:e}=n.payload,t=r.pages[i]??{lines:{},selected:-1};return Qe(ge({},r),{pages:Qe(ge({},r.pages),{[i]:{lines:Qe(ge({},t.lines),{[e.id]:e}),selected:e.id}})})}),Io(li.remove,(r,n)=>{let{pageIndex:i,guideLine:e}=n.payload,t=r.pages[i]??{lines:{},selected:-1};return Qe(ge({},r),{pages:Qe(ge({},r.pages),{[i]:{lines:Qe(ge({},t.lines),{[e.id]:void 0}),selected:t.selected===e.id?-1:t.selected}})})}));function ja(r,n){return gp(r,n)}var wr="guideLine";function $a(){return Wn(Eo(Ps(wr)))}function Wo(r){return Wn($a(),Eo(n=>n.pages[r]?.lines??{}))}function Ya(r){return Wn($a(),Eo(n=>{let i=n.pages[r]??{lines:{},selected:-1};return i.lines[i.selected]??null}))}function Cp(r,n){if(r&1){let i=M();h(0,"div",1),I("mousedown",function(){let t=f(i).$implicit,o=d();return g(o.onMousedown(t))}),_()}if(r&2){let i=n.$implicit,e=d();p("ngStyle",e.getLineStyles(i))}}var B0=(()=>{let n=class n{elementRef;changeDetectorRef;subscriptionService;store$;shortcutService;loggingService;pdfPage;get guideLineArray(){return S.isDefined(this.guideLines)?Object.values(this.guideLines).filter(S.isDefined):[]}guideLines;selectedLine=null;scale;degree;constructor(e,t,o,s,c,u){this.elementRef=e,this.changeDetectorRef=t,this.subscriptionService=o,this.store$=s,this.shortcutService=c,this.loggingService=u}trackByGuideLine=(e,t)=>t.id;ngOnInit(){this.subscriptionService.push(this.store$.pipe(Wo(this.pdfPage.i)).subscribe({next:e=>{this.guideLines=e,this.changeDetectorRef.markForCheck()}}),this.store$.pipe(Ya(this.pdfPage.i)).subscribe({next:e=>{this.selectedLine=e,this.selectedLine&&this.selectedLine.offset<0&&this.listenGuideLineMove(this.selectedLine)}}),this.store$.pipe(le("scale")).subscribe({next:e=>this.scale=e}),this.store$.pipe(le("degree")).subscribe({next:e=>{this.degree=e,this.changeDetectorRef.markForCheck()}}),this.shortcutService.getShortcutEvent(yt.DELETE_GUIDELINE).pipe(ns(this.store$.pipe(le("currentPageNo"))),w(([e,t])=>this.pdfPage.i===t-1)).subscribe({next:()=>{if(this.selectedLine===null){this.loggingService.common("warn",Ee.NOT_EXIST,"selectedLine");return}this.store$.dispatch(li.remove({payload:{pageIndex:this.pdfPage.i,guideLine:this.selectedLine}}))}}))}onMousedown(e){this.listenGuideLineMove(e)}getLineStyles(e){let t=D.normalizeDegree(this.degree+this.pdfPage.r+(e.isVertical?90:0)),o=`${Math.max(n.LINE_WIDTH/(this.scale/100),1)}px`,s={backgroundColor:"#FF6100"};return ge({position:"absolute",display:e.offset<0?"none":"block",top:e.isVertical?"0px":`${e.offset}px`,left:e.isVertical?`${e.offset}px`:"0px",width:e.isVertical?o:`${this.pdfPage.bbox.w}px`,height:e.isVertical?`${this.pdfPage.bbox.h}px`:o,backgroundColor:"#036FFC",backgroundClip:"padding-box",cursor:t===0||t===180?"row-resize":"col-resize",zIndex:String(D.LayoutOrder.GuideLine)},e.id===this.selectedLine?.id?s:{})}listenGuideLineMove(e){let t=this.elementRef.nativeElement.parentElement;if(!S.isDefined(t))throw new vt("Page element is not defined");let o=D.normalizeDegree(this.degree+this.pdfPage.r+(e.isVertical?90:0)),s=o===0||o===180?"row-resizing":"col-resizing";document.body.classList.add(s),this.selectedLine=e,this.subscriptionService.push(we(t,"mousemove",{capture:!0}).pipe($n(Et(we(window,"mouseup",{capture:!0}),we(t,"mouseleave")))).subscribe({next:c=>{let u=this.getPageOffset(c.target,{offsetX:c.offsetX,offsetY:c.offsetY});if(this.selectedLine===null){this.loggingService.common("warn",Ee.NOT_EXIST,"selectedLine");return}this.selectedLine=ge({},this.selectedLine),this.selectedLine.offset=this.selectedLine.isVertical?u.offsetX:u.offsetY,this.guideLines=Qe(ge({},this.guideLines),{[this.selectedLine.id]:this.selectedLine}),this.changeDetectorRef.markForCheck()},complete:()=>{if(this.selectedLine===null){this.loggingService.common("warn",Ee.NOT_EXIST,"selectedLine");return}this.selectedLine.offset<0?this.store$.dispatch(li.remove({payload:{pageIndex:this.pdfPage.i,guideLine:this.selectedLine}})):this.store$.dispatch(li.update({payload:{pageIndex:this.pdfPage.i,guideLine:this.selectedLine}})),document.body.classList.remove(s)}}))}getPageOffset(e,t){return e.matches("sd-page")?t:!e.offsetParent||e.offsetWidth===0||e.offsetHeight===0?this.getPageOffset(e.parentNode,t):this.getPageOffset(e.parentNode,{offsetX:t.offsetX+e.offsetLeft,offsetY:t.offsetY+e.offsetTop})}};E(n,"LINE_WIDTH",1),E(n,"\u0275fac",function(t){return new(t||n)(m(re),m($),m(R),m(me),m(Qi),m(ze))}),E(n,"\u0275cmp",H({type:n,selectors:[["sd-guide-line"]],inputs:{pdfPage:"pdfPage"},standalone:!1,features:[j([R])],decls:1,vars:2,consts:[[3,"ngStyle","mousedown",4,"ngFor","ngForOf","ngForTrackBy"],[3,"mousedown","ngStyle"]],template:function(t,o){t&1&&y(0,Cp,1,1,"div",0),t&2&&p("ngForOf",o.guideLineArray)("ngForTrackBy",o.trackByGuideLine)},dependencies:[De,_e],encapsulation:2}));let r=n;return r})();var Ho=(()=>{let n=class n{scaleWrapperOffsetSrc=new _r(1);scaleWrapperOffset$=this.scaleWrapperOffsetSrc.asObservable();scrollOffsetSrc=new _r(1);scrollOffset$=this.scrollOffsetSrc.asObservable();publishContentViewOffset(e){this.scaleWrapperOffsetSrc.next(e)}publishScrollOffset(e){this.scrollOffsetSrc.next(e)}};E(n,"\u0275fac",function(t){return new(t||n)}),E(n,"\u0275prov",Yt({token:n,factory:n.\u0275fac}));let r=n;return r})();var Ap=()=>({isVertical:!1,className:"horizontal"}),Ep=()=>({isVertical:!0,className:"vertical"});function Sp(r,n){r&1&&bi(0)}function Ip(r,n){r&1&&bi(0)}function xp(r,n){if(r&1&&(J(),h(0,"text"),P(1),_()),r&2){let i=n.$implicit,e=d(2);B("font-size",e.markerFontSize)("x",i.x)("y",i.y),l(),L(i.content)}}function vp(r,n){if(r&1){let i=M();h(0,"div",3),I("click",function(t){let o=f(i).isVertical,s=d();return g(s.onRulerClick(o,t))})("mousedown",function(t){let o=f(i).isVertical,s=d();return g(s.onRulerMousedown(o,t))}),J(),h(1,"svg"),x(2,"path")(3,"path"),y(4,xp,2,4,"text",4),_()()}if(r&2){let i=n.isVertical,e=n.className,t=d();p("ngClass",e)("ngStyle",t.getRulerStyles(i)),l(),Ye("transform",i?"translate(0, "+t.rulerOffset.offsetY+"px)":"translate("+t.rulerOffset.offsetX+"px, 0)"),l(),B("d",t.rendered[e].d),l(),B("d",t.mousePath[e]),l(),p("ngForOf",t.rendered[e].texts)}}var pn=class pn{elementRef;changeDetectorRef;subscriptionService;store$;pageService;guideLineService;unitPipe;markerFontSize=12;get rulerUnit(){return this.unitPipe.transform(this.scale>=250?K.MILLIMETER:K.CENTIMETER)}mousePath={horizontal:"",vertical:""};rulerOffset={offsetX:0,offsetY:0};rendered={horizontal:{d:"",texts:[]},vertical:{d:"",texts:[]}};scale;degree;pdfPage;cornerStyles={width:`${36}px`,height:`${36}px`};constructor(n,i,e,t,o,s,c){this.elementRef=n,this.changeDetectorRef=i,this.subscriptionService=e,this.store$=t,this.pageService=o,this.guideLineService=s,this.unitPipe=c}ngOnInit(){this.initSubscriptions()}getRulerStyles(n){let i={top:"0px",left:"0px"};return i[n?"top":"left"]=`${36}px`,i[n?"width":"height"]=`${36}px`,i[n?"height":"width"]=`calc(100% - ${36}px)`,i}render(n){this.rulerOffset=n;let i=D.normalizeScale(this.scale),e=s=>Ue.convert(K.POINT,this.rulerUnit,s/i),t={offsetX:e(n.offsetX),offsetY:e(n.offsetY),width:e(n.width),height:e(n.height)},o={horizontal:this.fixRange({min:-t.offsetX,max:t.width-t.offsetX}),vertical:this.fixRange({min:-t.offsetY,max:t.height-t.offsetY})};this.rendered.horizontal=this.renderRuler(this.rulerUnit,o.horizontal,i,!1),this.rendered.vertical=this.renderRuler(this.rulerUnit,o.vertical,i,!0),this.changeDetectorRef.markForCheck()}onRulerClick(n,i){let e=(n?i.offsetY:i.offsetX)/D.normalizeScale(this.scale),t=D.normalizeDegree(this.pdfPage.r+this.degree+(n?0:90)),o={isVertical:t===90||t===270,offset:e};e<0||(o.isVertical?this.pdfPage.bbox.w:this.pdfPage.bbox.h)<e||(t===180?o.offset=this.pdfPage.bbox.h-o.offset:t===270&&(o.offset=this.pdfPage.bbox.w-o.offset),this.createGuidelineForStatistics(xr.DRAW_ADJOINT_LINE_BY_CLICK,o))}onRulerMousedown(n,i){let e=D.normalizeDegree(this.pdfPage.r+this.degree+(n?90:0)),t={offset:-1,isVertical:e===90||e===270};this.subscriptionService.push(we(i.currentTarget,"mouseleave").pipe($n(we(window,"mouseup",{capture:!0})),Mt(1)).subscribe({next:()=>this.createGuidelineForStatistics(xr.DRAW_ADJOINT_LINE_BY_DRAG,t)}))}createGuideline(n){this.store$.dispatch(li.create({payload:{guideLine:n,pageIndex:this.pdfPage.i}}))}createGuidelineForStatistics(n,i){this.createGuideline(i)}initSubscriptions(){this.subscriptionService.push(we(window,"mousemove",{capture:!0}).subscribe({next:n=>{let i=this.elementRef.nativeElement.getBoundingClientRect(),e=(n.clientX-i.left-36-this.rulerOffset.offsetX).toFixed(3),t=(n.clientY-i.top-36-this.rulerOffset.offsetY).toFixed(3);this.mousePath={horizontal:`M ${e} 0 L ${e} ${36}`,vertical:`M 0 ${t} L ${36} ${t}`},this.changeDetectorRef.markForCheck()}}),An([this.store$.pipe(le("currentPageNo")),this.pageService.pdfPages$]).pipe(Ve({next:([n,i])=>this.pdfPage=i[n-1]}),Tt(()=>An([this.guideLineService.scaleWrapperOffset$,this.guideLineService.scrollOffset$])),qr(1),_t(([n,i])=>({offsetX:n.offsetX-i.offsetX,offsetY:n.offsetY-i.offsetY,width:n.width,height:n.height}))).subscribe({next:n=>this.render(n)}),this.store$.pipe(le("scale")).subscribe({next:n=>this.scale=n}),this.store$.pipe(le("degree")).subscribe({next:n=>this.degree=n}))}renderRuler(n,i,e,t){let o={d:"",texts:[]};for(let s=i.min;s<=i.max;++s){let c=s%10===0?36:s%5===0?36/2:36/4,u=Number(Ue.convert(n,K.POINT,s*e).toFixed(3)),C=u,N=0,O=u,U=c;if(t&&([C,N]=[N,C],[O,U]=[U,O]),o.d+=`M ${C} ${N} L ${O} ${U}`,s%10===0){let z=u,Me=c;t&&([z,Me]=[Me,z]),z+=3,Me-=3,o.texts.push({x:z,y:Me,content:s})}}return o}fixRange(n){return{min:Math[n.min>0?"ceil":"floor"](n.min),max:Math[n.min>0?"floor":"ceil"](n.max)}}};E(pn,"\u0275fac",function(i){return new(i||pn)(m(re),m($),m(R),m(me),m(ut),m(Ho),m(Ai))}),E(pn,"\u0275cmp",H({type:pn,selectors:[["sd-ruler"]],standalone:!1,features:[j([R])],decls:5,vars:7,consts:[["svgTemplateRef",""],[1,"corner",3,"ngStyle"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"ruler-container",3,"click","mousedown","ngClass","ngStyle"],[4,"ngFor","ngForOf"]],template:function(i,e){if(i&1&&(x(0,"div",1),y(1,Sp,1,0,"ng-container",2)(2,Ip,1,0,"ng-container",2)(3,vp,5,7,"ng-template",null,0,ke)),i&2){let t=Oe(4);p("ngStyle",e.cornerStyles),l(),p("ngTemplateOutlet",t)("ngTemplateOutletContext",oe(5,Ap)),l(),p("ngTemplateOutlet",t)("ngTemplateOutletContext",oe(6,Ep))}},dependencies:[je,De,ds,_e],styles:["div.corner[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:2;box-sizing:border-box;border-right:1px solid var(--mono-30);border-bottom:1px solid var(--mono-30);background-color:var(--mono-00)}.ruler-container[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;background-color:var(--mono-00)}.ruler-container.horizontal[_ngcontent-%COMP%]{z-index:1;border-bottom:1px solid var(--mono-30)}.ruler-container.vertical[_ngcontent-%COMP%]{border-right:1px solid var(--mono-30)}svg[_ngcontent-%COMP%]{width:100%;height:100%;overflow:visible}svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]{stroke:var(--mono-99);stroke-width:1;fill:transparent}svg[_ngcontent-%COMP%]   text[_ngcontent-%COMP%]{stroke:var(--mono-99)}"],changeDetection:0}));var zo=pn;Z([Se(Q.rulerComp.ngOnInit)],zo.prototype,"ngOnInit",null);Z([Se(Q.rulerComp.createGuidelineForStatistics)],zo.prototype,"createGuidelineForStatistics",null);var lC=(()=>{let n=class n{static forRoot(){return{ngModule:n,providers:[Ho]}}};E(n,"\u0275fac",function(t){return new(t||n)}),E(n,"\u0275mod",ot({type:n})),E(n,"\u0275inj",nt({imports:[rt,So.forFeature(wr,ja)]}));let r=n;return r})();var Op=["*"];function bp(r,n){if(r&1){let i=M();h(0,"div",1),I("click",function(){let t=f(i).$implicit,o=d();return o.selectedTab=t,g(o.selectedTabChange.emit(t))}),P(1),T(2,"translate"),_()}if(r&2){let i=n.$implicit,e=d();G("active",i===e.selectedTab),l(),Re(" ",A(2,3,i)," ")}}var jo=(()=>{let n=class n{tabItems=[];selectedTab;selectedTabChange=new Ge};E(n,"\u0275fac",function(t){return new(t||n)}),E(n,"\u0275cmp",H({type:n,selectors:[["e-tab-panel"]],inputs:{tabItems:"tabItems",selectedTab:"selectedTab"},outputs:{selectedTabChange:"selectedTabChange"},standalone:!1,ngContentSelectors:Op,decls:3,vars:1,consts:[["class","tab-item",3,"active","click",4,"ngFor","ngForOf"],[1,"tab-item",3,"click"]],template:function(t,o){t&1&&(as(),h(0,"header"),y(1,bp,3,5,"div",0),_(),cs(2)),t&2&&(l(),p("ngForOf",o.tabItems))},styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;flex:1;border-top:1px solid #DADADA;margin-top:10px}header[_ngcontent-%COMP%]{height:60px;box-sizing:border-box;background-color:#fff;border-top:1px solid #DADADA;border-left:1px solid #DADADA;border-right:1px solid #DADADA;border-top-left-radius:4px;border-top-right-radius:4px;display:flex;z-index:1}.tab-item[_ngcontent-%COMP%]{cursor:pointer;padding:16px 14px;font-family:NotoSans-Regular;font-size:14px;line-height:14px;letter-spacing:-.5px;color:#6c6c6c}.tab-item.active[_ngcontent-%COMP%]{font-family:NotoSans-Medium;border-top:3px solid #1E1E1E;padding-top:13px}"],changeDetection:0}));let r=n;return r})();var Ka=(()=>{let n=class n{};E(n,"\u0275fac",function(t){return new(t||n)}),E(n,"\u0275mod",ot({type:n})),E(n,"\u0275inj",nt({imports:[rt,kt]}));let r=n;return r})();Le(jo,[De],[ee]);var $o=new os("sd-instant-data"),Vi=class{_componentInstance;_onEvent=new it;_beforeClosed=new it;_afterClosed=new it;beforeClosed(){return this._beforeClosed.asObservable().pipe(Mt(1))}afterClosed(){return this._afterClosed.asObservable().pipe(Mt(1))}onEvent(){return this._onEvent.asObservable()}emit(n){this._onEvent.next(n)}close(n){this._componentInstance.onDestroy(()=>{this._afterClosed.next(n),this._afterClosed.unsubscribe(),this._beforeClosed.unsubscribe(),this._onEvent.unsubscribe()}),this._beforeClosed.next(n),this._componentInstance.destroy()}};var Yo=(()=>{let n=class n{injector;constructor(e){this.injector=e}instant(e,t,o){let s=new Vi,c=Yn.create({parent:this.injector,providers:[{provide:$o,useValue:o},{provide:Vi,useValue:s}]}),u=e.createComponent(t,{index:null,injector:c});return s._componentInstance=u,u.changeDetectorRef.detectChanges(),s}};E(n,"\u0275fac",function(t){return new(t||n)(It(Yn))}),E(n,"\u0275prov",Yt({token:n,factory:n.\u0275fac}));let r=n;return r})();var vi=function(r){return r.CREATE="create",r.EDIT="edit",r}(vi||{}),Xo=(()=>{let n=class n{regexModalParam;modalService;portalRef;subscriptionService;formBuilder;elementRef;regexForm;get RegexModalType(){return vi}get type(){return this.regexModalParam.type}constructor(e,t,o,s,c,u){this.regexModalParam=e,this.modalService=t,this.portalRef=o,this.subscriptionService=s,this.formBuilder=c,this.elementRef=u,this.regexForm=this.formBuilder.group({id:this.formBuilder.nonNullable.control(""),title:this.formBuilder.nonNullable.control(""),content:this.formBuilder.nonNullable.control("")})}ngOnInit(){this.type===vi.EDIT&&(this.regexForm.controls.id.setValue(this.regexModalParam.name),this.regexForm.controls.title.setValue(this.regexModalParam.name),this.regexForm.controls.content.setValue(this.regexModalParam.description)),this.subscriptionService.push(we(window,"keydown",{capture:!0}).pipe(w(e=>e.key==="Escape"),w(()=>this.modalService.lastModal===this.portalRef)).subscribe({next:()=>this.onButtonClick(!1)})),this.elementRef.nativeElement.parentElement.style.minWidth="460px"}onButtonClick(e){this.portalRef.dispose(e?this.regexForm.value:void 0)}};E(n,"\u0275fac",function(t){return new(t||n)(m(Hi),m(bt),m(Kt),m(R),m(gi),m(re))}),E(n,"\u0275cmp",H({type:n,selectors:[["sd-regex-modal"]],standalone:!1,features:[j([R])],decls:24,vars:22,consts:[[1,"papycon","papycon-cross",3,"click"],[1,"container",3,"formGroup"],[1,"input-container"],["formControlName","title",3,"placeholder"],["formControlName","content",3,"placeholder"],["size","small","color","white",1,"ep-button",3,"click"],["size","small","color","primary",1,"ep-button",3,"click"]],template:function(t,o){t&1&&(h(0,"h3"),P(1),T(2,"translate"),h(3,"i",0),I("click",function(){return o.onButtonClick(!1)}),_()(),h(4,"main",1)(5,"div",2)(6,"span"),P(7),T(8,"translate"),_(),x(9,"pu-input",3),T(10,"translate"),_(),h(11,"div",2)(12,"span"),P(13),T(14,"translate"),_(),x(15,"textarea",4),T(16,"translate"),_()(),h(17,"footer")(18,"button",5),I("click",function(){return o.onButtonClick(!1)}),P(19),T(20,"translate"),_(),h(21,"button",6),I("click",function(){return o.onButtonClick(!0)}),P(22),T(23,"translate"),_()()),t&2&&(l(),Re(" ",A(2,8,o.type===o.RegexModalType.CREATE?"ADD_USER_DEFINED_REGEX":"EDIT_REGEX_HEADER")," "),l(3),p("formGroup",o.regexForm),l(3),L(A(8,10,"TITLE")),l(2),p("placeholder",A(10,12,"NEW_TEMPLATE")),l(4),L(A(14,14,"REGEX_HEADER")),l(2),p("placeholder",A(16,16,"REGEX_HEADER_TEXTAREA_PLACEHOLDER")),l(4),L(A(20,18,"CANCEL")),l(3),L(A(23,20,"OK")))},styles:["h3[_ngcontent-%COMP%]{font-size:20px;line-height:28px;font-family:NotoSans-Medium,sans-serif;color:#1e1e1e;display:flex;margin:8px 0;justify-content:space-between;align-items:flex-start}h3[_ngcontent-%COMP%]   .papycon-cross[_ngcontent-%COMP%]{font-size:13px;line-height:22px;cursor:pointer;width:22px;height:22px;text-align:center;color:#6c6c6c;margin-right:0}main[_ngcontent-%COMP%]{font-size:13px;line-height:22px;color:#6c6c6c;white-space:pre-wrap;display:block;flex-direction:column;align-items:center}main[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1}main[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-family:NotoSans-Medium;font-size:13px;letter-spacing:-.5px;color:#6c6c6c}main[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   pu-input[_ngcontent-%COMP%]{height:40px}main[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   pu-input[_ngcontent-%COMP%]  input{padding:0 8px}main[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{border-radius:2px;border:solid 1.2px #DADADA;background-color:#fff;padding:8px;font-family:NotoSans-Regular;font-size:14px}main[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]:first-child{margin-top:16px}main[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]:last-child{margin-top:11px}main[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]:last-child   textarea[_ngcontent-%COMP%]{height:260px}footer[_ngcontent-%COMP%]{text-align:right;margin-top:20px}footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] + button[_ngcontent-%COMP%]{margin-left:12px}"],changeDetection:0}));let r=n;return r})();var Rp=["configItem"],Np=["puDropdown"],Pp=["puRadioButton"],Mp=r=>({marginRight:r}),Za=r=>({fontSize:r}),Dp=r=>({content:r,className:"with-icon"}),wp=r=>({"background-color":r}),Lp=()=>({color:"#6C6C6C"});function Fp(r,n){if(r&1&&(h(0,"div",20),x(1,"i",21),_()),r&2){let i=n.$implicit,e=n.index,t=d(2);p("ngStyle",at(3,Mp,e===t.item.data.icons.length-1?"8px":"")),l(),p("ngClass","papycon-"+i)("ngStyle",at(5,Za,t.item.data.iconSize))}}function kp(r,n){if(r&1){let i=M();h(0,"i",22),I("click",function(t){f(i);let o=d(2);return t.stopPropagation(),g(o.onNestedItemClick(o.item))}),_()}if(r&2){let i=d(2);p("@chevron",i.item.expanded)}}function Vp(r,n){if(r&1){let i=M();h(0,"pu-radio-button",23,2),T(2,"translate"),ce("ngModelChange",function(t){f(i);let o=d(2);return se(o.radioConfig[o.item.parent.data.key].value,t)||(o.radioConfig[o.item.parent.data.key].value=t),g(t)}),I("ngModelChange",function(){f(i);let t=d(2);return g(t.radioModelChange())}),_()}if(r&2){let i=d(2);p("disabled",i.item.data.disable||i.isDisabled())("label",A(2,4,i.item.data.name))("value",i.item.data.key),ae("ngModel",i.radioConfig[i.item.parent.data.key].value)}}function Up(r,n){if(r&1&&(h(0,"span",24),P(1),T(2,"translate"),_()),r&2){let i=d(2);l(),L(A(2,1,i.item.data.name))}}function Bp(r,n){if(r&1&&(x(0,"i",25),T(1,"translate")),r&2){let i=d(2);p("tooltip",at(3,Dp,A(1,1,i.item.data.tooltip)))}}function Gp(r,n){if(r&1){let i=M();h(0,"div",26)(1,"i",27),I("click",function(){f(i);let t=d(2);return g(t.openRegexModal(t.RegexModalType.EDIT))}),_(),h(2,"i",28),I("click",function(){f(i);let t=d(2);return g(t.deleteRegexItem())}),_()()}}function Wp(r,n){if(r&1&&(h(0,"span",29),P(1),T(2,"translate"),_()),r&2){let i=d(2);G("disabled",i.isDisabled()),l(),L(A(2,3,i.configDescriptions[i.radioConfig[i.item.data.key].value].name))}}function Hp(r,n){if(r&1){let i=M();h(0,"pu-toggle-button",30),ce("ngModelChange",function(t){f(i);let o=d(2);return se(o.item.data.value,t)||(o.item.data.value=t),g(t)}),I("click",function(t){return f(i),g(t.stopPropagation())})("ngModelChange",function(){f(i);let t=d(2);return g(t.toggle())}),_()}if(r&2){let i=d(2);G("disabled",i.item.data.disable||i.isDisabled()),ae("ngModel",i.item.data.value)}}function zp(r,n){r&1&&x(0,"i",36)}function jp(r,n){if(r&1){let i=M();h(0,"div",37)(1,"pu-color-picker",38),I("cancel",function(){f(i);let t=d(3);return g(t.colorPickerOpened=!1)})("confirm",function(t){f(i);let o=d(3);return g(o.onColorChange(t))}),_()()}if(r&2){let i=d(3);l(),p("inputColor",i.item.data.value)}}function $p(r,n){if(r&1){let i=M();h(0,"div",31)(1,"div",32),I("click",function(){f(i);let t=d(2);return g(t.colorPickerOpened=!0)}),y(2,zp,1,0,"i",33),_(),h(3,"pu-input",34),ce("ngModelChange",function(t){f(i);let o=d(2);return se(o.item.data.value,t)||(o.item.data.value=t),g(t)}),I("focus",function(){f(i);let t=d(2);return g(t.colorPickerOpened=!1)})("ngModelChange",function(t){f(i);let o=d(2);return g(o.onColorChange(t))}),_(),y(4,jp,2,1,"div",35),_()}if(r&2){let i=d(2);G("disabled",i.item.data.disable||i.isDisabled()),l(),p("ngStyle",at(9,wp,i.item.data.value)),l(),p("ngIf",!i.validateColor(i.item.data.value)),l(),p("inputStyle",oe(11,Lp))("maxLength",7)("placeholder",i.getDefaultRuntimeEnv(i.item.data.key)),ae("ngModel",i.item.data.value),l(),p("ngIf",i.colorPickerOpened)}}function Yp(r,n){if(r&1){let i=M();h(0,"pu-dropdown",39,3),ce("ngModelChange",function(t){f(i);let o=d(2);return se(o.item.data.value,t)||(o.item.data.value=t),g(t)}),I("ngModelChange",function(t){f(i);let o=d(2);return g(o.onDropDownChange(t))}),_()}if(r&2){let i=d(2);p("disabled",i.item.data.disable||i.isDisabled())("options",i.item.data.options),ae("ngModel",i.item.data.value)}}function Xp(r,n){if(r&1){let i=M();h(0,"pu-input",40),ce("ngModelChange",function(t){f(i);let o=d(2);return se(o.item.data.value,t)||(o.item.data.value=t),g(t)}),I("ngModelChange",function(t){f(i);let o=d(2);return g(o.onTextChange(t))}),_()}if(r&2){let i=d(2);p("disabled",i.item.data.disable),ae("ngModel",i.item.data.value)}}function Kp(r,n){if(r&1&&(y(0,Fp,2,7,"div",7)(1,kp,1,1,"i",8),h(2,"div",9),y(3,Vp,3,6,"pu-radio-button",10)(4,Up,3,3,"span",11)(5,Bp,2,5,"i",12),h(6,"div",13),P(7),T(8,"translate"),_(),y(9,Gp,3,0,"div",14),_(),y(10,Wp,3,5,"span",15)(11,Hp,1,3,"pu-toggle-button",16)(12,$p,5,12,"div",17)(13,Yp,2,3,"pu-dropdown",18)(14,Xp,1,2,"pu-input",19)),r&2){let i=d();p("ngForOf",i.item.data.icons),l(),p("ngIf",i.hasChildren),l(),G("editable",i.item.data.editable),l(),p("ngIf",i.radioConfig[i.item.parent==null?null:i.item.parent.data.key]&&i.item.data.isRadio),l(),p("ngIf",!i.item.data.isRadio||i.radioConfig[i.item.data.key]),l(),p("ngIf",i.item.data.tooltip),l(2),L(A(8,14,i.item.data.description)),l(2),p("ngIf",i.item.data.editable),l(),p("ngIf",i.radioConfig[i.item.data.key]),l(),p("ngIf",i.visibleToggleButton),l(),p("ngIf",i.item.data.isColorPicker),l(),p("ngIf",i.item.data.isDropDown),l(),p("ngIf",i.item.data.isText)}}function Qp(r,n){if(r&1){let i=M();h(0,"button",41),I("click",function(){f(i);let t=d();return g(t.openRegexModal(t.RegexModalType.CREATE))}),x(1,"i",21),h(2,"span"),P(3),T(4,"translate"),_()()}if(r&2){let i=d();l(),p("ngClass","papycon-"+i.item.data.icons[0])("ngStyle",at(5,Za,i.item.data.iconSize)),l(2),L(A(4,3,"ADD_USER_DEFINED_REGEX"))}}function Zp(r,n){r&1&&x(0,"div",42)}var Lr=(()=>{let n=class n{ngControl;changeDetectorRef;configsService;modalService;translatePipe;item;onRegexDialogConfirm=new Ge;onRegexDelete=new Ge;onToggle=new Ge;onRadioModelChange=new Ge;onColorModelChange=new Ge;onDropDownModelChange=new Ge;onTextModelChange=new Ge;configItemRef;puDropdown;puRadioButton;get setDuration(){return{value:"",params:{duration:this.item.data.depth?400:0}}}get RegexModalType(){return vi}get configDescriptions(){return wo}get IgnoredKey(){return W}get radioConfig(){return this.configsService.radioConfig}get RuntimeEnvKey(){return a}get hasChildren(){return this.item.children.length>0&&this.item.data.depth!==void 0&&this.item.data.depth>=0}get visibleToggleButton(){return!this.item.data.isRadio&&!this.item.data.isColorPicker&&!this.item.data.isDropDown&&!this.item.data.isText&&!this.item.data.isDummy}colorPickerOpened=!1;isShownWarningModal=!1;constructor(e,t,o,s,c){this.ngControl=e,this.changeDetectorRef=t,this.configsService=o,this.modalService=s,this.translatePipe=c,e&&(this.ngControl.valueAccessor=this)}ngAfterViewInit(){we(this.configItemRef.nativeElement,"click",{capture:!0}).subscribe({next:e=>this.onHasWarningItemClick(e)})}getDefaultRuntimeEnv(e){return v(e)}validateColor(e){return!!Mi.parseRgbString(e)}isDisabled(){return this.item.data.deps!==void 0&&this.item.data.deps.some(e=>!Y.get(e))}onNestedItemClick(e){e.children.length!==0&&(e.expanded=!e.expanded)}openRegexModal(e){let t={type:vi.CREATE};e===vi.EDIT&&(t.type=vi.EDIT,t.name=this.item.data.name,t.description=this.item.data.description),this.modalService.createModal(Xo,t).addOnDisposeListener(o=>{S.isDefined(o)&&this.onRegexDialogConfirm.emit({type:t.type,values:o})})}showWarningModal(e,t){this.configsService.fireOpenWarningModal({content:e,onDispose:t})}onHasWarningItemClick(e){let t=this.item.data.warning,o=e.target,s=u=>u.tagName==="INPUT"||this.item.data.isRadio&&this.puRadioButton.element.nativeElement.contains(u)||this.item.data.isDropDown&&this.puDropdown.element.nativeElement.contains(u),c=()=>pt.isObject(t.triggerValue)?JSON.stringify(t.triggerValue)!==JSON.stringify(this.item.data.value):t.triggerValue!==this.item.data.value;!t||this.isShownWarningModal||!(o instanceof HTMLElement)||!s(o)||!c()||(e.preventDefault(),e.stopPropagation(),this.isShownWarningModal=!0,this.showWarningModal(this.translatePipe.transform(t.message),u=>{u&&o.click()}))}toggle(){this.onToggle.emit()}onColorChange(e){this.item.data.value=e,this.onColorModelChange.emit(this.item),this.colorPickerOpened=!1}onDropDownChange(e){this.onDropDownModelChange.emit(e)}onTextChange(e){this.onTextModelChange.emit(e)}radioModelChange(){this.onRadioModelChange.emit()}deleteRegexItem(){this.onRegexDelete.emit()}registerOnChange(e){this.avcChanger(e)}registerOnTouched(){}writeValue(e){this.avcChanger(e),this.item.data.value=e,this.changeDetectorRef.markForCheck()}hasTopBorder(){return this.hasFullWidthBorder(this.item)||this.hasPartialWidthBorder(this.item)&&!this.hasBorder(this.findAdjacentTopNode())&&this.item.data.depth<3}hasBottomBorder(){return this.hasFullWidthBorder(this.item)&&this.item.expanded||this.hasPartialWidthBorder(this.item)&&this.findAdjacentBottomNode()!==this.item&&!this.hasFullWidthBorder(this.findAdjacentBottomNode())&&(this.item.data.depth!==2||!this.item.expanded)}hasFullWidthBorder(e){return e.data.depth===0}hasPartialWidthBorder(e){return e.data.depth>0&&e.children.length>0||e.data.depth===3&&e.isLast}hasBorder(e){return this.hasFullWidthBorder(e)||this.hasPartialWidthBorder(e)}findAdjacentTopNode(){if(this.item.data.depth===-1)return this.item;let e=this.item.parent.children.indexOf(this.item);if(e>0){let t=this.item.parent.children[e-1];for(;t.children.length>0&&t.expanded;)t=t.children[t.children.length-1];return t}return this.item.parent}findAdjacentBottomNode(){let e=this.item;if(e.expanded&&e.children.length>0)return e.children[0];for(;e.data.depth>-1;){let t=e.parent.children.indexOf(e);if(t<e.parent.children.length-1)return e.parent.children[t+1];e=e.parent}return this.item}avcChanger=e=>e};E(n,"\u0275fac",function(t){return new(t||n)(m(qn,10),m($),m(Rt),m(bt),m(ee))}),E(n,"\u0275cmp",H({type:n,selectors:[["sd-configs-item"]],viewQuery:function(t,o){if(t&1&&(te(Rp,5),te(Np,5,Xt),te(Pp,5,Xt)),t&2){let s;ie(s=ne())&&(o.configItemRef=s.first),ie(s=ne())&&(o.puDropdown=s.first),ie(s=ne())&&(o.puRadioButton=s.first)}},hostVars:1,hostBindings:function(t,o){t&2&&ss("@children",o.setDuration)},inputs:{item:"item"},outputs:{onRegexDialogConfirm:"onRegexDialogConfirm",onRegexDelete:"onRegexDelete",onToggle:"onToggle",onRadioModelChange:"onRadioModelChange",onColorModelChange:"onColorModelChange",onDropDownModelChange:"onDropDownModelChange",onTextModelChange:"onTextModelChange"},standalone:!1,decls:6,vars:20,consts:[["configItem",""],["notRegexButton",""],["puRadioButton",""],["puDropdown",""],[1,"item",3,"click","ngClass"],["class","ep-button","size","small","color","white",3,"click",4,"ngIf","ngIfElse"],["class","divider",4,"ngIf"],["class","icon-box",3,"ngStyle",4,"ngFor","ngForOf"],["class","papycon papycon-chevron2-right chevron",3,"click",4,"ngIf"],[1,"container"],[3,"disabled","label","value","ngModel","ngModelChange",4,"ngIf"],["class","name",4,"ngIf"],["class","papycon papycon-questionmark",3,"tooltip",4,"ngIf"],[1,"description"],["class","editor-tool",4,"ngIf"],["class","current-config",3,"disabled",4,"ngIf"],[3,"disabled","ngModel","ngModelChange","click",4,"ngIf"],["class","color-picker-container",3,"disabled",4,"ngIf"],["size","tiny",3,"disabled","options","ngModel","ngModelChange",4,"ngIf"],["class","text","spellcheck","false",3,"disabled","ngModel","ngModelChange",4,"ngIf"],[1,"icon-box",3,"ngStyle"],[1,"papycon",3,"ngClass","ngStyle"],[1,"papycon","papycon-chevron2-right","chevron",3,"click"],[3,"ngModelChange","disabled","label","value","ngModel"],[1,"name"],[1,"papycon","papycon-questionmark",3,"tooltip"],[1,"editor-tool"],[1,"papycon","papycon-pen",3,"click"],[1,"papycon","papycon-trash-can",3,"click"],[1,"current-config"],[3,"ngModelChange","click","ngModel"],[1,"color-picker-container"],[1,"color",3,"click","ngStyle"],["class","papycon papycon-exclamation-mark",4,"ngIf"],[1,"color-input",3,"ngModelChange","focus","inputStyle","maxLength","placeholder","ngModel"],["class","color-picker",4,"ngIf"],[1,"papycon","papycon-exclamation-mark"],[1,"color-picker"],["name","color-picker",3,"cancel","confirm","inputColor"],["size","tiny",3,"ngModelChange","disabled","options","ngModel"],["spellcheck","false",1,"text",3,"ngModelChange","disabled","ngModel"],["size","small","color","white",1,"ep-button",3,"click"],[1,"divider"]],template:function(t,o){if(t&1){let s=M();h(0,"div",4,0),I("click",function(){return f(s),g(o.onNestedItemClick(o.item))}),y(2,Kp,15,16,"ng-template",null,1,ke)(4,Qp,5,7,"button",5),_(),y(5,Zp,1,0,"div",6)}if(t&2){let s=Oe(3);G("expanded",o.item.expanded&&o.item.children.length>0)("single",o.item.children.length===0)("leaf",o.item.children.length>0)("leaf-first",o.item.isFirst)("leaf-last",o.item.isLast)("button",o.item.data.key===o.IgnoredKey.REGEX_BUTTON)("top-border",o.hasTopBorder())("bottom-border",o.hasBottomBorder()),p("ngClass","depth-"+o.item.data.depth),l(4),p("ngIf",o.item.data.key===o.IgnoredKey.REGEX_BUTTON)("ngIfElse",s),l(),p("ngIf",o.item.data.division)}},styles:["[_nghost-%COMP%]{display:block}i.papycon-questionmark[_ngcontent-%COMP%]{font-size:20px;margin-left:4px}.item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:0 30px;box-sizing:border-box}.item.top-border[_ngcontent-%COMP%]{border-top:1px solid #DADADA}.item.bottom-border[_ngcontent-%COMP%]{border-bottom:1px solid #DADADA}.item[_ngcontent-%COMP%]:not(.single){cursor:pointer}.item[_ngcontent-%COMP%]   .chevron[_ngcontent-%COMP%]{font-size:11px}.item[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{display:flex;align-items:flex-start}.item[_ngcontent-%COMP%]   .container.editable[_ngcontent-%COMP%]{max-width:422px}.item[_ngcontent-%COMP%]   .container.editable[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{flex:0 1 auto;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.item[_ngcontent-%COMP%]   .container.editable[_ngcontent-%COMP%]   .editor-tool[_ngcontent-%COMP%]{display:flex}.item[_ngcontent-%COMP%]   .container.editable[_ngcontent-%COMP%]   .editor-tool[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-left:7px;flex:0 0 auto;display:flex;align-items:center;justify-content:center;cursor:pointer;width:24px;height:24px;font-size:24px}.item.button[_ngcontent-%COMP%]{padding:10px 0 20px}.item.button[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{vertical-align:middle}.item.button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:26px;margin-right:6px}.item.depth-0[_ngcontent-%COMP%]{min-height:70px}.item.depth-0[_ngcontent-%COMP%]   .chevron[_ngcontent-%COMP%]{margin-right:8px;margin-bottom:24px}.item.depth-0[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{display:block}.item.depth-0[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{margin-top:5px}.item.depth-0.single[_ngcontent-%COMP%]{padding-left:50px}.item.depth-1[_ngcontent-%COMP%]{margin-left:90px;padding-left:0}.item.depth-1[_ngcontent-%COMP%]:not(.single)   .container[_ngcontent-%COMP%]{padding-left:12px}.item.depth-2[_ngcontent-%COMP%]{margin-left:90px;padding-left:48px;background-color:#f4f4f4}.item.depth-2[_ngcontent-%COMP%]:not(.single)   .container[_ngcontent-%COMP%]{padding-left:12px}.item.depth-2[_ngcontent-%COMP%]:not(.single){padding-left:24px}.item.depth-3[_ngcontent-%COMP%]{margin-left:90px;padding-left:48px;background-color:#f4f4f4}.item[_ngcontent-%COMP%]:not(.depth-0)   .container[_ngcontent-%COMP%]{padding:11px 0;box-sizing:border-box}.item[_ngcontent-%COMP%]:not(.depth-0)   .icon-box[_ngcontent-%COMP%]{width:24px;height:24px;display:flex;align-items:center;justify-content:center}.item[_ngcontent-%COMP%]:not(.depth-0)   .icon-box[_ngcontent-%COMP%]   .papycon[_ngcontent-%COMP%]{font-size:24px}.item[_ngcontent-%COMP%]:not(.depth-0)   .name[_ngcontent-%COMP%]{font-size:14px;width:auto}.item[_ngcontent-%COMP%]:not(.depth-0)   .description[_ngcontent-%COMP%]{margin-left:12px}.item[_ngcontent-%COMP%]:not(.depth-0)   i.papycon-questionmark[_ngcontent-%COMP%] + .description[_ngcontent-%COMP%]{margin-left:8px}.item[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-family:NotoSans-Regular,sans-serif;color:#1e1e1e;font-size:16px}.item[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]   .papycon[_ngcontent-%COMP%]{color:#6c6c6c;cursor:pointer}.item[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{font-family:NotoSans-Regular,sans-serif;font-size:14px;font-weight:400;letter-spacing:-.5px;color:#6c6c6c;flex:0 1 auto;white-space:pre}.item[_ngcontent-%COMP%]   .current-config[_ngcontent-%COMP%]{font-family:NotoSans-Regular,sans-serif;margin-left:auto;font-size:14px;font-weight:500;color:#ff6100}.item[_ngcontent-%COMP%]   .current-config.disabled[_ngcontent-%COMP%]{color:#c8c8c8}.item[_ngcontent-%COMP%]   pu-radio-button[_ngcontent-%COMP%]{width:auto}.item[_ngcontent-%COMP%]   pu-toggle-button[_ngcontent-%COMP%]{margin-left:auto}.item[_ngcontent-%COMP%]   pu-toggle-button.disabled[_ngcontent-%COMP%]{opacity:.5;pointer-events:none}.item[_ngcontent-%COMP%]   .color-picker-container[_ngcontent-%COMP%]{position:relative;display:flex;margin-left:auto}.item[_ngcontent-%COMP%]   .color-picker-container.disabled[_ngcontent-%COMP%]{opacity:.5;pointer-events:none}.item[_ngcontent-%COMP%]   .color-picker-container[_ngcontent-%COMP%]   .color[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:28px;height:28px;border-radius:50%;cursor:pointer}.item[_ngcontent-%COMP%]   .color-picker-container[_ngcontent-%COMP%]   .color[_ngcontent-%COMP%]:hover{opacity:.5}.item[_ngcontent-%COMP%]   .color-picker-container[_ngcontent-%COMP%]   .color-input[_ngcontent-%COMP%]{width:80px;height:30px;margin-left:6px}.item[_ngcontent-%COMP%]   .color-picker-container[_ngcontent-%COMP%]   .color-picker[_ngcontent-%COMP%]{position:absolute;z-index:1;left:calc(100% + 3px);padding:12px;width:216px;box-sizing:border-box;border:1.2px solid #DADADA;border-radius:2px;background-color:#fff}.item[_ngcontent-%COMP%]   pu-dropdown[_ngcontent-%COMP%]{margin-left:auto;width:77px}.item[_ngcontent-%COMP%]   pu-input.text[_ngcontent-%COMP%]{margin-left:auto;width:200px;height:40px}.item[_ngcontent-%COMP%]   pu-input.text[_ngcontent-%COMP%]  input{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.divider[_ngcontent-%COMP%]{height:1px;background-color:#dadada;margin:8px 0 8px 86px;padding-left:0}"],data:{animation:[Xi.rotate("chevron","90"),Zn("children",[In(":enter",[mi({height:"0",marginTop:"0",paddingTop:"0",paddingBottom:"0",overflow:"hidden"}),Sn("{{ duration }}ms cubic-bezier(0.86, 0, 0.07, 1)",mi({height:"*",marginTop:"*",paddingTop:"*",paddingBottom:"*",overflow:"hidden"}))]),In(":leave",[mi({height:"*",marginTop:"*",paddingTop:"*",paddingBottom:"*",overflow:"hidden"}),Sn("{{ duration }}ms cubic-bezier(0.86, 0, 0.07, 1)",mi({height:"0",marginTop:"0",paddingTop:"0",paddingBottom:"0",overflow:"hidden"}))])])]}}));let r=n;return r})();var Jp=["annotView"],ed=["gestureSection"];function td(r,n){if(r&1&&(h(0,"section",9,0),T(2,"translate"),P(3),_()),r&2){let i=d();p("title",A(2,3,"UNDEFINED_ANNOTATION"))("ngStyle",i.boxStyles),l(3),Re(" NOT YET IMPLEMENTED or UNSUPPORTED. Undefined gesture of annotation tool[",i.annotTool,`].
`)}}function id(r,n){if(r&1&&x(0,"sd-stamp",13),r&2){let i=d(2);p("data",i.previewAnnot)("ngStyle",i.previewStyle)("status",i.previewStatus)}}function nd(r,n){if(r&1&&x(0,"sd-widget",13),r&2){let i=d(2);p("data",i.previewAnnot)("ngStyle",i.previewStyle)("status",i.previewStatus)}}function od(r,n){if(r&1&&(h(0,"section",10,0),y(2,id,1,3,"sd-stamp",11)(3,nd,1,3,"sd-widget",11),x(4,"div",12),_()),r&2){let i=d();p("ngStyle",i.boxStyles),l(2),p("ngIf",i.annotTool===i.AnnotTool.STAMP),l(),p("ngIf",i.annotTool===i.AnnotTool.RADIO_BUTTON),l(),Ye("border-width",i.previewCursorWidth,"px")("width",i.previewSize.width,"px")("height",i.previewSize.height,"px"),p("ngStyle",i.previewStyle)}}function rd(r,n){if(r&1&&x(0,"sd-line",18,1),r&2){let i=d(2);p("annotLine",i.annot)("status",i.status)}}function sd(r,n){if(r&1&&x(0,"sd-rect",19,1),r&2){let i=d(2);p("data",i.annot)("status",i.status)}}function ad(r,n){if(r&1&&x(0,"sd-stamp",20,1),r&2){let i=d(2);p("data",i.annot)("status",i.status)("pdfData",i.page)}}function cd(r,n){if(r&1&&x(0,"sd-free-text",19,1),r&2){let i=d(2);p("data",i.annot)("status",i.status)}}function ld(r,n){if(r&1&&x(0,"sd-widget",19,1),r&2){let i=d(2);p("data",i.annot)("status",i.status)}}function pd(r,n){if(r&1&&x(0,"sd-link",19,1),r&2){let i=d(2);p("data",i.annot)("status",i.status)}}function dd(r,n){if(r&1){let i=M();h(0,"section",14,0),T(2,"translate"),I("mousedown",function(t){f(i);let o=d();return g(o.create(t))})("mousemove",function(t){f(i);let o=d();return g(o.pvOnMove(t))})("mouseenter",function(t){f(i);let o=d();return g(o.onMouseEnter(t))})("mouseleave",function(t){f(i);let o=d();return g(o.annot?o.clear(t):o.onMouseLeave())})("mouseup",function(t){f(i);let o=d();return g(o.clear(t))})("touchstart",function(t){f(i);let o=d();return g(o.create(o.touchToMouse(t)))})("touchmove",function(t){f(i);let o=d();return g(o.pvOnMove(o.touchToMouse(t)))})("touchend",function(t){f(i);let o=d();return g(o.clear(o.touchToMouse(t)))})("pointerdown",function(t){return f(i),g(t.stopPropagation())})("pointermove",function(t){return f(i),g(t.stopPropagation())})("pointerleave",function(t){return f(i),g(t.stopPropagation())})("pointerup",function(t){return f(i),g(t.stopPropagation())}),y(3,rd,2,2,"sd-line",15)(4,sd,2,2,"sd-rect",16)(5,ad,2,3,"sd-stamp",17)(6,cd,2,2,"sd-free-text",16)(7,ld,2,2,"sd-widget",16)(8,pd,2,2,"sd-link",16),_()}if(r&2){let i=d();p("title",A(2,8,"DRAG_TO_DRAW"))("ngStyle",i.boxStyles),l(3),p("ngIf",i.isLineTool()),l(),p("ngIf",i.isRectTool()),l(),p("ngIf",i.annotTool===i.AnnotTool.STAMP&&i.annot),l(),p("ngIf",i.annotTool===i.AnnotTool.TEXT_CALLOUT&&i.annot),l(),p("ngIf",(i.annotTool===i.AnnotTool.SIGNATURE||i.annotTool===i.AnnotTool.TEXT_FIELD||i.annotTool===i.AnnotTool.CHECK_BUTTON||i.annotTool===i.AnnotTool.RADIO_BUTTON||i.annotTool===i.AnnotTool.LIST_BOX||i.annotTool===i.AnnotTool.COMBO_BOX||i.annotTool===i.AnnotTool.INSTANT_SIGNATURE||i.annotTool===i.AnnotTool.BUTTON)&&i.annot),l(),p("ngIf",i.isLinkTool())}}function ud(r,n){if(r&1&&x(0,"sd-ink",24,1),r&2){let i=d(3);p("annotInk",i.annot)("status",i.status)}}function hd(r,n){if(r&1&&(h(0,"div"),y(1,ud,2,2,"sd-ink",23),_()),r&2){let i=d(2);l(),p("ngIf",i.annot)}}function md(r,n){if(r&1){let i=M();h(0,"section",21,0),T(2,"translate"),I("click",function(t){return f(i),g(t.stopPropagation())})("mousedown",function(t){f(i);let o=d();return g(o.create(t))})("mousemove",function(t){f(i);let o=d();return g(o.pvOnMove(t))})("mouseleave",function(){f(i);let t=d();return g(t.annot?t.initOutsidePageSub():void 0)})("mouseenter",function(){f(i);let t=d();return g(t.annot?t.destroyOutsidePageSub():void 0)})("mouseup",function(t){f(i);let o=d();return g(o.pvOnRelease(t))})("touchstart",function(t){f(i);let o=d();return g(o.create(o.touchToMouse(t)))})("touchmove",function(t){f(i);let o=d();return g(o.pvOnMove(o.touchToMouse(t)))})("touchend",function(t){f(i);let o=d();return g(o.pvOnRelease(o.touchToMouse(t)))})("pointerdown",function(t){return f(i),g(t.stopPropagation())})("pointermove",function(t){return f(i),g(t.stopPropagation())})("pointerleave",function(t){return f(i),g(t.stopPropagation())})("pointerup",function(t){return f(i),g(t.stopPropagation())}),y(3,hd,2,1,"div",22),_()}if(r&2){let i=d();p("title",A(2,4,"DRAG_AND_CLICK_TO_DRAW"))("ngStyle",i.boxStyles)("ngSwitch",i.annotTool),l(3),p("ngSwitchCase",i.AnnotTool.INK)}}function _d(r,n){if(r&1&&x(0,"sd-poly-shape",19,1),r&2){let i=d(3);p("data",i.annot)("status",i.status)}}function fd(r,n){if(r&1&&(h(0,"div"),y(1,_d,2,2,"sd-poly-shape",16),_()),r&2){let i=d(2);l(),p("ngIf",i.annot)}}function gd(r,n){if(r&1){let i=M();h(0,"span",27),I("click",function(t){f(i);let o=d(2);return g(o.clear(t))})("mousemove",function(t){return f(i),g(t.stopPropagation())})("mouseover",function(t){f(i);let o=d(2);return g(o.pvOnOver(t))})("mouseleave",function(t){return f(i),g(t.stopPropagation())})("mouseup",function(t){return f(i),g(t.stopPropagation())})("touchstart",function(t){return f(i),g(t.stopPropagation())})("touchmove",function(t){return f(i),g(t.stopPropagation())})("touchend",function(t){return f(i),g(t.stopPropagation())})("pointerdown",function(t){return f(i),g(t.stopPropagation())})("pointermove",function(t){return f(i),g(t.stopPropagation())})("pointerleave",function(t){return f(i),g(t.stopPropagation())})("pointerup",function(t){return f(i),g(t.stopPropagation())}),_()}if(r&2){let i=d(2);p("ngStyle",i.finishBtn.styles)}}function Cd(r,n){if(r&1){let i=M();h(0,"section",25,0),T(2,"translate"),I("click",function(t){return f(i),g(t.stopPropagation())})("mousedown",function(t){return f(i),g(t.stopPropagation())})("mousemove",function(t){f(i);let o=d();return g(o.pvOnMove(t))})("mouseup",function(t){f(i);let o=d();return o.create(t),g(o.pvOnRelease(t))})("touchstart",function(t){return f(i),t.preventDefault(),g(t.stopPropagation())})("touchmove",function(t){f(i);let o=d();return g(o.pvOnMove(o.touchToMouse(t)))})("touchend",function(t){f(i);let o=d();return o.create(o.touchToMouse(t)),g(o.pvOnRelease(o.touchToMouse(t)))})("pointerdown",function(t){return f(i),g(t.stopPropagation())})("pointermove",function(t){return f(i),g(t.stopPropagation())})("pointerup",function(t){return f(i),g(t.stopPropagation())}),y(3,fd,2,1,"div",22)(4,gd,1,1,"span",26),_()}if(r&2){let i=d();p("title",A(2,5,"CLICK_AND_MOVE_TO_DRAW"))("ngStyle",i.boxStyles)("ngSwitch",i.annotTool),l(3),p("ngSwitchCase",i.casePolyTool(i.annotTool)),l(),p("ngIf",i.showFinishBtn)}}function Td(r,n){if(r&1&&x(0,"sd-text-markup",19,1),r&2){let i=d(2);p("data",i.annot)("status",i.status)}}function Ad(r,n){if(r&1){let i=M();h(0,"section",28,0),I("mousedown",function(t){f(i);let o=d();return g(o.create(t))})("mousemove",function(t){f(i);let o=d();return g(o.pvOnMove(t))})("mouseup",function(t){f(i);let o=d();return g(o.clear(t))})("touchstart",function(t){f(i);let o=d();return g(o.create(o.touchToMouse(t)))})("touchmove",function(t){f(i);let o=d();return g(o.pvOnMove(o.touchToMouse(t)))})("touchend",function(t){f(i);let o=d();return g(o.clear(o.touchToMouse(t)))}),x(2,"sd-select-text",29),y(3,Td,2,2,"sd-text-markup",16),_()}if(r&2){let i=d();p("ngStyle",i.boxStyles),l(2),p("pdfPage",i.page)("documentId",i.documentId)("status",i.status)("annot",i.annot),l(),p("ngIf",i.annot)}}function Ed(r,n){if(r&1&&x(0,"sd-stamp",20,1),r&2){let i=d(2);p("data",i.annot)("status",i.status)("pdfData",i.page)}}function Sd(r,n){if(r&1){let i=M();h(0,"section",30,0),T(2,"translate"),I("pointerenter",function(t){f(i);let o=d();return g(o.onMouseEnter(t))})("pointerdown",function(t){f(i);let o=d();return g(o.create(t))})("pointermove",function(t){f(i);let o=d();return g(o.pvOnMove(t))})("pointerleave",function(){f(i);let t=d();return g(t.onMouseLeave())})("pointerup",function(t){f(i);let o=d();return g(o.clear(t))}),y(3,Ed,2,3,"sd-stamp",17),_()}if(r&2){let i=d();p("title",A(2,3,"CLICK_TO_DRAW"))("ngStyle",i.boxStyles),l(3),p("ngIf",i.annotTool===i.AnnotTool.STAMP&&i.annot)}}var Ko=(()=>{let n=class n{instanceOptions;ref;annotService;annotSelectedService;contentService;acroFormService;changeDetectorRef;sdContextMenuService;configsService;subscriptionService;store$;loggingService;translatePipe;page;documentId;annotView;gestureSectionElementRef;PREVIEW_CURSOR_WIDTH=2;scale;degree;annotContext;annotTool;annotDrawing=!0;status=X.CREATE;previewStatus=X.PREVIEW;boxStyles={};finishBtnStyles={};get finishBtn(){return this._finishBtn&&(this._finishBtn.styles.transform=`scale(${1.25/D.normalizeScale(this.scale)}) rotate(${-(this.page.r+this.degree)}deg)`),this._finishBtn}set finishBtn(e){this._finishBtn=e}get showFinishBtn(){return!!this.finishBtn&&!this.annotDrawing}annot;previewAnnot;popup;previewStyle;previewCursorWidth=this.PREVIEW_CURSOR_WIDTH;get AnnotTool(){return F}get Gesture(){return Ti}get activeGesture(){let e=Bs[this.annotTool];if(this.annotTool===F.STAMP){let t=this.configsService.radioConfig[W.STAMP_DRAWING_GESTURE];if(!S.isDefined(t))throw new zi("Radio configuration for stamp drawing gesture is not defined");let o=t.items.find(s=>Y.get(s.key));S.isDefined(o)&&(e=o.value)}return this.annotService.annotGesture??e}get previewSize(){if(!S.isDefined(this.annotContext))throw new vt("Annotation context is not defined");switch(this.annotTool){case F.STAMP:if(!S.isDefined(this.annotContext.stamp))throw new zi("Stamp context is not defined");return{width:this.annotContext.stamp.width,height:this.annotContext.stamp.height};case F.RADIO_BUTTON:if(!S.isDefined(this.annotContext.widget))throw new zi("Widget context is not defined");return{width:this.annotContext.widget.width,height:this.annotContext.widget.height};default:return{width:0,height:0}}}_finishBtn;lastEvent;gestureStrategy;continueWriting=!1;inkDraw$=new it;outsidePageSub;isMouseEnter=!1;isContextMenuOpened=!1;constructor(e,t,o,s,c,u,C,N,O,U,z,Me,Bt){this.instanceOptions=e,this.ref=t,this.annotService=o,this.annotSelectedService=s,this.contentService=c,this.acroFormService=u,this.changeDetectorRef=C,this.sdContextMenuService=N,this.configsService=O,this.subscriptionService=U,this.store$=z,this.loggingService=Me,this.translatePipe=Bt,this.page=this.instanceOptions.data.page,this.documentId=this.instanceOptions.data.documentId}getButton=e=>e.buttons;casePolyTool(e){return e===F.POLYGON||e===F.POLYGON_DIMENSION||e===F.CLOUD||e===F.POLYLINE||e===F.POLYLINE_DIMENSION?e:null}ngOnInit(){this.initSubscriptions(),D.bindLayoutOrder(this.boxStyles,D.LayoutOrder.AnnotCreate),this.boxStyles.width=`${this.page.bbox.w+this.page.bbox.x}px`,this.boxStyles.height=`${this.page.bbox.h+this.page.bbox.y}px`,D.bindLayoutOrder(this.finishBtnStyles,D.LayoutOrder.AnnotCreateFinish)}ngOnDestroy(){fe.destroy(this)}isPreviewVisible(){return this.isMouseEnter&&!this.annot&&this.satisfyPreviewAnnotInfo()&&!!this.previewAnnot}onMouseEnter(e){if(!this.previewAnnot&&this.satisfyPreviewAnnotInfo()){let t=this.annotService.createAnnot(this.annotTool,this.page,{x:e.offsetX,y:e.offsetY})[0];t.attributes.rect.bottom=0,t.attributes.rect.left=0,t.attributes.rect.right=this.previewSize.width,t.attributes.rect.top=this.previewSize.height,this.previewAnnot=t,this.previewStyle={transform:`translate(${e.offsetX}px,${e.offsetY}px)`}}this.isMouseEnter=!0}onMouseLeave(){this.isMouseEnter=!1}touchToMouse(e){return S.touchToMouseEvt(e,this.degree,this.scale,this.page,this.gestureSectionElementRef.nativeElement)}createFinishBtn(e){this._finishBtn=new Hs(e,this.finishBtnStyles)}createAnnot(e){let t=this.annotService.createAnnot(this.annotTool,this.page,e);this.annot=t[0],(b.isLineDimension(this.annot)||b.isPolyLineDimension(this.annot))&&this.contentService.fireMeasureIndicatorEvent({action:"create",annot:this.annot}),b.isFreeText(this.annot)&&this.degree+this.page.r!==0&&(this.annot.attributes.Rotate=this.degree+this.page.r),t[1]&&(this.popup=t[1])}isLineTool(){let e=this.annotTool;return!!this.annot&&(e===F.LINE||e===F.LINE_DIMENSION)}isRectTool(){let e=this.annotTool;return!!this.annot&&(e===F.CIRCLE||e===F.SQUARE||F.TEXT_FREE===e||F.REDACTION===e)}isLinkTool(){return!!this.annot&&this.annotTool===F.LINK}create(e){return e.button===2||!pt.isEventInPage(e,this.page)&&!this.isPreviewVisible()||(this.isContextMenuOpened&&this.sdContextMenuService.publishContextMenuStatus(!1),document.activeElement&&document.activeElement instanceof HTMLElement&&document.activeElement.blur(),e.preventDefault(),e.stopPropagation(),this.annotDrawing=!0,this.gestureStrategy.create(e),this.lastEvent=e,this.changeDetectorRef.destroyed||(this.changeDetectorRef.markForCheck(),this.popup&&this.changeDetectorRef.detectChanges())),!1}pvOnMove(e){return this.previewStyle&&(this.previewStyle.transform=`translate(${e.offsetX}px,${e.offsetY}px)`),this.boxStyles.cursor=this.getAnnotationCursor(e),!this.annot||this.activeGesture!==Ti.CLICK_MOVE&&this.getButton(e)>1?!0:(e.preventDefault(),e.stopPropagation(),this.lastEvent?.offsetX===e.offsetX&&this.lastEvent?.offsetY===e.offsetY||!pt.isEventInPage(e,this.page)||(this.annotView?.pvOnMove&&this.annotView.pvOnMove(e),this.lastEvent=e),!1)}pvOnRelease(e){return this.annot?(e.preventDefault(),e.stopPropagation(),this.destroyOutsidePageSub(),this.annotDrawing=!1,b.isInk(this.annot)&&this.inkDraw$.next(e),this.gestureStrategy.pvOnRelease(e),!1):!0}pvOnOver(e){return this.annot?(e.preventDefault(),e.stopPropagation(),this.annotView.pvOnOver&&this.annotView.pvOnOver(),!1):!0}clear(e,t=!0){if(!this.annot||!this.acroFormService.isAcroFieldsInitialized())return this.clearStatus(),!0;if(typeof e?.stopPropagation=="function"&&e.stopPropagation(),typeof e?.preventDefault=="function"&&e.preventDefault(),!Ws.isValid(this.annot))if(b.isStamp(this.annot)&&this.activeGesture===Ti.CLICK_ONLY){let{width:o,height:s}=this.annot.attributes.appearance;this.modifyAnnotRect(o,s,!1)}else if(b.isRadioWidget(this.annot,this.acroFormService.acroFields)&&this.annotContext.widget){let{width:o,height:s}=this.annotContext.widget;this.modifyAnnotRect(o,s,!1)}else return this.loggingService.common("debug",Ee.INVALID,this.translatePipe.transform("ANNOTATION"),this.annot),this.clearStatus(),!1;if(this.annotView?.postCreate&&this.annotView.postCreate(this.page),b.isLink(this.annot)){this.contentService.publishEnableLinkCreationDialog(this.annot),this.clearStatus();return}if(this.annotTool===F.SIGNATURE){this.ref.emit(this.annot),this.annotService.putModel(this.annot),this.annotService.normalizeWidget(this.annot,this.acroFormService.acroFields),this.clearStatus();return}if(this.annotTool===F.INSTANT_SIGNATURE){this.ref.emit(this.annot),this.clearStatus();return}if(this.popup&&(this.ref.emit(this.popup),this.annotService.putModel(this.popup)),this.annotService.putModel(this.annot),b.isWidget(this.annot)&&this.annotService.normalizeWidget(this.annot,this.acroFormService.acroFields),b.isFreeText(this.annot)){let o=document.createElement("div");o.contentEditable="true",document.body.appendChild(o),o.focus(),o.click(),S.isDefined(o.parentElement)&&o.parentElement.removeChild(o)}return this.ref.emit(this.annot),this.continueWriting||this.unselectAll(),this.clearStatus(t),!1}clearStatus(e=!0){this.annot=null,this.lastEvent=null,this.continueWriting?(this.annotDrawing=!0,this.changeDetectorRef.markForCheck()):e&&this.store$.dispatch(Fi.unselectTool())}initOutsidePageSub(){this.annotDrawing&&(this.outsidePageSub=we(document.documentElement,"mouseup").subscribe({next:e=>this.pvOnRelease(e)}))}destroyOutsidePageSub(){this.annotDrawing&&(S.isDefined(this.outsidePageSub)&&fe.unsubscribe(this.outsidePageSub),this.outsidePageSub=null)}initSubscriptions(){this.subscriptionService.push(this.store$.pipe(le("scale")).subscribe({next:e=>this.scale=e}),this.store$.pipe(le("degree")).subscribe({next:e=>this.degree=e}),this.store$.pipe(Be("annot","continueWriting")).subscribe({next:e=>{this.continueWriting=e}}),this.store$.pipe(le("scale")).subscribe({next:()=>{this.applyScale()}}),this.store$.pipe(le("degree")).subscribe({next:()=>this.changeDetectorRef.markForCheck()}),this.inkDraw$.pipe($t(500),w(()=>!this.annotDrawing)).subscribe({next:e=>{this.clear(e)}}),this.store$.pipe(Oo()).subscribe({next:e=>{this.annotContext=e,this.changeDetectorRef.markForCheck()}}),this.store$.pipe(Zi(),w(S.isDefined)).subscribe({next:e=>{this.annotTool=e,this.initGestureStrategy(),this.boxStyles.cursor=this.annotTool===F.TEXT_POPUP?'url("data:application/octet-stream;base64,AAACAAEAHBwAAA4ADgDYDAAAFgAAACgAAAAcAAAAOAAAAAEAIAAAAAAAQAwAANcNAADXDQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHx8fGSAgIDcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHBwcCSIiIsgiIiLoJCQkHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAiIiIq4iIiL/IiIi/yIiIs0cHBwJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACEhIYoiIiL/IiIi/yIiIv8iIiL/ISEhoQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAiIiIPIiIiQyEhIVUhISFVISEhVSEhIVUhISFVISEhVSIiIoAiIiL/IiIi/xxDS90YU2DSIiIi/yIiIv8iIiKGISEhVSEhIVUhISFVISEhVSEhIVUhISFVISEhRSAgIBAAAAAAAAAAAAAAAAAjIyNeIiIi8iIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/x8xNOwBzfrgAM/96h45PuUiIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL0IyMjZgAAAAAhISE2IiIi+yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yEmJ/cCxe/OANH//wDR//8ByfTYISks9iIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv0hISE+IyMjkyIiIv8hKiz1BL/oygHN+uIBzfriAc364gHN+uIBzfriAc364gHN+uIAz/3pANH//wDR//8A0f//ANH//wDP/ekBzfriAc364gHN+uIBzfriAc364gHN+uIBzfriAsHrzSAsMPEiIiL/IiIiniMjI7giIiL/GFFd0wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8WXWzNIiIi/yIiIsQiIiK6IiIi/xhTYNIA0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//Fl9vzCIiIv8hISHGIiIiuiIiIv8YU2DSANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//xZfb8wiIiL/ISEhxiIiIroiIiL/GFNg0gDR//8A0f//ANH//wDR//4EuuPICKzRwgis0cIIrNHCCKzRwgis0cIIrNHCCKzRwgis0cIIrNHCCKzRwgis0cIIrNHCBbTbxADR//gA0f//ANH//wDR//8WX2/MIiIi/yEhIcYiIiK6IiIi/xhTYNIA0f//ANH//wDR//8EuuPIIiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8Lmrq/ANH//wDR//8A0f//Fl9vzCIiIv8hISHGIiIiuiIiIv8YU2DSANH//wDR//8A0f//Acr22CEqLPUiIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iJCX8BbngxwDR//8A0f//ANH//xZfb8wiIiL/ISEhxiIiIroiIiL/GFNg0gDR//8A0f//ANH//wDR//8A0f/3AND+7wDQ/u8A0P7vAND+7wDQ/u8A0P7vAND+7wDQ/u8A0P7vAND+7wDQ/u8A0P7vANH/9ADR//8A0f//ANH//wDR//8WX2/MIiIi/yEhIcYiIiK6IiIi/xhTYNIA0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//Fl9vzCIiIv8hISHGIiIiuiIiIv8YU2DSANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//xZfb8wiIiL/ISEhxiIiIroiIiL/GFNg0gDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8WX2/MIiIi/yEhIcYiIiK6IiIi/xhTYNIA0f//ANH//wDR//8A0f//AsDqzAis0cIIrNHCCKzRwgis0cIIrNHCCKzRwgis0cIIrNHCCKzRwgis0cIIrNHCCKzRwgW64scA0f/7ANH//wDR//8A0f//Fl9vzCIiIv8hISHGIiIiuiIiIv8YU2DSANH//wDR//8A0f//BL3mySIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/C5+/vwDR//8A0f//ANH//xZfb8wiIiL/ISEhxiIiIroiIiL/GFNg0gDR//8A0f//ANH//wHI89UhJyj4IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiMj/gW028UA0f//ANH//wDR//8WX2/MIiIi/yEhIcYiIiK6IiIi/xhTYNIA0f//ANH//wDR//8A0f//AND+7wHN+uIBzfriAc364gHN+uIBzfriAc364gHN+uIBzfriAc364gHN+uIBzfriAc364gDP/esA0f//ANH//wDR//8A0f//Fl9vzCIiIv8hISHGIiIiuiIiIv8YU2DSANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//xZfb8wiIiL/ISEhxiIiIrYiIiL/GU5a1ADR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8YWmnOIiIi/yIiIsEjIyOLIiIi/yEkJfsJocLABbjgxgW44MYFuODGBbjgxgW44MYFuODGBbjgxgW44MYFuODGBbjgxgW44MYFuODGBbjgxgW44MYFuODGBbjgxgW44MYFuODGBbjgxgW44MYJpcfAISco+CIiIv8iIiKWJSUlIiIiIvMiIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL4IiIiLQAAAAAiIiI8IiIi1yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiLbIiIiQwAAAAAAAAAAAAAAAAAAAAAgICAYIyMjMyMjIzMjIyMzIyMjMyMjIzMjIyMzIyMjMyMjIzMjIyMzIyMjMyMjIzMjIyMzIyMjMyMjIzMjIyMzIyMjMyMjIzMjIyMzIyMjMyMjIzMdHR0aAAAAAAAAAAAAAAAA//n/8P/w//D/4H/w/+B/8MAAADCAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAQ4AAAcA=="), auto':null,this.changeDetectorRef.markForCheck()}}),this.sdContextMenuService.contextMenuStatus$.subscribe({next:e=>this.isContextMenuOpened=e}))}unselectAll(){this.annotSelectedService.unselectAll()}satisfyPreviewAnnotInfo(){switch(this.annotTool){case F.STAMP:return!!this.annotContext.stamp&&this.activeGesture===Ti.CLICK_ONLY;case F.RADIO_BUTTON:return!!this.annotContext.widget;default:return!1}}modifyAnnotRect(e,t,o){if(!S.isDefined(this.annot))throw new vt("Annotation is not defined");let{rect:s}=this.annot.attributes;o?(s.left-=e/2,s.right+=e/2,s.top-=t/2,s.bottom+=t/2):(s.right+=e,s.bottom+=t),this.validateAndFixAnnotRect()}validateAndFixAnnotRect(){if(!S.isDefined(this.annot))throw new vt("Annotation is not defined");let{rect:e}=this.annot.attributes;if(e.right>this.page.bbox.x+this.page.bbox.w){let t=e.right-(this.page.bbox.x+this.page.bbox.w);e.right-=t,e.left-=t}if(e.left<this.page.bbox.x&&(e.right-=e.left-this.page.bbox.x,e.left=this.page.bbox.x),e.bottom>this.page.bbox.h){let t=e.bottom-this.page.bbox.h;e.bottom-=t,e.top-=t}e.top<0&&(e.bottom-=e.top,e.top=0)}applyScale(){this.previewCursorWidth=Number((this.PREVIEW_CURSOR_WIDTH*100/this.scale).toFixed(1)),this.changeDetectorRef.markForCheck()}initGestureStrategy(){let e=Gs[this.activeGesture];if(!e){this.subscriptionService.push(fe.runAsync(()=>this.clearStatus()));return}this.gestureStrategy=new e(this)}getAnnotationCursor(e){if(!pt.isEventInPage(e,this.page))return"inherit";switch(this.annotTool){case F.HIGHLIGHT:case F.UNDERLINE:case F.STRIKE:return"text";case F.TEXT_POPUP:return'url("data:application/octet-stream;base64,AAACAAEAHBwAAA4ADgDYDAAAFgAAACgAAAAcAAAAOAAAAAEAIAAAAAAAQAwAANcNAADXDQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHx8fGSAgIDcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHBwcCSIiIsgiIiLoJCQkHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAiIiIq4iIiL/IiIi/yIiIs0cHBwJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACEhIYoiIiL/IiIi/yIiIv8iIiL/ISEhoQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAiIiIPIiIiQyEhIVUhISFVISEhVSEhIVUhISFVISEhVSIiIoAiIiL/IiIi/xxDS90YU2DSIiIi/yIiIv8iIiKGISEhVSEhIVUhISFVISEhVSEhIVUhISFVISEhRSAgIBAAAAAAAAAAAAAAAAAjIyNeIiIi8iIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/x8xNOwBzfrgAM/96h45PuUiIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL0IyMjZgAAAAAhISE2IiIi+yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yEmJ/cCxe/OANH//wDR//8ByfTYISks9iIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv0hISE+IyMjkyIiIv8hKiz1BL/oygHN+uIBzfriAc364gHN+uIBzfriAc364gHN+uIAz/3pANH//wDR//8A0f//ANH//wDP/ekBzfriAc364gHN+uIBzfriAc364gHN+uIBzfriAsHrzSAsMPEiIiL/IiIiniMjI7giIiL/GFFd0wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8WXWzNIiIi/yIiIsQiIiK6IiIi/xhTYNIA0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//Fl9vzCIiIv8hISHGIiIiuiIiIv8YU2DSANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//xZfb8wiIiL/ISEhxiIiIroiIiL/GFNg0gDR//8A0f//ANH//wDR//4EuuPICKzRwgis0cIIrNHCCKzRwgis0cIIrNHCCKzRwgis0cIIrNHCCKzRwgis0cIIrNHCBbTbxADR//gA0f//ANH//wDR//8WX2/MIiIi/yEhIcYiIiK6IiIi/xhTYNIA0f//ANH//wDR//8EuuPIIiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8Lmrq/ANH//wDR//8A0f//Fl9vzCIiIv8hISHGIiIiuiIiIv8YU2DSANH//wDR//8A0f//Acr22CEqLPUiIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iJCX8BbngxwDR//8A0f//ANH//xZfb8wiIiL/ISEhxiIiIroiIiL/GFNg0gDR//8A0f//ANH//wDR//8A0f/3AND+7wDQ/u8A0P7vAND+7wDQ/u8A0P7vAND+7wDQ/u8A0P7vAND+7wDQ/u8A0P7vANH/9ADR//8A0f//ANH//wDR//8WX2/MIiIi/yEhIcYiIiK6IiIi/xhTYNIA0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//Fl9vzCIiIv8hISHGIiIiuiIiIv8YU2DSANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//xZfb8wiIiL/ISEhxiIiIroiIiL/GFNg0gDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8WX2/MIiIi/yEhIcYiIiK6IiIi/xhTYNIA0f//ANH//wDR//8A0f//AsDqzAis0cIIrNHCCKzRwgis0cIIrNHCCKzRwgis0cIIrNHCCKzRwgis0cIIrNHCCKzRwgW64scA0f/7ANH//wDR//8A0f//Fl9vzCIiIv8hISHGIiIiuiIiIv8YU2DSANH//wDR//8A0f//BL3mySIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/C5+/vwDR//8A0f//ANH//xZfb8wiIiL/ISEhxiIiIroiIiL/GFNg0gDR//8A0f//ANH//wHI89UhJyj4IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiMj/gW028UA0f//ANH//wDR//8WX2/MIiIi/yEhIcYiIiK6IiIi/xhTYNIA0f//ANH//wDR//8A0f//AND+7wHN+uIBzfriAc364gHN+uIBzfriAc364gHN+uIBzfriAc364gHN+uIBzfriAc364gDP/esA0f//ANH//wDR//8A0f//Fl9vzCIiIv8hISHGIiIiuiIiIv8YU2DSANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//xZfb8wiIiL/ISEhxiIiIrYiIiL/GU5a1ADR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8A0f//ANH//wDR//8YWmnOIiIi/yIiIsEjIyOLIiIi/yEkJfsJocLABbjgxgW44MYFuODGBbjgxgW44MYFuODGBbjgxgW44MYFuODGBbjgxgW44MYFuODGBbjgxgW44MYFuODGBbjgxgW44MYFuODGBbjgxgW44MYJpcfAISco+CIiIv8iIiKWJSUlIiIiIvMiIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL4IiIiLQAAAAAiIiI8IiIi1yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiL/IiIi/yIiIv8iIiLbIiIiQwAAAAAAAAAAAAAAAAAAAAAgICAYIyMjMyMjIzMjIyMzIyMjMyMjIzMjIyMzIyMjMyMjIzMjIyMzIyMjMyMjIzMjIyMzIyMjMyMjIzMjIyMzIyMjMyMjIzMjIyMzIyMjMyMjIzMdHR0aAAAAAAAAAAAAAAAA//n/8P/w//D/4H/w/+B/8MAAADCAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAQ4AAAcA=="), auto'}return"crosshair"}};E(n,"\u0275fac",function(t){return new(t||n)(m($o),m(Vi),m(Ie),m(Ct),m(de),m(gt),m($),m(Vt),m(Rt),m(R),m(me),m(ze),m(ee))}),E(n,"\u0275cmp",H({type:n,selectors:[["ng-component"]],viewQuery:function(t,o){if(t&1&&(te(Jp,5),te(ed,5)),t&2){let s;ie(s=ne())&&(o.annotView=s.first),ie(s=ne())&&(o.gestureSectionElementRef=s.first)}},standalone:!1,features:[j([R])],decls:7,vars:7,consts:[["gestureSection",""],["annotView",""],[3,"title","ngStyle",4,"ngIf"],["class","preview-annot",3,"ngStyle",4,"ngIf"],[3,"title","ngStyle","mousedown","mousemove","mouseenter","mouseleave","mouseup","touchstart","touchmove","touchend","pointerdown","pointermove","pointerleave","pointerup",4,"ngIf"],[3,"title","ngStyle","ngSwitch","click","mousedown","mousemove","mouseleave","mouseenter","mouseup","touchstart","touchmove","touchend","pointerdown","pointermove","pointerleave","pointerup",4,"ngIf"],[3,"title","ngStyle","ngSwitch","click","mousedown","mousemove","mouseup","touchstart","touchmove","touchend","pointerdown","pointermove","pointerup",4,"ngIf"],["class","blend",3,"ngStyle","mousedown","mousemove","mouseup","touchstart","touchmove","touchend",4,"ngIf"],[3,"title","ngStyle","pointerenter","pointerdown","pointermove","pointerleave","pointerup",4,"ngIf"],[3,"title","ngStyle"],[1,"preview-annot",3,"ngStyle"],[3,"data","ngStyle","status",4,"ngIf"],[1,"cursor",3,"ngStyle"],[3,"data","ngStyle","status"],[3,"mousedown","mousemove","mouseenter","mouseleave","mouseup","touchstart","touchmove","touchend","pointerdown","pointermove","pointerleave","pointerup","title","ngStyle"],[3,"annotLine","status",4,"ngIf"],[3,"data","status",4,"ngIf"],[3,"data","status","pdfData",4,"ngIf"],[3,"annotLine","status"],[3,"data","status"],[3,"data","status","pdfData"],[3,"click","mousedown","mousemove","mouseleave","mouseenter","mouseup","touchstart","touchmove","touchend","pointerdown","pointermove","pointerleave","pointerup","title","ngStyle","ngSwitch"],[4,"ngSwitchCase"],[3,"annotInk","status",4,"ngIf"],[3,"annotInk","status"],[3,"click","mousedown","mousemove","mouseup","touchstart","touchmove","touchend","pointerdown","pointermove","pointerup","title","ngStyle","ngSwitch"],["class","papycon papycon-check-mark2",3,"ngStyle","click","mousemove","mouseover","mouseleave","mouseup","touchstart","touchmove","touchend","pointerdown","pointermove","pointerleave","pointerup",4,"ngIf"],[1,"papycon","papycon-check-mark2",3,"click","mousemove","mouseover","mouseleave","mouseup","touchstart","touchmove","touchend","pointerdown","pointermove","pointerleave","pointerup","ngStyle"],[1,"blend",3,"mousedown","mousemove","mouseup","touchstart","touchmove","touchend","ngStyle"],[3,"pdfPage","documentId","status","annot"],[3,"pointerenter","pointerdown","pointermove","pointerleave","pointerup","title","ngStyle"]],template:function(t,o){t&1&&y(0,td,4,5,"section",2)(1,od,5,10,"section",3)(2,dd,9,10,"section",4)(3,md,4,6,"section",5)(4,Cd,5,7,"section",6)(5,Ad,4,6,"section",7)(6,Sd,4,5,"section",8),t&2&&(p("ngIf",!o.activeGesture),l(),p("ngIf",o.isPreviewVisible()),l(),p("ngIf",o.activeGesture===o.Gesture.DRAG),l(),p("ngIf",o.activeGesture===o.Gesture.DRAG_CLICK),l(),p("ngIf",o.activeGesture===o.Gesture.CLICK_MOVE),l(),p("ngIf",o.activeGesture===o.Gesture.SELECT_TEXT),l(),p("ngIf",o.activeGesture===o.Gesture.CLICK_ONLY))},styles:["section[_ngcontent-%COMP%]{position:absolute;right:0;top:0;cursor:crosshair}div[_ngcontent-%COMP%]{position:absolute;left:0;top:0;width:100%;height:100%}span[_ngcontent-%COMP%]{position:absolute;padding:0;width:20px;height:20px;color:#1e1e1e;background:#fff;border-radius:10px;outline:none;font-size:20px}span[_ngcontent-%COMP%]:hover{color:#62ad46}input[type=button][_ngcontent-%COMP%]:hover{background-color:#0000ff80}.preview-annot[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{opacity:.5}.preview-annot[_ngcontent-%COMP%]   .cursor[_ngcontent-%COMP%]{border-style:solid;border-color:var(--primary-50);box-sizing:border-box;background-color:rgba(var(--primary-50),.08);opacity:1}.blend[_ngcontent-%COMP%]{mix-blend-mode:multiply}"],changeDetection:0}));let r=n;return r})();var Id=r=>Number(r.toFixed(1)),tt=function(r){return r.M="M",r.L="L",r.T="T",r.Q="Q",r.C="C",r.a="a",r.COMMA=",",r}(tt||{}),Nt=class r{hidden=!1;prefix;ratioX=1;ratioY=1;_values;get values(){return this.ratioX===1&&this.ratioY===1?this._values:this._values.map((n,i)=>i%2===0?n*this.ratioX:n*this.ratioY)}set values(n){this._values=n}constructor(n,i,...e){this.hidden=i,this.prefix=n,this._values=e}clone(){return new r(this.prefix,this.hidden,...this.values)}toString(){return`${this.prefix} ${this.values.map(n=>Id(n)).join(" ")}`}},Qo=class{parent;$element=document.createElementNS("http://www.w3.org/2000/svg","path");_partials=[];_options={translate:{x:0,y:0},ratio:{w:1,h:1}};get partials(){return this._partials}set partials(n){this._partials=n,this.render()}get options(){return this._options}set options(n){this.$element.setAttribute("stroke",`${n?.strokeColor||"black"}`),this.$element.setAttribute("stroke-width",`${n?.strokeWidth||1}`),this.$element.setAttribute("fill",n?.fill||"none"),Qt.hasDefinedProp(n,"translate")&&(n.translate.x!==this.options.translate?.x||n.translate.y!==this.options.translate.y)&&this.$element.setAttribute("transform",`translate(${n.translate.x}, ${n.translate.y})`),Qt.hasDefinedProp(n,"ratio")&&(n.ratio.w!==this.options.ratio?.w||n.ratio.h!==this.options.ratio.h)&&(this.partials.forEach(i=>{i.ratioX=n.ratio.w,i.ratioY=n.ratio.h}),this.render()),Object.assign(this._options,n)}constructor(n,i){this.parent=n,this.options=i,this.parent.element.appendChild(this.$element)}append(...n){this.partials=[...this.partials,...n]}remove(...n){let i=this.partials.slice();n.forEach(e=>{let t=i.indexOf(e);t!==-1&&i.splice(t,1)}),i.length!==this.partials.length&&(this.partials=i)}toString(){return this.partials.map(n=>n.toString()).join(" ")}destroy(){this.$element.parentElement?.removeChild(this.$element)}render(){let n=this.toString();this.$element.getAttribute("d")!==n&&this.$element.setAttribute("d",n)}};var Zo=class{renderer;options;_finished=!1;trackingElement=document.createElementNS("http://www.w3.org/2000/svg","path");trackingPoints=[];lastLinearized;lastRequested;cd=0;_lastPath;_lastPathD;get finished(){return this._finished}constructor(n,i){this.renderer=n,this.options=ge({realtimeLinearizeMinDistance:6,useRealtimeBezier:!0},i)}start(n){if(this._finished)throw new Error("Already finished reference");let i=this.renderer.getDrawablePath(),e=new Nt(tt.M,!1,n.x,n.y);i.append(e),this._lastPath=i,this._lastPathD=this.options.useRealtimeBezier?new Nt(tt.Q,!1,n.x,n.y,n.x,n.y):new Nt(tt.L,!1,n.x,n.y),i.append(this._lastPathD),this.lastLinearized=n,this.lastRequested=n,this.trackingElement.setAttribute("stroke",this.options?.strokeColor||"black"),this.trackingElement.setAttribute("stroke-width",`${this.options?.strokeWidth||1}`),this.trackingElement.setAttribute("fill","none"),this.renderer.element.appendChild(this.trackingElement)}forward(n){let i=st.from(this.lastLinearized).distance(st.from(n)),e=this.options.realtimeLinearizeMinDistance;if(this.options.useRealTimeLinearize)if(e&&this.cd+i>e){let t=e-this.cd,o=st.from(this.lastRequested).lerp(st.from(n),t/i),s=i-t;for(;s>e;)s-=e;this.cd=s,this.lastLinearized=o,this.linearized(o),this.trackingPoints.splice(0)}else this.cd+=i;else this.linearized(n),this.trackingPoints.splice(0);this.options.useTrackingPoint&&this.track(n),this.lastRequested=n}finish(){if(this.lastRequested!==this.lastLinearized&&this.linearized(this.lastRequested),this.trackingElement.parentElement?.removeChild(this.trackingElement),this._finished)throw new _s("Already finished draw reference");if(!S.isDefined(this._lastPath)||!S.isDefined(this._lastPathD))throw new He("Last path is not defined");if(this._lastPathD.prefix===tt.L&&this.options.useRealtimeBezier){let n=this._lastPath.partials[this._lastPath.partials.length-2];n.values=[...n.values.slice(0,2),...this._lastPathD.values],this._lastPath.remove(this._lastPathD),this._lastPath.render()}this._finished=!0}track(n){this.trackingPoints.push(n),this.trackingElement.setAttribute("d",this.trackingPoints.reduce((i,e,t,o)=>{let s=i;if(t===0&&(s+=`M ${e.x} ${e.y}`),o[t+1]&&o[o.length-1]!==e){let c=o[t+1];s+=` Q ${e.x} ${e.y} ${(e.x+c.x)/2} ${(e.y+c.y)/2}`}return s},""))}linearized({x:n,y:i}){if(this._finished)throw new Error("Already finished reference");let e=this.renderer.getDrawablePath();if(this._lastPathD?.prefix===tt.L&&this.options.useRealtimeBezier){let[o,s]=this._lastPathD.values;this._lastPathD.prefix=tt.Q,this._lastPathD.values.push((n+o)/2,(i+s)/2),S.isDefined(this._lastPath)&&e!==this._lastPath&&this._lastPath.render()}if(e.partials.length===0){let o=this._lastPathD?this._lastPathD.values.slice(this._lastPathD.values.length-2):[n,i],s=new Nt(tt.M,!0,...o);e.append(s)}let t=new Nt(tt.L,!1,n,i);this._lastPath=e,this._lastPathD=t,e.append(t)}};var qo=class{element;pathes=[];_points=[];_options={renderingMode:"origin",useRealtimeBezier:!0};get options(){return this._options}set options(n){Object.assign(this._options,n),this.pathes.forEach(i=>i.options=this.options)}get points(){return this._points.map(n=>n.map(i=>({x:i.x*(this.options?.ratio?.w||1),y:i.y*(this.options?.ratio?.h||1)})))}set points(n){this._points=n,this.render()}constructor(n,i){this.element=n,this.options=i}getDrawablePath(){let n=this.getLastPath();if(!this.options?.maxVertexCountPerPath&&n||n!==void 0&&this.options.maxVertexCountPerPath&&n.partials.length<this.options.maxVertexCountPerPath)return this.pathes[this.pathes.length-1];{let i=new Qo(this,this.options);return this.pathes.push(i),i}}getFreeDrawRef(){return new Zo(this,this.options)}render(){let n=[];this.options.renderingMode==="optimize"?this.points.map(i=>{let e=i.map(t=>st.from(t));return this.options.optimizationLinearizeMinDistance!==void 0&&(e=qs(i.map(t=>st.from(t)),this.options.optimizationLinearizeMinDistance,!1,!0)),e}).map(i=>Js(i)).map(i=>new Zs(i).fit(this.options.optimizationMaxCurveFittingErrorCount||1)).forEach(i=>{i.forEach((e,t)=>{if(t===0){let s=new Nt(tt.M,!1,e.p0.x,e.p1.y);n.push(s)}let o=new Nt(tt.C,!1,e.p1.x,e.p1.y,e.p2.x,e.p2.y,e.p3.x,e.p3.y);n.push(o)})}):this.points.forEach(i=>i.forEach((e,t,o)=>{let{x:s,y:c}=e;if(t===0){let u=new Nt(tt.M,!1,s,c),C=new Nt(tt.Q,!1,s,c,s,c);n.push(u,C)}else{let u=o[t-1],C=t===o.length-1,N=new Nt(tt.Q,!1,u.x,u.y,C?s:(u.x+s)/2,C?c:(u.y+c)/2);n.push(N)}})),this.apply(...n)}extactPoints(){return this.getMergedPathD().reduce((n,i,e,t)=>{i.prefix===tt.M&&n.push([]);let o=n[n.length-1],s=t[e-1];if(s&&s.prefix===tt.M){let[c,u]=i.values;return o.push({x:c,y:u}),n}switch(i.prefix){case tt.Q:case tt.L:let[c,u]=i.values;if(o.push({x:c,y:u}),e===t.length-1||t[e+1]&&t[e+1].prefix===tt.M){let[C,N]=i.values.slice(2);o.push({x:C,y:N})}break}return n},[])}getMergedPathD(n=!1){return this.pathes.reduce((i,e)=>(i.push(...n?e.partials:e.partials.filter(t=>!t.hidden)),i),[])}apply(...n){this.pathes.splice(1);let[i]=this.pathes;i||(i=this.getDrawablePath()),i.partials=n}getLastPath(){return this.pathes[this.pathes.length-1]}};var xd=["svgElement"],vd={indexMap:["all","x","all","y","all","x","all","y"],all(r,n,i,e){r.x=i.x+(Math.abs(i.w)-e*2)*n.x+e,r.y=i.y+(Math.abs(i.h)-e*2)*n.y+e},x(r,n,i,e){r.x=i.x+(Math.abs(i.w)-e*2)*n.x+e},y(r,n,i,e){r.y=i.y+(Math.abs(i.h)-e*2)*n.y+e},moverOf(r){let n=this.indexMap[r];return n?this[n]:null}},dn=(()=>{let n=class n{elementRef;annotService;editService;contentService;subscriptionService;pageService;$svg;pathRenderer;freeDrawRef;annotInk;status=X.RENDER;viewClasses={create:!1,debug:!1,remove:!1};srcRect;srcInks;srcBbox;get data(){return this.annotInk}constructor(e,t,o,s,c,u){this.elementRef=e,this.annotService=t,this.editService=o,this.contentService=s,this.subscriptionService=c,this.pageService=u}isCreate(){return this.status===X.CREATE}ngOnChanges(e){e.status&&this.annotService.bindCursorClass(this.viewClasses,this.status),e.annotInk&&(this.pathRenderer&&(this.pathRenderer.points=this.getTransformedPoints(),this.pathRenderer.options={strokeColor:this.annotInk.attributes.color,strokeWidth:this.annotInk.attributes.width}),this.preserveSource())}ngOnInit(){this.subscriptionService.push(this.contentService.annotEvent$.pipe(w(()=>!this.isCreate()),w(e=>e?.annot.oid===this.annotInk.oid)).subscribe({next:()=>{this.fitBox(),this.pathRenderer&&(this.pathRenderer.points=this.getTransformedPoints(),this.pathRenderer.options={strokeColor:this.annotInk.attributes.color,strokeWidth:this.annotInk.attributes.width})}}))}ngAfterViewInit(){this.pathRenderer=new qo(this.$svg.nativeElement,{maxVertexCountPerPath:30,useRealtimeBezier:!0,useRealTimeLinearize:!0,realtimeLinearizeMinDistance:3,useTrackingPoint:!0,strokeColor:this.annotInk.attributes.color,strokeWidth:this.annotInk.attributes.width,renderingMode:"origin",optimizationLinearizeMinDistance:1,optimizationMaxCurveFittingErrorCount:1}),this.isCreate()?(this.freeDrawRef=this.pathRenderer.getFreeDrawRef(),this.freeDrawRef.start({x:this.annotInk.attributes.inkList[0][0].x,y:this.annotInk.attributes.inkList[0][0].y})):this.pathRenderer.points=this.getTransformedPoints()}ngOnDestroy(){S.removeElement(this.elementRef.nativeElement),Array.isArray(this.srcInks)&&this.srcInks.splice(0),fe.destroy(this)}pvOnRepress(e){this.freeDrawRef&&!this.freeDrawRef.finished&&this.freeDrawRef.finish(),this.freeDrawRef=this.pathRenderer.getFreeDrawRef(),this.freeDrawRef.start({x:e.offsetX,y:e.offsetY})}pvOnMove(e){this.freeDrawRef&&!this.freeDrawRef.finished&&this.freeDrawRef.forward({x:e.offsetX,y:e.offsetY})}pvOnRelease(e){this.freeDrawRef&&!this.freeDrawRef.finished&&this.freeDrawRef.finish()}postCreate(e){this.annotInk.attributes.inkList=this.pathRenderer.extactPoints(),this.fitBox(void 0,!0)}verticesOf(e,t,o){return this.editService.createRectVertices(t,o)}postEdit(e,t){this.annotInk.attributes.inkList.forEach(s=>{k.applyVertexDelta(t,...s)}),k.validateRect(this.data.attributes.rect),this.fitBox(),this.preserveSource(),this.pathRenderer.options={translate:{x:0,y:0}}}pvOnVertexMove(e,t,o){if(!this.editService.resizeByRectVertex(this.data,t,o))return;let s=vd.moverOf(t);if(!s)return;let{inkList:c,rect:u,width:C}=this.data.attributes,N=k.bboxOf(u);this.srcInks.forEach((z,Me)=>z.forEach((Bt,Oi)=>s(c[Me][Oi],Bt,N,C+2)));let O={x:N.x-this.srcRect.left,y:this.srcRect.top-u.top||this.srcRect.bottom-u.bottom},U=this.srcBbox.h+N.h;this.srcRect.top!==u.top?O.y=N.h>0?O.y:U:O.y=N.h>0?0:U+O.y,O.x=N.w>0||this.srcRect.left===u.left?O.x:this.srcBbox.w,this.pathRenderer.points=this.getTransformedPoints(),this.pathRenderer.options={translate:O}}isTouched(e){let t=this.data.attributes.inkList,o=t[0][0],s=o;for(let c of t)for(let u of c){o||(o=u),s=u;let C=new st(s.x-o.x,s.y-o.y),N=new st(e.x-o.x,e.y-o.y),O=8+this.data.attributes.width*Ne.hitTestToleranceConst,U=Di.innerProduct(C,N),z=C.norm()*C.norm(),Me=N.orthogonalTo(C).norm();if(0<U&&U<z&&Me<O)return!0;o=u}return!1}fitBox(e,t=!1){if(!S.isDefined(this.pageService.pdfPages))return;let o=this.pageService.pdfPages[this.annotInk.attributes.pageIdx],{inkList:s,rect:c,width:u}=this.data.attributes,C=s.map(O=>O.map(U=>({x:U.x,y:t?o.bbox.h+o.bbox.y-U.y:U.y}))),N=C.reduce((O,U)=>O.concat(U),[]);k.fitBox(e||c,u+2,...N),Object.assign(s,C),Object.assign(e||this.srcRect,c)}preserveSource(){let{inkList:e,rect:t}=this.data.attributes,o={left:Math.min(...e.map(s=>Math.min(...s.map(c=>c.x)))),right:Math.max(...e.map(s=>Math.max(...s.map(c=>c.x)))),bottom:Math.min(...e.map(s=>Math.min(...s.map(c=>c.y)))),top:Math.max(...e.map(s=>Math.max(...s.map(c=>c.y))))};this.srcRect=S.deepClone(t),this.srcBbox={x:0,y:0,w:Math.abs(this.srcRect.right-this.srcRect.left),h:Math.abs(this.srcRect.top-this.srcRect.bottom)},this.srcInks=e.map(s=>s.map(c=>({x:(c.x-o.left)/(o.right-o.left),y:(c.y-o.bottom)/(o.top-o.bottom)})))}getTransformedPoints(){let e=this.annotInk.attributes.rect;return this.annotInk.attributes.inkList.map(t=>t.map(o=>k.transformPoint(o,e)))}};E(n,"\u0275fac",function(t){return new(t||n)(m(re),m(Ie),m(ht),m(de),m(R),m(ut))}),E(n,"\u0275cmp",H({type:n,selectors:[["sd-ink"]],viewQuery:function(t,o){if(t&1&&te(xd,5),t&2){let s;ie(s=ne())&&(o.$svg=s.first)}},inputs:{annotInk:"annotInk",status:"status"},standalone:!1,features:[j([R]),Te],decls:2,vars:1,consts:[["svgElement",""],["stroke-linecap","round","stroke-linejoin","round",3,"ngClass"]],template:function(t,o){t&1&&(J(),x(0,"svg",1,0)),t&2&&p("ngClass",o.viewClasses)},dependencies:[je],encapsulation:2,changeDetection:0}));let r=n;return r})();var Fr=class{d;opacity},kr={highlight:.5,underline:1,strikeout:.8},qa={render(r,n,i){return this[r.type]?(n.opacity=r.attributes.opacity??kr[r.type.toLowerCase()]??1,n.d=(r.attributes.quadPoints||[]).reduce((e,t)=>{let o=this[r.type](t,r.attributes,i);return e.concat(`M${o[0].x.toFixed(3)} ${o[0].y.toFixed(3)} `).concat(`L${o[1].x.toFixed(3)} ${o[1].y.toFixed(3)} `).concat(`L${o[2].x.toFixed(3)} ${o[2].y.toFixed(3)} `).concat(`L${o[3].x.toFixed(3)} ${o[3].y.toFixed(3)} Z `)},S.EMPTY_STRING),n):(console.warn(`Undrawable TextMarkup oid=${r.oid}, type=${r.type}`),null)},Highlight(r,{rect:n},i){let{left:e,bottom:t}=n,o=n.top-n.bottom+i.y;return[{x:r[0].x-e,y:o+t-r[0].y},{x:r[1].x-e,y:o+t-r[1].y},{x:r[3].x-e,y:o+t-r[3].y},{x:r[2].x-e,y:o+t-r[2].y}]},Underline(r,{rect:n},i){let{left:e,bottom:t}=n,o=n.top-n.bottom+i.y,s=.06,c=[];return c[2]={x:r[3].x-e,y:o+t-r[3].y},c[3]={x:r[2].x-e,y:o+t-r[2].y},c[0]={x:c[3].x+(r[0].x-e-c[3].x)*s,y:c[3].y+(o+t-r[0].y-c[3].y)*s},c[1]={x:c[2].x+(r[1].x-e-c[2].x)*s,y:c[2].y+(o+t-r[1].y-c[2].y)*s},c},StrikeOut(r,{rect:n},i){let{left:e,bottom:t}=n,o=n.top-n.bottom+i.y,c=(1-.12)/2;return[{x:(r[0].x-e)*(1-c)+c*(r[2].x-e),y:(o+t-r[0].y)*(1-c)+c*(o+t-r[2].y)},{x:(r[1].x-e)*(1-c)+c*(r[3].x-e),y:(o+t-r[1].y)*(1-c)+c*(o+t-r[3].y)},{x:(1-c)*(r[3].x-e)+(r[1].x-e)*c,y:(1-c)*(o+t-r[3].y)+(o+t-r[1].y)*c},{x:(1-c)*(r[2].x-e)+(r[0].x-e)*c,y:(1-c)*(o+t-r[2].y)+(o+t-r[0].y)*c}]}},Jo=(()=>{let n=class n{annotService;contentService;changeDetectorRef;subscriptionService;elementRef;pageService;data;status=X.RENDER;viewClasses={};path=new Fr;constructor(e,t,o,s,c,u){this.annotService=e,this.contentService=t,this.changeDetectorRef=o,this.subscriptionService=s,this.elementRef=c,this.pageService=u}ngOnInit(){this.subscriptionService.push(this.contentService.annotEvent$.pipe(w(e=>e===null?!1:e.annot.oid===this.data.oid)).subscribe({next:()=>this.detectChange()}))}ngOnDestroy(){S.removeElement(this.elementRef.nativeElement),fe.destroy(this)}ngOnChanges(){this.render(),this.changeCursor()}pvOnMove(e){this.detectChange()}postCreate(e){k.fitTextMarkupBox(this.data)}renderFillColor(){return this.data.attributes.color===null?"transparent":this.data.attributes.color}detectChange(){this.render(),this.changeDetectorRef.markForCheck()}render(){let e=this.pageService.pdfPages?.[this.data.attributes.pageIdx]?.bbox??{x:0,y:0,w:0,h:0};this.status===X.RENDER?qa.render(this.data,this.path,{x:0,y:0,w:e.w,h:e.h}):this.status===X.CREATE&&qa.render(this.data,this.path,e)}changeCursor(){this.annotService.bindCursorClass(this.viewClasses,this.status)}};E(n,"\u0275fac",function(t){return new(t||n)(m(Ie),m(de),m($),m(R),m(re),m(ut))}),E(n,"\u0275cmp",H({type:n,selectors:[["sd-text-markup"]],inputs:{data:"data",status:"status"},standalone:!1,features:[j([R]),Te],decls:2,vars:5,consts:[[3,"ngClass","ngStyle"]],template:function(t,o){t&1&&(J(),h(0,"svg",0),x(1,"path"),_()),t&2&&(p("ngClass",o.viewClasses)("ngStyle",o.viewClasses),l(),B("d",o.path.d)("fill-opacity",o.path.opacity)("fill",o.renderFillColor()))},dependencies:[je,_e],encapsulation:2,changeDetection:0}));let r=n;return r})();var Od=["dragSelect"],bd=["annotElementContainer"],yd=["annotCreatePortal"],Rd=["editableComp"];function Nd(r,n){if(r&1&&x(0,"sd-widget",20,3),r&2){let i=d().$implicit;p("data",i)}}function Pd(r,n){if(r&1&&x(0,"sd-free-text",21,3),r&2){let i=d().$implicit,e=d(2);p("ngStyle",e.annotationStyle(i))("data",i)("status",e.annotStatus)}}function Md(r,n){if(r&1&&x(0,"sd-ink",22,3),r&2){let i=d().$implicit,e=d(2);p("ngStyle",e.annotationStyle(i))("annotInk",i)("status",e.annotStatus)}}function Dd(r,n){if(r&1&&x(0,"sd-line",23,3),r&2){let i=d().$implicit,e=d(2);p("ngStyle",e.annotationStyle(i))("annotLine",i)("status",e.annotStatus)}}function wd(r,n){if(r&1&&x(0,"sd-poly-shape",21,3),r&2){let i=d().$implicit,e=d(2);p("ngStyle",e.annotationStyle(i))("data",i)("status",e.annotStatus)}}function Ld(r,n){if(r&1&&x(0,"sd-rect",21,3),r&2){let i=d().$implicit,e=d(2);p("ngStyle",e.annotationStyle(i))("data",i)("status",e.annotStatus)}}function Fd(r,n){if(r&1&&x(0,"sd-stamp",24,3),r&2){let i=d().$implicit,e=d(2);p("data",i)("pdfData",e.pdfPage)}}function kd(r,n){if(r&1&&x(0,"sd-text",25,3),r&2){let i=d().$implicit,e=d(2);p("ngStyle",e.annotationStyle(i))("annotText",i)("status",e.annotStatus)("pdfPage",e.pdfPage)}}function Vd(r,n){if(r&1&&x(0,"sd-text-markup",21,3),r&2){let i=d().$implicit,e=d(2);p("ngStyle",e.annotationStyle(i))("data",i)("status",e.annotStatus)}}function Ud(r,n){if(r&1&&x(0,"sd-redaction",26,3),r&2){let i=d().$implicit,e=d(2);p("data",i)("status",e.annotStatus)}}function Bd(r,n){if(r&1&&x(0,"sd-link",21,3),r&2){let i=d().$implicit,e=d(2);p("ngStyle",e.annotationStyle(i))("data",i)("status",e.annotStatus)}}function Gd(r,n){if(r&1&&x(0,"div",27),r&2){let i=d().$implicit,e=d(2);p("ngStyle",e.appearanceStyle(i))}}function Wd(r,n){if(r&1&&(h(0,"p"),P(1),T(2,"json"),_()),r&2){let i=d().$implicit;l(),Re("TODO::",A(2,1,i),"")}}function Hd(r,n){if(r&1){let i=M();h(0,"li",10,2),I("mousedown",function(t){let o=f(i).$implicit,s=d(2);return g(s.onAnnotMousedown(t,o))})("touchstart",function(t){let o=f(i).$implicit,s=d(2);return g(s.onAnnotTouchstart(t,o))})("mousemove",function(t){let o=f(i).$implicit,s=Oe(1),c=d(2);return g(c.mouseMoveOnAnnot(o,s,t))}),y(2,Nd,2,1,"sd-widget",11)(3,Pd,2,3,"sd-free-text",12)(4,Md,2,3,"sd-ink",13)(5,Dd,2,3,"sd-line",14)(6,wd,2,3,"sd-poly-shape",12)(7,Ld,2,3,"sd-rect",12)(8,Fd,2,2,"sd-stamp",15)(9,kd,2,4,"sd-text",16)(10,Vd,2,3,"sd-text-markup",12)(11,Ud,2,2,"sd-redaction",17)(12,Bd,2,3,"sd-link",12)(13,Gd,1,1,"div",18)(14,Wd,3,3,"p",19),_()}if(r&2){let i=n.$implicit,e=d(2);G("blend",e.isBlend(i)),p("ngSwitch",i.type)("ngClass",e.classes)("ngStyle",e.containerStylesOf(i)),l(2),p("ngSwitchCase","Widget"),l(),p("ngSwitchCase","FreeText"),l(),p("ngSwitchCase","Ink"),l(),p("ngSwitchCase","Line"),l(),p("ngSwitchCase",e.caseOf("PolyShape",i.type)),l(),p("ngSwitchCase",e.caseOf("Rect",i.type)),l(),p("ngSwitchCase","Stamp"),l(),p("ngSwitchCase","Text"),l(),p("ngSwitchCase",e.caseOf("TextMarkup",i.type)),l(),p("ngSwitchCase","Redact"),l(),p("ngSwitchCase","Link"),l(),p("ngIf",e.shouldRemoveAppearance(i))}}function zd(r,n){if(r&1){let i=M();h(0,"ul",8,1),I("mousemove",function(t){f(i);let o=d();return g(o.onMousemove(t))}),y(2,Hd,15,17,"li",9),_()}if(r&2){let i=d();p("ngStyle",i.styles),l(2),p("ngForOf",i.visibleAnnots)("ngForTrackBy",i.trackById)}}function jd(r,n){}function $d(r,n){if(r&1){let i=M();h(0,"sd-annot-edit",28),I("select",function(t){f(i);let o=d();return g(o.postSelect(t))})("edit",function(t){f(i);let o=d();return g(o.renderModel(t))})("postEdit",function(t){f(i);let o=d();return g(o.finishEdit(t.isValid))}),_()}if(r&2){let i=d();p("pdfPage",i.pdfPage)("comps",i.filteredEditableComps)("acroFields",i.acroFormService.acroFields)}}function Yd(r,n){if(r&1){let i=M();h(0,"sd-drag-select",29,4),I("select",function(t){f(i);let o=d();return g(o.postSelect(t))})("clickEvent",function(t){f(i);let o=d();return g(o.selectByPriority(t[0],t[1],!1))}),_()}if(r&2){let i=d();p("comps",i.filteredEditableComps)("page",i.pdfPage)}}var Xd={[F.ERASER]:!0},Kd={PolyShape:{Polygon:!0,PolyLine:!0},TextMarkup:{Highlight:!0,StrikeOut:!0,Underline:!0},Rect:{Circle:!0,Square:!0}},un=class un{annotService;autoSaveService;annotSelectedService;contentService;popupService;pageService;elementRef;changeDetectorRef;documentService;acroFormService;toastService;shortcutService;subscriptionService;scriptService;store$;translatePipe;instanceService;signatureService;selectTextService;sdContextMenuService;renderer;loggingService;pdfPage;documentId;selectText;dragSelect;annotElementContainer;editableComps;annotCreatePortal;get hostTabIndex(){return this.isEditing()?0:-1}dragMode;scale;degree;annotTool=null;preferences=null;oidToStyleMap=new Map;data=[];hasSignedSignature;isContextMenuOpened=!1;isAnnotLoading=!1;continueWriting=!1;isTextHover=!1;visibleAnnots=[];get styles(){return this._styles||(this._styles={height:`${this.pdfPage.bbox.y+this.pdfPage.bbox.h}${D.UNIT}`,width:`${this.pdfPage.bbox.x+this.pdfPage.bbox.w}${D.UNIT}`}),D.bindLayoutOrder(this._styles,this.isActiveEraser?D.LayoutOrder.AnnotCreate:null)}get classes(){return{debug:this.debug}}get annotStatus(){return this.isActiveEraser?X.REMOVE:X.RENDER}get isDeletable(){return Y.get(a.DELETE_FORM)||Y.get(a.DELETE_ANNOTATION)}get isActiveEraser(){return this.annotTool===F.ERASER}get filteredEditableComps(){return S.isDefined(this.editableComps)?this.editableComps.filter(n=>n.data).filter(n=>!this.annotService.isReadonly(n.data.oid)):[]}get isEditable(){return!this.hasSignedSignature||this.documentService.checkAuthority(be.EDIT_ANNOTATION)}get oidToZIndexMap(){let n={};for(let i of this.oidToStyleMap.keys()){let e=this.oidToStyleMap.get(i);n[i]=Number(e[D.SK_Z_INDEX])}return n}get shouldRemoveAppearance(){return k.shouldRemoveAppearance}_styles;debug=!1;afterViewJob=null;focusedAnnot=null;fontsResponse={fontList:[]};annotOrder=[];annotZIndexPriority=[];annotContext;visibleAnnotationOids;annotCreateRef;constructor(n,i,e,t,o,s,c,u,C,N,O,U,z,Me,Bt,Oi,ur,hr,mr,fc,gc,Cc){this.annotService=n,this.autoSaveService=i,this.annotSelectedService=e,this.contentService=t,this.popupService=o,this.pageService=s,this.elementRef=c,this.changeDetectorRef=u,this.documentService=C,this.acroFormService=N,this.toastService=O,this.shortcutService=U,this.subscriptionService=z,this.scriptService=Me,this.store$=Bt,this.translatePipe=Oi,this.instanceService=ur,this.signatureService=hr,this.selectTextService=mr,this.sdContextMenuService=fc,this.renderer=gc,this.loggingService=Cc}ngOnChanges(n){n.documentId&&this.delayFetch()}ngOnInit(){this.subscriptionService.push(this.store$.pipe(le("dragMode")).subscribe({next:n=>{this.dragMode=n,this.changeDetectorRef.markForCheck()}}),this.store$.pipe(le("scale")).subscribe({next:n=>this.scale=n}),this.store$.pipe(le("degree")).subscribe({next:n=>this.degree=n}),this.store$.pipe(Be("annot","continueWriting")).subscribe({next:n=>{this.continueWriting=n}}),this.annotService.popup$.pipe(w(n=>b.hasPopup(n)&&this.pdfPage.ref===n.attributes.pageIdx)).subscribe({next:n=>this.togglePopup(n)}),this.store$.pipe(Zi()).subscribe({next:n=>{if(this.annotTool=n,this.annotCreateRef){let i=this.annotCreateRef._componentInstance.instance,e=i.annotView;i.annot&&e instanceof dn&&e.data.attributes.inkList.length&&i.clear(void 0,!1),this.annotCreateRef.close(),this.annotCreateRef=void 0}!this.annotTool||Xd[this.annotTool]||(this.annotCreateRef=this.instanceService.instant(this.annotCreatePortal,Ko,{data:{page:this.pdfPage,documentId:this.documentId}}),this.annotCreateRef.onEvent().pipe(Tt(i=>n===F.INSTANT_SIGNATURE?(this.signatureService.toggleOverlay(!0),this.signatureService.openSignatureDrawDialog(this.documentId,i).pipe(Hn(e=>{throw this.signatureService.toggleOverlay(!1),e}),Tt(e=>{if(!e)throw new fs("User cancelled a drawing signature.");return this.signatureService.module$.pipe(Tt(t=>t?this.signatureService.injectSignature(e,"create",this.annotContext.signature?.serverSide?this.annotContext.signature.certificate||null:void 0,this.annotContext.signature?.identificationNumber).pipe(w(()=>!1)):Tn(e).pipe(Ve(()=>this.signatureService.toggleOverlay(!1)))))}),Ve(e=>{this.annotService.putModel(e),this.annotService.normalizeWidget(e,this.acroFormService.acroFields)}))):Tn(i))).subscribe({next:i=>{this.pushAnnot(i),this.changeDetectorRef.markForCheck()}}),this.annotCreateRef.afterClosed().subscribe({next:()=>this.changeDetectorRef.detectChanges()}))}}),this.annotService.editor$.subscribe({next:()=>{this.closeEditor()}}),this.contentService.annotEvent$.pipe(w(S.isDefined),w(n=>n.annot.attributes.pageIdx===this.pdfPage.ref),w(n=>n.sdEventType!==pe.FOCUSED&&n.sdEventType!==pe.UNFOCUSED)).subscribe({next:n=>this.updateModel(n)}),this.contentService.annotEvent$.pipe(w(S.isDefined),w(n=>n.annot.attributes.pageIdx===this.pdfPage.ref),w(n=>n.sdEventType===pe.FOCUSED||n.sdEventType===pe.UNFOCUSED)).subscribe({next:n=>{this.focusedAnnot=n.sdEventType===pe.FOCUSED?n.annot:null,this.oidToStyleMap.set(n.annot.oid,null),this.changeDetectorRef.markForCheck()}}),this.contentService.annotEvent$.pipe(w(S.isDefined),w(n=>n.annot.attributes.pageIdx===this.pdfPage.ref),w(n=>n.sdEventType===pe.UPDATE)).subscribe({next:n=>this.updateModel(n)}),this.contentService.annotListEvent$.pipe(w(()=>!this.continueWriting),w(n=>n.pageIdx===this.pdfPage.ref),w(n=>n.from==="AnnotComponent"&&n.sdEventType===pe.CREATE&&S.isDefined(n.annot))).subscribe({next:n=>this.selectAnnot(n.annot,k.AnnotViewEvt,!0,!0)}),this.store$.pipe(Be()).subscribe({next:n=>{this.preferences=n,this.data&&this.synchronize(this.data)}}),this.contentService.reload$.pipe(w(n=>Ro.type(n,yo.Annot))).subscribe({next:n=>{this.isAnnotLoading=!0,this.closeEditor(),this.changeDetectorRef.markForCheck(),n.types?.length===1?this.delayFetch(0):this.delayFetch()}}),this.pageService.pageArrangeEvt$.pipe(w(n=>this.pageService.arrangeAffectedChecker(this.pdfPage.originalIndex,n))).subscribe({next:()=>this.delayFetch()}),this.acroFormService.acroFields$.pipe(w(n=>!!n)).subscribe({next:()=>{this.data&&(this.normalizeWidgets(this.data),this.changeDetectorRef.markForCheck())}}),this.contentService.fontsResponse$.subscribe({next:n=>this.fontsResponse=n}),this.annotSelectedService.selectionInfoChange$.pipe(w(()=>this.annotSelectedService.pageIndex===this.pdfPage.ref)).subscribe({next:()=>{this.updateSelectedAnnotations(!0),this.annotSelectedService.selectedComponents.forEach(n=>{if(!S.isDefined(n.elementRef)){this.loggingService.common("warn",Ee.NOT_EXIST,this.translatePipe.joinedTransform("ANNOTATION","ELEMENT"));return}this.renderer.setStyle(n.elementRef.nativeElement.parentElement,"opacity",n.data.attributes.opacity)})}}),this.annotService.annotOrder$.subscribe({next:n=>{this.annotOrder=n[this.pdfPage.ref]??[],[this.data,this.visibleAnnots].forEach(i=>{i.sort((e,t)=>this.annotOrder.indexOf(e.oid)-this.annotOrder.indexOf(t.oid))}),this.changeDetectorRef.markForCheck()}}),Et(this.shortcutService.getShortcutEvent(yt.TAB_KEY),this.shortcutService.getShortcutEvent(yt.SHIFT_TAB_KEY)).pipe(w(()=>this.elementRef.nativeElement.contains(document.activeElement)),w(()=>this.isEditing())).subscribe({next:n=>{let i=this.annotSelectedService.selectedComponents,e=i[0].data,t=i[i.length-1].data;if(n.shiftKey&&!b.isWidget(e)||!n.shiftKey&&!b.isWidget(t))return;n.preventDefault(),n.stopPropagation();let o;n.shiftKey?o=this.findPreviousSelectionField(e):o=this.findNextSelectionField(t),o.length>0&&(this.annotSelectedService.unselectAll(),this.annotSelectedService.pageIndex=this.pdfPage.ref,this.annotSelectedService.trigger=n.type,this.annotSelectedService.isFirstSelection=!1,o.forEach(s=>this.annotSelectedService.add(s)),this.annotSelectedService.dispatchSelectionInfoChange())}}),this.acroFormService.hasSignedSignature$.subscribe({next:n=>this.hasSignedSignature=n}),this.sdContextMenuService.contextMenuStatus$.subscribe({next:n=>this.isContextMenuOpened=n}),this.store$.pipe(Oo()).subscribe({next:n=>this.annotContext=n}),this.annotService.annotVisibleEvent$.subscribe({next:n=>{this.visibleAnnots=this.data,this.visibleAnnotationOids=n,this.applyHideAnnotation(),this.changeDetectorRef.markForCheck()}}),this.selectTextService.isTextHover$.subscribe({next:n=>{this.isTextHover=n,this.changeDetectorRef.markForCheck()}}))}ngOnDestroy(){this.annotSelectedService.removeNullComp(),this.oidToStyleMap.clear(),S.removeElement(this.elementRef.nativeElement),fe.destroy(this)}caseOf(n,i){return Kd[n][i]?i:null}touchToMouse(n){return S.touchToMouseEvt(n,this.degree,this.scale,this.pdfPage)}isFetched(){return this.data?.length>0}isEditing(){return!this.annotTool&&this.annotSelectedService.getSelectedInfo()&&this.annotSelectedService.pageIndex===this.pdfPage.ref&&this.annotSelectedService.selectedComponents&&this.annotSelectedService.length>0&&this.annotSelectedService.selectedComponents.every(n=>n.data.oid!==null)}trackById(n,i){return i.oid}containerStylesOf(n){let i=this.oidToStyleMap.get(n.oid);if(i)return i;i=ge(ge({},i||{}),k.elementStyleOf(n));let e;b.isRedact(n)?e=this.focusedAnnot===n?D.LayoutOrder.BlackMarking+1:D.LayoutOrder.BlackMarking:e=this.focusedAnnot===n?D.LayoutOrder.AnnotRender+1:D.LayoutOrder.AnnotRender,D.bindLayoutOrder(i,e),i.opacity=(n.attributes.opacity||n.attributes.opacity===0)&&n.attributes.opacity>=0&&n.attributes.opacity!==1&&!k.shouldRemoveAppearance(n)?n.attributes.opacity:null,i.transform=null,this.oidToStyleMap.set(n.oid,i);let t=this.annotZIndexPriority.indexOf(n.oid);return t>-1&&(i[D.SK_Z_INDEX]=(parseInt(i[D.SK_Z_INDEX],10)+t+1).toString(10)),b.isWidget(n)&&(i[D.SK_Z_INDEX]=(parseInt(i[D.SK_Z_INDEX],10)+this.annotZIndexPriority.length+1).toString(10)),i}remove(n,i){if(b.isRedact(n)){if(!this.documentService.checkAuthority(be.EDIT_REDACTION))return}else if(!this.documentService.checkAuthority(be.EDIT_ANNOTATION)||qe.get(n.attributes.F,7))return;if(!n||ia[n.type]&&this.dragMode!==Ae.SELECT_ANNOT)return!0;let e=this.editableComps.find(t=>t.data?.oid===n.oid);if(!e){if(b.isPopup(n))this._remove(n.oid,i);else{let t=n;this.loggingService.common("warn",Ee.INVALID,this.translatePipe.transform("ANNOTATION"),`oid[${t.oid}], type[${t.type}]`)}return!1}if(i.type.indexOf("annotViewEvt")<0){let t=i.type.indexOf("touch")<0?i:this.touchToMouse(i),o={x:e.data.attributes.rect.left+t.offsetX,y:e.data.attributes.rect.top-t.offsetY};if(e.isTouched&&!e.isTouched(o))return}i.stopPropagation(),i.preventDefault(),this._remove(n.oid,i)}mouseMoveOnAnnot(n,i,e){let t=this.editableComps.find(c=>c.data?.oid===n.oid);if(t?.data&&b.isWidget(t.data)){this.isActiveEraser&&!Y.get(a.DELETE_FORM)?i.style.cursor="not-allowed":i.style.cursor="inherit";return}let o=e.type.indexOf("touch")<0?e:this.touchToMouse(e),s={x:t.data.attributes.rect.left+o.offsetX,y:t.data.attributes.rect.top-o.offsetY};if(!this.isActiveEraser&&t.isTouched&&!t.isTouched(s)){i.style.cursor="default",this.dragMode===Ae.MOVE?i.style.cursor="grab":this.dragMode===Ae.SELECT_TEXT&&(i.style.cursor="text");return}!this.isActiveEraser&&!this.annotService.isReadonly(n.oid)?i.style.cursor="pointer":!b.isWidget(n)&&!Y.get(a.DELETE_ANNOTATION)?i.style.cursor="not-allowed":i.style.cursor="inherit"}isAnnotSelectMode(){let n=this.dragMode!==Ae.AUTO?!1:S.isDefined(this.dragSelect)?this.dragSelect.created?!0:!this.isTextHover:!this.isTextHover;return this.dragMode===Ae.SELECT_ANNOT||n}selectAnnot(n,i,e,t){if(this.autoSaveService.isAutoSaving||this.pageService.hasAnnotationAffectedLog())return this.toastService.create({toastStyle:dt.NOTIFICATION,header:this.translatePipe.transform("NOTIFICATION"),content:this.autoSaveService.isAutoSaving?this.translatePipe.transform("AUTO_SAVE_DETECTED"):this.translatePipe.transform("PAGE_CHANGELOG_DETECTED")}),!1;if(this.isAnnotLoading)return!1;let o=this.checkEditable(n,i);if(!o.editable)return!!o.returnValue;let s=this.editableComps.find(c=>c.data?.oid===n.oid);if(!s)return this.loggingService.common("warn",Ee.INVALID,this.translatePipe.transform("ANNOTATION"),`oid[${n.oid}], type[${n.type}]`),!1;if(i.type.indexOf("annotViewEvt")<0){let c=i.type.indexOf("touch")<0?i:this.touchToMouse(i),u={x:s.data.attributes.rect.left+c.offsetX,y:s.data.attributes.rect.top-c.offsetY};if(s.isTouched&&!s.isTouched(u))return this.selectByPriority(u,c,t)===void 0?!!this.useDrag(i):(i.isDummy||this.reorderComp(),!0);this.reorderComp(n)}if(i.stopPropagation(),this.isEditing()||this.loggingService.common("debug",Ee.OPENED,this.translatePipe.transform("ANNOTATION_FLOATING_MENU"),`[oid[${n.oid}], type[${n.type}], page[${this.pdfPage.ref+1}]]`),b.isText(s.data)&&this.dragMode!==Ae.SELECT_ANNOT&&this.dragMode!==Ae.AUTO&&this.togglePopup(s.data),e)this.annotSelectedService.unselectAll();else if(this.annotSelectedService.selectedComponents.some(c=>c.data.oid===n.oid))return!1;return this.annotSelectedService.pageIndex=this.pdfPage.ref,this.annotSelectedService.add(s),this.annotSelectedService.trigger=i.type,this.selectTextService.publishSelectedText(null),this.changeDetectorRef.markForCheck(),t&&(this.annotSelectedService.isFirstSelection=!1),!0}selectByPriority(n,i,e){for(let t=this.visibleAnnots.length-1;t>=0;t--){let o=this.visibleAnnots[t];if(o.attributes.rect.left<=n.x&&n.x<=o.attributes.rect.right&&o.attributes.rect.bottom<=n.y&&n.y<=o.attributes.rect.top)return this.visibleAnnots.splice(this.visibleAnnots.indexOf(o),1),this.selectAnnot(o,{offsetX:n.x-o.attributes.rect.left,offsetY:o.attributes.rect.top-n.y,clientX:i.clientX,clientY:i.clientY,type:i.type,stopPropagation:()=>i.stopPropagation(),preventDefault:()=>i.preventDefault(),isDummy:!0},!0,e),this.visibleAnnots.push(o),o}}useDrag(n){if(this.dragMode===Ae.MOVE)return!0;if(this.dragMode===Ae.SELECT_TEXT)return this.selectText?.selectedElementRef?.nativeElement&&this.selectText.selectedElementRef.nativeElement.dispatchEvent(new MouseEvent(n.type,n)),!1}postSelect(n){if(!n||!n.selectedComps||n.selectedComps.length===0){this.annotSelectedService.unselectAll(),this.closeEditor();return}let i=n.selectedComps[0].data;this.loggingService.common("debug",Ee.SELECTED,this.translatePipe.transform("ANNOTATION"),i),this.reorderComp(i),this.notifyToAnnotList(i,n.trigger)}finishEdit(n=!0){this.annotSelectedService.pageIndex===this.pdfPage.ref&&this.annotSelectedService.selectedComponents.forEach(i=>{this.rerenderModel(i.data),n&&(this.annotService.putModel(i.data,"modify"),this.contentService.fireAnnotListEvent({from:"AnnotComponent",sdEventType:pe.UPDATE,pageIdx:this.pdfPage.ref,annot:i.data}))})}pushAnnot(n){if(!b.isPopup(n)){if(b.isWidget(n)){let i=n.attributes;i.MK===void 0&&(i.MK={}),i.MK.R=D.normalizeDegree(this.pdfPage.r+this.degree),(b.isTextField(n,this.acroFormService.acroFields)||b.isListBox(n,this.acroFormService.acroFields)||b.isComboBox(n,this.acroFormService.acroFields))&&this.fontsResponse.fontList.length===0&&this.toastService.create({toastStyle:dt.FAILURE,header:this.translatePipe.transform("ERROR"),content:`${this.translatePipe.transform("AVAILABLE_FONT_NOT_EXISTS")}`})}this.visibleAnnots.push(n),this.reorderComp(n),setTimeout(()=>{this.contentService.fireAnnotListEvent({from:"AnnotComponent",sdEventType:pe.CREATE,pageIdx:this.pdfPage.ref,annot:n})})}}rerenderModel(n){this.oidToStyleMap.set(n.oid,null)}renderModel(n){n.preAction&&this[n.preAction]&&this[n.preAction](n.model),Object.assign(this.containerStylesOf(n.model),n.transform)}prevent(n){this.isActiveEraser||(n.preventDefault(),n.stopPropagation())}onAnnotMousedown(n,i){if(!this.annotService.isReadonly(i.oid)){if(n.button===2){this.selectTextService.publishSelectedText(null);return}this.isContextMenuOpened&&this.sdContextMenuService.publishContextMenuStatus(!1),this.isActiveEraser&&this.isDeletableAnnotation(i)?this.remove(i,n):this.selectAnnot(i,n,!0,!1)}}isDeletableAnnotation(n){return b.isWidget(n)&&Y.get(a.DELETE_FORM)||!b.isWidget(n)&&Y.get(a.DELETE_ANNOTATION)}onAnnotTouchstart(n,i){this.onAnnotMousedown(this.touchToMouse(n),i)}closeEditor(){this.annotSelectedService.pageIndex===this.pdfPage.ref&&(this.annotSelectedService.unselectAll(),this.loggingService.common("debug",Ee.CLOSED,this.translatePipe.transform("ANNOTATION_FLOATING_MENU"),`[page-${this.pdfPage.i+1}]`),this.changeDetectorRef.markForCheck())}updateModel(n){switch(n.sdEventType){case pe.DELETE:this._remove(n.annot.oid,k.AnnotViewEvt,n.emitEvent);break;case pe.SELECTED:case pe.MULTI_SELECTED:if(this.editableComps){let i=n.sdEventType===pe.SELECTED;this.selectAnnot(n.annot,k.AnnotViewEvt,i,!0)}else this.afterViewJob=()=>this.selectAnnot(n.annot,k.AnnotViewEvt,!0,!0);break;case pe.UPDATE:n.from==="AnnotationViewComponent"||n.from==="EditMenuComponent"||n.from==="AnnotService"?(this.synchronize(this.data),this.updateFromUI(n.annot)):n.from==="AcroFormService"?this.updateFromData(n):this.updateFromUI(n.annot);break;case pe.CREATE:this.synchronize(this.data),this.reorderComp(n.annot);break}this.contentService.fireAnnotEvent(null),this.changeDetectorRef.detectChanges()}updateFromData(n){let i=this.data.findIndex(({oid:e})=>e===n.annot.oid);this.data[i]=n.annot,n.annot.visible&&(i=this.visibleAnnots.findIndex(({oid:e})=>e===n.annot.oid),this.visibleAnnots[i]=n.annot)}normalizeWidgets(n){this.acroFormService.isAcroFieldsInitialized()&&n.forEach(i=>{this.annotService.normalizeWidget(i,this.acroFormService.acroFields,qi.IGNORE)&&(this.annotService.putModel(i,"modify",qi.IGNORE),this.contentService.fireAnnotEvent({annot:i}))})}synchronize(n){this.data=n,this.visibleAnnots.splice(0);let i=[];this.data.forEach(e=>{!e.visible||b.isPopup(e)||!this.preferences||this.documentService.checkAuthority(be.ANNOTATION)&&!this.documentService.checkAuthority(be.FORM)&&b.isWidget(e)||this.documentService.checkAuthority(be.FORM)&&!this.documentService.checkAuthority(be.ANNOTATION)&&!b.isWidget(e)||i.push(e)}),i.forEach(e=>{(e.oid===e.IRT||i.findIndex(t=>e.IRT===t.oid)<0)&&this.visibleAnnots.push(e)}),this.oidToStyleMap.clear(),this.applyHideAnnotation(),this.changeDetectorRef.markForCheck()}applyHideAnnotation(){this.visibleAnnotationOids&&(this.visibleAnnots=this.visibleAnnots.filter(n=>b.isWidget(n)||this.visibleAnnotationOids?.includes(n.oid)))}doAfterPagedLoaded(){setTimeout(()=>{this.updateSelectedAnnotations(!1),typeof this.afterViewJob=="function"&&this.afterViewJob(),this.afterViewJob=null})}fetch(){if(this.pdfPage.isDuplicated){this.synchronize([]);return}this.subscriptionService.set("dataSub",this.annotService.getAnnotations(this.pdfPage.ref).pipe(es(()=>this.isAnnotLoading=!1)).subscribe({next:n=>{this.annotService.publishAnnotOrder(n.map(i=>i.oid),this.pdfPage.ref),this.synchronize(n),this.normalizeWidgets(n),this.doAfterPagedLoaded()},error:n=>{throw this.synchronize([]),n}}))}delayFetch(n=D.TaskPriority.ANNOT){this.subscriptionService.set("delayedFetchSub",ri(n).subscribe({next:()=>this.fetch()}))}togglePopup(n,i=!1,e){if(!b.hasPopup(n)||!i&&this.isActiveEraser)return;let t=this.data.find(o=>o.oid===n.Popup);if(!t){this.loggingService.common("warn",Ee.INVALID,this.translatePipe.transform("POPUP"),`[${n.Popup}] of model[${n.oid}]`);return}this.popupService.togglePopup({src:n,popup:t,pdfPage:this.pdfPage,open:e})}_remove(n,i,e=!0){let t=this.visibleAnnots.findIndex(C=>C.oid===n);if(t>=0){if(this.isEditing()){let C=this.annotSelectedService.selectedComponents.findIndex(N=>N.data.oid===n);C>-1&&(this.annotSelectedService.selectedComponents.splice(C,1),this.annotSelectedService.dispatchSelectionInfoChange())}this.visibleAnnots.splice(t,1)}let o=[].concat(...this.annotService.getActionLog().map(C=>C.annots)),s=o.find(C=>C.oid===n&&C.action==="remove"),c=this.data.findIndex(C=>C.oid===n);if(c<0)return!s&&o.length>0&&this.loggingService.common("warn",Ee.NOT_EXIST,this.translatePipe.transform("ANNOTATION"),`oid[${n}]`),!1;let u=this.data.splice(c,1)[0];return b.isWidget(u)?(this.acroFormService.unlinkWidget(u),this.scriptService.executeAll(this.acroFormService.acroFields)):b.isPopup(u)&&(this.popupService.togglePopup({src:null,popup:u,pdfPage:this.pdfPage,open:!1}),this.removePopupLink(u)),this.annotService.putModel(u,"remove",qi.MERGE_WITH_PREVIOUS,e),this.togglePopup(u,!0,!1),b.hasPopup(u)&&this.remove(this.data.find(C=>b.isPopup(C)&&C.oid===u.Popup),i),this.contentService.fireAnnotListEvent({from:"AnnotComponent",sdEventType:pe.DELETE,pageIdx:this.pdfPage.ref,annot:u}),this.data.filter(C=>C.IRT===u.oid).forEach(C=>this.remove(C,i)),!1}checkEditable(n,i){return b.isLink(n)&&this.dragMode!==Ae.SELECT_ANNOT||b.isWidget(n)&&this.dragMode!==Ae.SELECT_ANNOT||b.isWidget(n)&&!this.isEditable?{editable:!1,returnValue:!0}:i.type===k.AnnotViewEvt.type?{editable:!0}:ta[n.type]?(this.togglePopup(n),{editable:!1,returnValue:!1}):{editable:!0}}reorderComp(n){if(!n)return;let i=this.annotZIndexPriority.indexOf(n.oid);i>-1&&this.annotZIndexPriority.splice(i,1),this.annotZIndexPriority.push(n.oid),this.annotZIndexPriority.forEach(e=>this.oidToStyleMap.set(e,null)),b.isRedact(n)||this.visibleAnnots.filter(e=>b.isWidget(e)).forEach(e=>this.rerenderModel(e))}notifyToAnnotList(n,i){i!==k.AnnotViewEvt.type&&this.contentService.fireAnnotListEvent({from:"AnnotComponent",sdEventType:pe.SELECTED,pageIdx:this.pdfPage.ref,annot:n})}updateFromUI(n){this.visibleAnnots.findIndex(i=>i.oid===n.oid)<0||(this.finishEdit(),this.changeDetectorRef.markForCheck())}updateSelectedAnnotations(n){this.editableComps&&(this.annotSelectedService.selectedComponents.forEach((i,e)=>{if(!this.annotSelectedService.selectedComponents[e].elementRef){let t=this.editableComps.find(o=>o.data.oid===i.data.oid);t&&(this.annotSelectedService.selectedComponents[e]=t,n||this.annotSelectedService.dispatchSelectionInfoChange())}}),this.changeDetectorRef.markForCheck())}removePopupLink(n){let i=this.data.find(e=>e.Popup===n.oid);i&&(i.Popup=null,this.annotService.putModel(i,"modify"))}findNextSelectionField(n){let i=[],e=Array.from(this.editableComps).filter(o=>b.isWidget(o.data)),t=e.findIndex(o=>o.data?.oid===n.oid);if(t>=e.length-1)return i;if(b.isRadioWidget(n,this.acroFormService.acroFields)){let o=this.acroFormService.acroFields[n.attributes.Parent].Kids;if(o.every(c=>this.annotSelectedService.selectedComponents.findIndex(u=>u.data?.oid===c.oid)>-1)&&o.length>1){let c=e.find(u=>u.data?.attributes.Parent===n.attributes.Parent);i.push(c)}else i.push(e[t+1])}else{let o=e[t+1];b.isRadioWidget(o.data,this.acroFormService.acroFields)?i.push(...e.filter(s=>s.data?.attributes.Parent===o.data.attributes.Parent)):i.push(e[t+1])}return i}findPreviousSelectionField(n){let i=[],e=Array.from(this.editableComps).filter(o=>b.isWidget(o.data)),t=e.findIndex(o=>o.data?.oid===n.oid);if(t<1)return i;if(b.isRadioWidget(n,this.acroFormService.acroFields)){let o=this.acroFormService.acroFields[n.attributes.Parent].Kids;if(o.every(c=>this.annotSelectedService.selectedComponents.findIndex(u=>u.data?.oid===c.oid)>-1)||o.length===1)i.push(e[t-1]);else{let c=o.filter(C=>C.i===this.pdfPage.ref),u=c.findIndex(C=>C.oid===n.oid);u===0?i.push(...e.filter(C=>C.data?.attributes.Parent===n.attributes.Parent)):i.push(e.find(C=>C.data?.oid===c[u-1].oid))}}else i.push(e[t-1]);return i}appearanceStyle(n){let i=k.appearanceStyle(n.attributes);return b.isTextMarkup(n)?Object.assign(i,{opacity:n.attributes.opacity??kr[n.type.toLowerCase()]??1}):i}annotationStyle(n){return k.annotationStyle(n.attributes)}onMousemove(n){if(!pt.isEventInPage(n,this.pdfPage)&&n.target===this.annotElementContainer.nativeElement){this.renderer.setStyle(this.annotElementContainer.nativeElement,"cursor","inherit");return}if(this.isActiveEraser&&this.isDeletable){this.renderer.setStyle(this.annotElementContainer.nativeElement,"cursor",'url("data:application/octet-stream;base64,AAACAAEAEBYAAAYAFQAABgAAFgAAACgAAAAQAAAALAAAAAEAIAAAAAAAgAUAACMuAAAjLgAAAAAAAAAAAAD///8A////AP///wD///8A////AP///0b///90////gP///1v///8Z////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///1r///+w////2////+X////F////ff///xf///8A////AP///wD///8A////AP///wD///8A////E////8fb29v/g4OD/1xcXP9VVVX/bm5u/7CwsP/////6////Xf///wD///8A////AP///wD///8A////Bv///+epqan/JSUl/x8fH/8yMjL/NjY2/ygoKP8aGhr/Y2Nj//r6+v////9T////AP///wD///8A////AP///6W9vb3/FhYW/zs7O/9HR0f/RUVF/0VFRf9GRkb/R0dH/xcXF/9ra2v//////////xH///8A////AP///yz6+vr/SUlJ/y8vL/9HR0f/RUVF/0VFRf9GRkb/RERE/zs7O/8rKyv/AAAA/7Kysv////92////AP///wD///94yMjI/ycnJ/9GRkb/RUVF/z4+Pv8uLi7/IiIi/ysrK/9RUVH/i4uL/7+/v//19fX/////wf///wD///8A////ka2trf8PDw//IiIi/ycnJ/9HR0f/fHx8/7m5uf/j4+P/8/Pz/+rq6v+/v7//jo6O//z8/Pv///8I////AP///4G+vr7/VVVV/7CwsP/g4OD/9fX1//Dw8P/Pz8//l5eX/1xcXP8yMjL/HBwc/xoaGv/c3Nz/////SP///wD///9E/f39//Dw8P/b29v/pqam/2lpaf85OTn/IyMj/ycnJ/84ODj/Q0ND/0dHR/8gICD/pqam/////4////8A////Av///+Bra2v/DQ0N/yQkJP8zMzP/QUFB/0ZGRv9FRUX/RUVF/0VFRf9FRUX/KSkp/3R0dP/////X////AP///wD///+YmZmZ/x8fH/9GRkb/RUVF/0VFRf9FRUX/RUVF/0VFRf9FRUX/RUVF/zo6Ov9ISEj/+Pj4/////xn///8A////UtPT0/8tLS3/RERE/0VFRf9FRUX/RUVF/0VFRf9FRUX/RUVF/0VFRf9FRUX/KCgo/8nJyf////9g////AP///w/+/v7/UFBQ/zg4OP9FRUX/RUVF/0VFRf9FRUX/RUVF/0VFRf9FRUX/RkZG/yAgIP+VlZX/////qP///wD///8A////yX19ff8mJib/RUVF/0VFRf9FRUX/RUVF/0VFRf9FRUX/RUVF/0VFRf8vLy//ZWVl/////9f///8A////AP///4KwsLD/ISEh/0ZGRv9FRUX/RUVF/0VFRf9FRUX/RUVF/0VFRf9FRUX/Pz8//zs7O//r6+vx////AP///wD///865OTk/zY2Nv9BQUH/RUVF/0VFRf9FRUX/RUVF/0VFRf9FRUX/RUVF/0ZGRv8ZGRn/qamp+P///wD///8A////Af////NeXl7/MjIy/0VFRf9FRUX/RUVF/0ZGRv9CQkL/NDQ0/yQkJP8kJCT/IiIi/5WVlf////8A////AP///wD///+xjY2N/yMjI/9ERET/ODg4/ygoKP8jIyP/NDQ0/1lZWf+Hh4f/uLi4/+rq6v/////V////AP///wD///8A////ar+/v/8FBQX/LCws/09PT/97e3v/rKys/9vb2//////s////sf///3D///8x////AP///wD///8A////AP///yPv7+//n5+f/8/Pz//8/Pz1////uv///3r///87////A////wD///8A////AP///wD///8A////AP///wD///8A////s////5b///9I////C////wD///8A////AP///wD///8A////AP///wD///8A+D8AAPAfAADADwAAgAcAAIADAAAAAwAAAAMAAAABAAAAAQAAAAEAAAABAACAAAAAgAAAAIAAAADAAAAAwAAAAMAAAADAAAAA4AAAAOABAADgDwAA8P8AAA=="), auto');return}this.renderer.setStyle(this.annotElementContainer.nativeElement,"cursor","inherit")}isBlend(n){return b.isTextMarkup(n)}};E(un,"\u0275fac",function(i){return new(i||un)(m(Ie),m(ra),m(Ct),m(de),m(ea),m(ut),m(re),m($),m(mt),m(gt),m(Zt),m(Qi),m(R),m(qt),m(me),m(ee),m(Yo),m(nn),m(Jt),m(Vt),m(xt),m(ze))}),E(un,"\u0275cmp",H({type:un,selectors:[["sd-annot"]],viewQuery:function(i,e){if(i&1&&(te(Od,5),te(bd,5),te(yd,7,Xt),te(Rd,5)),i&2){let t;ie(t=ne())&&(e.dragSelect=t.first),ie(t=ne())&&(e.annotElementContainer=t.first),ie(t=ne())&&(e.annotCreatePortal=t.first),ie(t=ne())&&(e.editableComps=t)}},hostVars:1,hostBindings:function(i,e){i&1&&I("click",function(o){return e.prevent(o)}),i&2&&B("tabIndex",e.hostTabIndex)},inputs:{pdfPage:"pdfPage",documentId:"documentId",selectText:"selectText"},standalone:!1,features:[j([R,Yo]),Te],decls:5,vars:3,consts:[["annotCreatePortal",""],["annotElementContainer",""],["annotElement",""],["editableComp",""],["dragSelect",""],[3,"ngStyle","mousemove",4,"ngIf"],[3,"pdfPage","comps","acroFields","select","edit","postEdit",4,"ngIf"],[3,"comps","page","select","clickEvent",4,"ngIf"],[3,"mousemove","ngStyle"],[3,"ngSwitch","ngClass","blend","ngStyle","mousedown","touchstart","mousemove",4,"ngFor","ngForOf","ngForTrackBy"],[3,"mousedown","touchstart","mousemove","ngSwitch","ngClass","ngStyle"],[3,"data",4,"ngSwitchCase"],[3,"ngStyle","data","status",4,"ngSwitchCase"],[3,"ngStyle","annotInk","status",4,"ngSwitchCase"],[3,"ngStyle","annotLine","status",4,"ngSwitchCase"],[3,"data","pdfData",4,"ngSwitchCase"],[3,"ngStyle","annotText","status","pdfPage",4,"ngSwitchCase"],[3,"data","status",4,"ngSwitchCase"],["class","annotation-appearance",3,"ngStyle",4,"ngIf"],[4,"ngSwitchDefault"],[3,"data"],[3,"ngStyle","data","status"],[3,"ngStyle","annotInk","status"],[3,"ngStyle","annotLine","status"],[3,"data","pdfData"],[3,"ngStyle","annotText","status","pdfPage"],[3,"data","status"],[1,"annotation-appearance",3,"ngStyle"],[3,"select","edit","postEdit","pdfPage","comps","acroFields"],[3,"select","clickEvent","comps","page"]],template:function(i,e){i&1&&y(0,zd,3,3,"ul",5)(1,jd,0,0,"ng-template",null,0,ke)(3,$d,1,3,"sd-annot-edit",6)(4,Yd,2,2,"sd-drag-select",7),i&2&&(p("ngIf",e.isFetched()),l(3),p("ngIf",e.isEditing()),l(),p("ngIf",e.isAnnotSelectMode()))},styles:["ul[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;padding:0;margin:0;right:0;top:0;list-style-type:none}li[_ngcontent-%COMP%]{position:absolute}li[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%}p[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:100%;color:#00000080}.blend[_ngcontent-%COMP%]{mix-blend-mode:multiply}"],changeDetection:0}));var hn=un;Z([Se(Q.annotComp.pushAnnot),Nn(Q.annotComp.pushAnnotWidget)],hn.prototype,"pushAnnot",null);Z([Se(Q.annotComp.onAnnotMouseDown)],hn.prototype,"onAnnotMousedown",null);var Qd=["bboxComp"],Zd=["arrowComp"],qd=["textView"];function Jd(r,n){if(r&1&&x(0,"sd-poly-shape",5,2),r&2){let i=d();p("data",i.data)("status",i.status)}}var eu={90:{x:"0",y:"-100%"},180:{x:"-100%",y:"-100%"},270:{x:"-100%",y:"0"},get(r,n,i){let e=this[r];if(!e)return S.EMPTY_STRING;let t;return n||i?t=`translate(${this.calcOf(n,e.x)}, ${this.calcOf(i,e.y)})`:t=`translate(${e.x}, ${e.y})`,t},calcOf(r,n){return r==="0"&&n==="0"?"0":`calc(${n} + ${r})`}},pi=(()=>{let n=class n{elementRef;annotService;contentService;editService;annotSelectedService;documentService;subscriptionService;loggingService;translatePipe;data;get status(){return this._status}set status(e){this._status=e}bboxComp;arrowComp;textView;containerStyles={};textStyles={};isTextareaEdited=!1;srcRect;srcTextRect;_status=X.RENDER;viewClasses={create:!1,remove:!1};isTextFocus=!1;get isCallout(){return b.isFreeTextCallout(this.data)}get oid(){return this.data?.oid}get translateMap(){return eu}_textSrc;get textSrc(){return this._textSrc?this._textSrc:(this._textSrc=new it,this.subscriptionService.push(this._textSrc.pipe(jn(this.data.attributes.contentsRichtext.text),$t(400)).subscribe({next:e=>this.updateText(e)})),this._textSrc)}get renderAppearance(){return k.hasAppearance(this.data.attributes.appearance)&&b.isFreeTextCallout(this.data)}constructor(e,t,o,s,c,u,C,N,O){this.elementRef=e,this.annotService=t,this.contentService=o,this.editService=s,this.annotSelectedService=c,this.documentService=u,this.subscriptionService=C,this.loggingService=N,this.translatePipe=O}ngOnChanges(){this.srcRect=S.deepClone(this.data.attributes.rect),this.srcTextRect=S.deepClone(this.data.attributes.textRect),this.viewClasses.create=X.CREATE===this.status,this.viewClasses.remove=X.REMOVE===this.status}ngOnInit(){this.subscriptionService.push(this.contentService.annotEvent$.pipe(w(e=>e?.sdEventType===pe.UPDATE&&e.annot.oid===this.data.oid)).subscribe({next:()=>{this.srcRect=S.deepClone(this.data.attributes.rect),this.isCallout&&(this.srcTextRect=S.deepClone(this.data.attributes.textRect),$e.applyRect(this.data)),this.detectChange()}}),this.annotSelectedService.selectionInfoChange$.pipe(w(()=>this.annotSelectedService.selectedComponents[0]?.data!==this.data)).subscribe({next:()=>{this.isTextareaEdited||this.restoreTextBox(),this.textView.nativeElement.blur(),this.isTextFocus=!1}}))}ngOnDestroy(){S.removeElement(this.textView.nativeElement),fe.destroy(this)}ngAfterViewInit(){typeof this.data.IT<"u"||this.data.action!=="create"||this.data.attributes.contentsRichtext.text.length>0||this.textView.nativeElement.focus()}isCloud(){return this.data.attributes.borderEffect?.style==="C"}isReadonly(){return!this.documentService.checkAuthority(be.EDIT_ANNOTATION)||qe.get(this.data.attributes.F,7)}onTextareaFocus(){this.autoResizeTextbox(),this.isTextFocus=!0}onTextareaInput(){this.autoResizeTextbox(),this.isTextareaEdited=!0}onTextareaBlur(){this.textView.nativeElement.scrollTop=0}render(){let{contentsRichtext:e,rect:t}=this.data.attributes,o=this.data.attributes.textRect||t,s=Math.abs(o.right-o.left),c=Math.abs(o.top-o.bottom),u=e.fontSize/10,C=Math.min(this.data.attributes.width*2*2,Math.min(s,c))/2/u;return this.textStyles.margin=`${C}px`,this.textStyles.fontSize="10px",this.textStyles.lineHeight="10px",this.textStyles.width=`calc(${100/u}% - ${C*2}px)`,this.textStyles.height=`calc(${100/u}% - ${C*2}px)`,this.renderAppearance?{width:`${s}px`,height:`${c}px`,opacity:"0"}:(this.containerStyles.background=this.buildBackground()||"none",this.containerStyles.left=`${D.fixedOf(o.left-t.left,3)+(this.isCloud()?this.data.attributes.borderEffect.intensity*5+this.data.attributes.width*2:0)}px`,this.containerStyles.top=`${D.fixedOf(t.top-o.top,3)+(this.isCloud()?this.data.attributes.borderEffect.intensity*5+this.data.attributes.width*2:0)}px`,this.textStyles.fontFamily=e.fontName,this.textStyles.fontFamily=JSON.stringify(this.textStyles.fontFamily),this.textStyles.color=e.fontColor,this.textStyles.textAlign=e.textAlign,this.textStyles.transform=`scale(${u})`,this.textStyles.transformOrigin=`${-C}px ${-C}px`,this.renderRotation(this.containerStyles,o))}verticesOf(e,t,o){let s=this.data.attributes,c=s.textRect||s.rect;if(!this.isCallout)return this.editService.createRectVertices(t,o);let u=[{x:c.left,y:c.top},{x:c.left,y:(c.top+c.bottom)/2},{x:c.left,y:c.bottom},{x:(c.left+c.right)/2,y:c.bottom},{x:c.right,y:c.bottom},{x:c.right,y:(c.top+c.bottom)/2},{x:c.right,y:c.top},{x:(c.left+c.right)/2,y:c.top}];return this.isCallout&&s.vertices&&u.push(s.vertices[0]),this.editService.createPathVertices(e,o,...u)}postEdit(e,t){this.isTextareaEdited||this.restoreTextBox(),this.isTextFocus=!1,this.bboxComp.postEdit(e,t),k.validateRect(this.data.attributes.rect),this.containerStyles.transform=null,this.ngOnChanges(),this.bboxComp.renderer.status=X.RENDER,this.detectChange(),this.isTextareaEdited=!1}pvOnMove(e){this.isCallout&&(this.bboxComp.pvOnMove&&this.bboxComp.pvOnMove(e),$e.applyVertices(this.data),$e.applyRect(this.data),this.detectChange())}postCreate(e){this.isCallout&&([this.bboxComp,this.arrowComp].forEach(t=>{t?.postCreate&&t.postCreate(e)}),$e.applyVertices(this.data),$e.applyRect(this.data))}pvOnVertexMove(e,t,o){this.isTextareaEdited=!0;let s=this.data.attributes,c=s.vertices||[];t===8&&c[0]&&k.applyVertexDelta(o,c[0]);let u={oid:null,type:null,visible:null,attributes:{rect:s.textRect||s.rect,width:s.width}};if(!this.editService.resizeByRectVertex(u,t,o)){this.detectChange();return}if(this.bboxComp.renderer.status=X.EDIT,!this.isCallout){let C=s.rect;this.containerStyles.transform=`translate(${C.left-this.srcRect.left}px, ${this.srcRect.top-Math.max(C.top,C.bottom)}px)`}this.detectChange()}setText(e){this.textSrc.next(e)}renderRotation(e,t){let o=(360+-(this.data.attributes.Rotate||0)%360)%360,s=Math.abs(t.right-t.left),c=Math.abs(t.top-t.bottom);if(o!==0&&!(o%90)&&o%180&&([s,c]=[c,s]),Object.assign(e||{},{width:`${s}px`,height:`${c}px`,"transform-origin":null}),!o)return e;let u="";return this.containerStyles.transform&&(u=this.containerStyles.transform),Qe(ge({},e||{}),{transform:`${u&&!u.includes("rotate")?`${u} `:""}rotate(${o}deg) ${this.translateMap.get(o,0,0)}`,"transform-origin":"0 0"})}buildBackground(){if(!this.data.attributes.color||this.status===X.CREATE)return;let e=/#([0-9a-f]{1,2})([0-9a-f]{1,2})([0-9a-f]{1,2})/i.exec(this.data.attributes.color);if(!e||e.length<4){this.loggingService.common("warn",Ee.INVALID,this.translatePipe.transform("COLOR_CODE"),`oid=${this.data.oid}, color=${this.data.attributes.color}`);return}return e.shift(),`${e.reduce((t,o)=>`${t}${Number.parseInt(o,16)}, `,"rgba(")}1)`}detectChange(){this.bboxComp&&this.bboxComp.detectChange(),this.arrowComp&&this.arrowComp.detectChange()}updateText(e){this.data.attributes.contentsRichtext.text=e??"",this.annotService.putModel(this.data,"modify"),this.contentService.fireAnnotListEvent({from:"FreeTextComponent",sdEventType:pe.UPDATE,annot:this.data}),this.detectChange()}autoResizeTextbox(){let e=this.textView.nativeElement;if(e.clientHeight>=e.scrollHeight)return;let{contentsRichtext:t,rect:o}=this.data.attributes,s=t.fontSize/10,c=Math.round(e.scrollHeight/parseFloat(e.style.lineHeight)),u=(parseInt(e.style.fontSize)*c+parseFloat(e.style.margin)*2)*s;if(!this.isCallout)o.bottom=o.top-u;else{let{textRect:C}=this.data.attributes;C.bottom=C.top-u,$e.applyVertices(this.data),$e.applyRect(this.data)}this.contentService.fireAnnotEvent({annot:this.data,from:"FreeTextComponent"}),this.detectChange()}restoreTextBox(){if(this.isCallout){let{textRect:e}=this.data.attributes;e.bottom=e.top-(this.srcTextRect.top-this.srcTextRect.bottom),$e.applyVertices(this.data),$e.applyRect(this.data)}else{let{rect:e}=this.data.attributes;e.bottom=e.top-(this.srcRect.top-this.srcRect.bottom)}this.detectChange()}};E(n,"\u0275fac",function(t){return new(t||n)(m(re),m(Ie),m(de),m(ht),m(Ct),m(mt),m(R),m(ze),m(ee))}),E(n,"\u0275cmp",H({type:n,selectors:[["sd-free-text"]],viewQuery:function(t,o){if(t&1&&(te(Qd,7),te(Zd,5),te(qd,5)),t&2){let s;ie(s=ne())&&(o.bboxComp=s.first),ie(s=ne())&&(o.arrowComp=s.first),ie(s=ne())&&(o.textView=s.first)}},inputs:{data:"data",status:"status"},standalone:!1,features:[j([{provide:Cs,useValue:!1},R]),Te],decls:6,vars:9,consts:[["textView",""],["bboxComp",""],["arrowComp",""],[3,"ngClass","ngStyle"],["spellcheck","false",3,"ngModelChange","focus","input","blur","paste","id","ngStyle","ngModel","readonly"],[3,"data","status"],[3,"data","status",4,"ngIf"]],template:function(t,o){if(t&1){let s=M();h(0,"div",3)(1,"textarea",4,0),I("ngModelChange",function(u){return f(s),g(o.setText(u))})("focus",function(){return f(s),g(o.onTextareaFocus())})("input",function(){return f(s),g(o.onTextareaInput())})("blur",function(){return f(s),g(o.onTextareaBlur())})("paste",function(u){return f(s),g(u.stopPropagation())}),_()(),x(3,"sd-rect",5,1),y(5,Jd,2,2,"sd-poly-shape",6)}t&2&&(p("ngClass",o.viewClasses)("ngStyle",o.render()),l(),p("id",o.oid)("ngStyle",o.textStyles)("ngModel",o.data.attributes.contentsRichtext.text)("readonly",o.isReadonly()),l(2),p("data",o.data)("status",o.status),l(2),p("ngIf",o.isCallout))},styles:["div[_ngcontent-%COMP%]{position:absolute;padding:0;margin:0}textarea[_ngcontent-%COMP%]{border:none;padding:0;margin:0;resize:none;outline:none;overflow:hidden;background:none;box-sizing:border-box}"],changeDetection:0}));let r=n;return r})();var At=9,wn=class{prevEvt;editorComp;vertexIdx;moved=!1;delta={x:0,y:0};srcRect={};forBbox={};page;vertex={};srcVertex={};bboxStyle;vertexStyle;constructor(n,i,e){this.prevEvt=n,this.editorComp=i,this.vertexIdx=e,i.annotSelectedService.selectedComponents.forEach(t=>{Object.assign(this.getSrcRect(t.data),S.deepClone(t.data.attributes.rect)),Object.assign(this.getForBbox(t.data),S.deepClone(t.data.attributes.rect));let o=i.getVertexCoords(t.data)[e];this.setVertex(t.data,o),Object.assign(this.getSrcVertex(t.data),S.deepClone(o))}),this.page=i.pdfPage,this.bboxStyle=i.style.bbox,this.vertexStyle={width:String(i.vertex.styles),height:String(i.vertex.styles)}}getSrcRect(n){if(!n||!n.oid)throw new He(`Invalid Annotation. ${n}`);return this.srcRect[n.oid]||(this.srcRect[n.oid]={top:0,right:0,bottom:0,left:0}),this.srcRect[n.oid]}getForBbox(n){if(!n||!n.oid)throw new He(`Invalid Annotation. ${n}`);return this.forBbox[n.oid]||(this.forBbox[n.oid]={top:0,right:0,bottom:0,left:0}),this.forBbox[n.oid]}setVertex(n,i){if(!n||!n.oid)throw new He(`Invalid Annotation. ${n}`);this.vertex[n.oid]=i}getVertex(n){if(!n||!n.oid)throw new He(`Invalid Annotation. ${n}`);return this.vertex[n.oid]||(this.vertex[n.oid]={x:0,y:0}),this.vertex[n.oid]}getSrcVertex(n){if(!n||!n.oid)throw new He(`Invalid Annotation. ${n}`);return this.srcVertex[n.oid]||(this.srcVertex[n.oid]={x:0,y:0}),this.srcVertex[n.oid]}move(n,i,e,t){let o={x:n.offsetX-this.prevEvt.offsetX,y:n.offsetY-this.prevEvt.offsetY};this.prevEvt=n;let s=this.getVertex(i.data);this.cursor=this.isInvalidateDelta(this.page.bbox,s)?"not-allowed":"pointer",this.moveVertexOfEditor(s,o),i.pvOnVertexMove&&i.pvOnVertexMove(this.page,this.vertexIdx,o)}renderBbox(n){n.fitBox?(n.fitBox(this.getForBbox(n.data)),this.editorComp.renderBbox(n,this.getForBbox(n.data))):this.editorComp.renderBbox(n)}postMove(...n){return n.length>1&&console.warn("Editing multiple vertex is not implemented yet. It may malfunction."),setTimeout(()=>this.cursor=null),n.some(e=>{let t=this.getVertex(e.data);return this.isInvalidateDelta(this.page.bbox,t)})?(n.forEach(e=>{let t=this.getVertex(e.data),o=this.getSrcVertex(e.data),s={x:o.x-t.x,y:o.y-t.y};this.moveVertexOfEditor(t,s),e.pvOnVertexMove&&e.pvOnVertexMove(this.page,this.vertexIdx,s)}),!1):(n.forEach(e=>{e.postEdit&&e.postEdit(this.page,this.delta)}),!0)}set cursor(n){this.bboxStyle&&(this.bboxStyle.cursor=n),this.vertexStyle&&(this.vertexStyle.cursor=n)}moveVertexOfEditor(n,i){n.x+=i.x,n.y+=i.y}isInvalidateDelta(n,i){return this.delta.x+i.x<n.x||this.delta.x+i.x+this.editorComp.vertex.size>n.w+n.x||i.y-this.delta.y<0||i.y-this.delta.y+this.editorComp.vertex.size>n.h}};Z([Se(Q.annotEditTool.vertexMover.move,1e3),Nn(Q.annotEditTool.vertexMover.moveWidget,1e3)],wn.prototype,"move",null);var mn=class{prevEvt;editorComp;moved=!1;delta={x:0,y:0};srcRect={};page;cdelta;cursorStyle;transformStyle;useSnapIn=!1;constructor(n,i){this.prevEvt=n,this.editorComp=i,this.cursorStyle=i.style.bbox,this.transformStyle=i.editorTransform,this.page=i.pdfPage,i.annotSelectedService.selectedComponents.forEach(e=>{Object.assign(this.getSrcRect(e.data),S.deepClone(e.data.attributes.rect))})}getSrcRect(n){if(!n||!n.oid)throw new He(`Invalid Annotation. ${n}`);return this.srcRect[n.oid]||(this.srcRect[n.oid]={top:0,right:0,bottom:0,left:0}),this.srcRect[n.oid]}move(n,i,e,t){let o=this.calcDelta(n,e,t);!o.x&&!o.y||(this.delta.x=o.x,this.delta.y=o.y,this.editorComp.rulerActive&&(this.stickToGuideLine(i.data.attributes.rect,e),this.useSnapIn=o.x!==this.delta.x||o.y!==this.delta.y),this.transform=`translate(${this.delta.x}px, ${this.delta.y}px)`,this.cursor=this.editorComp.annotSelectedService.selectedComponents.some(s=>this.isInvalidateDelta(this.page.bbox,s.data.attributes.rect))?"not-allowed":null,this.editorComp.annotSelectedService.selectedComponents.forEach(s=>{this.editorComp.edit.emit({model:s.data,transform:this.editorComp.editorTransform}),s.pvOnAnnotMove&&s.pvOnAnnotMove(this.editorComp.pdfPage,this.cdelta,this.delta)}))}stickToGuideLine(n,i){let e=[];this.editorComp.store$.pipe(Wo(this.editorComp.pdfPage.i),Mt(1)).subscribe({next:s=>{e=Object.keys(s).map(c=>s[c]).filter(c=>c!=null)}});let t=(s,c)=>Math.abs(c-s)*i<15,o=(s,c,u)=>t(c,s+u)?c-s:u;e.forEach(s=>{let c=s.isVertical?s.offset:this.page.bbox.h-s.offset;s.isVertical?(this.delta.x=o(n.left,c,this.delta.x),this.delta.x=o(n.right,c,this.delta.x)):(this.delta.y=-o(n.top,c,-this.delta.y),this.delta.y=-o(n.bottom,c,-this.delta.y))}),this.transform=`translate(${this.delta.x}px, ${this.delta.y}px)`,this.cursor=this.editorComp.annotSelectedService.selectedComponents.some(s=>this.isInvalidateDelta(this.page.bbox,s.data.attributes.rect))?"not-allowed":null,this.emitAnnotChanges(this.editorComp.annotSelectedService.selectedComponents)}emitAnnotChanges(n){n.forEach(i=>{this.editorComp.edit.emit({model:i.data,transform:this.editorComp.editorTransform}),i.pvOnAnnotMove&&i.pvOnAnnotMove(this.editorComp.pdfPage,this.cdelta,this.delta)})}postMove(...n){return this.transform="translate(0, 0)",setTimeout(()=>this.cursor=null),n.some(e=>this.isInvalidateDelta(this.page.bbox,e.data.attributes.rect))?!1:(n.forEach(e=>{let t=e.data.attributes.rect;if(t.left+=this.delta.x,t.right+=this.delta.x,t.bottom-=this.delta.y,t.top-=this.delta.y,b.isFreeTextCallout(e.data)){let o=e.data.attributes.textRect;if(!S.isDefined(o))throw new vt("Text rectangle is not defined");o.left+=this.delta.x,o.right+=this.delta.x,o.bottom-=this.delta.y,o.top-=this.delta.y,e.pvOnVertexMove&&e.pvOnVertexMove(this.page,8,this.delta),$e.applyVertices(e.data),$e.applyRect(e.data)}e.postEdit&&e.postEdit(this.page,this.delta)}),!0)}renderBbox(n){this.editorComp.renderBbox(n)}calcDelta(n,i,e){this.cdelta={x:this.prevEvt.clientX-n.clientX,y:this.prevEvt.clientY-n.clientY};let t=i,o=i,s=e===90,c=e===270;return e===0?(t=-t,o=-o):s?o=-o:c&&(t=-t),this.cdelta.x/=t,this.cdelta.y/=o,(s||c)&&([this.cdelta.x,this.cdelta.y]=[this.cdelta.y,this.cdelta.x]),this.cdelta}set cursor(n){this.cursorStyle&&(this.cursorStyle.cursor=n)}set transform(n){this.transformStyle&&(this.transformStyle.transform=n)}isInvalidateDelta(n,i){return this.delta.x+i.left<n.x||this.delta.x+i.right>n.w+n.x||i.bottom-this.delta.y<n.y||i.top-this.delta.y>n.h+n.y}};Z([Se(Q.annotEditTool.annotMover.move)],mn.prototype,"move",null);Z([Se(Q.annotEditTool.annotMover.emitAnnotChanges,1e3),Nn(Q.annotEditTool.annotMover.emitAnnotChangesWidget,1e3)],mn.prototype,"emitAnnotChanges",null);var er=class extends mn{srcTextRect={};srcVertices={};offSet={x:this.prevEvt.offsetX,y:this.prevEvt.offsetY};constructor(n,i){super(n,i),i.annotSelectedService.selectedComponents.forEach(e=>{b.isFreeText(e.data)&&(Object.assign(this.getSrcTextRect(e.data),S.deepClone(e.data.attributes.textRect)),Object.assign(this.getSrcVertices(e.data),S.deepClone(e.data.attributes.vertices)))})}getSrcTextRect(n){if(!n||!n.oid)throw new He(`Invalid Annotation. ${n}`);return this.srcTextRect[n.oid]||(this.srcTextRect[n.oid]={top:0,right:0,bottom:0,left:0}),this.srcTextRect[n.oid]}getSrcVertices(n){if(!n||!n.oid)throw new He(`Invalid Annotation. ${n}`);return this.srcVertices[n.oid]||(this.srcVertices[n.oid]=[]),this.srcVertices[n.oid]}move(n,i,e,t){let o=this.calcDelta(n,e,t);if(!(!o.x&&!o.y)){if(this.delta.x=o.x,this.delta.y=o.y,this.applyTextRect(i.data,o),!this.isTextBoxClicked(n,i.data)){let s={x:n.offsetX-this.offSet.x,y:n.offsetY-this.offSet.y};this.offSet={x:n.offsetX,y:n.offsetY},i.pvOnVertexMove&&i.pvOnVertexMove(this.page,8,s)}$e.applyVertices(i.data),$e.applyRect(i.data),this.cursor=this.isInvalidateDelta(this.page.bbox,i.data.attributes.rect)||$e.isInvalidatePoint(i.data)?"not-allowed":null,this.editorComp.edit.emit({model:i.data,transform:null,preAction:"rerenderModel"}),i.detectChange()}}postMove(...n){return n.length>1&&console.warn("Editing multiple callout is not implemented yet. It may malfunction."),setTimeout(()=>this.cursor=null),n.some(e=>this.isInvalidateDelta(this.page.bbox,e.data.attributes.rect)||$e.isInvalidatePoint(e.data))?(n.forEach(e=>{let t=e.data.attributes.rect,o=e.data.attributes.textRect,s=e.data.attributes.vertices;if(!S.isDefined(o))throw new vt("Text rectangle is not defined");if(!S.isDefined(s))throw new vt("Vertices are not defined");Object.assign(t,this.getSrcRect(e.data)),Object.assign(o,this.getSrcTextRect(e.data)),Object.assign(s,this.getSrcVertices(e.data)),e.detectChange()}),!1):(n.forEach(e=>{e.postEdit&&e.postEdit(this.page,this.delta)}),!0)}isInvalidateDelta(n,i){return i.left<n.x||i.right>n.w+n.x||i.bottom<n.y||i.top>n.h+n.y}isTextBoxClicked(n,i){let e=i.attributes.textRect,t={x:n.offsetX,y:this.page.bbox.h-n.offsetY};return S.isDefined(e)&&t.x>e.left&&t.x<e.right&&t.y>e.bottom&&t.y<e.top}applyTextRect(n,i){let e=n.attributes.textRect,t=this.getSrcTextRect(n);if(!S.isDefined(e))throw new vt("Text rectangle is not defined");e.left=t.left+i.x,e.right=t.right+i.x,e.bottom=t.bottom-i.y,e.top=t.top-i.y}};Z([Se(Q.annotEditTool.annotCalloutMover.move,1e3)],er.prototype,"move",null);var tr=class extends wn{move(n,i,e,t){super.move(n,i,e,t),$e.applyVertices(i.data),$e.applyRect(i.data),this.cursor=this.isInvalidateDelta(this.page.bbox,this.getVertex(i.data))||$e.isInvalidatePoint(i.data)?"not-allowed":null,this.editorComp.edit.emit({model:i.data,transform:null,preAction:"rerenderModel"}),i.detectChange()}postMove(...n){n.length>1&&console.warn("Editing multiple callout vertex is not implemented yet. It may malfunction.");let i=super.postMove(...n);return n.some(t=>$e.isInvalidatePoint(t.data))&&(n.forEach(t=>{let o=this.getVertex(t.data),s=this.getSrcVertex(t.data),c={x:s.x-o.x,y:s.y-o.y};this.moveVertexOfEditor(o,c),t.pvOnVertexMove&&t.pvOnVertexMove(this.page,this.vertexIdx,c)}),i=!1),n.forEach(t=>{$e.applyVertices(t.data),$e.applyRect(t.data),t.postEdit&&t.postEdit(this.page,this.delta),t.detectChange()}),i}};Z([Se(Q.annotEditTool.vertexCalloutMover.move,1e3)],tr.prototype,"move",null);var tu={annot:mn,vertex:wn,annotCallout:er,vertexCallout:tr,create(r,n,i,e){let t="annot";e!==void 0&&(t="vertex"),b.isFreeTextCallout(r)&&i.annotSelectedService.selectedComponents.length===1&&(t+="Callout");let o=this[t];return o?new o(n,i,e):null}},ir=class{domEl;editorComp;renderer;page;mover;_isPointerDown=!1;draggingEventRemover;panningEventRemover;pendedPanningEvt=null;editingComp;constructor(n,i,e,t){this.domEl=n,this.editorComp=i,this.renderer=e,this.page=t}get isMoving(){return!!this.mover}get isPointerDown(){return this._isPointerDown}set isPointerDown(n){this._isPointerDown=n}getButton=n=>n.buttons;renderBbox(n){let i=this.mover||this.editorComp;i?.renderBbox&&i.renderBbox(n)}touchToMouse(n){return S.touchToMouseEvt(n,this.editorComp.degree,this.editorComp.scale,this.page,this.domEl)}createMover(n,i,e){if(this.mover)return;let t=i?.type?i.type.substring(0,5):"",o=t==="touch"?this.touchToMouse(i):i;if(!(this.getButton(o)>1)&&(this.mover=tu.create(n.data,o,this.editorComp,e),!!this.mover))switch(this.editingComp=n,t){case"touch":this.addPanningListener();break;default:this.addDraggingListener();break}}finalizeMover(n){if(this.removeDraggingListener(),this.removePanningListener(),!this.mover||!this.mover.moved)return this.mover=null;n&&(n.preventDefault(),n.stopPropagation());let i=this.mover;return this.mover=null,i}performMove(n){if(!this.mover||!this.draggingEventRemover&&!this.panningEventRemover)return;n.preventDefault(),n.stopPropagation();let i=this.editorComp.scale,e=this.page.r+this.editorComp.degree;this.mover.move(n,this.editingComp,D.normalizeScale(i),D.normalizeDegree(e)),this.mover.moved=!0,this.editorComp.detectChange()}addDraggingListener(){this.removeDraggingListener(),this.draggingEventRemover=this.renderer.listen(this.domEl,"mousemove",n=>this.performMove(n))}pendPanningListener(n){if(n.stopPropagation(),n.preventDefault(),!this.pendedPanningEvt){this.pendedPanningEvt={clientX:n.changedTouches[0].clientX,clientY:n.changedTouches[0].clientY};return}let i=this.pendedPanningEvt,e=n.changedTouches[0];Math.pow(e.clientX-i.clientX,2)+Math.pow(e.clientY-i.clientY,2)<30||(this.removePanningListener(),this.panningEventRemover=this.renderer.listen(this.domEl,"touchmove",t=>this.performMove(this.touchToMouse(t))))}addPanningListener(){this.removePanningListener(),this.pendedPanningEvt=null,this.panningEventRemover=this.renderer.listen(this.domEl,"touchmove",n=>this.pendPanningListener(n))}removeDraggingListener(){S.isDefined(this.draggingEventRemover)&&this.draggingEventRemover(),this.draggingEventRemover=null}removePanningListener(){S.isDefined(this.panningEventRemover)&&this.panningEventRemover(),this.panningEventRemover=null}},Ln=class{editorComp;annotTree;comps;evt;page;constructor(n){this.editorComp=n}destroy(){this.clearTree(),fe.destroy(this)}build(n){n&&(this.page=n,this.annotTree=new Yi(this.editorComp.pdfPage),this.editorComp.comps!==void 0&&this.editorComp.comps.forEach(i=>this.addTree(i)))}findNextAnnotComp(n,i){let e=!this.evt||!this.comps||this.evt.offsetX!==n.offsetX||this.evt.offsetY!==n.offsetY?this.search(n):this.comps;if(this.evt=n,i!==Ae.SELECT_ANNOT&&e.filter&&(e=e.filter(u=>u.data.type!=="Widget"&&u.data.type!=="Link")),!e.length)return null;let t={x:n.offsetX,y:this.page.bbox.h-n.offsetY},o=this.editorComp.annotSelectedService.selectedComponents[this.editorComp.annotSelectedService.selectedComponents.length-1],s=e.findIndex(u=>u===o);if(s!==-1&&o instanceof pi)if(o.isTextFocus)o.textView.nativeElement.blur(),o.isTextFocus=!1;else return o.textView.nativeElement.focus(),o.isTextFocus=!0,o;this.comps=s<0?e:e.splice(s+1).concat(e);let c=this.comps.shift();if(!S.isDefined(c))throw new vt("Result component is not defined");return this.comps.push(c),c.isTouched&&!c.isTouched(t)?null:(!n.ctrlKey&&!n.metaKey&&!this.editorComp.annotSelectedService.selectedComponents.includes(c)&&(this.editorComp.annotSelectedService.selectedComponents.splice(0),this.editorComp.annotSelectedService.add(c),this.editorComp.annotSelectedService.trigger=n.type,this.editorComp.select.emit(this.editorComp.annotSelectedService.getSelectedInfo())),c)}rebuild(n,i){this.annotTree.remove(n,i),this.annotTree.insert(i.data.attributes.rect,i),this.reset()}search(n){return this.annotTree.searchByPoint(n)}addTree(n){this.annotTree.insert(n.data.attributes.rect,n)}clearTree(){this.annotTree&&this.annotTree.clear()}reset(){this.evt=null,this.comps=null}};var Fn=class{annot;selector;constructor(n,i,e,t){this.annot=n,this.selector=new tn({offsetX:i.x+3,offsetY:i.y+3},t,!1,!1),this.selector.renderer=new en(this.selector,n,!0),this.selector.select({offsetX:e.x-3,offsetY:e.y-3})}select(n,i){this.selector.select(n,!1,i),this.selector.render(),k.fitTextMarkupBox(this.annot)}updatePoint(n,i){this.selector.select({offsetX:n.x+3,offsetY:n.y+3},!1,"start"),this.selector.select({offsetX:i.x-3,offsetY:i.y-3},!1,"end")}};Z([Se(Q.textMarkUpEditor.select,1e3)],Fn.prototype,"select",null);var iu=["containerEl"];function nu(r,n){if(r&1&&(J(),x(0,"rect",10)),r&2){let i=d(2).$implicit,e=d();p("ngStyle",e.style.bbox),B("x",e.getBbox(i.data).x)("y",e.getBbox(i.data).y)("rx",e.getEditBoxRadius(i.data))("ry",e.getEditBoxRadius(i.data))("width",e.getBbox(i.data).w)("height",e.getBbox(i.data).h)("stroke-width",e.strokeWidth)}}function ou(r,n){if(r&1){let i=M();J(),h(0,"rect",11,1),I("mousemove",function(){let t=f(i).index,o=Oe(1),s=d(2).$implicit,c=d();return g(c.ChangeCursorStyle(o,t,s.data))})("mousedown",function(t){let o=f(i).index,s=d(2).$implicit,c=d();return g(c.createMover(s,t,o))})("touchstart",function(t){let o=f(i).index,s=d(2).$implicit,c=d();return g(c.createMover(s,t,o))}),_()}if(r&2){let i=n.$implicit,e=n.index,t=d(2).$implicit,o=d();Ye("cursor",o.cursorStyle(e,t.data)),p("ngStyle",o.vertex.styles),B("x",i.x)("y",i.y)("rx",o.vertex.styles.width/2)("ry",o.vertex.styles.height/2)("width",o.vertex.styles.width)("height",o.vertex.styles.height)("stroke-width",o.strokeWidth)}}function ru(r,n){if(r&1){let i=M();J(),h(0,"g",7),I("mousedown",function(t){f(i);let o=d().$implicit,s=d();return g(s.createMover(o,t))})("touchstart",function(t){f(i);let o=d().$implicit,s=d();return g(s.createMover(o,t))}),y(1,nu,1,8,"rect",8)(2,ou,2,10,"rect",9),_()}if(r&2){let i=d().$implicit,e=d();B("transform",e.getTransform()),l(),p("ngIf",e.getBbox(i.data).w&&e.getBbox(i.data).h),l(),p("ngForOf",e.getVertexCoords(i.data))}}function su(r,n){if(r&1&&(J(),x(0,"path")),r&2){let i=d(2).$implicit,e=d();B("d",e.mergedQuadPointsPath[i.data.oid])("stroke-width",e.strokeWidth)("fill","transparent")}}function au(r,n){if(r&1&&(J(),h(0,"g"),y(1,su,1,3,"path",6),_()),r&2){let i=d().$implicit,e=d();l(),p("ngIf",e.mergedQuadPointsPath[i.data.oid])}}function cu(r,n){if(r&1&&(J(),h(0,"g"),x(1,"ellipse")(2,"ellipse"),_()),r&2){let i=d(2);l(),B("cx",i.textMarkupStartPoint.x)("cy",i.textMarkupStartPoint.y)("rx",i.textMarkupHandleRadius)("ry",i.textMarkupHandleRadius)("stroke-width",i.strokeWidth),l(),B("cx",i.textMarkupEndPoint.x)("cy",i.textMarkupEndPoint.y)("rx",i.textMarkupHandleRadius)("ry",i.textMarkupHandleRadius)("stroke-width",i.strokeWidth)}}function lu(r,n){if(r&1&&(J(),h(0,"g"),y(1,ru,3,3,"g",5)(2,au,2,1,"g",6)(3,cu,3,10,"g",6),_()),r&2){let i=n.$implicit,e=d();l(),p("ngIf",e.isEditableAnnot(i.data)&&e.canBeEdited(i.data)),l(),p("ngIf",!e.isEditableAnnot(i.data)&&e.documentService.checkAuthority(e.DocumentAction.EDIT_ANNOTATION)),l(),p("ngIf",e.editor&&e.textMarkupStartPoint&&e.textMarkupEndPoint)}}function pu(r,n){if(r&1&&x(0,"sd-edit-menu",12),r&2){let i=d();p("scale",i.scale)("degree",i.degree)("page",i.pdfPage)("bbox",i.mergedBbox)("acroFields",i.acroFields)}}var di=function(r){return r[r.OFF=0]="OFF",r[r.START_POINT_EDIT=1]="START_POINT_EDIT",r[r.END_POINT_EDIT=2]="END_POINT_EDIT",r}(di||{}),Vr=(()=>{let n=class n{annotService;contentService;renderer;changeDetectorRef;annotSelectedService;documentService;subscriptionService;shortcutService;acroFormService;unitPipe;translatePipe;store$;textService;loggingService;get DocumentAction(){return be}get MergedRuntimeEnvKey(){return V}get runtimeEnv(){return Y}get isEditable(){return!this.hasSignedSignature||this.documentService.checkAuthority(be.EDIT_ANNOTATION)}pdfPage;comps;acroFields;postEdit=new Ge;edit=new Ge;select=new Ge;containerElementRef;scale;degree;dragMode;textAnnotStrokeWidth=2;strokeWidth=2;textMarkupHandleRadius=At/2;vertex={size:At,styles:{width:At,height:At},coords:{}};bbox={};style={bbox:{},layout:{width:null,height:null}};editorTransform={transform:null};mergedBbox;moverService;menuVisibility=!1;renderedAndSelectedComponents=[];mergedQuadPointsPath={};charTree;data;editor;textMarkupStartPoint;textMarkupEndPoint;textMarkupEditingStatus=di.OFF;hasSignedSignature=!1;selector;rulerActive=!1;annotEl=null;constructor(e,t,o,s,c,u,C,N,O,U,z,Me,Bt,Oi){this.annotService=e,this.contentService=t,this.renderer=o,this.changeDetectorRef=s,this.annotSelectedService=c,this.documentService=u,this.subscriptionService=C,this.shortcutService=N,this.acroFormService=O,this.unitPipe=U,this.translatePipe=z,this.store$=Me,this.textService=Bt,this.loggingService=Oi,this.renderedAndSelectedComponents=this.annotSelectedService.selectedComponents}ngAfterViewInit(){this.moverService=new ir(this.containerElementRef.nativeElement,this,this.renderer,this.pdfPage),this.moverService.isPointerDown=!0}ngOnChanges(e){e.pdfPage&&(this.style.layout.width=String(this.pdfPage.bbox.w+this.pdfPage.bbox.x),this.style.layout.height=String(this.pdfPage.bbox.h+this.pdfPage.bbox.y),e.pdfPage.isFirstChange()||this.detectChange()),this.selector||(this.selector=new Ln(this)),e.pdfPage&&this.selector.build(e.pdfPage.currentValue),e.trigger?.isFirstChange()&&this.annotSelectedService.trigger===k.AnnotViewEvt.type&&(this.annotSelectedService.isFirstSelection=!1),e.renderComp&&!e.renderComp.isFirstChange()&&(this.moverService.finalizeMover(),this.ngAfterViewInit(),this.detectChange()),this.determineCursor()}ngOnInit(){if(this.annotEl=this.containerElementRef.nativeElement.closest("sd-annot"),this.renderedAndSelectedComponents.some(e=>!this.canBeEdited(e.data))){this.close();return}this.renderedAndSelectedComponents.length===1&&b.isTextMarkup(this.renderedAndSelectedComponents[0].data)&&this.fetchTextData(this.renderedAndSelectedComponents[0].data),this.subscriptionService.push(this.acroFormService.hasSignedSignature$.subscribe({next:e=>this.hasSignedSignature=e}),this.store$.pipe(le("scale")).subscribe({next:e=>{this.scale=e,this.detectChange()}}),this.store$.pipe(le("degree")).subscribe({next:e=>{this.degree=e,this.detectChange()}}),this.store$.pipe(le("dragMode")).subscribe({next:e=>this.dragMode=e}),this.store$.pipe(le("rulerActive")).subscribe({next:e=>this.rulerActive=e}),this.contentService.annotEvent$.pipe(w(S.isDefined),w(e=>e.from==="AnnotService"||e.from==="FreeTextComponent")).subscribe({next:e=>{if(e.annot){let t=this.renderedAndSelectedComponents.findIndex(o=>o.data.oid===e.annot.oid);if(t>-1){let o=this.renderedAndSelectedComponents[t];this.contentService.publishPostAnnotEdit({annotOid:o.data.oid}),this.selector.destroy(),this.selector=new Ln(this),this.selector.build(this.pdfPage)}}this.detectChange()}}),this.annotSelectedService.selectionInfoChange$.subscribe({next:()=>{if(this.renderedAndSelectedComponents=this.annotSelectedService.selectedComponents,this.renderedAndSelectedComponents.some(e=>e.data.oid===null)){this.close();return}this.subscriptionService.get("textDataFetchSubscription")?.unsubscribe(),this.renderedAndSelectedComponents.length===1&&b.isTextMarkup(this.renderedAndSelectedComponents[0].data)&&this.fetchTextData(this.renderedAndSelectedComponents[0].data),this.detectChange()}}),Et(this.shortcutService.getShortcutEvent(yt.MOVE_TOP),this.shortcutService.getShortcutEvent(yt.MOVE_BOTTOM),this.shortcutService.getShortcutEvent(yt.MOVE_RIGHT),this.shortcutService.getShortcutEvent(yt.MOVE_LEFT),this.shortcutService.getShortcutEvent(yt.MOVE_MORE_TOP),this.shortcutService.getShortcutEvent(yt.MOVE_MORE_BOTTOM),this.shortcutService.getShortcutEvent(yt.MOVE_MORE_RIGHT),this.shortcutService.getShortcutEvent(yt.MOVE_MORE_LEFT)).pipe(w(e=>this.renderedAndSelectedComponents.length>0&&e.target instanceof Element&&e.target.tagName!=="INPUT"&&e.target.tagName!=="TEXTAREA"),w(()=>this.renderedAndSelectedComponents.every(e=>!this.isLockedAnnot(e.data)&&(b.isWidget(e.data)||b.isMovableAnnot(e.data))))).subscribe({next:e=>{if(this.renderedAndSelectedComponents.length===1&&b.isFreeText(this.renderedAndSelectedComponents[0].data)&&this.dragMode===Ae.SELECT_TEXT)return;e.preventDefault();let t=this.renderedAndSelectedComponents.filter(s=>b.isMovableAnnot(s.data)),o=this.renderedAndSelectedComponents.map(s=>s.data).filter(b.isWidget);this.shortcutMoveAnnots(e,t,o)}}),Et(we(this.containerElementRef.nativeElement,"mouseenter"),we(this.containerElementRef.nativeElement,"mousemove"),we(this.containerElementRef.nativeElement,"mouseleave")).pipe(St((e,t)=>e.offsetX===t.offsetX&&e.offsetY===t.offsetY),_t(e=>e.type==="mouseleave"?[]:this.selector.search(e)),_t(e=>e.find(t=>t.data.type==="Widget")?.elementRef?.nativeElement),jn(void 0),zn(),w(([e,t])=>e!==t)).subscribe({next:([e,t])=>{e&&this.removeHover(e),t&&this.addHover(t)}})),this.determineMenuVisibility(),D.bindLayoutOrder(this.style.layout,D.LayoutOrder.AnnotCreate)}ngOnDestroy(){this.removeAllHover(),this.moverService.finalizeMover(),this.selector.destroy(),fe.destroy(this)}getBbox(e){if(!e||!e.oid)throw new He(`Invalid Annotation. ${e}`);return this.bbox[e.oid]?this.bbox[e.oid]:this.bbox[e.oid]={x:0,y:0,w:0,h:0}}getVertexCoords(e){if(!e||!e.oid)throw new He(`Invalid Annotation. ${e}`);return this.vertex.coords[e.oid]||(this.vertex.coords[e.oid]=[]),this.vertex.coords[e.oid]}renderMergedBbox(){let e=1/0,t=0,o=1/0,s=0;this.renderedAndSelectedComponents.forEach(c=>{let u=this.getBbox(c.data);u.x<e&&(e=u.x),u.x+u.w>t&&(t=u.x+u.w),u.y<o&&(o=u.y),u.y+u.h>s&&(s=u.y+u.h)}),this.mergedBbox={x:e,y:o,w:t-e,h:s-o}}isEditableAnnot(e){return b.isEditableAnnot(e)&&!e.attributes.quadPoints}isTextAnnot(e){return b.isText(e)}canBeEdited(e){return b.isRedact(e)?this.documentService.checkAuthority(be.EDIT_REDACTION):b.isWidget(e)&&!this.isEditable||b.isSignedSignature2(e)?!1:this.documentService.checkAuthority(be.EDIT_ANNOTATION)}allCanBeEdited(){return this.renderedAndSelectedComponents.every(e=>this.canBeEdited(e.data))}cursorStyle(e,t){let o=(this.pdfPage.r+this.degree+360)%360;return k.resizeCursorOf(b.isSizeableAnnot(t),e,o)}detectChange(){this.determineMenuVisibility(),this.applyScale(),this.render(),this.changeDetectorRef.markForCheck()}renderBbox(e,t){if(!e)return;let o=e.data,s=t||o.attributes.rect,c=this.getBbox(o);c.x=Math.min(s.left,s.right),c.y=this.pdfPage.bbox.h+this.pdfPage.bbox.y-Math.max(s.top,s.bottom),c.w=Math.abs(s.right-s.left),c.h=Math.abs(s.top-s.bottom),this.isTextAnnot(o)&&(c.x-=this.textAnnotStrokeWidth,c.y-=this.textAnnotStrokeWidth,c.w=25,c.h+=this.textAnnotStrokeWidth*2),this.style.bbox.fill="rgba(var(--primary-50-rgb), 0.08)",e instanceof pi&&e.isTextFocus&&(this.style.bbox.fill="transparent"),this.bbox[o.oid]=c}touchToMouse(e){return S.touchToMouseEvt(e,this.degree,this.scale,this.pdfPage,this.containerElementRef.nativeElement)}onMousedown(e){this.moverService.isPointerDown=!0,e.stopPropagation(),!(!this.textMarkupStartPoint||!this.textMarkupEndPoint)&&(this.textMarkupStartPoint.x-At*1.5<e.offsetX&&e.offsetX<this.textMarkupStartPoint.x+At*1.5&&this.textMarkupStartPoint.y-At*1.5<e.offsetY&&e.offsetY<this.textMarkupStartPoint.y+At*1.5&&(this.textMarkupEditingStatus=di.START_POINT_EDIT),this.textMarkupEndPoint.x-At*1.5<e.offsetX&&e.offsetX<this.textMarkupEndPoint.x+At*1.5&&this.textMarkupEndPoint.y-At*1.5<e.offsetY&&e.offsetY<this.textMarkupEndPoint.y+At*1.5&&(this.textMarkupEditingStatus=di.END_POINT_EDIT),this.determineMenuVisibility())}onMousemove(e){if(e.stopPropagation(),this.textMarkupEditingStatus===di.OFF){this.comps.some(t=>{let o=t.data.attributes.rect,s=this.pdfPage.bbox,c={x:s.x+e.offsetX,y:s.y+s.h-e.offsetY};if(t.isTouched&&t.isTouched(c)||["FreeText","Stamp","Text","Link"].includes(t.data.type)&&pt.isPointInRect(o,c))return this.containerElementRef.nativeElement.style.cursor="pointer",!0;if(this.dragMode===Ae.SELECT_ANNOT&&t.acroField?.FT&&["Rb","Btn","Tx"].includes(t.acroField.FT)&&pt.isPointInRect(o,c))return this.containerElementRef.nativeElement.style.cursor="default",!0;if(this.dragMode===Ae.SELECT_TEXT||this.dragMode===Ae.MOVE){if(t.acroField?.FT&&["Cb","Rb","Btn"].includes(t.acroField.FT)&&pt.isPointInRect(o,c))return this.containerElementRef.nativeElement.style.cursor="pointer",!0;if(t.acroField?.FT&&["Tx"].includes(t.acroField.FT)&&pt.isPointInRect(o,c))return this.containerElementRef.nativeElement.style.cursor="text",!0}return this.containerElementRef.nativeElement.style.cursor="inherit",!1});return}e.preventDefault(),this.editor.select(e,this.textMarkupEditingStatus===di.START_POINT_EDIT?"start":"end"),this.render(),this.contentService.fireAnnotEvent({annot:this.annotSelectedService.selectedComponents[0].data,pageIdx:this.pdfPage.i,sdEventType:pe.UPDATE}),this.changeDetectorRef.markForCheck()}onSelect(e){if(!this.moverService.isPointerDown){this.finishMove(e);return}let t=this.finishMove(e);if(this.textMarkupEditingStatus!==di.OFF){this.textMarkupEditingStatus=di.OFF,this.determineMenuVisibility(),this.editor&&this.editor.updatePoint(this.textMarkupStartPoint,this.textMarkupEndPoint);return}t||this.selectNormal(e)}createMover(e,t,o){b.isWidget(e.data)&&o===void 0&&!Y.get(a.FORM_MOVE)||!b.isWidget(e.data)&&o===void 0&&!Y.get(a.MOVE_ANNOTATION)||b.isWidget(e.data)&&o!==void 0&&!Y.get(a.FORM_RESIZE)||!b.isWidget(e.data)&&o!==void 0&&!Y.get(a.RESIZE_ANNOTATION)||this.renderedAndSelectedComponents.some(s=>qe.get(s.data.attributes.F,7)||b.isTextMarkup(s.data))||(k.shouldRemoveAppearance(e.data)&&(e.data.attributes.appearance=void 0),this.moverService.createMover(e,t,o),this.detectChange())}finishMove(e){this.moverService.isPointerDown&&(this.moverService.isPointerDown=!1);let t=this.moverService.finalizeMover(e);if(!t||!t.moved)return!1;let o=t.postMove(...this.renderedAndSelectedComponents);return this.postEdit.emit({isValid:o}),this.renderedAndSelectedComponents.forEach(s=>{this.contentService.publishPostAnnotEdit({annotOid:s.data.oid}),this.selector.rebuild(t.getSrcRect(s.data),s)}),this.detectChange(),t.moved}getTransform(){return(this.editorTransform.transform||S.EMPTY_STRING).replace(",",S.EMPTY_STRING).replace(/px/g,S.EMPTY_STRING)}getEditBoxRadius(e){return b.isFreeText(e)||b.isInk(e)||b.isCircle(e)||b.isSquare(e)||b.isStamp(e)||b.isRedact(e)||b.isWidget(e)?"0":"5px"}ChangeCursorStyle(e,t,o){if(b.isWidget(o)&&!Y.get(a.FORM_RESIZE)){e.style.cursor="not-allowed";return}if(!b.isWidget(o)&&!Y.get(a.RESIZE_ANNOTATION)){e.style.cursor="not-allowed";return}e.style.cursor=this.cursorStyle(t,o)}removeHover(e){e.classList.remove("hover")}addHover(e){e.classList.contains("hover")||e.classList.add("hover")}removeAllHover(){if(!S.isDefined(this.annotEl)){this.loggingService.common("warn",Ee.NOT_EXIST,this.translatePipe.joinedTransform("ANNOTATION","ELEMENT"));return}this.annotEl.querySelectorAll("sd-widget.hover").forEach(e=>this.removeHover(e))}determineMenuVisibility(){this.menuVisibility=this.textMarkupEditingStatus===di.OFF&&(this.renderedAndSelectedComponents.every(e=>!this.isTextAnnot(e.data))||this.dragMode===Ae.SELECT_ANNOT||this.dragMode===Ae.AUTO)}applyScale(){this.vertex.size=Number((At*100/this.scale).toFixed(1)),this.vertex.styles.height=this.vertex.size,this.vertex.styles.width=this.vertex.styles.height,this.strokeWidth=Number((2*100/this.scale).toFixed(1)),this.textMarkupHandleRadius=Number((At/2*100/this.scale).toFixed(1))}render(){this.renderedAndSelectedComponents.forEach(e=>{this.moverService?this.moverService.renderBbox(e):this.renderBbox(e),this.isEditableAnnot(e.data)?this.renderPoints(e):this.renderMergedQuadPoints(e.data)}),this.renderMergedBbox()}renderMergedQuadPoints(e){this.mergedQuadPointsPath[e.oid]="";let c=[];e.attributes.quadPoints.forEach((C,N)=>{let O=Math.min(C[0].x,C[1].x,C[2].x,C[3].x),U=Math.max(C[0].x,C[1].x,C[2].x,C[3].x),z=this.pdfPage.bbox.h+this.pdfPage.bbox.y-Math.max(C[0].y,C[1].y,C[2].y,C[3].y),Me=this.pdfPage.bbox.h+this.pdfPage.bbox.y-Math.min(C[0].y,C[1].y,C[2].y,C[3].y);O===U||z===Me||(N===0&&(this.textMarkupStartPoint={x:O,y:z}),N===e.attributes.quadPoints.length-1&&(this.textMarkupEndPoint={x:U,y:Me}),c.push({left:O,right:U,top:z,bottom:Me}))}),c.sort((C,N)=>C.left-N.left);let u=[];for(;c.length!==0;){let C=c.shift(),N=[];if(C===void 0)throw new fr("Unexpected undefined criteriaRect.");for(let O=0;O<c.length;++O)(Math.abs(c[O].top-C.top)<3||Math.abs(c[O].bottom-C.bottom)<3)&&(c[O].left-C.right<8&&c[O].right>C.left||C.left-c[O].right<8&&c[O].left<C.right)&&(N.unshift(O),C.left=Math.min(C.left,c[O].left),C.right=Math.max(C.right,c[O].right),C.top=Math.min(C.top,c[O].top),C.bottom=Math.max(C.bottom,c[O].bottom));N.forEach(O=>c.splice(O,1)),u.push(C)}for(u.sort((C,N)=>C.top-N.top);u.length!==0;){let C=u.shift();if(C===void 0)throw new fr("Unexpected undefined criteriaRect.");let N=[],O=[{x:C.left,y:C.top},{x:C.left,y:C.bottom}],U=[{x:C.right,y:C.top},{x:C.right,y:C.bottom}];for(let z=0;z<u.length;++z)Math.abs(u[z].top-C.bottom)<8&&u[z].left<C.right&&C.left<u[z].right&&(N.unshift(z),u[z].left<C.left?(O[O.length-1].y=u[z].top,O.push({x:u[z].left,y:u[z].top})):O.push({x:u[z].left,y:O[O.length-1].y}),O.push({x:u[z].left,y:u[z].bottom}),u[z].right<C.right?U.push({x:u[z].right,y:U[U.length-1].y}):(U[U.length-1].y=u[z].top,U.push({x:u[z].right,y:u[z].top})),U.push({x:u[z].right,y:u[z].bottom}),C=u[z]);N.forEach(z=>u.splice(z,1)),this.mergedQuadPointsPath[e.oid]+=`M ${O[0].x} ${O[0].y} `,U.forEach(z=>this.mergedQuadPointsPath[e.oid]+=`L ${z.x} ${z.y} `),O.reverse().forEach(z=>this.mergedQuadPointsPath[e.oid]+=`L ${z.x} ${z.y} `),this.mergedQuadPointsPath[e.oid]+="Z"}}renderPoints(e){if(qe.get(e.data.attributes.F,7)||this.renderedAndSelectedComponents.length>1||b.isSignatureWidget(e.data,this.acroFields)&&k.hasAppearance(e.data.attributes.appearance)||!Y.get(a.RESIZE_ANNOTATION)){this.getVertexCoords(e.data).splice(0);return}if(!e.verticesOf){this.loggingService.common("warn",Ee.NOT_EXIST,"verticesOf");return}let t=e.verticesOf(this.pdfPage,this.getBbox(e.data),this.vertex.size),o=this.getVertexCoords(e.data);o.splice(t.length),t.forEach((s,c)=>{o[c]?Object.keys(s).forEach(u=>o[c][u]=s[u]):o[c]=s})}selectNormal(e){if(this.annotSelectedService.isFirstSelection){this.annotSelectedService.isFirstSelection=!1;return}e.preventDefault();let t=this.selector.findNextAnnotComp(e,this.dragMode);if(t){b.isText(t.data)&&this.dragMode!==Ae.SELECT_ANNOT&&this.dragMode!==Ae.AUTO&&this.annotService.togglePopup(t.data);let o=this.renderedAndSelectedComponents.indexOf(t);o===-1?this.annotSelectedService.add(t):(e.ctrlKey===!0||e.metaKey===!0)&&this.renderedAndSelectedComponents.length>1&&this.renderedAndSelectedComponents.splice(o,1),this.determineCursor()}else{this.annotSelectedService.isFirstSelection=!0,this.select.emit(null);return}this.annotSelectedService.dispatchSelectionInfoChange(),this.detectChange()}determineCursor(){if(this.renderedAndSelectedComponents.some(e=>b.isWidget(e.data))&&!Y.get(a.FORM_MOVE)){this.style.bbox.cursor="not-allowed";return}if(this.renderedAndSelectedComponents.some(e=>!b.isWidget(e.data))&&!Y.get(a.MOVE_ANNOTATION)){this.style.bbox.cursor="not-allowed";return}this.style.bbox.cursor=this.renderedAndSelectedComponents.some(e=>qe.get(e.data.attributes.F,7))?"pointer":"move"}close(){this.annotService.closeEditor()}fetchTextData(e){if(!S.isDefined(this.documentService.openedDocument)){this.loggingService.common("warn",Ee.NOT_EXIST,this.translatePipe.joinedTransform("DOCUMENT","OBJECT"));return}this.subscriptionService.set("textDataFetchSubscription",this.textService.fetchPdfPageText(this.documentService.openedDocument.streamdocsId,this.pdfPage.ref).subscribe({next:t=>{this.data=t,this.charTree=go.buildTextBoxTree(t,this.pdfPage),this.initSelector(e)}}))}initSelector(e){if(!this.textMarkupStartPoint||!this.textMarkupEndPoint){let t=e.attributes.quadPoints,o=t[0],s=t[t.length-1];this.textMarkupStartPoint={x:Math.min(o[0].x,o[1].x,o[2].x,o[3].x),y:this.pdfPage.bbox.h+this.pdfPage.bbox.y-Math.max(o[0].y,o[1].y,o[2].y,o[3].y)},this.textMarkupEndPoint={x:Math.max(s[0].x,s[1].x,s[2].x,s[3].x),y:this.pdfPage.bbox.h+this.pdfPage.bbox.y-Math.min(s[0].y,s[1].y,s[2].y,s[3].y)}}this.editor=new Fn(e,this.textMarkupStartPoint,this.textMarkupEndPoint,this)}isLockedAnnot(e){return qe.get(e.attributes.F,7)}shortcutMoveAnnots(e,t,o){let s=this.unitPipe.isRegionUS()?K.INCH:K.MILLIMETER,c=this.unitPipe.isRegionUS()?Ne.shortcutMoveAnnot.inch:Ne.shortcutMoveAnnot.milliMeter;e.shiftKey?(this.moveWidgets(o,Ue.convert(s,K.POINT,c*10),e.code),this.moveAnnots(t,Ue.convert(s,K.POINT,c*10),e.code)):(this.moveWidgets(o,Ue.convert(s,K.POINT,c),e.code),this.moveAnnots(t,Ue.convert(s,K.POINT,c),e.code))}moveAnnots(e,t,o){e.forEach(s=>{let c=s.data.attributes.rect,u=c.left,C=c.bottom;switch(o){case"ArrowUp":C+=t;break;case"ArrowDown":C-=t;break;case"ArrowLeft":u-=t;break;case"ArrowRight":u+=t;break;default:return}this.annotService.moveAnnotRectAbsolutely(s,u,C,this.pdfPage.i),this.changeDetectorRef.detectChanges(),this.annotService.dispatchModify(s.data)})}moveWidgets(e,t,o){e.forEach(s=>{let c=s.attributes.rect;switch(o){case"ArrowUp":c.top+=t,c.bottom+=t;break;case"ArrowDown":c.top-=t,c.bottom-=t;break;case"ArrowLeft":c.left-=t,c.right-=t;break;case"ArrowRight":c.left+=t,c.right+=t;break;default:return}this.validateMovePosition(c),this.render(),this.contentService.fireAnnotEvent({annot:s,sdEventType:pe.UPDATE,pageIdx:this.pdfPage.i})}),this.changeDetectorRef.detectChanges()}validateMovePosition(e){let t=this.pdfPage.bbox,o=e.top-e.bottom,s=e.right-e.left;e.left<0?(e.left=0,e.right=s):e.right>t.w-t.x?(e.left=t.w-t.x-s,e.right=t.w-t.x):e.bottom<0?(e.bottom=0,e.top=o):e.top>t.h-t.y&&(e.bottom=t.h-t.y-o,e.top=t.h-t.y)}};E(n,"\u0275fac",function(t){return new(t||n)(m(Ie),m(de),m(xt),m($),m(Ct),m(mt),m(R),m(Qi),m(gt),m(Ai),m(ee),m(me),m(Mo),m(ze))}),E(n,"\u0275cmp",H({type:n,selectors:[["sd-annot-edit"]],viewQuery:function(t,o){if(t&1&&te(iu,7),t&2){let s;ie(s=ne())&&(o.containerElementRef=s.first)}},inputs:{pdfPage:"pdfPage",comps:"comps",acroFields:"acroFields"},outputs:{postEdit:"postEdit",edit:"edit",select:"select"},standalone:!1,features:[j([R]),Te],decls:4,vars:3,consts:[["containerEl",""],["vertexElement",""],[3,"click","mousedown","mousemove","touchstart","touchmove","mouseup","touchend","mouseleave","pointerdown","pointermove","pointerup","ngStyle"],[4,"ngFor","ngForOf"],[3,"scale","degree","page","bbox","acroFields",4,"ngIf"],[3,"mousedown","touchstart",4,"ngIf"],[4,"ngIf"],[3,"mousedown","touchstart"],["class","bbox",3,"ngStyle",4,"ngIf"],["class","vertex",3,"cursor","ngStyle","mousemove","mousedown","touchstart",4,"ngFor","ngForOf"],[1,"bbox",3,"ngStyle"],[1,"vertex",3,"mousemove","mousedown","touchstart","ngStyle"],[3,"scale","degree","page","bbox","acroFields"]],template:function(t,o){if(t&1){let s=M();J(),h(0,"svg",2,0),I("click",function(u){return f(s),g(u.stopPropagation())})("mousedown",function(u){return f(s),g(o.onMousedown(u))})("mousemove",function(u){return f(s),g(o.onMousemove(u))})("touchstart",function(u){return f(s),g(o.onMousedown(o.touchToMouse(u)))})("touchmove",function(u){return f(s),g(o.onMousemove(o.touchToMouse(u)))})("mouseup",function(u){return f(s),g(o.onSelect(u))})("touchend",function(u){return f(s),g(o.onSelect(o.touchToMouse(u)))})("mouseleave",function(u){return f(s),g(o.finishMove(u))})("pointerdown",function(u){return f(s),g(u.stopPropagation())})("pointermove",function(u){return f(s),g(u.stopPropagation())})("pointerup",function(u){return f(s),g(u.stopPropagation())}),y(2,lu,4,3,"g",3),_(),y(3,pu,1,5,"sd-edit-menu",4)}t&2&&(p("ngStyle",o.style.layout),l(2),p("ngForOf",o.renderedAndSelectedComponents),l(),p("ngIf",o.runtimeEnv.get(o.MergedRuntimeEnvKey.ANNOTATION_FLOATING_MENU)&&(!o.moverService||!o.moverService.isMoving)&&o.mergedBbox&&o.menuVisibility&&o.allCanBeEdited()))},styles:["svg[_ngcontent-%COMP%]{position:absolute;right:0;top:0;-webkit-user-select:none;user-select:none;width:100%;height:100%;cursor:default}rect.bbox[_ngcontent-%COMP%]{fill:rgba(var(--primary-50-rgb),.08);stroke:var(--primary-50);cursor:move}rect.vertex[_ngcontent-%COMP%]{fill:#fff;stroke:var(--primary-50);-webkit-user-select:none;user-select:none;font-size:12px}path[_ngcontent-%COMP%], ellipse[_ngcontent-%COMP%]{stroke:var(--primary-50);pointer-events:none}ellipse[_ngcontent-%COMP%]{fill:#fff}"],changeDetection:0}));let r=n;return r})();var du=["selEl"],uu=["selPathEl"],hu=["indEl"],mu=["startIndicator"],_u=["endIndicator"];function fu(r,n){if(r&1&&(J(),x(0,"rect",13)),r&2){let i=d().$implicit,e=d(2);B("x",i.searchBox.x)("y",e.pdfPage.bbox.h-i.searchBox.y-i.searchBox.h)("width",i.searchBox.w)("height",i.searchBox.h)}}function gu(r,n){if(r&1&&(J(),x(0,"rect",14)),r&2){let i=d().$implicit,e=d(2);B("x",i.points.start.x-5)("y",e.pdfPage.bbox.h-i.points.start.y-5)}}function Cu(r,n){if(r&1&&(J(),x(0,"rect",14)),r&2){let i=d().$implicit,e=d(2);B("x",i.points.end.x-5)("y",e.pdfPage.bbox.h-i.points.end.y-5)}}function Tu(r,n){if(r&1&&(J(),ue(0),y(1,fu,1,4,"rect",11)(2,gu,1,2,"rect",12)(3,Cu,1,2,"rect",12),he()),r&2){let i=n.$implicit;l(),p("ngIf",i==null?null:i.searchBox),l(),p("ngIf",i==null?null:i.points),l(),p("ngIf",i==null?null:i.points)}}function Au(r,n){if(r&1&&(J(),h(0,"svg",10),y(1,Tu,4,3,"ng-container",6),_()),r&2){let i=d();l(),p("ngForOf",i.selectors)}}function Eu(r,n){if(r&1&&x(0,"div",16,2),r&2){let i=d().$implicit,e=d();G("debug",e.debug),p("ngStyle",i.indStyle)}}function Su(r,n){if(r&1&&(ue(0),y(1,Eu,2,3,"div",15),he()),r&2){let i=n.$implicit;l(),p("ngIf",i==null?null:i.indStyle)}}function Iu(r,n){if(r&1){let i=M();J(),h(0,"svg",17,3),I("click",function(t){return f(i),g(t.stopPropagation())})("mousemove",function(t){f(i);let o=d();return g(o.onMousemove(t))}),x(2,"path",null,4),_()}if(r&2){let i=d();p("ngStyle",i.stStyles),B("aria-label",i.svgAriaLabel)("width",i.width)("height",i.height)}}var Ja=(()=>{let n=class n{changeDetectorRef;renderer;contentService;sdContextMenuService;selectTextService;accessibilityService;subscriptionService;store$;textService;translatePipe;debug=!1;pdfPage;documentId;status;annot;isScreenReaderActive;textFetched=new Ge;selectedElementRef;selectedPathElementRef;indicatorElementRef;startIndicatorElementRef;endIndicatorElementRef;data;scale;degree;width;height;charTree;stStyles={};gestureSelectors=[];pageScript="";pageAriaLabels=[];get selectors(){return this.gestureSelectors.map(e=>e.selector)}get indicatorStyle(){return{display:this.selectors.some(e=>e?.textBox)?"inline":"none"}}get svgAriaLabel(){return this.pageAriaLabels[this.pdfPage.i]?this.pageAriaLabels[this.pdfPage.i]:this.isScreenReaderActive&&this.pageScript.trim().length===0?this.translatePipe.transform("NO_CONTENT"):`${this.pdfPage.i+1} ${this.translatePipe.transform("PAGE")}`}constructor(e,t,o,s,c,u,C,N,O,U){this.changeDetectorRef=e,this.renderer=t,this.contentService=o,this.sdContextMenuService=s,this.selectTextService=c,this.accessibilityService=u,this.subscriptionService=C,this.store$=N,this.textService=O,this.translatePipe=U}ngOnChanges(e){if(this.delayFetch(),e.pdfPage){let{bbox:t}=this.pdfPage;this.width=t.w+t.x,this.height=t.h+t.y}}ngOnInit(){this.subscriptionService.push(this.selectTextService.publishSelectedText$.pipe(w(e=>!e)).subscribe({next:()=>this.clearGestureSelector(!0)}),this.contentService.reload$.pipe(w(e=>Ro.typeAndPage(e,this.pdfPage.i,yo.TextSelection))).subscribe({next:()=>this.delayFetch()}),Et(this.store$.pipe(le("scale")).pipe(Ve(e=>this.scale=e)),this.store$.pipe(le("degree")).pipe(Ve(e=>this.degree=e))).pipe(is(2)).subscribe({next:()=>this.selectTextService.publishSelectedText(null)}),this.accessibilityService.pageAriaLabel$.subscribe({next:e=>{this.pageAriaLabels=e,this.changeDetectorRef.markForCheck()}}),Et(we(Pe.nativeWindow,"keydown"),we(Pe.nativeWindow,"keyup")).pipe(w(()=>!this.gestureSelectors.some(e=>e.isDragging)),w(e=>e.key==="Shift")).subscribe({next:e=>{e.type==="keydown"?D.bindLayoutOrder(this.stStyles,D.LayoutOrder.SelectText):e.type==="keyup"&&D.defaultLayoutOrder(this.stStyles),this.changeDetectorRef.markForCheck()}}))}ngOnDestroy(){this.destroySelector(),fe.destroy(this)}isAnnotCreate(){return this.status===X.CREATE}markForCheck(){this.changeDetectorRef.markForCheck()}fetch(){this.subscriptionService.set("dataSub",this.textService.fetchPdfPageText(this.documentId,this.pdfPage.ref).subscribe({next:e=>{this.isScreenReaderActive&&this.extractPageScript(e);let t=go.buildTextBoxTree(e,this.pdfPage);this.render({data:e,charTree:t}),this.subscriptionService.push(fe.runAsync(()=>this.gestureSelectors.length===0&&this.buildSelector()))}}))}extractPageScript(e){e.forEach(t=>{this.pageScript+=t.text})}delayFetch(){this.subscriptionService.set("delayedFetchSub",ri(D.TaskPriority.TEXT).subscribe({next:()=>this.fetch()}))}destroySelector(){this.gestureSelectors.forEach(e=>e.destroy()),this.gestureSelectors.splice(0)}buildSelector(){!this.data||!this.data.length||this.gestureSelectors.push(...this.selectTextService.createGesture(this,this.isAnnotCreate()))}clearGestureSelector(e=!1){this.debug&&this.changeDetectorRef.markForCheck(),this.gestureSelectors.forEach(t=>t.clear(e))}render({data:e,charTree:t}){this.data=e,this.textFetched.emit(e),this.charTree=t,this.changeDetectorRef.markForCheck()}onMousemove(e){if(!pt.isEventInPage(e,this.pdfPage)){this.renderer.setStyle(this.selectedElementRef.nativeElement,"cursor","default");return}this.renderer.setStyle(this.selectedElementRef.nativeElement,"cursor","text")}publishIsTextHover(e){let t=this.charTree.search(Yi.createSearchArea(this.pdfPage.bbox,e));this.selectTextService.publishIsTextHover(t.length>0)}};E(n,"\u0275fac",function(t){return new(t||n)(m($),m(xt),m(de),m(Vt),m(Jt),m(oa),m(R),m(me),m(Mo),m(ee))}),E(n,"\u0275cmp",H({type:n,selectors:[["sd-select-text"]],viewQuery:function(t,o){if(t&1&&(te(du,5),te(uu,5),te(hu,5),te(mu,5),te(_u,5)),t&2){let s;ie(s=ne())&&(o.selectedElementRef=s.first),ie(s=ne())&&(o.selectedPathElementRef=s.first),ie(s=ne())&&(o.indicatorElementRef=s.first),ie(s=ne())&&(o.startIndicatorElementRef=s.first),ie(s=ne())&&(o.endIndicatorElementRef=s.first)}},inputs:{pdfPage:"pdfPage",documentId:"documentId",status:"status",annot:"annot",isScreenReaderActive:"isScreenReaderActive"},outputs:{textFetched:"textFetched"},standalone:!1,features:[j([R]),Te],decls:11,vars:13,consts:[["startIndicator",""],["endIndicator",""],["indEl",""],["selEl",""],["selPathEl",""],["class","debug",4,"ngIf"],[4,"ngFor","ngForOf"],["width","0","height","0","viewBox","0 0 24 30",1,"indicator",3,"ngStyle"],["stroke","#f79f1a","stroke-width","2","fill","white"],["id","sel-el",3,"ngStyle","click","mousemove",4,"ngIf"],[1,"debug"],["class","searchBox",4,"ngIf"],["class","points","width","10","height","10",4,"ngIf"],[1,"searchBox"],["width","10","height","10",1,"points"],["id","ind",3,"debug","ngStyle",4,"ngIf"],["id","ind",3,"ngStyle"],["id","sel-el",3,"click","mousemove","ngStyle"]],template:function(t,o){t&1&&(y(0,Au,2,1,"svg",5)(1,Su,2,1,"ng-container",6),J(),h(2,"svg",7,0)(4,"g",8),x(5,"ellipse"),_()(),h(6,"svg",7,1)(8,"g",8),x(9,"ellipse"),_()(),y(10,Iu,4,4,"svg",9)),t&2&&(p("ngIf",o.debug&&(o.data==null?null:o.data.length)>0&&!o.isAnnotCreate()),l(),p("ngForOf",o.gestureSelectors),l(),p("ngStyle",o.indicatorStyle),l(3),B("cx",12)("cy",15)("rx",5)("ry",5),l(),p("ngStyle",o.indicatorStyle),l(3),B("cx",12)("cy",15)("rx",5)("ry",5),l(),p("ngIf",(o.data==null?null:o.data.length)>0))},dependencies:[De,Ce,_e],styles:["html[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{--mono-00: #FFFFFF;--mono-10: #F4F4F4;--mono-30: #DADADA;--mono-50: #C8C8C8;--mono-70: #6C6C6C;--mono-90: #363636;--mono-99: #1E1E1E;--mono-00-rgb: 255, 255, 255;--mono-99-rgb: 30, 30, 30;--primary-50: #F79F1A;--primary-50-rgb: 247, 159, 26;--primary-50-hover: #E09119;--primary-50-pressed: #C78016;--primary-70: #FF6100;--primary-70-rgb: 255, 97, 0;--second-50: #0C7489;--exception: #E4002B;--background: #DADADA;--input-background: #FFFFFF;--input-border: #DADADA;--button-background: #FFFFFF;--button-border: #DADADA;--button-pressed: #A3A3A3;--font-disable: #C4C4C4}table.pui-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], table.pui-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{word-break:break-all}table.pui-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child, table.pui-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{padding-left:20px}table.pui-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child, table.pui-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{padding-right:20px}table.pui-table[_ngcontent-%COMP%]   tr.pui-thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:400;text-align:left;border-top:1px solid #D1D1D1;border-bottom:1px solid #D1D1D1}*[_ngcontent-%COMP%]{-webkit-text-fill-color:currentcolor;letter-spacing:-.5px}input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{letter-spacing:initial}#sel-el[_ngcontent-%COMP%]{position:absolute;right:0;top:0;-webkit-user-select:none;user-select:none}svg.debug[_ngcontent-%COMP%]{right:0;top:0;position:absolute;width:100%;height:100%}svg.indicator[_ngcontent-%COMP%]{position:absolute;top:0;left:0;transform:scale(0);pointer-events:none}rect.searchBox[_ngcontent-%COMP%]{fill:#00ff0040;stroke-width:1;stroke:#000}rect.points[_ngcontent-%COMP%]{fill:#00000040;stroke-width:1;stroke:#000}#ind[_ngcontent-%COMP%]{right:0;top:0;position:absolute;width:1px;height:1px;transform-origin:100% 0}#ind.debug[_ngcontent-%COMP%]{border:solid 1px #000000}svg[_ngcontent-%COMP%]   path[_ngcontent-%COMP%]{mix-blend-mode:multiply;pointer-events:none;fill:rgba(var(--primary-50-rgb),.15)}"],changeDetection:0}));let r=n;return r})();var ec=(()=>{let n=class n{};E(n,"\u0275fac",function(t){return new(t||n)}),E(n,"\u0275mod",ot({type:n})),E(n,"\u0275inj",nt({providers:[Jt],imports:[rt,kt]}));let r=n;return r})();var vu=["dragSelectSvg"];function Ou(r,n){if(r&1&&(J(),x(0,"rect",3)),r&2){let i=d();B("x",i.rectRender.x)("y",i.rectRender.y)("width",i.rectRender.w)("height",i.rectRender.h)}}var _n=class _n{changeDetectorRef;renderer;annotSelectedService;sdContextMenuService;subscriptionService;selectTextService;dragSelectSvgElementRef;page;comps;select=new Ge;clickEvent=new Ge;created=!1;startPoint={x:0,y:0};rectRender={x:0,y:0,w:0,h:0};prevEvent;onMouseMoveListener=null;onMouseUpListener=null;onMouseLeaveListener=null;annotTree;isContextMenuOpened=!1;styles={};constructor(n,i,e,t,o,s){this.changeDetectorRef=n,this.renderer=i,this.annotSelectedService=e,this.sdContextMenuService=t,this.subscriptionService=o,this.selectTextService=s}ngOnInit(){this.togglePriority(D.LayoutOrder.DragSelect),this.styles.width=`${this.page.bbox.w+this.page.bbox.x}px`,this.styles.height=`${this.page.bbox.h+this.page.bbox.y}px`,this.subscriptionService.push(this.sdContextMenuService.contextMenuStatus$.subscribe({next:n=>this.isContextMenuOpened=n}))}onDown(n){return n.button===2?!1:(this.annotSelectedService.pageIndex!==this.page.i&&(this.annotSelectedService.unselectAll(),this.annotSelectedService.pageIndex=this.page.i),this.selectTextService.publishSelectedText(null),this.togglePriority(D.LayoutOrder.DragSelectActive),this.rectRender.h=0,this.rectRender.w=this.rectRender.h,this.onMouseUpListener=this.renderer.listen(this.dragSelectSvgElementRef.nativeElement,"mouseup",i=>this.onUp(i)),this.onMouseLeaveListener=this.renderer.listen(this.dragSelectSvgElementRef.nativeElement,"mouseleave",i=>this.onUp(i)),this.isContextMenuOpened||n.stopPropagation(),this.prevEvent=n,this.changeDetectorRef.markForCheck(),this.created=!0,this.rectRender.x=n.offsetX,this.startPoint.x=this.rectRender.x,this.rectRender.y=n.offsetY,this.startPoint.y=this.rectRender.y,this.onMouseMoveListener=this.renderer.listen(this.dragSelectSvgElementRef.nativeElement,"mousemove",i=>this.onMove(i)),!0)}onMove(n){return this.created?(n.preventDefault(),n.stopPropagation(),this.prevEvent.offsetX===n.offsetX&&this.prevEvent.offsetY===n.offsetY||(this.rectRender.x=Math.min(this.startPoint.x,n.offsetX),this.rectRender.y=Math.min(this.startPoint.y,n.offsetY),this.rectRender.w=Math.abs(n.offsetX-this.startPoint.x),this.rectRender.h=Math.abs(n.offsetY-this.startPoint.y),this.prevEvent=n,this.changeDetectorRef.markForCheck(),(n.offsetX<this.page.bbox.x||this.page.bbox.h<n.offsetY||this.annotSelectedService.pageIndex!==this.page.i)&&this.onUp(n)),!1):!0}onUp(n){n.preventDefault(),n.stopPropagation(),this.destroyMouseListeners(),this.created=!1,this.build();let i={x:this.rectRender.x,y:this.page.bbox.y+this.page.bbox.h-this.rectRender.y-this.rectRender.h,w:this.rectRender.w,h:this.rectRender.h},e=this.search(i);if(this.annotSelectedService.selectedComponents.splice(0),e.forEach(t=>{(this.rectRender.h>10||this.rectRender.w>10)&&this.annotSelectedService.add(t)}),this.annotSelectedService.trigger=n.type,this.annotSelectedService.isFirstSelection=!1,this.select.emit(this.annotSelectedService.getSelectedInfo()),this.annotTree.clear(),this.changeDetectorRef.markForCheck(),this.togglePriority(D.LayoutOrder.DragSelect),this.annotSelectedService.length===0){let t={x:i.x,y:i.y};this.clickEvent.emit([t,n])}return!1}ngOnDestroy(){this.destroyMouseListeners()}togglePriority(n){return D.bindLayoutOrder(this.styles,n)}search(n){return this.annotTree.search(n)}build(){this.annotTree=new Yi(this.page),this.comps.forEach(n=>this.addTree(n))}addTree(n){this.annotTree.insert(n.data.attributes.rect,n)}destroyMouseListeners(){S.isDefined(this.onMouseMoveListener)&&this.onMouseMoveListener(),this.onMouseMoveListener=null,S.isDefined(this.onMouseUpListener)&&this.onMouseUpListener(),this.onMouseUpListener=null,S.isDefined(this.onMouseLeaveListener)&&this.onMouseLeaveListener(),this.onMouseLeaveListener=null}};E(_n,"\u0275fac",function(i){return new(i||_n)(m($),m(xt),m(Ct),m(Vt),m(R),m(Jt))}),E(_n,"\u0275cmp",H({type:_n,selectors:[["sd-drag-select"]],viewQuery:function(i,e){if(i&1&&te(vu,7),i&2){let t;ie(t=ne())&&(e.dragSelectSvgElementRef=t.first)}},inputs:{page:"page",comps:"comps"},outputs:{select:"select",clickEvent:"clickEvent"},standalone:!1,features:[j([R])],decls:3,vars:2,consts:[["dragSelectSvg",""],["id","dragSelect",1,"dragSelect",3,"mousedown","ngStyle"],["stroke","#c8c8c8","stroke-width","0.6","fill","#dadada","fill-opacity","0.25",4,"ngIf"],["stroke","#c8c8c8","stroke-width","0.6","fill","#dadada","fill-opacity","0.25"]],template:function(i,e){if(i&1){let t=M();J(),h(0,"svg",1,0),I("mousedown",function(s){return f(t),g(e.onDown(s))}),y(2,Ou,1,4,"rect",2),_()}i&2&&(p("ngStyle",e.styles),l(2),p("ngIf",e.created))},dependencies:[Ce,_e],styles:[".dragSelect[_ngcontent-%COMP%]{width:100%;height:100%;background-color:#fff0;position:absolute;right:0;top:0;-webkit-user-select:none;user-select:none}"]}));var kn=_n;Z([Se(Q.dragSelectComp.onUp)],kn.prototype,"onUp",null);var tc={[F.HIGHLIGHT]:{label:"HIGHLIGHT",icon:"papycon papycon-text-highlight"},[F.STRIKE]:{label:"STRIKEOUT",icon:"papycon papycon-text-strikeout"},[F.UNDERLINE]:{label:"UNDERLINE",icon:"papycon papycon-text-underline"},[F.SEARCH]:{label:"SEARCH",icon:"papycon papycon-search"},[F.COPY]:{label:"COPY",icon:"papycon papycon-copy"},[F.ERASER]:{label:"REMOVE",icon:"papycon papycon-trash-can"},[F.POPUP]:{label:"TEXT",icon:"papycon papycon-memo2"},[F.EDIT]:{label:"PROPERTIES",icon:"papycon papycon-palette"},[F.RADIO_BUTTON]:{label:"ADD_NEIGHBOR_BUTTON",icon:"papycon papycon-plus"},[F.LINK]:{label:"CREATE_LINK",icon:"papycon papycon-link"},[F.REDACTION]:{label:"MARK_FOR_REDACTION",icon:"papycon papycon-redaction-partial2"}};var ic,nc,oc,bu=["bboxEl"],yu=r=>({content:r});function Ru(r,n){if(r&1){let i=M();h(0,"i",4),T(1,"translate"),T(2,"translate"),I("click",function(){let t=f(i).$implicit,o=d();return g(o.executeCommand(t))})("mousedown",function(t){let o=f(i).index,s=d();return g(s.onMousedown(t,o))})("mouseenter",function(){let t=f(i).index,o=d();return g(o.activeIconIndex=t)})("mouseup",function(t){return f(i),g(t.stopPropagation())}),_()}if(r&2){let i=n.$implicit,e=n.index,t=d();Gi(t.iconMap[i].icon),p("ngClass",t.activeIconIndex===e?t.currentPressedIndex===e?"active":"hover":null)("title",A(1,5,t.iconMap[i].label))("tooltip",at(9,yu,A(2,7,t.iconMap[i].label)))}}var Ur=(()=>{let n=class n{annotService;annotSelectedService;contentService;changeDetectorRef;subscriptionService;store$;scale;page;bbox;degree;acroFields;bboxElementRef;activeIconIndex;currentPressedIndex;menus=[];_positionStyle={left:"0",top:"0",transform:null,transformOrigin:null,visibility:D.STYLE_VISIBILITY_HIDDEN};get positionStyle(){return this._positionStyle}bboxStyles={transform:null};iconMap=tc;commands=new fn(this);realScale;get rotation(){return this.page?.r+this.degree}constructor(e,t,o,s,c,u){this.annotService=e,this.annotSelectedService=t,this.contentService=o,this.changeDetectorRef=s,this.subscriptionService=c,this.store$=u}ngOnChanges(){this.buildMenu(),setTimeout(()=>{this.realScale=1/D.normalizeScale(this.scale),S.isDefined(this.positionStyle)&&(this.positionStyle.transform=`scale(${this.realScale}) ${D.rotationNote(-this.rotation)}`,this.positionStyle.visibility=D.STYLE_VISIBILITY_HIDDEN,this.changeDetectorRef.detectChanges(),this.renderPosition())})}ngOnInit(){D.bindLayoutOrder(this.positionStyle,D.LayoutOrder.CONTEXT_MENU)}ngOnDestroy(){fe.destroy(this)}onMousedown(e,t){e.preventDefault(),e.stopPropagation(),this.currentPressedIndex=t,this.subscriptionService.push(Pe.windowMouseUp$.pipe(Mt(1)).subscribe({next:()=>this.currentPressedIndex=-1}))}executeCommand(e){this.commands.execute(e)}buildMenu(){this.menus.length&&this.menus.splice(0),!(!this.annotSelectedService.getSelectedInfo||!this.annotSelectedService.selectedComponents||this.annotSelectedService.selectedComponents.length===0)&&(Y.get(a.ANNOT_FLOATING_PROPERTY)&&this.menus.push(F.EDIT),Y.get(a.ANNOT_FLOATING_POPUP_NOTE)&&this.annotSelectedService.selectedComponents.length===1&&b.canHavePopup(this.annotSelectedService.selectedComponents[0].data)&&!b.isLink(this.annotSelectedService.selectedComponents[0].data)&&this.menus.push(F.POPUP),this.annotSelectedService.selectedComponents.every(e=>!qe.get(e.data.attributes.F,7))&&(Y.get(a.ANNOT_FLOATING_ADD_RADIO_BUTTON)&&this.annotSelectedService.selectedComponents.length===1&&b.isRadioWidget(this.annotSelectedService.selectedComponents[0].data,this.acroFields)&&!si.isReadonly(this.acroFields[this.annotSelectedService.selectedComponents[0].data.attributes.Parent].Ff)&&this.menus.push(F.RADIO_BUTTON),Y.get(a.ANNOT_FLOATING_DELETE)&&this.annotSelectedService.selectedComponents.every(e=>b.isWidget(e.data)&&Y.get(a.DELETE_FORM)||!b.isWidget(e.data)&&Y.get(a.DELETE_ANNOTATION))&&this.menus.push(F.ERASER)))}renderPosition(){if(!this.bboxElementRef||this.menus.length===0)return;let e=this.bboxElementRef.nativeElement.getBoundingClientRect();this.positionStyle.transformOrigin="50% 50%",this.positionStyle.transform=`${this.translationOf(e,26)} ${this.positionStyle.transform}`,this.positionStyle.visibility=null,setTimeout(()=>{this.changeDetectorRef&&this.changeDetectorRef.markForCheck()})}translationOf({width:e,height:t},o){let s=D.normalizeDegree(-this.rotation),c=this.computeDefaultPosition(e,t,o,s),{x:u,y:C}=this.computeOverflow(c,e,t,s);return`translate(${u}px, ${C}px)`}computeDefaultPosition(e,t,o,s){let c={x:this.bbox.x-(e-this.bbox.w)/2,y:this.bbox.y-(t-this.bbox.h)/2},u=c.x,C=c.y,N=this.bbox.w/2+(t/2+o)*this.realScale,O=this.bbox.h/2+(t/2+o)*this.realScale;switch(s){case 0:C-=O;break;case 90:u+=N;break;case 180:C+=O;break;case 270:u-=N;break;default:break}return{x:u,y:C}}computeOverflow(e,t,o,s){let{x:c,y:u}=e;switch(s){case 0:c=Math.max(c,(t*this.realScale-t)/2),c=Math.min(c,this.page.bbox.w-(t*this.realScale+t)/2),u=Math.max(u,(o*this.realScale-o)/2);break;case 90:c=Math.min(c,this.page.bbox.w-(o*this.realScale+t)/2),u=Math.max(u,(t*this.realScale-o)/2),u=Math.min(u,this.page.bbox.h-(t*this.realScale+o)/2);break;case 180:c=Math.max(c,(t*this.realScale-t)/2),c=Math.min(c,this.page.bbox.w-(t*this.realScale+t)/2),u=Math.min(u,this.page.bbox.h-(o*this.realScale+o)/2);break;case 270:c=Math.max(c,(o*this.realScale-t)/2),u=Math.max(u,(t*this.realScale-o)/2),u=Math.min(u,this.page.bbox.h-(t*this.realScale+o)/2);break;default:break}return{x:c,y:u}}};E(n,"\u0275fac",function(t){return new(t||n)(m(Ie),m(Ct),m(de),m($),m(R),m(me))}),E(n,"\u0275cmp",H({type:n,selectors:[["sd-edit-menu"]],viewQuery:function(t,o){if(t&1&&te(bu,7),t&2){let s;ie(s=ne())&&(o.bboxElementRef=s.first)}},inputs:{scale:"scale",page:"page",bbox:"bbox",degree:"degree",acroFields:"acroFields"},standalone:!1,features:[j([R,{provide:Kn,useValue:new ui(300)}]),Te],decls:4,vars:3,consts:[["bboxEl",""],[1,"position",3,"ngStyle"],[1,"bbox",3,"mouseleave","ngStyle"],[3,"class","ngClass","title","tooltip","click","mousedown","mouseenter","mouseup",4,"ngFor","ngForOf"],[3,"click","mousedown","mouseenter","mouseup","ngClass","title","tooltip"]],template:function(t,o){if(t&1){let s=M();h(0,"div",1)(1,"div",2,0),I("mouseleave",function(){return f(s),g(o.activeIconIndex=-1)}),y(3,Ru,3,11,"i",3),_()()}t&2&&(p("ngStyle",o.positionStyle),l(),p("ngStyle",o.bboxStyles),l(2),p("ngForOf",o.menus))},styles:["div.position[_ngcontent-%COMP%]{position:absolute;left:0;top:0;pointer-events:none}div.bbox[_ngcontent-%COMP%]{background:var(--mono-00);border:1px solid;border-color:var(--mono-50);box-shadow:0 -4px 9px #0000001f;border-radius:4px;transform-origin:50% 100%;pointer-events:auto}.papycon[_ngcontent-%COMP%]{display:inline-block;font-size:24px;line-height:40px;padding:0 8px;height:40px;width:40px;border-radius:8px;color:var(--mono-90);text-align:center;cursor:pointer}.papycon.active[_ngcontent-%COMP%]{color:var(--primary-50)}.papycon.hover[_ngcontent-%COMP%]{color:var(--mono-99)}"],changeDetection:0}));let r=n;return r})(),fn=class{comp;constructor(n){this.comp=n}get annotService(){return this.comp.annotService}execute(n){if(!this[n]){console.warn("Unsupported",n);return}this[n]()}[ic=F.ERASER](){let n=this.comp.annotSelectedService.selectedComponents;for(let i=n.length-1;i>=0;--i)this.comp.contentService.fireAnnotEvent({sdEventType:pe.DELETE,pageIdx:this.comp.page.i,annot:n[i].data})}buildPopup(n){if(b.hasPopup(n)||!b.canHavePopup(n))return;let i=n.attributes.rect,e=this.annotService.createAnnot(F.POPUP,this.comp.page,{x:i.left/2,y:i.top/2})[0];n.Popup=e.oid,this.annotService.putModel(e),this.annotService.putModel(n,"modify"),this.comp.contentService.fireAnnotEvent({from:"EditMenuComponent",sdEventType:pe.UPDATE,annot:n})}[nc=F.POPUP](){let n=this.comp.annotSelectedService.selectedComponents[0].data;this.buildPopup(n),this.comp.annotService.togglePopup(n),this.comp.annotService.closeEditor()}[oc=F.EDIT](){this.comp.store$.dispatch(ft.set({key:"rightSideViewMode",value:Li.AnnotProperty})),this.comp.store$.dispatch(ft.set({key:"rightSideViewVisible",value:!0}))}[F.RADIO_BUTTON](){let n=this.comp.annotSelectedService.selectedComponents[0].data,{rect:i}=n.attributes,e=this.comp.acroFields[n.attributes.Parent],t=e.Kids[e.Kids.length-1].oid;this.comp.annotService.closeEditor(),this.comp.store$.dispatch(Fi.selectTool({payload:F.RADIO_BUTTON})),this.comp.store$.dispatch(Fi.updateWidgetContext({payload:{title:e.T,AP_N:`${t>0?t+1:t-1}`,width:i.right-i.left,height:i.top-i.bottom}}))}};Z([Se(Q.editMenuComp.eraser)],fn.prototype,ic,null);Z([Se(Q.editMenuComp.popup)],fn.prototype,nc,null);Z([Se(Q.editMenuComp.edit)],fn.prototype,oc,null);function Nu(r,n){if(r&1&&(h(0,"div",2),ue(1),P(2),he(),_()),r&2){let i=d();p("ngStyle",i.annotStyle),l(2),L(i.caption)}}function Pu(r,n){if(r&1&&x(0,"div",2),r&2){let i=d();p("ngStyle",i.appearanceStyle)}}var rc=(()=>{let n=class n{changeDetectorRef;subscriptionService;contentService;loggingService;data;get caption(){let e=this.data.attributes.MK?.CA;return S.isDefined(e)?e:(this.loggingService.common("warn",Ee.NOT_EXIST,"CA"),"")}get renderAppearance(){return k.hasAppearance(this.data.attributes.appearance)}get appearanceStyle(){return k.appearanceStyle(this.data.attributes)}get annotStyle(){return{fontSize:`${this.data.attributes.fontSize}px`,color:this.data.attributes.fontColor,fontFamily:this.data.attributes.fontName}}constructor(e,t,o,s){this.changeDetectorRef=e,this.subscriptionService=t,this.contentService=o,this.loggingService=s}ngOnInit(){this.subscriptionService.push(this.contentService.annotEvent$.pipe(w(S.isDefined),w(e=>e.annot.oid===this.data.oid)).subscribe({next:()=>{this.changeDetectorRef.detectChanges()}}))}};E(n,"\u0275fac",function(t){return new(t||n)(m($),m(R),m(de),m(ze))}),E(n,"\u0275cmp",H({type:n,selectors:[["sd-form-button"]],inputs:{data:"data"},standalone:!1,features:[j([R])],decls:3,vars:2,consts:[["appearance",""],[3,"ngStyle",4,"ngIf","ngIfElse"],[3,"ngStyle"]],template:function(t,o){if(t&1&&y(0,Nu,3,2,"div",1)(1,Pu,1,1,"ng-template",null,0,ke),t&2){let s=Oe(2);p("ngIf",!o.renderAppearance)("ngIfElse",s)}},dependencies:[Ce,_e],styles:["[_nghost-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;height:100%;cursor:pointer;white-space:nowrap}"],changeDetection:0}));let r=n;return r})();var nr=class{view;checkImageUrl;unCheckedImageUrl;constructor(n,i,e){this.view=n,this.checkImageUrl=i,this.unCheckedImageUrl=e}buttonStyle(n){return n?this.checkImageUrl:this.unCheckedImageUrl}buttonAction(n){this.view.widget.value===n?this.view.widget.value="Off":this.view.widget.value=n}},or=class{view;checkImageUrl;unCheckedImageUrl;constructor(n,i,e){this.view=n,this.checkImageUrl=i,this.unCheckedImageUrl=e}buttonStyle(n){return n?this.checkImageUrl:this.unCheckedImageUrl}buttonAction(n){this.view.data.attributes.AP_N&&(this.view.widget.value=n)}};var Mu={data:null,status:null,annotService:null,oid:null,width:null,stroke:null,fill:null,dashArray:null,srcRect:null,viewClasses:null,render(){},pvOnMove(r){},postCreate(r){},isCreateStatus(){return!1},isRemoveStatus(){return!1}},Dt=class{data;status;annotService;static create(n,i,e){return b.isCircle(n)?new Br(n,i,e):b.isSquare(n)||b.isWidget(n)||b.isLink(n)?new Vn(n,i,e):b.isFreeTextCallout(n)?new Gr(n,i,e):b.isFreeText(n)?new rr(n,i,e):b.isRedact(n)?new Wr(n,i,e):(console.warn(`Unsupported rect render type[${n.type}] of oid[${n.oid}]`),Mu)}oid;width;stroke;fill;dashArray=null;srcRect=null;viewClasses={absolute:!0,create:!1,debug:!1,remove:!1,freeText:!1};constructor(n,i,e){this.data=n,this.status=i,this.annotService=e,this.srcRect=this.data?S.deepClone(this.data.attributes.rect):null}isCreateStatus(){return X.CREATE===this.status}isRemoveStatus(){return X.REMOVE===this.status}pvOnMove(n){let i=this.data.attributes.rect;i.right=n.offsetX,i.top=n.offsetY}postCreate(n){let i=this.data.attributes.rect;i.bottom=n.bbox.h+n.bbox.y-i.bottom,i.top=n.bbox.h+n.bbox.y-i.top}render(){this.annotService.bindCursorClass(this.viewClasses,this.status),this.oid=this.data.oid,this.width=this.data.attributes.width,this.fill=this.data.attributes.InteriorColor||"none",b.isRedact(this.data)?this.stroke=this.data.attributes.OutlineColor:this.stroke=this.data.attributes.color;let n=this.data.attributes.borderStyle;this.dashArray=n?.style==="dashed"?n.dashPattern.map(i=>i.toString()).reduce((i,e)=>(i&&`${i}, `)+e,S.EMPTY_STRING):null}},Br=class extends Dt{cx;cy;rx;ry;render(){super.render();let n=this.data.attributes.rect;this.rx=Math.max((Math.abs(n.right-n.left)-this.data.attributes.width)/2,0),this.ry=Math.max((Math.abs(n.top-n.bottom)-this.data.attributes.width)/2,0),this.cx=(n.right+n.left)/2,this.cy=(n.top+n.bottom)/2,X.CREATE!==this.status&&(this.cx-=n.left-this.width,this.cy-=n.bottom-this.width),X.EDIT===this.status&&(this.cx+=n.left-this.srcRect.left,this.cy+=this.srcRect.top-n.top)}},Vn=class extends Dt{x;y;rectWidth;rectHeight;render(){super.render();let n=this.data.attributes.rect;this.rectWidth=Math.max(D.fixedOf(Math.abs(n.right-n.left),3)-(this.data.attributes.width||0),0),this.rectHeight=Math.max(D.fixedOf(Math.abs(n.bottom-n.top),3)-(this.data.attributes.width||0),0),this.isCreateStatus()?(this.x=Math.min(n.left,n.right),this.y=Math.min(n.bottom,n.top)):this.status===X.EDIT?(this.x=Math.min(n.left,n.right)-Math.min(this.srcRect.left,this.srcRect.right),this.y=Math.max(this.srcRect.top,this.srcRect.bottom)-Math.max(n.bottom,n.top)):(this.y=0,this.x=this.y),this.x+=this.width*.5,this.y+=this.width*.5}},rr=class extends Vn{render(){super.render(),this.status===X.CREATE&&(this.fill=this.data.attributes.color||"none"),this.stroke=this.data.attributes.contentsRichtext.borderColor,this.viewClasses.freeText=!0}},Gr=class extends rr{render(){super.render();let n=this.data.attributes.rect,i=this.data.attributes.textRect,e=this.data.attributes.width;this.isCreateStatus()?(this.x+=Math.min(i.left,i.right)-Math.min(n.left,n.right),this.y+=Math.min(i.bottom,i.top)-Math.min(n.bottom,n.top)):(this.x=i.left-n.left+e/2,this.y=n.top-i.top+e/2),this.rectWidth=Math.max(D.fixedOf(Math.abs(i.right-i.left),3)-this.data.attributes.width,0),this.rectHeight=Math.max(D.fixedOf(Math.abs(i.top-i.bottom),3)-this.data.attributes.width,0)}postCreate(n){let i=this.data.attributes.textRect;i.bottom=n.bbox.h+n.bbox.y-i.bottom,i.top=n.bbox.h+n.bbox.y-i.top,k.validateRect(i)}pvOnMove(n){let i=this.data.attributes.textRect,e=Math.abs((i.left-i.right)/2),t=(i.top-i.bottom)/2;i.left=n.offsetX-e,i.right=n.offsetX+e,i.bottom=n.offsetY-t,i.top=n.offsetY+t}},Wr=class extends Vn{fillOpacity;render(){super.render(),this.fill=this.data.attributes.OutlineColor,this.fillOpacity=this.data.attributes.fillOpacity||.2}};var Du=["form"];function wu(r,n){if(r&1&&x(0,"sd-form-text",9,0),r&2){let i=d(2);p("data",i.data)}}function Lu(r,n){if(r&1&&x(0,"sd-form-checkable-button",9,0),r&2){let i=d(2);p("data",i.data)}}function Fu(r,n){if(r&1&&x(0,"sd-form-signature",10,0),r&2){let i=d(2);p("data",i.data)("canEdit",i.canEdit)}}function ku(r,n){if(r&1&&x(0,"sd-form-button",9,0),r&2){let i=d(2);p("data",i.data)}}function Vu(r,n){if(r&1&&x(0,"sd-form-list-box",9,0),r&2){let i=d(2);p("data",i.data)}}function Uu(r,n){if(r&1&&x(0,"sd-form-combo-box",9,0),r&2){let i=d(2);p("data",i.data)}}function Bu(r,n){if(r&1&&(h(0,"p"),P(1),_()),r&2){let i=d(2);l(),Re("TODO::",i.type,"")}}function Gu(r,n){if(r&1){let i=M();h(0,"div",4),I("mousedown",function(t){f(i);let o=d();return g(o.onMousedown(t))})("click",function(){f(i);let t=d();return g(t.onClick())})("touchstart",function(t){f(i);let o=d();return g(o.onTouchstart(t))}),h(1,"div",5),y(2,wu,2,1,"sd-form-text",6)(3,Lu,2,1,"sd-form-checkable-button",6)(4,Fu,2,2,"sd-form-signature",7)(5,ku,2,1,"sd-form-button",6)(6,Vu,2,1,"sd-form-list-box",6)(7,Uu,2,1,"sd-form-combo-box",6),_(),y(8,Bu,2,1,"p",8),_()}if(r&2){let i=d();p("ngSwitch",i.type)("title",i.canEdit?i.title:"")("ngStyle",i.transformStyle),l(),p("ngStyle",i.widgetStyle),l(),p("ngSwitchCase","Tx"),l(),p("ngSwitchCase",i.caseCheckableButton(i.type)),l(),p("ngSwitchCase","Sig"),l(),p("ngSwitchCase","Btn"),l(),p("ngSwitchCase","Lx"),l(),p("ngSwitchCase","Cx")}}function Wu(r,n){if(r&1&&(J(),h(0,"svg",11),x(1,"rect")(2,"rect",12),_()),r&2){let i=d();p("ngStyle",i.transformStyle),l(),B("x",i.rectX)("y",i.rectY)("width",i.rectWidth+i.renderer.width)("height",i.rectHeight+i.renderer.width)("fill",i.rectFill)("fill-opacity",i.rectFillOpacity),l(),B("x",i.rectX+i.rectStrokeWidth/2)("y",i.rectY+i.rectStrokeWidth/2)("width",i.Math.max(i.rectWidth-(i.isFixedStrokeWidth?1:0),0))("height",i.Math.max(i.rectHeight-(i.isFixedStrokeWidth?1:0),0))("stroke",i.rectStroke)("stroke-width",i.rectStrokeWidth)("stroke-dasharray",i.rectStrokeDasharray)}}function Hu(r,n){if(r&1&&(h(0,"div",13)(1,"div",14),P(2),_()()),r&2){let i=d();Ye("width",i.rectWidth+i.rectStrokeWidth-(i.isFixedStrokeWidth?1:0),"px")("height",i.rectHeight+i.rectStrokeWidth-(i.isFixedStrokeWidth?1:0),"px"),G("left-align",i.isLeftAlign),p("ngStyle",i.transformStyle),l(),Ye("background-color",i.isRequired()?i.preferences==null?null:i.preferences.formFieldRequiredColor:"#000000"),l(),L(i.title)}}var Pt=(()=>{let n=class n{elementRef;acroFormService;contentService;annotService;documentService;editService;changeDetectorRef;subscriptionService;scriptService;store$;viewerService;loggingService;data;status=X.RENDER;form;get AnnotStatus(){return X}renderer;preferences;widgetStyle={overflow:"hidden"};transformStyle={};type;canEdit=null;detectWithChild=!1;rectX=0;rectY=0;rectWidth=0;rectHeight=0;acroFieldsInit=!1;acroField;srcRect;constructor(e,t,o,s,c,u,C,N,O,U,z,Me){this.elementRef=e,this.acroFormService=t,this.contentService=o,this.annotService=s,this.documentService=c,this.editService=u,this.changeDetectorRef=C,this.subscriptionService=N,this.scriptService=O,this.store$=U,this.viewerService=z,this.loggingService=Me}onMousedown(e){return e.stopPropagation(),this.emitWidgetMouseDownEvent(),!0}onClick(){this.data.attributes.type==="JavaScript"&&this.scriptService.execute(this.acroField,this.data.attributes.JS||S.EMPTY_STRING)}onTouchstart(e){e.stopPropagation(),this.emitWidgetMouseDownEvent()}ngOnInit(){this.subscriptionService.push(this.contentService.annotEvent$.pipe(w(S.isDefined),w(e=>e.annot.oid===this.data.oid)).subscribe({next:()=>{this.srcRect=S.deepClone(this.data.attributes.rect),this.detectWithChild=!0,this.detectChange()}}),this.acroFormService.acroFields$.pipe(w(e=>!!e),Ve({next:()=>this.acroFieldsInit=!0})).subscribe({next:()=>{this.detectWithChild=!0,this.detectChange()}}),this.store$.pipe(le("dragMode"),Ve({next:e=>this.canEdit=e===Ae.SELECT_ANNOT})).subscribe({next:()=>{this.detectChange()}}),this.store$.pipe(Be()).subscribe({next:e=>{this.preferences=e,this.detectWithChild=!0,this.detectChange()}}),this.contentService.fieldEvent$.pipe(w(S.isDefined),w(e=>e.fieldTitle===this.title)).subscribe({next:()=>{this.detectWithChild=!0,this.detectChange()}}))}ngOnDestroy(){S.removeElement(this.elementRef.nativeElement),fe.destroy(this)}ngOnChanges(e){e.data&&this.updateAcroField(),this.srcRect=S.deepClone(this.data.attributes.rect),this.renderer=Dt.create(this.data,this.status,this.annotService),this.setFieldRotateStyle(),this.detectWithChild=!0,this.detectChange()}get title(){return this.acroField?.T||this.data.attributes.T}get Math(){return Math}get value(){return this.acroField?.hasOwnProperty("V")?this.acroField.V:this.data.attributes.V}set value(e){if(!this.acroField){this.loggingService.common("warn",Ee.NOT_EXIST,"acroField");return}this.acroField.V!==e&&(this.acroField.V=e,this.acroFormService.putModel(this.acroField,"modify"))}get flag(){return this.acroField?.Ff||this.data.attributes.Ff}get opt(){return this.acroField?.Opt||[]}get selectedItems(){return this.acroField?.I||[]}set selectedItems(e){this.acroField&&(this.acroField.I=e,this.acroFormService.putModel(this.acroField,"modify"))}get rectFill(){if(this.status===X.CREATE)return this.viewerService.customColor.main;if(this.isNeedHighlight()){let e=this.preferences.formFieldHighlightedColor;if(!this.data.attributes.MK?.backgroundColor&&!this.data.attributes.MK?.borderColor)return e;let t=Mi.parseRgbString(e),o=Mi.rgbToHsl(t);o.l=o.l-7;let s=Mi.hslToRgb(o);return Mi.rgbToHexString(s)}return this.data.attributes.MK?.backgroundColor||"none"}get rectFillOpacity(){return this.status===X.CREATE?.08:this.isNeedHighlight()&&!this.data.attributes.MK?.backgroundColor&&!this.data.attributes.MK?.borderColor?.66:1}get rectStroke(){return this.status===X.CREATE?this.viewerService.customColor.main:this.data.attributes.MK?.borderColor?this.isNeedHighlight()&&this.isRequired()?this.preferences?.formFieldRequiredColor:this.data.attributes.MK?.borderColor||"none":this.isRequired()?!this.canEdit&&!this.isNeedHighlight()?"none":this.preferences?.formFieldRequiredColor:this.canEdit?"#000000":"none"}get rectStrokeWidth(){return this.isFixedStrokeWidth?1:this.renderer.width}get isFixedStrokeWidth(){return this.status===X.CREATE||this.renderer.width<=0&&(this.canEdit||this.isNeedHighlight()&&this.isRequired())}get isLeftAlign(){let e=document.createElement("canvas").getContext("2d");if(e===null)throw new Ni("Failed to get CanvasRenderingContext2D");e.font="8px NotoSans-Regular";let{rect:t}=this.data.attributes;return Math.abs(t.right-t.left)<e.measureText(this.title).width}get rectStrokeDasharray(){return this.status===X.CREATE?"8 8":this.isNeedHighlight()&&this.isRequired()?null:this.renderer.dashArray}isRequired(){let e=this.acroField?this.acroField.Ff:this.data.attributes.Ff;return S.isDefined(e)&&si.isRequired(e)}isReadonly(){let e=this.acroField?this.acroField.Ff:this.data.attributes.Ff;return S.isDefined(e)&&(si.isReadonly(e)||!this.documentService.checkAuthority(be.FILL_FORM))}isNeedHighlight(){return this.preferences?.formFieldHighlighted&&!this.isReadonly()&&(!this.isSignature()||this.isSignature()&&!this.data.attributes.appearance&&!this.value)&&this.type!=="Btn"}isEdited(){return this.data.attributes.Parent<0?!0:this.annotService.getActionLogAnnots(this.data.attributes.pageIdx).findIndex(t=>t.oid===this.data.oid)>-1||this.value!==this.acroFormService.lastFetchedAcroFields?.get(this.data.attributes.Parent)?.V}pvOnMove(e){this.renderer.pvOnMove(e);let{rect:t}=this.data.attributes;this.rectX=Math.min(t.left,t.right),this.rectY=Math.min(t.top,t.bottom),this.rectWidth=Math.abs(t.right-t.left),this.rectHeight=Math.abs(t.top-t.bottom),this.detectChange()}postCreate(e){this.renderer.postCreate(e),(b.isCheckBox(this.data,this.acroFormService.acroFields)||b.isRadioWidget(this.data,this.acroFormService.acroFields))&&this.annotService.updateCheckableButtonAppearance(this.data),this.validate()}verticesOf(e,t,o){return this.editService.createRectVertices(t,o)}postEdit(e,t){this.validate(),this.transformStyle.transform=S.EMPTY_STRING,this.form.postEdit&&this.form.postEdit(e,t),this.ngOnChanges({}),this.detectChange()}pvOnVertexMove(e,t,o){if(this.renderer.status=X.EDIT,!this.editService.resizeByRectVertex(this.data,t,o))return;let s=this.data.attributes.rect;this.transformStyle.transform=`translate(${Math.min(s.left,s.right)-this.srcRect.left}px, ${this.srcRect.top-Math.max(s.top,s.bottom)}px)`,this.setFieldRotateStyle(),this.form?.pvOnVertexMove&&this.form.pvOnVertexMove(void 0,void 0,void 0),this.detectChange()}caseCheckableButton(e){return e==="Cb"||e==="Rb"?e:null}setFieldRotateStyle(){let e=k.elementStyleOf(this.data);this.widgetStyle.width=e.width,this.widgetStyle.height=e.height,Object.assign(this.widgetStyle,k.fieldRotateStyleOf(this.data,e))}isComponentInitialized(){return this.acroFieldsInit&&this.preferences!==null&&this.canEdit!==null}isSignature(){return this.type==="Sig"}emitWidgetMouseDownEvent(){let e=S.deepClone(this.data);e.attributes.Parent=S.deepClone(this.acroFormService.acroFields[this.data.attributes.Parent]),this.annotService.fireWidgetMousedownEvent(e)}updateAcroField(){this.acroField=this.acroFormService.getAcroField(this.data.attributes.Parent),this.type=this.acroField?.FT||this.data.attributes.FT}validate(){k.validateRect(this.data.attributes.rect)}detectChange(){if(!this.isComponentInitialized()||this.changeDetectorRef.destroyed)return;this.renderer&&(this.renderer.render(),this.rectWidth=this.renderer.rectWidth,this.rectHeight=this.renderer.rectHeight),this.data.attributes.Parent&&this.updateAcroField();let e=this.form;this.setFieldRotateStyle(),this.detectWithChild&&e?.detectChange&&(e.detectChange(),this.detectWithChild=!1),this.changeDetectorRef.detach(),this.changeDetectorRef.detectChanges(),this.changeDetectorRef.reattach()}};E(n,"\u0275fac",function(t){return new(t||n)(m(re),m(gt),m(de),m(Ie),m(mt),m(ht),m($),m(R),m(qt),m(me),m(on),m(ze))}),E(n,"\u0275cmp",H({type:n,selectors:[["sd-widget"]],viewQuery:function(t,o){if(t&1&&te(Du,5),t&2){let s;ie(s=ne())&&(o.form=s.first)}},inputs:{data:"data",status:"status"},standalone:!1,features:[j([R]),Te],decls:3,vars:3,consts:[["form",""],[3,"ngSwitch","title","ngStyle","mousedown","click","touchstart",4,"ngIf"],["class","absolute","id","background",3,"ngStyle",4,"ngIf"],["class","title-container",3,"left-align","width","height","ngStyle",4,"ngIf"],[3,"mousedown","click","touchstart","ngSwitch","title","ngStyle"],[3,"ngStyle"],[3,"data",4,"ngSwitchCase"],[3,"data","canEdit",4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"data"],[3,"data","canEdit"],["id","background",1,"absolute",3,"ngStyle"],["fill","none"],[1,"title-container",3,"ngStyle"],[1,"title-text"]],template:function(t,o){t&1&&y(0,Gu,9,10,"div",1)(1,Wu,3,14,"svg",2)(2,Hu,3,10,"div",3),t&2&&(p("ngIf",o.type&&o.status!==o.AnnotStatus.CREATE),l(),p("ngIf",o.type&&o.status!==o.AnnotStatus.PREVIEW),l(),p("ngIf",o.type&&o.canEdit&&o.status!==o.AnnotStatus.CREATE&&o.status!==o.AnnotStatus.PREVIEW))},styles:["[_nghost-%COMP%]{width:100%;height:100%;display:block}div[_ngcontent-%COMP%]{width:100%;height:100%;display:block}svg[_ngcontent-%COMP%]{left:0;top:0}svg#background[_ngcontent-%COMP%]{z-index:-1;cursor:crosshair}.title-container[_ngcontent-%COMP%]{position:absolute;left:0;top:0;display:flex;align-items:center;justify-content:center;overflow:hidden}.title-container.left-align[_ngcontent-%COMP%]{justify-content:flex-start}.title-container.left-align[_ngcontent-%COMP%]   .title-text[_ngcontent-%COMP%]{transform-origin:0 center}.title-container[_ngcontent-%COMP%]   .title-text[_ngcontent-%COMP%]{width:auto;height:auto;color:#fff;padding:0 2px;font-family:NotoSans-Regular;font-size:10px;transform-origin:center;transform:scale(.8)}.SELECT_ANNOT[_nghost-%COMP%]:hover, .SELECT_ANNOT   [_nghost-%COMP%]:hover, .SELECT_ANNOT.hover[_nghost-%COMP%], .SELECT_ANNOT   .hover[_nghost-%COMP%]{opacity:.3}"],changeDetection:0}));let r=n;return r})();var sc=(()=>{let n=class n{elementRef;changeDetectorRef;annotService;loggingService;data;_annotStyle={};widget;rendererMap={Cb:nr,Rb:or};appearanceTypeMap={4:"check",l:"circle",8:"cross",u:"diamond",n:"square",H:"star"};selectBtnRenderer;lastRenderedImageInfo={width:0,height:0,apperanceType:null};constructor(e,t,o,s,c){this.elementRef=e,this.changeDetectorRef=t,this.annotService=o,this.loggingService=s,this.widget=c}ngOnChanges(){this.widget.status!==X.CREATE&&k.hasAppearance(this.data.attributes.appearance)&&(this.lastRenderedImageInfo.width=this.widget.rectWidth,this.lastRenderedImageInfo.height=this.widget.rectHeight,this.lastRenderedImageInfo.apperanceType=this.data.attributes.MK?.CA||(this.widget.type==="Cb"?"4":"l")),this.detectChange()}get onValue(){let e="";return this.data.attributes.AP_N.forEach(t=>{t.toLowerCase()!=="off"&&(e=t)}),e}get annotStyle(){return this.selectBtnRenderer&&(this._annotStyle["background-image"]=this.selectBtnRenderer.buttonStyle(this.widget.value===this.onValue)),this.widget.isReadonly()?this._annotStyle.cursor="default":this._annotStyle.cursor=null,this._annotStyle}buttonClick(){this.widget.isReadonly()||(this.selectBtnRenderer.buttonAction(this.onValue),this.detectChange())}postEdit(e,t){this.isValidAppearance()||(this.data.attributes.appearance=void 0,this.annotService.updateCheckableButtonAppearance(this.data))}detectChange(){if(this.changeDetectorRef.destroyed)return;let e=this.widget.type;if(this.widget.renderer.status===X.EDIT||this.data.attributes.appearance===void 0||this.widget.isNeedHighlight()){let t=this.data.attributes.MK?.CA||(this.widget.type==="Cb"?"4":"l"),o=this.widget.type==="Cb"?Ji.checkbox:Ji.radio;this.selectBtnRenderer=this.rendererMap[e]?new this.rendererMap[e](this,`url('data:image/svg+xml;base64,${o[this.appearanceTypeMap[t]]}')`,`url('data:image/svg+xml;base64,${o.unchecked}')`):null}else if(this.data.attributes.appearance!==void 0){let t=this.data.attributes.appearance?.find(s=>s.state!=="Off"),o=this.data.attributes.appearance?.find(s=>s.state==="Off");(!S.isDefined(t)||!S.isDefined(o))&&this.loggingService.common("warn",Ee.NOT_EXIST,"on/off AP"),this.selectBtnRenderer=this.rendererMap[e]?new this.rendererMap[e](this,`url('data:image/png;base64,${t?.data}')`,`url('data:image/png;base64,${o?.data}')`):null}this.changeDetectorRef.detectChanges()}isValidAppearance(){return this.lastRenderedImageInfo.width===this.widget.rectWidth&&this.lastRenderedImageInfo.height===this.widget.rectHeight&&this.lastRenderedImageInfo.apperanceType===(this.data.attributes.MK?.CA||(this.widget.type==="Cb"?"4":"l"))}};E(n,"\u0275fac",function(t){return new(t||n)(m(re),m($),m(Ie),m(ze),m(Pt,1))}),E(n,"\u0275cmp",H({type:n,selectors:[["sd-form-checkable-button"]],inputs:{data:"data"},standalone:!1,features:[j([R]),Te],decls:1,vars:1,consts:[[3,"click","ngStyle"]],template:function(t,o){t&1&&(h(0,"div",0),I("click",function(){return o.buttonClick()}),_()),t&2&&p("ngStyle",o.annotStyle)},dependencies:[_e],styles:["div[_ngcontent-%COMP%]{width:100%;height:100%;display:block;margin:0;padding:0;cursor:pointer;border:none;background-color:#fff0;background-size:contain;background-repeat:no-repeat;background-position:center center}"]}));let r=n;return r})();var zu=["container"],ju=["selectionContainer"];function $u(r,n){r&1&&x(0,"i",6)}function Yu(r,n){if(r&1){let i=M();h(0,"div",8),I("mousedown",function(){let t=f(i).index,o=d(2);return g(o.onItemClicked(t))}),P(1),_()}if(r&2){let i=n.$implicit,e=d(2);l(),L(e.getDisplayName(i))}}function Xu(r,n){if(r&1&&(h(0,"section",3,1),y(2,Yu,2,1,"div",7),_()),r&2){let i=d();p("ngStyle",i.selectionContainerStyle),l(2),p("ngForOf",i.widget.opt)}}var ac=(()=>{let n=class n{elementRef;contentService;changeDetectorRef;pageService;subscriptionService;data;containerEl;selectionContainerEl;widget;selectionContainerStyle={};_active=!1;autoFitFontSize=0;currentPage;constructor(e,t,o,s,c,u){this.elementRef=e,this.contentService=o,this.changeDetectorRef=s,this.pageService=c,this.subscriptionService=u,this.widget=t}ngOnInit(){this.subscriptionService.push(this.pageService.pdfPages$.subscribe({next:e=>this.currentPage=e[this.data.attributes.pageIdx]}))}get active(){return this._active}set active(e){this.widget.isReadonly()||(this._active=e,e?setTimeout(()=>{this.determineSelectionPosition(),this.selectionContainerStyle.visibility="visible",this.detectChange(!1)}):this.selectionContainerStyle.visibility="hidden",this.contentService.fireAnnotEvent({sdEventType:e?pe.FOCUSED:pe.UNFOCUSED,annot:this.data}))}get itemStyle(){let e=`${this.data.attributes.fontSize||this.autoFitFontSize}px`,t=this.data.attributes.fontColor,o=this.data.attributes.fontName;return{fontSize:e,color:t,fontFamily:o}}get containerStyles(){let e=`${this.data.attributes.fontSize}px`,t=this.data.attributes.fontColor;return{background:this.active?"#C4E5F6":"rgba(255, 255, 255, 0)",outline:this.active?"1px solid #4D90FE":"none",fontSize:e,fontColor:t}}getActiveItem(){return this.widget.selectedItems?.length>0?this.widget.opt[this.widget.selectedItems[0]]:null}getDisplayName(e){return e?typeof e=="string"?e:e[1]:""}getValue(e){return typeof e=="string"?e:e[0]}onItemClicked(e){this.widget.selectedItems=[e],this.widget.value=this.getValue(this.widget.opt[e]),this.containerEl.nativeElement.blur(),this.detectChange()}detectChange(e=!0){this.changeDetectorRef.destroyed||(!this.data.attributes.fontSize&&e&&this.fitFontSize(),this.changeDetectorRef.detectChanges())}fitFontSize(){if(this.getDisplayName(this.getActiveItem()).length===0)return;let o=!1,s=this.containerEl.nativeElement;for(;this.autoFitFontSize<300&&s.scrollHeight-1<=s.clientHeight&&s.scrollWidth-1<=s.clientWidth;)++this.autoFitFontSize,this.detectChange(!1);for(s.scrollHeight-1>s.clientHeight&&(o=!0);this.autoFitFontSize>10&&(s.scrollHeight-1>s.clientHeight||s.scrollWidth-1>s.clientWidth);)--this.autoFitFontSize,this.detectChange(!1);this.autoFitFontSize<10&&(this.autoFitFontSize=10),o&&(this.autoFitFontSize-=3),this.detectChange(!1)}determineSelectionPosition(){let e=this.selectionContainerEl?.nativeElement.offsetHeight,t=this.data.attributes.rect;!this.selectionContainerEl||t.bottom-e>=this.currentPage.bbox.y?(this.selectionContainerStyle.top="100%",this.selectionContainerStyle.bottom=null):(this.selectionContainerStyle.top=null,this.selectionContainerStyle.bottom="100%")}};E(n,"\u0275fac",function(t){return new(t||n)(m(re),m(Pt,1),m(de),m($),m(ut),m(R))}),E(n,"\u0275cmp",H({type:n,selectors:[["sd-form-combo-box"]],viewQuery:function(t,o){if(t&1&&(te(zu,7),te(ju,5)),t&2){let s;ie(s=ne())&&(o.containerEl=s.first),ie(s=ne())&&(o.selectionContainerEl=s.first)}},inputs:{data:"data"},standalone:!1,features:[j([R])],decls:6,vars:5,consts:[["container",""],["selectionContainer",""],["id","container","tabIndex","-1",3,"blur","focus","ngStyle"],[3,"ngStyle"],["aria-hidden","true","class","papycon papycon-chevron-down",4,"ngIf"],[3,"ngStyle",4,"ngIf"],["aria-hidden","true",1,"papycon","papycon-chevron-down"],["class","items",3,"mousedown",4,"ngFor","ngForOf"],[1,"items",3,"mousedown"]],template:function(t,o){if(t&1){let s=M();h(0,"div",2,0),I("blur",function(){return f(s),g(o.active=!1)})("focus",function(){return f(s),g(o.active=!0)}),h(2,"span",3),P(3),_(),y(4,$u,1,0,"i",4),_(),y(5,Xu,3,2,"section",5)}t&2&&(p("ngStyle",o.containerStyles),l(2),p("ngStyle",o.itemStyle),l(),L(o.getDisplayName(o.getActiveItem())),l(),p("ngIf",o.active),l(),p("ngIf",o.active))},dependencies:[De,Ce,_e],styles:["div#container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;align-items:center;justify-content:space-between;overflow:hidden}div[_ngcontent-%COMP%]{cursor:default}div.items[_ngcontent-%COMP%]{font-size:12px;overflow:hidden}i[_ngcontent-%COMP%]{font-size:10px;padding:0 5px 0 3px}section[_ngcontent-%COMP%]{position:absolute;width:100%;box-sizing:border-box;background:#fff;border:1px solid #000000}div.items[_ngcontent-%COMP%]:hover{background:#4d90fe;color:#fff}"]}));let r=n;return r})();var Ku=["container"],Qu=["items"];function Zu(r,n){if(r&1){let i=M();h(0,"div",4,1),I("mousedown",function(t){let o=f(i).index,s=d();return g(s.onItemClicked(t,o))}),P(2),_()}if(r&2){let i=n.$implicit,e=n.index,t=d();p("ngStyle",t.itemStyles(e)),l(2),L(t.getDisplayName(i))}}var cc=(()=>{let n=class n{elementRef;changeDetectorRef;data;containerEl;itemsEl;widget;_active=!1;longestNameLength=0;containerWidth=0;totalItemsCount=0;autoFontSize=64;constructor(e,t,o){this.elementRef=e,this.changeDetectorRef=o,this.widget=t}get active(){return this._active}set active(e){this.widget.isReadonly()||(this._active=e)}ngAfterViewInit(){this.widget.selectedItems.length>0&&(this.containerEl.nativeElement.scrollTop=this.itemsEl.toArray()[this.widget.selectedItems[0]].nativeElement.offsetTop)}get containerStyles(){return this.magnifyAutoFont(),this.containerWidth=this.containerEl.nativeElement.offsetWidth,{"overflow-y":this.active?"auto":"hidden",outline:this.active?"1px solid #4D90FE":"none"}}isFontSizeAuto(){return this.data.attributes.fontSize===0}magnifyAutoFont(){if(this.isFontSizeAuto()){if(this.containerWidth<this.containerEl.nativeElement.offsetWidth&&this.containerWidth!==0){let e=(this.containerEl.nativeElement.offsetWidth-this.containerWidth+this.containerWidth)/this.containerWidth;this.autoFontSize=this.autoFontSize*e}this.totalItemsCount!==this.widget.opt.length&&(this.totalItemsCount=this.widget.opt.length,this.autoFontSize=64)}}itemStyles(e){let t=`${this.data.attributes.fontSize===0?this.autoFontSize:this.data.attributes.fontSize}px`,o=this.data.attributes.fontColor,s=this.data.attributes.fontName;return this.isActiveItem(e)?{background:"#4D90FE",color:"#FFF",fontSize:t,fontFamily:s}:{background:null,color:o,fontSize:t,fontFamily:s}}getDisplayName(e){let t=typeof e=="string"?e:e[1];return this.longestNameLength=this.longestNameLength<t.length?t.length:this.longestNameLength,t}getValue(e){return typeof e=="string"?e:e[0]}onItemClicked(e,t){this.active&&(e.stopPropagation(),this.widget.selectedItems=[t],this.widget.value=this.getValue(this.widget.opt[t]))}detectChange(e=!0){this.changeDetectorRef.destroyed||(!this.data.attributes.fontSize&&e&&(this.changeDetectorRef.detectChanges(),this.autoFontSizeCheck()),this.changeDetectorRef.detectChanges())}autoFontSizeCheck(){this.isFontSizeAuto()&&this.itemsEl!==void 0&&this.itemsEl.forEach(e=>{if(e.nativeElement.offsetWidth<e.nativeElement.scrollWidth){if(this.autoFontSize>12)for(;e.nativeElement.offsetWidth<e.nativeElement.scrollWidth&&this.autoFontSize>12;)this.autoFontSize--,this.detectChange(!1);return}}),this.containerEl.nativeElement.offsetHeight<this.autoFontSize&&(this.autoFontSize=this.containerEl.nativeElement.offsetHeight)}isActiveItem(e){return this.widget.selectedItems.length===0?!1:this.widget.selectedItems[0]===e}};E(n,"\u0275fac",function(t){return new(t||n)(m(re),m(Pt,1),m($))}),E(n,"\u0275cmp",H({type:n,selectors:[["sd-form-list-box"]],viewQuery:function(t,o){if(t&1&&(te(Ku,7),te(Qu,5)),t&2){let s;ie(s=ne())&&(o.containerEl=s.first),ie(s=ne())&&(o.itemsEl=s)}},inputs:{data:"data"},standalone:!1,features:[j([R])],decls:3,vars:2,consts:[["container",""],["items",""],["id","container","tabIndex","-1",3,"blur","focus","ngStyle"],["class","items",3,"ngStyle","mousedown",4,"ngFor","ngForOf"],[1,"items",3,"mousedown","ngStyle"]],template:function(t,o){if(t&1){let s=M();h(0,"div",2,0),I("blur",function(){return f(s),g(o.active=!1)})("focus",function(){return f(s),g(o.active=!0)}),y(2,Zu,3,2,"div",3),_()}t&2&&(p("ngStyle",o.containerStyles),l(2),p("ngForOf",o.widget.opt))},dependencies:[De,_e],styles:["div#container[_ngcontent-%COMP%]{width:100%;height:100%;overflow-x:hidden;background:#fff0}.items[_ngcontent-%COMP%]{font-size:12px;white-space:nowrap}"]}));let r=n;return r})();function qu(r,n){if(r&1&&(h(0,"section"),x(1,"div",3),_()),r&2){let i=d();l(),p("ngStyle",i.styles)}}function Ju(r,n){if(r&1&&(J(),h(0,"g"),x(1,"rect",4)(2,"rect",5),h(3,"text",6),P(4),T(5,"translate"),_()()),r&2){let i=d();l(),B("width",i.widget.widgetStyle.width)("height",i.widget.widgetStyle.height),l(),B("width",i.getLanguage()==="en"?48:28)("transform",i.getLanguage()==="en"?"translate(-24,-7)":"translate(-14,-9)"),l(),B("letter-spacing",i.getLanguage()==="en"?"0.2ch":"0.5ch")("font-size",i.fontSize),l(),L(A(5,7,"SIGN"))}}var Hr=(()=>{let n=class n{elementRef;changeDetectorRef;contentService;documentService;renderer;pageService;acroFormService;annotService;subscriptionService;i18nService;signatureService;data;canEdit;fontSize=6;pdfDoc;timer;styles_={};widget;hasSignedSignature=!1;canvas;imageData=S.EMPTY_STRING;backgroundColor=[0,0,0,0];validityImgMap={F:"verify-fail.png",S:"valid.png",M:"invalid.png"};get tsaParam(){return this.signatureService.getTSAParam(this.data?.attributes??this.widget.acroField)}constructor(e,t,o,s,c,u,C,N,O,U,z,Me){this.elementRef=e,this.changeDetectorRef=t,this.contentService=o,this.documentService=s,this.renderer=c,this.pageService=u,this.acroFormService=N,this.annotService=O,this.subscriptionService=U,this.i18nService=z,this.signatureService=Me,this.widget=C,this.canvas=this.renderer.createElement("canvas")}ngOnInit(){this.initSubscription()}ngOnChanges(e){e.data&&this.updateAppearance()}getLanguage(){return this.i18nService.language}get canSign(){return!this.hasSignedSignature||this.documentService.checkAuthority(be.FILL_FORM)}renderDefaultAppearance(){return!this.data.attributes.appearance&&!this.canEdit&&!this.widget.isReadonly()&&!this.widget.value}onClick(e){if(this.widget.isReadonly()||!this.canSign||this.data.attributes.V||this.documentService.isDAP)return!0;e.preventDefault(),e.stopPropagation(),this.subscriptionService.set("openSignatureDrawDialog",this.signatureService.openSignatureDrawDialog(this.pdfDoc.streamdocsId,this.data).pipe(Hn(t=>{throw this.signatureService.toggleOverlay(!1),t})).subscribe({next:t=>{t&&(this.data.attributes.appearance=t.attributes.appearance,this.annotService.putModel(this.data,"modify"),this.contentService.fireAnnotEvent({sdEventType:pe.UPDATE,pageIdx:this.data.attributes.pageIdx,annot:this.data}))}}))}detectChange(e=!0){this.changeDetectorRef.destroyed||(e&&this.updateAppearance(),this.changeDetectorRef.detectChanges())}updateAppearance(){this.timer&&(this.timer.unsubscribe(),this.timer=null);let e=this.data.attributes.appearance;if(e){let t=this.canvas.getContext("2d");if(t===null)throw new Ni("Failed to get CanvasRenderingContext2D");t.imageSmoothingEnabled=!1,this.timer=fe.runAsync(()=>{let o=new Image;o.onload=()=>{if(!k.hasAppearance(this.data.attributes.appearance))return;t.canvas.width=o.naturalWidth,t.canvas.height=o.naturalHeight,t.drawImage(o,0,0);let s=t.getImageData(0,0,1,1).data;for(let c=0;c<4;++c)this.backgroundColor[c]=s[c];this.renderCanvas(),this.validateDocument(),this.timer?.unsubscribe(),this.timer=null},o.src=`data:image/${e.format};base64,${e.data}`})}else this.imageData=S.EMPTY_STRING}renderCanvas(){this.imageData=this.canvas.toDataURL("image/png"),this.detectChange(!1)}get styles(){return this.styles_.backgroundImage=`url(${this.imageData})`,this.styles_}initSubscription(){this.subscriptionService.push(this.documentService.openedDocument$.pipe(w(S.isDefined)).subscribe({next:e=>this.pdfDoc=e}),this.contentService.annotEvent$.pipe(w(e=>e?.annot.oid===this.data.oid)).subscribe({next:()=>this.detectChange()}),this.acroFormService.hasSignedSignature$.subscribe({next:e=>this.hasSignedSignature=e}))}validateDocument(){this.subscriptionService.push(this.signatureService.tsaVerifyCache$.pipe(w(()=>S.isDefined(this.signatureService.getTSAParam(this.data.attributes))&&this.data.attributes.V.Contents),Tt(e=>this.documentService.isDAP?this.documentService.pageDescriptions$.pipe(w(S.isDefined),Mt(1),_t(t=>{let o=t[this.pageService.originalPdfPages[this.data.attributes.pageIdx].ref];return e[o.refId]})):Tn(e[1])),w(e=>!!e)).subscribe({next:e=>{e.validity==="S"?this.setValidity(e):this.setValidity(e.validity),this.detectChange(!1)}}))}get baseBox(){return this.tsaParam?{width:this.tsaParam.baseBox.w,height:this.tsaParam.baseBox.h}:{width:this.canvas.width,height:this.canvas.height}}get baseBoxCanvasRatio(){return{x:this.canvas.width/this.baseBox.width,y:this.canvas.height/this.baseBox.height}}get blockArea(){return this.tsaParam?this.tsaParam.blockArea.map(e=>{let t=this.baseBoxCanvasRatio;return e.x*=t.x,e.y*=t.y,e.w*=t.x,e.h*=t.y,e}):[]}get txtBox(){if(!this.tsaParam){let o=this.baseBox;return{x:0,y:0,w:o.width,h:o.height}}let e=this.tsaParam.txtBox,t=this.baseBoxCanvasRatio;return e.x*=t.x,e.y*=t.y,e.w*=t.x,e.h*=t.y,e}get txtWithTimestrBox(){if(!this.tsaParam){let o=this.baseBox;return{x:0,y:0,w:o.width,h:o.height}}let e=this.tsaParam.txtWithTimestrBox,t=this.baseBoxCanvasRatio;return e.x*=t.x,e.y*=t.y,e.w*=t.x,e.h*=t.y,e}calcCenterFit(e,t){let o=t.width/t.height;if(e.w/e.h>o){let c={w:e.h*o,h:e.h};return ge({x:(e.w-c.w)/2+e.x,y:e.y},c)}else{let c={w:e.w,h:e.w/o};return ge({x:e.x,y:(e.h-c.h)/2+e.y},c)}}setValidity(e){if(!this.canvas||this.documentService.isDAP)return;let t,o,s=e;typeof s!="string"&&(t=s.text,o=s.fontName,s=s.validity);let c=new Image;c.onload=()=>{let u=this.canvas.getContext("2d");if(u===null)throw new Ni("Failed to get CanvasRenderingContext2D");let C=360-this.pageService.pdfPages[this.data.attributes.pageIdx].r,N=0,O=0;C>0&&((C===90||C===180)&&(O=this.canvas.height),(C===180||C===270)&&(N=this.canvas.width),u.save(),u.rotate(C*Math.PI/180),u.translate(-N,-O)),u.save(),this.blockArea.forEach(z=>{u.clearRect(z.x,z.y,z.w,z.h),u.fillStyle=`rgba(
          ${this.backgroundColor[0]},
          ${this.backgroundColor[1]},
          ${this.backgroundColor[2]},
          ${this.backgroundColor[3]}
        )`,u.fillRect(z.x,z.y,z.w,z.h)});let U;if(s==="S"?U=this.calcCenterFit(t&&o?this.txtWithTimestrBox:this.txtBox,{width:c.naturalWidth,height:c.naturalHeight}):U={x:0,y:0,w:this.canvas.width,h:this.canvas.height},u.drawImage(c,U.x,U.y,U.w,U.h),u.restore(),this.signatureService.shouldRenderTimeStamp&&t&&o){u.font=`${6*this.canvas.height/60}px ${o}`;let z=33*this.canvas.height/60;u.textAlign="center",t.split(`
`).forEach((Me,Bt)=>{u.fillText(Me,this.canvas.width/2,z+6*Bt*this.canvas.height/60)})}u.restore(),this.renderCanvas()},c.src=`assets/images/time-stamp/${this.validityImgMap[s]||this.validityImgMap.F}`}};E(n,"\u0275fac",function(t){return new(t||n)(m(re),m($),m(de),m(mt),m(xt),m(ut),m(Pt,1),m(gt),m(Ie),m(R),m(Co),m(nn))}),E(n,"\u0275cmp",H({type:n,selectors:[["sd-form-signature"]],inputs:{data:"data",canEdit:"canEdit"},standalone:!1,features:[j([R]),Te],decls:4,vars:2,consts:[[4,"ngIf"],[1,"focused-container"],["focusable","false",1,"absolute",3,"click"],[3,"ngStyle"],["fill","#f79f1a","fill-opacity","0.08","stroke","#f79f1a","stroke-width","1"],["fill","#1e1e1e","height","16","x","50%","y","50%"],["x","50%","y","50%","alignment-baseline","middle","text-anchor","middle","fill","#ffffff"]],template:function(t,o){t&1&&(y(0,qu,2,1,"section",0),h(1,"div",1),J(),h(2,"svg",2),I("click",function(c){return o.onClick(c)}),y(3,Ju,6,9,"g",0),_()()),t&2&&(p("ngIf",o.data.attributes.appearance),l(3),p("ngIf",o.renderDefaultAppearance()))},styles:["canvas[_ngcontent-%COMP%]{width:100%;height:100%;position:absolute;display:block}div[_ngcontent-%COMP%]{width:100%;height:100%;position:absolute;display:block;background-repeat:no-repeat;background-size:contain;background-position:center}text[_ngcontent-%COMP%]{font-size:12px;line-height:20px;font-family:NotoSans-Regular,sans-serif}"]}));let r=n;return r})();var eh=["txtArea"],th=["sizeCheckerArea"];function ih(r,n){if(r&1&&x(0,"div",5),r&2){let i=d();p("ngStyle",i.appearanceStyle)}}var ar=class{text;rect;constructor(n,i){this.text=n,this.rect=i}equals(n){return this.text===n.text&&this.rect.width===n.rect.width&&this.rect.height===n.rect.height}},sr=2,nh=12,oh=300,lc=(()=>{let n=class n{elementRef;changeDetectorRef;acroFormService;scriptService;contentService;subscriptionService;store$;txtAreaElementRef;sizeCheckerAreaElementRef;data;appearanceStyle={};calculatedFontSize=sr;widget;focused=!1;lastCalculationContext=new ar(void 0,{width:0,height:0});checkerFontSize=0;_annotStyle={};get sizeCheckerStyle(){if(!S.isDefined(this._annotStyle.height))throw new zi("Annotation style height is not defined");return Qe(ge({},this._annotStyle),{height:`${Number.parseInt(this._annotStyle.height)*.9}px`,"font-size":`${this.checkerFontSize}px`})}formControl=new Ze;get isEdited(){let e=this.acroFormService.lastFetchedAcroFields?.get(this.data.attributes.Parent),t=this.widget.acroField?.Ff,o=e?.Ff!==void 0&&si.isMultiLine(e.Ff),s=t!==void 0&&si.isMultiLine(t);return this.widget.isEdited()||this.focused||o!==s}lastFocusedValue;dragMode;constructor(e,t,o,s,c,u,C,N){this.elementRef=e,this.changeDetectorRef=t,this.acroFormService=o,this.scriptService=s,this.contentService=u,this.subscriptionService=C,this.store$=N,this.widget=c}ngOnInit(){this.formControl.setValue(this.widget.value,{emitEvent:!1}),this.updateAppearanceStyle(),this.subscriptionService.push(this.contentService.fieldEvent$.pipe(w(S.isDefined),w(e=>e.fieldTitle===this.widget.title),w(()=>this.data.attributes.fontSize===0)).subscribe({next:()=>this.sizeChecker(this.widget.value)}),this.store$.pipe(le("dragMode")).subscribe({next:e=>{this.dragMode=e,this.changeDetectorRef.markForCheck()}}),this.formControl.valueChanges.subscribe({next:e=>this.onChangeValue(e)}))}ngOnChanges(){this.updateAppearanceStyle(),this.detectChange()}ngAfterViewInit(){this.widget.canEdit||this.data.action!=="create"||this.txtAreaElementRef.nativeElement.focus()}get fontSize(){return this.isEdited||!this.imageUrl?this.data.attributes.fontSize||this.calculatedFontSize:0}get fontName(){return this.data.attributes.fontName}get imageUrl(){let{appearance:e}=this.data.attributes;return e===void 0?"":`url(data:image/${e.format};base64,${e.data})`}get annotStyle(){if(this._annotStyle.fontSize=`${this.fontSize}px`,this._annotStyle.fontFamily=this.fontName,this._annotStyle.fontFamily=JSON.stringify(this._annotStyle.fontFamily),this._annotStyle.textAlign=this.data.attributes.alignment,this._annotStyle.color=this.data.attributes.fontColor,this._annotStyle.width=`${this.widget.rectWidth-(this.data.attributes.width||0)*2}px`,this._annotStyle.height=`${this.widget.rectHeight-(this.data.attributes.width||0)*2}px`,this._annotStyle.lineHeight=this.isMultiLine?null:this._annotStyle.height,this.data.attributes.MK===void 0)return this._annotStyle;let e=this.data.attributes.MK.R;return(e===90||e===270)&&(this._annotStyle.width=`${this.widget.rectHeight-(this.data.attributes.width||0)*2}px`,this._annotStyle.height=`${this.widget.rectWidth-(this.data.attributes.width||0)*2}px`),this._annotStyle.whiteSpace=this.isMultiLine?"pre-wrap":"pre",this._annotStyle}get isMultiLine(){return si.isMultiLine(this.widget.flag)}get tabIndex(){return this.dragMode===Ae.SELECT_ANNOT||this.dragMode===Ae.AUTO?-1:null}onFocus(){this.focused=!0,this.lastFocusedValue=this.widget.value}onBlur(e){this.widget.value=e.target.value,this.focused=!1,this.lastFocusedValue!==this.widget.value&&this.scriptService.executeAll(this.acroFormService.acroFields,!1,qi.MERGE_WITH_PREVIOUS)}onChangeValue(e){let t=e,o=t;this.isMultiLine||(o=t.replace(/\n/g,S.EMPTY_STRING),t!==o&&(this.formControl.setValue(o,{emitEvent:!1}),t=o)),o!==t&&(this.formControl.setValue(o),t=o),this.widget.value=t,this.detectChange(),this.contentService.fireFieldEvent({sdEventType:pe.UPDATE,fieldTitle:this.widget.title})}sizeChecker(e){if(this.fontSize===null||this.data.attributes.fontSize)return;let t=this.isMultiLine?nh:oh,o=this.txtAreaElementRef.nativeElement;if(!o.value){this.calculatedFontSize=Math.max(Math.min(o.scrollHeight*.8,t),sr),this.detectChange(!1);return}if(this.isMultiLine){let O=this.sizeCheckerAreaElementRef?.nativeElement;if(!O)return;for(this.checkerFontSize=t,O.value=O.value,this.detectChange(!1);this.checkerFontSize>sr&&O.scrollHeight-1>O.clientHeight;)--this.checkerFontSize,O.value=O.value,this.detectChange(!1);this.calculatedFontSize=this.checkerFontSize,this.detectChange(!1);return}let s=new ar(e,{width:this.widget.rectWidth,height:this.widget.rectHeight});if(this.calculatedFontSize===0||this.lastCalculationContext.equals(s))return;this.lastCalculationContext=s;let{fontFamily:c}=window.getComputedStyle(o),u={width:this.calculateTextWidth(c,this.calculatedFontSize,e),height:this.calculateTextHeight(c,this.calculatedFontSize,e)},C=o.clientWidth/u.width,N=o.clientHeight/u.height;this.calculatedFontSize=Math.max(Math.min(this.calculatedFontSize*Math.min(C,N)*.9,t),sr),this.detectChange(!1)}pvOnVertexMove(e,t,o){this.detectChange()}detectChange(e=!0){this.changeDetectorRef.destroyed||(!this.data.attributes.fontSize&&e&&this.sizeChecker(this.txtAreaElementRef.nativeElement.value),this.formControl.setValue(this.widget.value,{emitEvent:!1}),this.changeDetectorRef.detectChanges())}updateAppearanceStyle(){let e=k.fieldRotateStyleOf(this.data);if(e){let t=this.data.attributes.MK;this.appearanceStyle.width=e.height,this.appearanceStyle.height=e.width,t&&(this.appearanceStyle.transform=`rotate(${t.R}deg)`),S.isDefined(e.left)&&(this.appearanceStyle.left=`${-parseInt(e.left,10)}px`),this.appearanceStyle.top=e.bottom}this.appearanceStyle.backgroundImage=this.imageUrl}calculateTextWidth(e,t,o){let s=document.createElement("canvas").getContext("2d");if(s===null)throw new Ni("Failed to get CanvasRenderingContext2D");return s.font=`${t}px ${e}`,s.measureText(o).width}calculateTextHeight(e,t,o){let s=document.createElement("span");s.style.fontFamily=e,s.style.fontSize=`${t}px`,s.innerHTML=o;let c=document.createElement("div");c.style.display="inline-block",c.style.width="1px",c.style.height="0px",c.style.verticalAlign="bottom";let u=document.createElement("div");u.appendChild(s),u.appendChild(c),u.style.height="0px",u.style.overflow="hidden",document.body.appendChild(u);let C=this.getElementOffset(s),O=this.getElementOffset(c).top-C.top;return document.body.removeChild(u),Math.min(O,t)}getElementOffset(e){let t=e,o=0,s=0;if(t.offsetParent)do s+=t.offsetLeft,o+=t.offsetTop,t=t.offsetParent;while(t);else s+=t.offsetLeft,o+=t.offsetTop;return{top:o,left:s}}};E(n,"\u0275fac",function(t){return new(t||n)(m(re),m($),m(gt),m(qt),m(Pt,1),m(de),m(R),m(me))}),E(n,"\u0275cmp",H({type:n,selectors:[["sd-form-text"]],viewQuery:function(t,o){if(t&1&&(te(eh,7),te(th,7)),t&2){let s;ie(s=ne())&&(o.txtAreaElementRef=s.first),ie(s=ne())&&(o.sizeCheckerAreaElementRef=s.first)}},inputs:{data:"data"},standalone:!1,features:[j([R]),Te],decls:6,vars:7,consts:[["txtArea",""],["sizeCheckerArea",""],[3,"blur","focus","formControl","ngStyle","readonly"],[1,"hidden",3,"ngStyle","value"],["class","appearance",3,"ngStyle",4,"ngIf"],[1,"appearance",3,"ngStyle"]],template:function(t,o){if(t&1){let s=M();h(0,"textarea",2,0),I("blur",function(u){return f(s),g(o.onBlur(u))})("focus",function(){return f(s),g(o.onFocus())}),P(2,"  "),_(),x(3,"textarea",3,1),y(5,ih,1,1,"div",4)}t&2&&(p("formControl",o.formControl)("ngStyle",o.annotStyle)("readonly",o.widget.isReadonly()),B("tabIndex",o.tabIndex),l(3),p("ngStyle",o.sizeCheckerStyle)("value",o.widget.value),l(2),p("ngIf",!o.isEdited))},dependencies:[Ce,_e,_i,lt,Pi],styles:["[_nghost-%COMP%]{display:flex;width:100%;height:100%;justify-content:center;align-items:center}textarea[_ngcontent-%COMP%]{width:100%;height:100%;display:block;margin:0;padding:0;box-sizing:border-box;resize:none;overflow:hidden;border:none;background:#fff0;background-size:100% 100%}.hidden[_ngcontent-%COMP%]{visibility:hidden;position:absolute;left:0;top:0;pointer-events:none;height:90%}.appearance[_ngcontent-%COMP%]{left:0;top:0;width:100%;height:100%;background-size:100%;position:absolute;pointer-events:none}"]}));let r=n;return r})();var rh=(r,n,i,e)=>({shape:r,stroke:n,strokeDasharray:i,fill:e,location:"start"}),sh=(r,n,i,e)=>({shape:r,stroke:n,strokeDasharray:i,fill:e,location:"end"});function ah(r,n){if(r&1&&(J(),h(0,"marker",6),x(1,"path",7),_()),r&2){let i=d();B("id",i.markerID.sp.def)("refX",i.environment.annotation.refX)("refY",i.environment.annotation.refY),l(),p("markerStyle",Wi(4,rh,i.data.attributes.LE[0],i.lineStroke,i.markerDashArray,i.data.attributes.InteriorColor))}}function ch(r,n){if(r&1&&(J(),h(0,"marker",8),x(1,"path",7),_()),r&2){let i=d();B("id",i.markerID.ep.def),l(),p("markerStyle",Wi(2,sh,i.data.attributes.LE[1],i.lineStroke,i.markerDashArray,i.data.attributes.InteriorColor))}}function lh(r,n){if(r&1&&(J(),x(0,"path")),r&2){let i=d();B("id","lp-"+i.data.oid)("d",i.textPath)}}function ph(r,n){if(r&1&&(J(),x(0,"line")),r&2){let i=n.$implicit,e=d();B("stroke",e.lineStroke)("stroke-width",e.lineWidth)("stroke-dasharray",e.dashArray)("x1",i.x1)("y1",i.y1)("x2",i.x2)("y2",i.y2)}}function dh(r,n){if(r&1&&(J(),h(0,"text",9)(1,"textPath",10),P(2),_()()),r&2){let i=d();B("dy",i.annotLine.attributes.width*-6),l(),B("href",i.localhost+"#lp-"+i.data.oid,null,"xlink"),l(),L(i.measurement)}}var Bn=(()=>{let n=class n{elementRef;contentService;editService;changeDetectorRef;subscriptionService;annotLine;status=X.RENDER;lineAttrs={};dashArray=null;markerDashArray=null;measureLineCoords=[];measureLineAttrs;measurement;viewClasses={absolute:!0,create:!1,remove:!1};get localhost(){return location.href}get lineStroke(){return this.annotLine.attributes.color}get lineWidth(){return this.annotLine.attributes.width}get environment(){return Ne}get data(){return this.annotLine}get isLineDimension(){return b.isLineDimension(this.data)}get screenCoord(){let e=this.annotLine.attributes.coordinates;if(!this.isLineDimension)return e;let t=this.getLineUnitVector(e),o=this.getNumberAttribute("LL"),s={x:-t.y*o,y:t.x*o};return{sp:{x:e.sp.x+s.x,y:e.sp.y+s.y},ep:{x:e.ep.x+s.x,y:e.ep.y+s.y}}}get textPath(){if(!this.lineAttrs||this.lineAttrs.x1===null||this.lineAttrs.y1===null||this.lineAttrs.x2===null||this.lineAttrs.y2===null)return null;let e={x:this.lineAttrs.x2-this.lineAttrs.x1,y:this.lineAttrs.y2-this.lineAttrs.y1},t=Math.sqrt(Math.pow(this.lineAttrs.x2-this.lineAttrs.x1,2)+Math.pow(this.lineAttrs.y2-this.lineAttrs.y1,2));return t===0?null:(e.x=e.x/t*100,e.y=e.y/t*100,`M ${Number(this.lineAttrs.x1)-Number(e.x)} ${Number(this.lineAttrs.y1)-Number(e.y)} L ${Number(this.lineAttrs.x2)+Number(e.x)} ${Number(this.lineAttrs.y2)+Number(e.y)}`)}markerID={};constructor(e,t,o,s,c){this.elementRef=e,this.contentService=t,this.editService=o,this.changeDetectorRef=s,this.subscriptionService=c}isExistLineMarker(e){return k.isExistLineMarker(e,this.data)}getNumberAttribute(e){return this.data?.attributes&&S.isDefined(this.data.attributes[e])?this.data.attributes[e]:0}ngOnInit(){this.calcDistance(),this.subscriptionService.push(this.contentService.annotEvent$.pipe(w(e=>e===null||e.from==="AnnotationViewComponent"?!1:e.annot.oid===this.data.oid)).subscribe({next:()=>{this.fitBox(),this.calcDistance(),this.detectChange()}}))}ngOnChanges(){this.render(),this.markerID.sp=k.createMarkerID(!0,this.data),this.markerID.ep=k.createMarkerID(!1,this.data)}pvOnMove(e){let{rect:t,coordinates:{ep:o}}=this.annotLine.attributes;o.x=e.offsetX,o.y=t.top-t.bottom-e.offsetY,this.calcDistance(),this.detectChange()}postCreate(e){this.annotLine.attributes.coordinates.sp.y+=e.bbox.y,this.annotLine.attributes.coordinates.ep.y+=e.bbox.y,this.fitBox()}verticesOf(e,t,o){let s=this.annotLine.attributes.coordinates,c=this.isLineDimension?[this.screenCoord.sp,this.screenCoord.ep,s.sp,s.ep]:[s.sp,s.ep];return this.editService.createPathVertices(e,o,...c)}postEdit(e,t){let o=this.data.attributes,s=o.coordinates;k.applyVertexDelta(t,s.sp,s.ep),this.isLineDimension&&(o.LL=Number(o.LL.toFixed(0))),this.fitBox(),this.detectChange()}pvOnVertexMove(e,t,o){if(!this.isLineDimension){let s=this.data.attributes.coordinates[n.indexProperties[t]];k.applyVertexDelta(o,s),this.calcDistance(),this.detectChange();return}if(t>=2){let s=this.data.attributes.coordinates[n.indexProperties[t-2]];k.applyVertexDelta(o,s),this.calcDistance()}else this.resizeMeasureLength(o);this.detectChange()}isTouched(e){let t=this.annotLine.attributes.coordinates,o=8+this.data.attributes.width*Ne.hitTestToleranceConst;return this.isLineDimension?this.isMeasureLineTouched(e):!!this.isContained(t,e,o)}isMeasureLineTouched(e){let t=this.annotLine.attributes.coordinates,o=[...this.measureLineCoords,{sp:[this.measureLineCoords[1].sp,this.measureLineCoords[1].ep].find(c=>!this.compareTPoint(t.ep,c,!0))??this.measureLineCoords[1].sp,ep:[this.measureLineCoords[0].sp,this.measureLineCoords[0].ep].find(c=>!this.compareTPoint(t.sp,c,!0))??this.measureLineCoords[0].ep}],s=8+this.data.attributes.width*Ne.hitTestToleranceConst;for(let c of o)if(this.isContained(c,e,s))return!0;return!1}isContained(e,t,o){let s=new st(e.ep.x-e.sp.x,e.ep.y-e.sp.y),c=new st(t.x-e.sp.x,t.y-e.sp.y);return Di.innerProduct(s,c)>0&&Di.innerProduct(s,c)<s.norm()*s.norm()&&c.orthogonalTo(s).norm()<o}fitBox(e){this.calcMeasureLine(),k.fitBox(e||this.data.attributes.rect,this.annotLine.attributes.width+2,...[this.screenCoord,...this.measureLineCoords].reduce((t,o)=>(t.push(o.sp,o.ep),t),[...Ot.rotationCoord(this.screenCoord,this.data)]))}render(){if(!this.annotLine)return;this.viewClasses.create=this.status===X.CREATE,this.viewClasses.remove=X.REMOVE===this.status;let e=this.screenCoord,{rect:t,borderStyle:o,width:s}=this.annotLine.attributes;this.lineAttrs.x1=Number(k.transformX(e.sp.x,t).toFixed(1)),this.lineAttrs.y1=Number(k.transformY(e.sp.y,t).toFixed(1)),this.lineAttrs.x2=Number(k.transformX(e.ep.x,t).toFixed(1)),this.lineAttrs.y2=Number(k.transformY(e.ep.y,t).toFixed(1)),this.dashArray=o?.style==="dashed"?o.dashPattern.map(c=>c.toString()).reduce((c,u)=>(c&&`${c}, `)+u,S.EMPTY_STRING):null,this.markerDashArray=o?.style==="dashed"?o.dashPattern.map(c=>(c/s).toFixed(2)).reduce((c,u)=>(c&&`${c}, `)+u,S.EMPTY_STRING):null,this.calcMeasureLine(),this.renderLineDimension()}getLineUnitVector(e){let t=e.ep.x-e.sp.x,o=e.ep.y-e.sp.y,s=Math.sqrt(t*t+o*o);return s===0?{x:0,y:0}:{x:t/s,y:o/s}}calcMeasureLine(){if(!this.isLineDimension)return;let e=this.screenCoord,{LL:t,LLE:o}=this.annotLine.attributes,s=Math.abs(t<0?o:t),c=Math.abs(t<0?t:o),u=this.getLineUnitVector(e);this.measureLineCoords=[{sp:{x:-u.y*c+e.sp.x,y:u.x*c+e.sp.y},ep:{x:u.y*s+e.sp.x,y:-u.x*s+e.sp.y}},{sp:{x:-u.y*c+e.ep.x,y:u.x*c+e.ep.y},ep:{x:u.y*s+e.ep.x,y:-u.x*s+e.ep.y}}]}renderLineDimension(){if(!this.isLineDimension)return;let e=this.data.attributes.rect;this.measureLineAttrs=[{x1:Number(k.transformX(this.measureLineCoords[0].sp.x,e).toFixed(1)),y1:Number(k.transformY(this.measureLineCoords[0].sp.y,e).toFixed(1)),x2:Number(k.transformX(this.measureLineCoords[0].ep.x,e).toFixed(1)),y2:Number(k.transformY(this.measureLineCoords[0].ep.y,e).toFixed(1))},{x1:Number(k.transformX(this.measureLineCoords[1].sp.x,e).toFixed(1)),y1:Number(k.transformY(this.measureLineCoords[1].sp.y,e).toFixed(1)),x2:Number(k.transformX(this.measureLineCoords[1].ep.x,e).toFixed(1)),y2:Number(k.transformY(this.measureLineCoords[1].ep.y,e).toFixed(1))}]}detectChange(){this.changeDetectorRef.destroyed||(this.render(),this.changeDetectorRef.markForCheck())}resizeMeasureLength(e){let t=this.annotLine.attributes.coordinates,o={x:t.ep.x-t.sp.x,y:t.ep.y-t.sp.y},s=o.y*e.x+o.x*e.y,c=Math.sqrt(e.x*e.x+e.y*e.y),u=Math.sqrt(o.y*o.y+o.x*o.x),C=c*u;if(C!==0){let N=s/C,O=c*N;this.annotLine.attributes.LL-=O}}calcDistance(){b.isLineDimension(this.data)&&(this.measurement=Rs.calcMeasurement(this.data),this.contentService.fireMeasureIndicatorEvent({action:"edit"}))}compareTPoint(e,t,o=!1){if(o){let s=c=>Math.round(c*1e3)/1e3;return s(e.x)===s(t.x)&&s(e.y)===s(t.y)}return e.x===t.x&&e.y===t.y}};E(n,"indexProperties",["sp","ep"]),E(n,"\u0275fac",function(t){return new(t||n)(m(re),m(de),m(ht),m($),m(R))}),E(n,"\u0275cmp",H({type:n,selectors:[["sd-line"]],inputs:{annotLine:"annotLine",status:"status"},standalone:!1,features:[j([R]),Te],decls:8,vars:15,consts:[[3,"ngClass"],["markerWidth","20","markerHeight","10","orient","auto",4,"ngIf"],["markerWidth","20","markerHeight","10","refX","10","refY","5","orient","auto",4,"ngIf"],[4,"ngIf"],[4,"ngFor","ngForOf"],["font-family","Verdana","text-anchor","middle",4,"ngIf"],["markerWidth","20","markerHeight","10","orient","auto"],["sdMarkerPath","",3,"markerStyle"],["markerWidth","20","markerHeight","10","refX","10","refY","5","orient","auto"],["font-family","Verdana","text-anchor","middle"],["startOffset","50%"]],template:function(t,o){t&1&&(J(),h(0,"svg",0)(1,"defs"),y(2,ah,2,9,"marker",1)(3,ch,2,7,"marker",2)(4,lh,1,2,"path",3),_(),x(5,"line"),y(6,ph,1,7,"line",4)(7,dh,3,3,"text",5),_()),t&2&&(p("ngClass",o.viewClasses),l(2),p("ngIf",o.isExistLineMarker(0)),l(),p("ngIf",o.isExistLineMarker(1)),l(),p("ngIf",o.isLineDimension),l(),B("stroke",o.lineStroke)("stroke-width",o.lineWidth)("stroke-dasharray",o.dashArray)("x1",o.lineAttrs==null?null:o.lineAttrs.x1)("y1",o.lineAttrs==null?null:o.lineAttrs.y1)("x2",o.lineAttrs==null?null:o.lineAttrs.x2)("y2",o.lineAttrs==null?null:o.lineAttrs.y2)("marker-start",o.isExistLineMarker(0)?o.markerID.sp.ref:void 0)("marker-end",o.isExistLineMarker(1)?o.markerID.ep.ref:void 0),l(),p("ngForOf",o.measureLineAttrs),l(),p("ngIf",o.isLineDimension))},encapsulation:2,changeDetection:0}));let r=n;return r})();var zr=(()=>{let n=class n{elementRef;mWidth=20;mHeight=10;path;markerStyle;constructor(e){this.elementRef=e,this.path=this.elementRef.nativeElement}ngOnChanges(){let e=Ot;this.path.setAttribute("stroke",this.markerStyle.stroke),this.path.setAttribute("stroke-width","1"),this.path.setAttribute("stroke-dasharray",this.markerStyle.strokeDasharray),e.isClosedCapType(this.markerStyle.shape)?this.path.setAttribute("fill",this.markerStyle.fill||"none"):this.path.setAttribute("fill","none");let t=`get${this.markerStyle.shape}`;e[t]&&this.path.setAttribute("d",e[t](this.mWidth,this.mHeight,this.markerStyle.location))}};E(n,"\u0275fac",function(t){return new(t||n)(m(re))}),E(n,"\u0275dir",Bi({type:n,selectors:[["","sdMarkerPath",""]],inputs:{markerStyle:"markerStyle"},standalone:!1,features:[Te]}));let r=n;return r})();function uh(r,n){if(r&1&&(J(),x(0,"rect",4)),r&2){let i=d();B("fill","none")("height",i.rectHeight-(i.width-1))("stroke-dasharray",i.dashArray)("stroke-width",i.width)("stroke",i.color)("width",i.rectWidth-(i.width-1))("x",i.rectX+(i.width-1)/2)("y",i.rectY+(i.width-1)/2)}}function hh(r,n){if(r&1&&(J(),x(0,"rect",5)),r&2){let i=d();B("fill",i.canEdit?"none":i.primary50)("height",i.rectHeight)("stroke-dasharray",i.canEdit?null:8)("stroke",i.canEdit?"#000000":i.primary50)("width",i.rectWidth)("x",i.rectX)("y",i.rectY)}}function mh(r,n){if(r&1&&(J(),x(0,"path",6)),r&2){let i=d();B("d",i.editRectD)}}var cr=(()=>{let n=class n{annotService;contentService;editService;changeDetectorRef;subscriptionService;store$;translatePipe;elementRef;viewerService;data;status=X.RENDER;dragMode;renderer;transformStyle={};editRectD=S.EMPTY_STRING;linkActMode=!0;srcRect;get canEdit(){return this.dragMode===Ae.SELECT_ANNOT}get isCreating(){return this.status===X.CREATE}get primary50(){return this.viewerService.customColor.main}constructor(e,t,o,s,c,u,C,N,O){this.annotService=e,this.contentService=t,this.editService=o,this.changeDetectorRef=s,this.subscriptionService=c,this.store$=u,this.translatePipe=C,this.elementRef=N,this.viewerService=O}ngOnInit(){this.subscriptionService.push(this.store$.pipe(le("dragMode")).subscribe({next:e=>{this.dragMode=e,this.changeDetectorRef.detectChanges()}}),this.contentService.annotEvent$.pipe(w(e=>e===null||e.from==="AnnotationViewComponent"?!1:e.annot.oid===this.data.oid)).subscribe({next:()=>{this.srcRect=S.deepClone(this.data.attributes.rect),this.makeContents(),this.changeDetectorRef.markForCheck()}}),this.store$.pipe(Be("linkActMode")).subscribe({next:e=>{this.linkActMode=e}}))}ngOnDestroy(){S.removeElement(this.elementRef.nativeElement),fe.destroy(this)}ngOnChanges(){this.srcRect=S.deepClone(this.data.attributes.rect),this.createRenderer(),this.renderEditRect(),this.makeContents()}renderEditRect(){if(!this.data.attributes.quadPoints)return;let e=this.data.attributes.rect;this.editRectD=this.data.attributes.quadPoints.reduce((t,o)=>{let s={x:o[0].x,y:o[0].y},c={x:o[0].x,y:o[0].y};return o.forEach(u=>{s.x=Math.min(u.x,s.x),s.y=Math.min(u.y,s.y),c.x=Math.max(u.x,c.x),c.y=Math.max(u.y,c.y)}),s.x=s.x-e.left,c.x=c.x-e.left,s.y=e.top-s.y,c.y=e.top-c.y,`${t}M ${s.x} ${s.y} L ${c.x} ${s.y} L ${c.x} ${c.y} L ${s.x} ${c.y} L ${s.x} ${s.y}`},"")}get rectX(){let{rect:e}=this.data.attributes;return this.status!==X.CREATE?0:Math.min(e.left,e.right)}get rectY(){let{rect:e}=this.data.attributes;return this.status!==X.CREATE?0:Math.min(e.top,e.bottom)}get rectWidth(){let{rect:e}=this.data.attributes;return Math.abs(e.right-e.left)}get rectHeight(){let{rect:e}=this.data.attributes;return Math.abs(e.top-e.bottom)}get color(){return this.data.attributes.color}get width(){return this.data.attributes.width??0}get dashArray(){let e=this.data.attributes.borderStyle;return e?.style==="dashed"?e.dashPattern.join(" "):"none"}onClick(e){if(!(this.canEdit||!this.linkActMode)){if(e.preventDefault(),e.stopPropagation(),this.data.attributes.type==="GoTo"){let t=Number(this.data.attributes.dest);if(Number.isNaN(t)||t<0)return;this.contentService.requestViewChange({pageNo:t+1})}else if(this.data.attributes.type==="URI"){let t=this.data.attributes.dest;t.startsWith("javascript:")?window.open(t,"_self"):(t.indexOf("://")<0&&(t=`http://${t}`),window.open(t,"_blank"))}}}pvOnMove(e){this.renderer.pvOnMove(e),this.changeDetectorRef.markForCheck()}postCreate(e){this.renderer.postCreate(e),this.validate()}verticesOf(e,t,o){return this.editService.createRectVertices(t,o)}pvOnVertexMove(e,t,o){if(this.renderer.status=X.EDIT,!this.editService.resizeByRectVertex(this.data,t,o))return;let s=this.data.attributes.rect;this.transformStyle.transform=`translate(${Math.min(s.left,s.right)-this.srcRect.left}px, ${this.srcRect.top-Math.max(s.top,s.bottom)}px)`,this.changeDetectorRef.markForCheck()}postEdit(e,t){this.validate(),this.renderEditRect(),this.transformStyle.transform=S.EMPTY_STRING,this.ngOnChanges(),this.changeDetectorRef.markForCheck()}makeContents(){this.data.attributes.type==="GoTo"?this.data.attributes.contents=this.translatePipe.transform("GO_TO_PAGE").replace("%s",`${parseInt(this.data.attributes.dest,10)+1}`):this.data.attributes.type==="URI"&&(this.data.attributes.contents=this.translatePipe.transform("GO_TO_SITE").replace("%s",`${this.data.attributes.dest}`))}validate(){k.validateRect(this.data.attributes.rect)}createRenderer(){this.renderer=Dt.create(this.data,this.status,this.annotService)}};E(n,"\u0275fac",function(t){return new(t||n)(m(Ie),m(de),m(ht),m($),m(R),m(me),m(ee),m(re),m(on))}),E(n,"\u0275cmp",H({type:n,selectors:[["sd-link"]],inputs:{data:"data",status:"status"},standalone:!1,features:[j([R]),Te],decls:4,vars:4,consts:[["id","background",1,"absolute",3,"click","ngStyle"],["stroke-alignment","inside",4,"ngIf"],["fill-opacity","0.08",4,"ngIf"],["fill","none","stroke","#000000",4,"ngIf"],["stroke-alignment","inside"],["fill-opacity","0.08"],["fill","none","stroke","#000000"]],template:function(t,o){t&1&&(J(),h(0,"svg",0),I("click",function(c){return o.onClick(c)}),y(1,uh,1,8,"rect",1)(2,hh,1,7,"rect",2)(3,mh,1,1,"path",3),_()),t&2&&(p("ngStyle",o.transformStyle),l(),p("ngIf",!o.isCreating),l(),p("ngIf",o.isCreating||o.canEdit&&!o.data.attributes.quadPoints),l(),p("ngIf",o.canEdit&&o.data.attributes.quadPoints))},dependencies:[Ce,_e],encapsulation:2,changeDetection:0}));let r=n;return r})();var _h=(r,n,i,e)=>({shape:r,stroke:n,strokeDasharray:i,fill:e,location:"start"}),fh=(r,n,i,e)=>({shape:r,stroke:n,strokeDasharray:i,fill:e,location:"end"});function gh(r,n){if(r&1&&(J(),h(0,"marker",4),x(1,"path",5),_()),r&2){let i=d(2);B("id",i.markerID.sp.def),l(),p("markerStyle",Wi(2,_h,i.polylineData.attributes.LE[0],i.pathStroke,i.markerDashArray,i.isCallout()?i.data.attributes.color:i.data.attributes.InteriorColor))}}function Ch(r,n){if(r&1&&(J(),h(0,"marker",4),x(1,"path",5),_()),r&2){let i=d(2);B("id",i.markerID.ep.def),l(),p("markerStyle",Wi(2,fh,i.polylineData.attributes.LE[1],i.pathStroke,i.markerDashArray,i.isCallout()?i.data.attributes.color:i.data.attributes.InteriorColor))}}function Th(r,n){if(r&1&&(J(),h(0,"defs"),y(1,gh,2,7,"marker",3)(2,Ch,2,7,"marker",3),_()),r&2){let i=d();l(),p("ngIf",i.isExistLineMarker(0)),l(),p("ngIf",i.isExistLineMarker(1))}}function Ah(r,n){if(r&1&&(J(),x(0,"path")),r&2){let i=d();B("stroke",i.pathStroke)("stroke-width",i.pathStrokeWidth)("stroke-dasharray",i.pathStrokeDashArray)("d",i.isCloudType()?i.cloudPointsNote:i.linePath)}}var gn=(()=>{let n=class n{elementRef;annotService;contentService;shapeService;changeDetectorRef;subscriptionService;data;status=X.RENDER;fillColor;pathStroke;pathStrokeWidth;pathStrokeDashArray;markerDashArray;viewClasses={};linePointsNote;linePath;cloudPointsNote;markerID={};get polylineData(){return this.data}get interiorColor(){return this.data.attributes.InteriorColor}get isMarkerType(){return this.isPolyLine()||this.isCallout()}lineRenderer;cloudRenderer;vertexEditor;constructor(e,t,o,s,c,u){this.elementRef=e,this.annotService=t,this.contentService=o,this.shapeService=s,this.changeDetectorRef=c,this.subscriptionService=u}ngOnInit(){this.subscriptionService.push(this.contentService.annotEvent$.pipe(w(e=>e?.annot.oid===this.data.oid),w(e=>e.from!=="AnnotationViewComponent")).subscribe({next:()=>{this.isCallout()||this.fitBox(),this.fireMeasureIndicatorEvent(),this.detectChange()}}))}ngOnDestroy(){fe.destroy(this)}ngOnChanges(e){e.status&&this.annotService.bindCursorClass(this.viewClasses,this.status),e.data&&(this.checkFinalVertex(),this.lineRenderer=this.shapeService.createRenderer(this),this.cloudRenderer=this.shapeService.createCloudRenderer(this),this.vertexEditor=this.shapeService.createVertexEditor(this),this.render()),this.markerID.sp=this.isMarkerType?k.createMarkerID(!0,this.data):{},this.markerID.ep=this.isMarkerType?k.createMarkerID(!1,this.data):{}}isCloudType(){return b.isPolygonCloud(this.data)}isPolyLine(){return b.isPolyLine(this.data)}isCallout(){return b.isFreeTextCallout(this.data)}isExistLineMarker(e){return k.isExistLineMarker(e,this.data)}pvOnRepress(e){this.pvOnMove(e);let t=this.data.attributes.vertices;if(t.length>1){let[o,s]=t.slice(t.length-2);if(o.x===s.x&&o.y===s.y)return}t.push({x:void 0,y:void 0}),this.pvOnMove(e)}pvOnMove(e){this.vertexEditor.pvOnMove(e),this.detectChange()}pvOnOver(){this.lineRenderer.finalizeLine(),this.detectChange()}postCreate(e){this.lineRenderer.postCreate();let t=this.data.attributes.vertices;t.forEach(o=>o.y=e.bbox.h+e.bbox.y-o.y),k.fitBox(this.data.attributes.rect,this.data.attributes.width+(this.isCloudType()?Sr:0),...t),this.fireMeasureIndicatorEvent(),this.detectChange()}verticesOf(e,t,o){return this.vertexEditor.verticesOf(e,t,o)}postEdit(e,t){k.applyVertexDelta(t,...this.data.attributes.vertices),this.fitBox(),this.detectChange()}pvOnVertexMove(e,t,o){this.vertexEditor.pvOnVertexMove(e,t,o),this.detectChange()}detectChange(){this.changeDetectorRef.destroyed||(this.render(),this.changeDetectorRef.markForCheck())}fireMeasureIndicatorEvent(){!b.isPolyLineDimension(this.data)&&!b.isPolygonDimension(this.data)||this.contentService.fireMeasureIndicatorEvent({action:"edit"})}isTouched(e){let t=this.isLineTouched(e);return this.fillColor!=="none"&&!t&&(t=this.isAreaTouched(e)),t}isLineTouched(e){let t=this.data.attributes.vertices,o=t[0],s=o;for(let c of t){s=c;let u=new st(s.x-o.x,s.y-o.y),C=new st(e.x-o.x,e.y-o.y),N=Di.innerProduct(u,C),O=u.norm()*u.norm(),U=C.orthogonalTo(u).norm(),z=8+this.data.attributes.width*Ne.hitTestToleranceConst;if(0<N&&N<O&&U<z)return!0;o=c}return!1}isAreaTouched(e){let t=this.data.attributes.vertices,o=0,s=t[0],c=s;for(let u of t)c=u,s!==c&&(s.y<=e.y?c.y>e.y&&this.isLeft(s,c,e)>0&&++o:c.y<=e.y&&this.isLeft(s,c,e)<0&&--o),s=u;return o!==0}isLeft(e,t,o){return(t.x-e.x)*(o.y-e.y)-(o.x-e.x)*(t.y-e.y)}fitBox(e){let t=e||this.data.attributes.rect,o=this.data.attributes.vertices,s=b.isPolyLine(this.data)?Ot.calcLinecapCoord(o,this.data):o;k.fitBox(t,this.data.attributes.width+(this.isCloudType()?Sr:0),...s)}checkFinalVertex(){if(this.data.type!=="Polygon"||!this.data||!this.data.attributes)return;let e=this.data.attributes.vertices;if(!e||e.length<1)return;let t=e.length-1;(e[0].x!==e[t].x||e[0].y!==e[t].y)&&e.push(S.deepClone(e[0]))}render(){this.pathStroke=this.isCallout()?this.data.attributes.contentsRichtext.borderColor:this.data.attributes.color,this.pathStrokeWidth=this.data.attributes.width,this.fillColor=this.lineRenderer.interiorColor,this.linePointsNote=this.lineRenderer.render(),this.cloudPointsNote=this.cloudRenderer?.render();let{rect:e,borderStyle:t,width:o}=this.data.attributes,s=this.status===X.CREATE?this.data.attributes.vertices:this.data.attributes.vertices.map(c=>k.transformPoint(c,e));this.linePath=s.reduce((c,u,C)=>C===0?`M ${u.x} ${u.y}`:`${c} L ${u.x} ${u.y}`,""),this.pathStrokeDashArray=t?.style==="dashed"?t.dashPattern.map(c=>c.toString()).reduce((c,u)=>(c&&`${c}, `)+u,S.EMPTY_STRING):null,this.markerDashArray=t?.style==="dashed"?t.dashPattern.map(c=>(c/o).toFixed(2)).reduce((c,u)=>(c&&`${c}, `)+u,S.EMPTY_STRING):null}};E(n,"\u0275fac",function(t){return new(t||n)(m(re),m(Ie),m(de),m(Po),m($),m(R))}),E(n,"\u0275cmp",H({type:n,selectors:[["sd-poly-shape"]],inputs:{data:"data",status:"status"},standalone:!1,features:[j([R]),Te],decls:4,vars:10,consts:[["focusable","false",3,"ngClass"],[4,"ngIf"],["stroke-linecap","square"],["markerWidth","20","markerHeight","10","refX","10","refY","5","orient","auto",4,"ngIf"],["markerWidth","20","markerHeight","10","refX","10","refY","5","orient","auto"],["sdMarkerPath","",3,"markerStyle"]],template:function(t,o){t&1&&(J(),h(0,"svg",0),y(1,Th,3,2,"defs",1),x(2,"polyline",2),y(3,Ah,1,4,"path",1),_()),t&2&&(p("ngClass",o.viewClasses),B("fill",o.fillColor),l(),p("ngIf",o.isMarkerType),l(),B("stroke",o.isCloudType()?o.interiorColor:o.pathStrokeDashArray?null:o.pathStroke)("stroke-width",o.isCloudType()?1:o.pathStrokeWidth)("stroke-dasharray",o.isCloudType()?null:o.pathStrokeDashArray)("points",o.linePointsNote)("marker-start",o.isExistLineMarker(0)&&o.markerID.sp.ref)("marker-end",o.isExistLineMarker(1)&&o.markerID.ep.ref),l(),p("ngIf",o.isCloudType()||o.pathStrokeDashArray))},styles:["svg[_ngcontent-%COMP%]{opacity:.999999;position:absolute}"],changeDetection:0}));let r=n;return r})();function Eh(r,n){if(r&1&&x(0,"sd-free-text",8),r&2){let i=d(2);p("data",i.annot)("status",i.status)}}function Sh(r,n){if(r&1&&x(0,"sd-ink",9),r&2){let i=d(2);p("annotInk",i.annot)("status",i.status)}}function Ih(r,n){if(r&1&&x(0,"sd-line",10),r&2){let i=d(2);p("annotLine",i.annot)("status",i.status)}}function xh(r,n){if(r&1&&x(0,"sd-poly-shape",8),r&2){let i=d(2);p("data",i.annot)("status",i.status)}}function vh(r,n){if(r&1&&x(0,"sd-rect",8),r&2){let i=d(2);p("data",i.annot)("status",i.status)}}function Oh(r,n){if(r&1&&x(0,"sd-stamp",11),r&2){let i=d(2);p("data",i.annot)("pdfData",i.pdfPage)("status",i.status)}}function bh(r,n){if(r&1&&x(0,"sd-text",12),r&2){let i=d(2);p("annotText",i.annot)("status",i.status)("pdfPage",i.pdfPage)}}function yh(r,n){if(r&1&&x(0,"sd-text-markup",8),r&2){let i=d(2);p("data",i.annot)("status",i.status)}}function Rh(r,n){if(r&1&&x(0,"sd-redaction",8),r&2){let i=d(2);p("data",i.annot)("status",i.status)}}function Nh(r,n){if(r&1&&x(0,"sd-link",8),r&2){let i=d(2);p("data",i.annot)("status",i.status)}}function Ph(r,n){if(r&1&&(ue(0),y(1,Eh,1,2,"sd-free-text",3)(2,Sh,1,2,"sd-ink",4)(3,Ih,1,2,"sd-line",5)(4,xh,1,2,"sd-poly-shape",3)(5,vh,1,2,"sd-rect",3)(6,Oh,1,3,"sd-stamp",6)(7,bh,1,3,"sd-text",7)(8,yh,1,2,"sd-text-markup",3)(9,Rh,1,2,"sd-redaction",3)(10,Nh,1,2,"sd-link",3),he()),r&2){let i=d();l(),p("ngSwitchCase","FreeText"),l(),p("ngSwitchCase","Ink"),l(),p("ngSwitchCase","Line"),l(),p("ngSwitchCase",i.caseOf("PolyShape",i.annot==null?null:i.annot.type)),l(),p("ngSwitchCase",i.caseOf("Rect",i.annot==null?null:i.annot.type)),l(),p("ngSwitchCase","Stamp"),l(),p("ngSwitchCase","Text"),l(),p("ngSwitchCase",i.caseOf("TextMarkup",i.annot==null?null:i.annot.type)),l(),p("ngSwitchCase","Redact"),l(),p("ngSwitchCase","Link")}}var Mh={PolyShape:{Polygon:!0,PolyLine:!0},TextMarkup:{Highlight:!0,StrikeOut:!0,Underline:!0},Rect:{Circle:!0,Square:!0}},lr=(()=>{let n=class n{changeDetectorRef;annotService;subs;annot;containerStyleMap=new Map;status=X.RENDER;pdfPage={bbox:{x:0,y:0,w:595,h:842},annot:!0,i:0,originalIndex:0,r:0,originalR:0,ref:0,isDuplicated:!1,thumbnail:""};constructor(e,t,o){this.changeDetectorRef=e,this.annotService=t,this.subs=o}caseOf(e,t){return t&&Mh[e][t]?t:null}ngOnInit(){this.subs.push(this.annotService.annotAttributeChange$.subscribe({next:()=>{this.changeDetectorRef.markForCheck()}}))}containerStylesOf(e){if(!e)return{};let t=this.containerStyleMap.get(e.oid);return t=ge(ge({},t||{}),k.elementStyleOf(e)),delete t.left,delete t.bottom,t.opacity=(e.attributes.opacity||e.attributes.opacity===0)&&e.attributes.opacity>=0&&e.attributes.opacity!==1?e.attributes.opacity:null,t.transform=null,this.containerStyleMap.set(e.oid,t),t}};E(n,"\u0275fac",function(t){return new(t||n)(m($),m(Ie),m(R))}),E(n,"\u0275cmp",H({type:n,selectors:[["sd-preview-paper"]],inputs:{annot:"annot"},standalone:!1,features:[j([R])],decls:3,vars:3,consts:[[1,"paper"],[1,"preset-annots-container",3,"ngSwitch","ngStyle"],[4,"ngIf"],[3,"data","status",4,"ngSwitchCase"],[3,"annotInk","status",4,"ngSwitchCase"],[3,"annotLine","status",4,"ngSwitchCase"],[3,"data","pdfData","status",4,"ngSwitchCase"],[3,"annotText","status","pdfPage",4,"ngSwitchCase"],[3,"data","status"],[3,"annotInk","status"],[3,"annotLine","status"],[3,"data","pdfData","status"],[3,"annotText","status","pdfPage"]],template:function(t,o){t&1&&(h(0,"div",0)(1,"div",1),y(2,Ph,11,10,"ng-container",2),_()()),t&2&&(l(),p("ngSwitch",o.annot==null?null:o.annot.type)("ngStyle",o.containerStylesOf(o.annot)),l(),p("ngIf",o.annot))},styles:["[_nghost-%COMP%]{display:flex;justify-content:center;align-items:center}.paper[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;background-color:var(--mono-00);width:100%;height:100%}.preset-annots-container[_ngcontent-%COMP%]{position:relative}.preset-annots-container[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]  svg{overflow:visible}sd-free-text[_ngcontent-%COMP%]{position:relative}"],changeDetection:0}));let r=n;return r})();function wh(r,n){if(r&1&&(J(),x(0,"ellipse")),r&2){let i=d();B("cx",i.circleRenderer.cx)("cy",i.circleRenderer.cy)("fill",i.circleRenderer.fill)("rx",i.circleRenderer.rx)("ry",i.circleRenderer.ry)("stroke-dasharray",i.circleRenderer.dashArray)("stroke-width",i.circleRenderer.width)("stroke",i.circleRenderer.stroke)}}function Lh(r,n){if(r&1&&(J(),x(0,"rect")),r&2){let i=d();B("fill-opacity",i.redactionRectRender.fillOpacity)("fill",i.squareRenderer.fill)("height",i.squareRenderer.rectHeight)("stroke-dasharray",i.squareRenderer.dashArray)("stroke-width",i.squareRenderer.width)("stroke",i.squareRenderer.stroke)("width",i.squareRenderer.rectWidth)("x",i.squareRenderer.x)("y",i.squareRenderer.y)}}function Fh(r,n){if(r&1&&(J(),x(0,"path",3)),r&2){let i=d();B("d",i.cloudRenderer.render())("fill",i.renderer.fill)("stroke-width",i.renderer.width)("stroke",i.renderer.stroke)}}var Gn=(()=>{let n=class n{elementRef;annotService;editService;contentService;changeDetectorRef;subscriptionService;data;status=X.RENDER;renderer;get circleRenderer(){return this.renderer}get squareRenderer(){return this.renderer}get redactionRectRender(){return this.renderer}cloudRenderer;constructor(e,t,o,s,c,u){this.elementRef=e,this.annotService=t,this.editService=o,this.contentService=s,this.changeDetectorRef=c,this.subscriptionService=u}ngOnInit(){this.subscriptionService.push(this.contentService.annotEvent$.pipe(w(e=>e===null?!1:e.annot.oid===this.data.oid)).subscribe({next:()=>{this.renderer.srcRect=S.deepClone(this.data.attributes.rect),this.detectChange()}}))}ngOnDestroy(){S.removeElement(this.elementRef.nativeElement),fe.destroy(this)}ngOnChanges(){this.createRenderer(),this.renderer.render()}isCircle(){return b.isCircle(this.data)}isCloud(){return this.data?.attributes.borderEffect?.style==="C"}pvOnMove(e){this.renderer.pvOnMove(e),this.detectChange()}postCreate(e){this.renderer.postCreate(e),this.validate()}verticesOf(e,t,o){return this.editService.createRectVertices(t,o)}postEdit(e,t){this.validate(),this.createRenderer(),this.detectChange()}pvOnVertexMove(e,t,o){this.renderer.status=X.EDIT,this.isCloud()&&(this.cloudRenderer.comp.status=X.EDIT),this.editService.resizeByRectVertex(this.data,t,o)&&this.detectChange()}detectChange(){this.checkRenderer(),this.renderer?.render(),this.changeDetectorRef.markForCheck()}isTouched(e){return this.isCircle()?this.isCircleTouch(e):this.isRectTouch(e)}validate(){k.validateRect(this.data.attributes.rect)}createRenderer(){this.renderer=Dt.create(this.data,this.status,this.annotService),this.isCloud()&&(this.cloudRenderer=new Ir(this.data,this.status))}checkRenderer(){this.isCloud()&&!this.cloudRenderer?this.cloudRenderer=new Ir(this.data,this.status):!this.isCloud()&&this.cloudRenderer&&delete this.cloudRenderer}isCircleTouch(e){let t=this.data.attributes.rect,o=Math.abs(t.right-t.left)/2,s=Math.abs(t.top-t.bottom)/2,c={x:(t.right+t.left)/2,y:(t.top+t.bottom)/2},u=s>o,C,N,O,U=8+this.data.attributes.width*Ne.hitTestToleranceConst;u?(C={x:c.x,y:c.y+Math.sqrt(s*s-o*o)},N={x:c.x,y:c.y-Math.sqrt(s*s-o*o)},O=2*s):(C={x:c.x+Math.sqrt(o*o-s*s),y:c.y},N={x:c.x-Math.sqrt(o*o-s*s),y:c.y},O=2*o);let z=new st(e.x-C.x,e.y-C.y).norm()+new st(e.x-N.x,e.y-N.y).norm();return this.renderer.fill==="none"&&Math.abs(O-z)<U||this.renderer.fill!=="none"&&z-O<U}isRectTouch(e){let t=this.data.attributes.rect,o=Math.abs(t.right-t.left)/2,s=Math.abs(t.top-t.bottom)/2,c=8+this.data.attributes.width*Ne.hitTestToleranceConst,u={x:(t.right+t.left)/2,y:(t.top+t.bottom)/2},C=Math.abs(e.x-u.x),N=Math.abs(e.y-u.y),O={left:t.left-c,right:t.right+c,bottom:t.bottom-c,top:t.top+c};return this.renderer.fill==="none"&&(Math.abs(o-C)<c||Math.abs(s-N)<c)&&pt.isPointInRect(O,e)||this.renderer.fill!=="none"&&pt.isPointInRect(t,e)}};E(n,"\u0275fac",function(t){return new(t||n)(m(re),m(Ie),m(ht),m(de),m($),m(R))}),E(n,"\u0275cmp",H({type:n,selectors:[["sd-rect"]],inputs:{data:"data",status:"status"},standalone:!1,features:[j([R]),Te],decls:4,vars:4,consts:[[3,"ngClass"],[4,"ngIf"],["stroke-linejoin","bevel",4,"ngIf"],["stroke-linejoin","bevel"]],template:function(t,o){t&1&&(J(),h(0,"svg",0),y(1,wh,1,8,"ellipse",1)(2,Lh,1,9,"rect",1)(3,Fh,1,4,"path",2),_()),t&2&&(p("ngClass",o.renderer.viewClasses),l(),p("ngIf",o.isCircle()&&!o.isCloud()),l(),p("ngIf",!o.isCircle()&&!o.isCloud()),l(),p("ngIf",o.isCloud()))},dependencies:[je,Ce],encapsulation:2,changeDetection:0}));let r=n;return r})();function kh(r,n){if(r&1){let i=M();J(),h(0,"rect",2),I("mouseover",function(){f(i);let t=d();return g(t.changeRenderer(!0))})("mouseout",function(){f(i);let t=d();return g(t.changeRenderer(!1))}),_()}if(r&2){let i=d();B("fill",i.render.fill)("fill-opacity",i.render.fillOpacity)("stroke",i.render.stroke)("stroke-width",i.render.width)("x",i.render.x)("y",i.render.y)("width",i.render.rectWidth)("height",i.render.rectHeight)}}var jr=(()=>{let n=class n{elementRef;contentService;annotService;editService;changeDetectorRef;subscriptionService;data;status=X.RENDER;render;originalRender;hoverRender;constructor(e,t,o,s,c,u){this.elementRef=e,this.contentService=t,this.annotService=o,this.editService=s,this.changeDetectorRef=c,this.subscriptionService=u,this.subscriptionService.push(this.contentService.redactionEvent$.pipe(w(C=>C.annot.oid===this.data.oid&&(C.sdEventType===pe.HOVER||C.sdEventType===pe.UNHOVER))).subscribe({next:C=>{let N=C.sdEventType===pe.HOVER;this.changeRenderer(N)}}),this.contentService.annotEvent$.pipe(w(C=>C?.sdEventType===pe.UPDATE||C?.sdEventType===pe.CREATE),w(C=>S.isDefined(C.annot)&&S.isDefined(this.data)&&C.annot.oid===this.data.oid)).subscribe({next:()=>{this.render&&(this.ngOnChanges(),this.changeDetectorRef.markForCheck())}}))}changeRenderer(e){e?((!this.hoverRender||this.hoverRender.fill!==this.data.attributes.InteriorColor)&&this.renewHoverRenderer(),this.render=this.hoverRender,this.render.render()):(this.render=this.originalRender,this.render.render()),this.changeDetectorRef.destroyed||this.changeDetectorRef.detectChanges()}renewHoverRenderer(){let e=S.deepClone(this.data);e.attributes.InteriorColor=this.data.attributes.InteriorColor,e.attributes.OutlineColor=this.data.attributes.InteriorColor,e.attributes.fillOpacity=1,this.hoverRender=Dt.create(e,this.status,this.annotService)}ngOnDestroy(){S.removeElement(this.elementRef.nativeElement),fe.destroy(this)}ngOnChanges(){this.originalRender=Dt.create(this.data,this.status,this.annotService),this.renewHoverRenderer(),this.render=this.originalRender,this.render.render()}pvOnMove(e){this.render.pvOnMove(e)}postCreate(e){this.render.postCreate(e)}verticesOf(e,t,o){return this.editService.createRectVertices(t,o)}postEdit(e,t){this.ngOnChanges()}isRedaction(){return b.isRedact(this.data)}pvOnVertexMove(e,t,o){this.render.status=X.EDIT,this.editService.resizeByRectVertex(this.data,t,o)&&this.render.render()}};E(n,"\u0275fac",function(t){return new(t||n)(m(re),m(de),m(Ie),m(ht),m($),m(R))}),E(n,"\u0275cmp",H({type:n,selectors:[["sd-redaction"]],inputs:{data:"data",status:"status"},standalone:!1,features:[j([R]),Te],decls:2,vars:2,consts:[["id","oid","target","redaction",3,"ngClass"],[3,"mouseover","mouseout",4,"ngIf"],[3,"mouseover","mouseout"]],template:function(t,o){t&1&&(J(),h(0,"svg",0),y(1,kh,1,8,"rect",1),_()),t&2&&(p("ngClass",o.render.viewClasses),l(),p("ngIf",o.isRedaction()))},dependencies:[je,Ce],encapsulation:2}));let r=n;return r})();var Vh=[D.RATIO_FULL+D.SPACE+D.RATIO_FULL,D.RATIO_FULL+D.SPACE+D.RATIO_HALF,D.RATIO_FULL+D.SPACE+D.RATIO_ZERO,D.RATIO_HALF+D.SPACE+D.RATIO_ZERO,D.RATIO_ZERO+D.SPACE+D.RATIO_ZERO,D.RATIO_ZERO+D.SPACE+D.RATIO_HALF,D.RATIO_ZERO+D.SPACE+D.RATIO_FULL,D.RATIO_HALF+D.SPACE+D.RATIO_FULL],$r=class{backgroundImage;backgroundSize;transform;transformOrigin},pr=(()=>{let n=class n{elementRef;editService;changeDetectorRef;contentService;subscriptionService;store$;loggingService;data;status=X.RENDER;pdfData;styles=new $r;degree;srcBbox;srcRect;firstMouseEvent=null;constructor(e,t,o,s,c,u,C){this.elementRef=e,this.editService=t,this.changeDetectorRef=o,this.contentService=s,this.subscriptionService=c,this.store$=u,this.loggingService=C}isCreate(){return this.status===X.CREATE}ngOnChanges(){let e=this.data.attributes.appearance;if(e.type!=="image"){this.loggingService.common("warn",Ee.INVALID,"stamp.appearance.type",`[${e.type}] of oid=${this.data.oid}`);return}this.render()}ngOnInit(){this.subscriptionService.push(this.store$.pipe(le("degree")).subscribe({next:e=>this.degree=e}),this.contentService.annotEvent$.pipe(w(S.isDefined),w(e=>e.annot?.oid===this.data.oid)).subscribe({next:()=>this.render()}))}ngOnDestroy(){fe.destroy(this.styles),fe.destroy(this)}pvOnMove(e){this.firstMouseEvent===null&&(this.firstMouseEvent=e);let t=(this.pdfData.r+this.degree+360)%360,o=e.clientX-this.firstMouseEvent.clientX,s=e.clientY-this.firstMouseEvent.clientY,c=this.data.attributes.rect,u=this.data.attributes.appearance,C=u.width/u.height,N=e.offsetX-c.left,O=e.offsetY-c.top,U=t===90||t===270;o*s>0&&!U||o*s<0&&U?Math.abs(N)<Math.abs(O*C)?(c.right=e.offsetX,c.bottom=c.top+N/C):(c.right=c.left+O*C,c.bottom=e.offsetY):Math.abs(N)<Math.abs(O*C)?(c.right=e.offsetX,c.bottom=c.top-N/C):(c.right=c.left-O*C,c.bottom=e.offsetY),this.render(),this.changeDetectorRef.markForCheck()}postCreate(e){this.firstMouseEvent=null;let t=this.data.attributes.rect;this.data.attributes.rect={left:Math.min(t.left,t.right),top:e.bbox.h+e.bbox.y-Math.min(t.top,t.bottom),right:Math.max(t.left,t.right),bottom:e.bbox.h+e.bbox.y-Math.max(t.top,t.bottom)},this.render(),this.changeDetectorRef.markForCheck()}verticesOf(e,t,o){return this.editService.createRectVertices(t,o)}postEdit(e,t){k.validateRect(this.data.attributes.rect),this.render()}pvOnVertexMove(e,t,o){if(!this.editService.resizeByRectVertex(this.data,t,o))return;let s=this.data.attributes.rect,c=k.bboxOf(s);if(this.styles.transformOrigin=Vh[t],this.styles.transform=`scale(${Math.abs(c.w/this.srcBbox.w).toFixed(3)}, ${D.SPACE}${Math.abs(c.h/this.srcBbox.h).toFixed(3)})`,c.w<0||c.h<0){let u={x:(this.srcRect.right!==s.right?"-":S.EMPTY_STRING)+D.RATIO_FULL,y:(this.srcRect.bottom!==s.bottom?"-":S.EMPTY_STRING)+D.RATIO_FULL};this.styles.transform+=` translate(${c.w<0?u.x:0}, ${c.h<0?u.y:0}`}this.changeDetectorRef.markForCheck()}render(){let e=this.data.attributes.appearance,t=this.data.attributes.rect;this.isCreate()?(t.right<t.left?this.styles["background-position-x"]=`${t.right}px`:this.styles["background-position-x"]=`${t.left}px`,t.bottom<t.top?this.styles["background-position-y"]=`${t.bottom}px`:this.styles["background-position-y"]=`${t.top}px`):(this.styles["background-position-x"]="0",this.styles["background-position-x"]="0",this.styles["min-width"]="100%",this.styles["min-height"]="100%"),this.srcBbox=k.bboxOf(t),this.srcRect=S.deepClone(t),this.styles.backgroundImage=`url(data:image/${e.format};base64,${e.data})`,this.styles.backgroundSize=`${Math.abs(t.right-t.left)}px ${Math.abs(t.bottom-t.top)}px`,this.styles.transform=null,this.styles.transformOrigin=null,this.changeDetectorRef.markForCheck()}};E(n,"\u0275fac",function(t){return new(t||n)(m(re),m(ht),m($),m(de),m(R),m(me),m(ze))}),E(n,"\u0275cmp",H({type:n,selectors:[["sd-stamp"]],inputs:{data:"data",status:"status",pdfData:"pdfData"},standalone:!1,features:[j([R]),Te],decls:1,vars:1,consts:[[3,"ngStyle"]],template:function(t,o){t&1&&x(0,"div",0),t&2&&p("ngStyle",o.styles)},dependencies:[_e],styles:["[_nghost-%COMP%]{width:100%;height:100%;display:block}div[_ngcontent-%COMP%]{position:absolute;left:0;top:0;padding:0;margin:0;min-width:100%;min-height:100%;background-repeat:no-repeat}"],changeDetection:0}));let r=n;return r})();var Yr=(()=>{let n=class n{elementRef;annotService;contentService;changeDetectorRef;subscriptionService;store$;annotText;status=X.RENDER;pdfPage;scale;degree;annotStyle={transform:null,color:null};get data(){return this.annotText}changesSrc=new ui({});constructor(e,t,o,s,c,u){this.elementRef=e,this.annotService=t,this.contentService=o,this.changeDetectorRef=s,this.subscriptionService=c,this.store$=u}ngOnInit(){this.subscriptionService.push(this.contentService.annotEvent$.pipe(w(e=>e?.sdEventType===pe.UPDATE&&e.annot.oid===this.data.oid)).subscribe({next:()=>{this.detectChange()}}),Et(this.changesSrc,this.store$.pipe(le("scale"),Ve({next:()=>this.scale})),this.store$.pipe(le("degree"),Ve({next:e=>this.degree=e}))).pipe($t(10)).subscribe({next:()=>this.detectChange()}))}ngOnDestroy(){S.removeElement(this.elementRef.nativeElement),fe.destroy(this)}ngOnChanges(e){this.changesSrc.next(e)}postCreate(e){this.annotService.togglePopup(this.annotText)}postEdit(e,t){this.annotService.moveText(this.annotText,{x:0,y:0})}verticesOf(e,t,o){return[]}pvOnAnnotMove(e,t,o){this.annotService.moveText(this.annotText,o)}render(){let e=this.annotStyle;e.transform=`scale(${100/Math.max(this.scale,100)}) rotate(${-(this.pdfPage.r+this.degree)}deg)`,this.data?.attributes.color&&(e.color=this.data.attributes.color)}detectChange(){this.changeDetectorRef.markForCheck(),this.render()}};E(n,"\u0275fac",function(t){return new(t||n)(m(re),m(Ie),m(de),m($),m(R),m(me))}),E(n,"\u0275cmp",H({type:n,selectors:[["sd-text"]],inputs:{annotText:"annotText",status:"status",pdfPage:"pdfPage"},standalone:!1,features:[j([R]),Te],decls:1,vars:1,consts:[[1,"papycon","papycon-memo",3,"pointerdown","pointermove","pointerup","ngStyle"]],template:function(t,o){t&1&&(h(0,"i",0),I("pointerdown",function(c){return c.stopPropagation()})("pointermove",function(c){return c.stopPropagation()})("pointerup",function(c){return c.stopPropagation()}),_()),t&2&&p("ngStyle",o.annotStyle)},dependencies:[_e],styles:["[_nghost-%COMP%]{left:0;top:0;text-align:center;cursor:pointer;display:block}i[_ngcontent-%COMP%]{font-size:20px;text-shadow:-1.5px 0 0 #000000,1.5px 0 0 #000000,0 1.5px 0 #000000,0 -1.5px 0 #000000,-1.5px -1.5px 0 #000000,1.5px -1.5px 0 #000000}"],changeDetection:0}));let r=n;return r})();var pc=(()=>{let n=class n{};E(n,"\u0275fac",function(t){return new(t||n)}),E(n,"\u0275mod",ot({type:n})),E(n,"\u0275inj",nt({providers:[ht,Po],imports:[rt,ji,kt,$i,So.forFeature(Xs,Ys),ec]}));let r=n;return r})();Le(hn,function(){return[je,De,Ce,_e,yi,Ri,En,Vr,kn,pi,dn,Bn,cr,gn,Gn,jr,pr,Yr,Jo,Pt]},function(){return[us]});Le(Ko,function(){return[Ce,_e,yi,Ri,Ja,pi,dn,Bn,cr,gn,Gn,pr,Jo,Pt]},function(){return[ee]});Le(Vr,function(){return[De,Ce,_e,Ur]},[]);Le(Ur,function(){return[je,De,_e,hi]},function(){return[ee]});Le(Hr,function(){return[Ce,_e]},function(){return[ee]});Le(pi,function(){return[je,Ce,_e,_i,lt,wt,gn,Gn]},[]);Le(Bn,function(){return[je,De,Ce,zr]},[]);Le(gn,function(){return[je,Ce,zr]},[]);Le(lr,function(){return[Ce,_e,yi,Ri,pi,dn,Bn,cr,gn,Gn,jr,pr,Yr,Jo]},[]);Le(Pt,function(){return[Ce,_e,yi,Ri,En,rc,sc,ac,cc,Hr,lc]},[]);var Uh=()=>["textRect"],dc=()=>["opacity"],uc=()=>["FillColor"],Xr=()=>["StrokeColor"],Bh=()=>["width"],hc=()=>["FontSize"],mc=()=>["FontColor"],Gh=()=>["FT"],Wh=()=>["borderStyle","style"],Hh=()=>["LE"];function zh(r,n){if(r&1){let i=M();h(0,"button",21),I("click",function(){f(i);let t=d(2).$implicit,o=d();return g(o.onExpanderClicked(t))}),x(1,"i",22),_()}}function jh(r,n){if(r&1&&x(0,"div",23),r&2){let i=d(2).$implicit,e=d();G("no-subtool",!e.isNestedMenuItem(i))}}function $h(r,n){if(r&1){let i=M();h(0,"button",27),I("click",function(){f(i);let t=d(),o=t.$implicit,s=t.index,c=d(3).$implicit,u=d();return c.lastUsed=s,g(u.activateTool(o.tool))}),x(1,"i",17),_()}if(r&2){let i=d().$implicit,e=d(4);G("selected",e.isSelected(i))("dirty",e.isDirty(i)),p("title",i.alt),l(),p("ngClass",i.iconClass)}}function Yh(r,n){if(r&1&&(ue(0),y(1,$h,2,6,"button",26),he()),r&2){let i=n.$implicit;l(),p("ngIf",i.use)}}function Xh(r,n){if(r&1&&(h(0,"div",24)(1,"div",25),y(2,Yh,2,1,"ng-container",9),_()()),r&2){let i=d(2).$implicit;p("@menuState",i.menuState),l(2),p("ngForOf",i.subtools)}}function Kh(r,n){if(r&1){let i=M();ue(0),h(1,"div",15)(2,"button",16),I("click",function(){f(i);let t=d().$implicit,o=d();return g(o.activateTool(o.isNestedMenuItem(t)?t.lastTool.tool:t.tool))}),x(3,"i",17),P(4),_(),y(5,zh,2,0,"button",18)(6,jh,1,2,"div",19)(7,Xh,3,2,"div",20),_(),he()}if(r&2){let i=d().$implicit,e=d();l(2),G("ep-text-button",!i.text)("ep-button",i.text)("expandable",e.isExpandable(i))("dirty",!e.isNestedMenuItem(i)&&e.isDirty(i)),p("title",i.alt),B("color",i.text?"white":"dark")("size",i.text?"tiny":null),l(),p("ngClass",i.iconClass),l(),Re(" ",i.text||""," "),l(),p("ngIf",e.isExpandable(i)),l(),p("ngIf",e.isActive(i)),l(),p("ngIf",e.isExpandable(i))}}function Qh(r,n){if(r&1&&(ue(0),y(1,Kh,8,16,"ng-container",14),he()),r&2){let i=n.$implicit;l(),p("ngIf",i.use)}}function Zh(r,n){r&1&&bi(0)}function qh(r,n){r&1&&(h(0,"div",28),x(1,"i",29),h(2,"span"),P(3),T(4,"translate"),_()()),r&2&&(l(3),L(A(4,1,"PLEASE_CHOOSE_ANNOT")))}function Jh(r,n){if(r&1){let i=M();h(0,"section",32),ue(1),h(2,"div")(3,"span",33),P(4),T(5,"translate"),_(),h(6,"form")(7,"pu-input-value",34),I("mousedown",function(t){f(i);let o=d(3);return g(o.preventDragging(t))}),_()()(),h(8,"div")(9,"span",33),P(10),T(11,"translate"),_(),h(12,"pu-input-value",34),I("mousedown",function(t){f(i);let o=d(3);return g(o.preventDragging(t))}),_()(),he(),_()}if(r&2){let i=d(3);l(4),L(A(5,10,"WIDTH")),l(3),p("width",90)("max",113)("suffix",i.convertedUnit)("formControl",i.textBoxWidthFormControl),l(3),L(A(11,12,"HEIGHT")),l(2),p("width",90)("max",180)("suffix",i.convertedUnit)("formControl",i.textBoxHeightFormControl)}}function em(r,n){if(r&1&&(h(0,"pu-accordion-tab",31),T(1,"translate"),y(2,Jh,13,14,"ng-template",null,2,ke),_()),r&2){let i=Oe(3);p("contentTemplate",i)("selected",!0)("header",A(1,4,"TEXT_BOX_SIZE"))("borderHidden",!0)}}function tm(r,n){if(r&1){let i=M();ue(0),h(1,"div",39)(2,"span",33),P(3),T(4,"translate"),_(),h(5,"span",40),P(6),_()(),h(7,"form",41),I("ngSubmit",function(){f(i);let t=d(4);return g(t.opacityAsPercentage=t.opacityAsPercentageFormControl.value)}),h(8,"pu-slider",42),ce("ngModelChange",function(t){f(i);let o=d(4);return se(o.opacity,t)||(o.opacity=t),g(t)}),I("puStepApply",function(t){f(i);let o=d(4);return g(o.opacityAsPercentage=((o.opacity+t)*100).toFixed(0))}),_(),h(9,"pu-input",43),I("blur",function(){f(i);let t=d(4);return g(t.opacityAsPercentage=t.opacityAsPercentageFormControl.value)}),_()(),he()}if(r&2){let i=d(4);l(3),L(A(4,11,"OPACITY")),l(3),Re("",i.opacityAsPercentage," %"),l(2),p("min",0)("max",1)("step",.01)("name","opacity")("puInputStep","all")("puStep",.01)("puAlterStep",.1),ae("ngModel",i.opacity),l(),p("formControl",i.opacityAsPercentageFormControl)}}function im(r,n){if(r&1){let i=M();h(0,"div",44)(1,"span",33),P(2),T(3,"translate"),_(),h(4,"div",45)(5,"div",46),I("click",function(){f(i);let t=d(4);return g(t.onColorTabColorClick(t.ColorTabColor.FILL_COLOR))}),_()()()}if(r&2){let i=d(4);l(2),L(A(3,5,"FILL")),l(2),G("selected",i.selectedColorTabColor===i.ColorTabColor.FILL_COLOR),l(),Ye("background",i.fillColor===null?i.transparentBackground:i.fillColor)}}function nm(r,n){if(r&1){let i=M();h(0,"div",44)(1,"span",33),P(2),T(3,"translate"),_(),h(4,"div",45)(5,"div",46),I("click",function(){f(i);let t=d(4);return g(t.onColorTabColorClick(t.ColorTabColor.STROKE_COLOR))}),_()()()}if(r&2){let i=d(4);l(2),L(A(3,5,"STROKE")),l(2),G("selected",i.selectedColorTabColor===i.ColorTabColor.STROKE_COLOR),l(),Ye("background",i.strokeColor===null?i.transparentBackground:i.strokeColor)}}function om(r,n){if(r&1){let i=M();h(0,"pu-color-palette",47),T(1,"translate"),T(2,"translate"),ce("ngModelChange",function(t){f(i);let o=d(4);return se(o.activatedColorTabColor,t)||(o.activatedColorTabColor=t),g(t)}),_()}if(r&2){let i=d(4);p("nullable",i.selectedColorTabColor===i.ColorTabColor.STROKE_COLOR?i.isCommonFieldAttribute(oe(9,Gh)):i.isCommonAnnotAttribute(oe(10,Xr)))("customColorLabel",A(1,5,"CUSTOM_COLOR"))("defaultColorLabel",A(2,7,"DEFAULT_COLOR"))("defaultColorPanelExpandedd",!0),ae("ngModel",i.activatedColorTabColor)}}function rm(r,n){if(r&1&&(h(0,"section",35),y(1,tm,10,13,"ng-container",14),h(2,"div",36),y(3,im,6,7,"div",37)(4,nm,6,7,"div",37),_(),y(5,om,3,11,"pu-color-palette",38),_()),r&2){let i=d(3);l(),p("ngIf",i.hasAttributes(oe(4,dc))),l(2),p("ngIf",i.hasAttributes(oe(5,uc))),l(),p("ngIf",i.hasAttributes(oe(6,Xr))),l(),p("ngIf",i.selectedColorTabColor!==null)}}function sm(r,n){if(r&1&&(h(0,"pu-accordion-tab",31),T(1,"translate"),y(2,rm,6,7,"ng-template",null,3,ke),_()),r&2){let i=Oe(3);p("contentTemplate",i)("selected",!0)("header",A(1,4,"COLOR"))("borderHidden",!0)}}function am(r,n){if(r&1){let i=M();ue(0),h(1,"span",33),P(2),T(3,"translate"),_(),h(4,"pu-dropdown",49),ce("ngModelChange",function(t){f(i);let o=d(4);return se(o.selectedBorderStyle,t)||(o.selectedBorderStyle=t),g(t)}),_(),he()}if(r&2){let i=d(4);l(2),L(A(3,5,"STYLE")),l(2),p("isImageLabel",!0)("options",i.borderStyleOptions)("size",i.isSmallWidthScreen?"small":"tiny"),ae("ngModel",i.selectedBorderStyle)}}function cm(r,n){if(r&1){let i=M();ue(0),h(1,"span",33),P(2),T(3,"translate"),_(),h(4,"pu-dropdown",50),ce("ngModelChange",function(t){f(i);let o=d(5);return se(o.selectedEndLinecap,t)||(o.selectedEndLinecap=t),g(t)}),I("mousedown",function(t){f(i);let o=d(5);return g(o.preventDragging(t))}),_(),he()}if(r&2){let i=d(5);l(2),L(A(3,5,"END")),l(2),p("isImageLabel",!0)("options",i.endLinecapOptions)("size",i.isSmallWidthScreen?"small":"tiny"),ae("ngModel",i.selectedEndLinecap)}}function lm(r,n){if(r&1){let i=M();ue(0),h(1,"span",33),P(2),T(3,"translate"),_(),h(4,"pu-dropdown",50),ce("ngModelChange",function(t){f(i);let o=d(4);return se(o.selectedStartLinecap,t)||(o.selectedStartLinecap=t),g(t)}),I("mousedown",function(t){f(i);let o=d(4);return g(o.preventDragging(t))}),_(),y(5,cm,5,7,"ng-container",14),he()}if(r&2){let i=d(4);l(2),L(A(3,6,"START")),l(2),p("isImageLabel",!0)("options",i.startLinecapOptions)("size",i.isSmallWidthScreen?"small":"tiny"),ae("ngModel",i.selectedStartLinecap),l(),p("ngIf",!i.isFreeTextCallout())}}function pm(r,n){if(r&1){let i=M();h(0,"section",35)(1,"div",39)(2,"span",33),P(3),T(4,"translate"),_(),h(5,"span",40),P(6),_()(),h(7,"form",41),I("ngSubmit",function(){f(i);let t=d(3);return g(t.stringStrokeWidth=t.strokeWidthFormControl.value)}),h(8,"pu-slider",48),ce("ngModelChange",function(t){f(i);let o=d(3);return se(o.width,t)||(o.width=t),g(t)}),I("puStepApply",function(t){f(i);let o=d(3);return g(o.stringStrokeWidth=o.width+(t>0?1:-1)+"")}),_(),h(9,"pu-input",43),I("blur",function(){f(i);let t=d(3);return g(t.stringStrokeWidth=t.strokeWidthFormControl.value)}),_()(),y(10,am,5,7,"ng-container",14)(11,lm,6,8,"ng-container",14),_()}if(r&2){let i=d(3);l(3),L(A(4,9,"THICKNESS")),l(3),Re("",i.stringStrokeWidth," pt"),l(2),p("puInputStep","all")("max",i.MaximumStrokeWidth)("min",i.MinimumStrokeWidth),ae("ngModel",i.width),l(),p("formControl",i.strokeWidthFormControl),l(),p("ngIf",i.hasAttributes(oe(11,Wh))),l(),p("ngIf",i.hasAttributes(oe(12,Hh)))}}function dm(r,n){if(r&1&&(h(0,"pu-accordion-tab",31),T(1,"translate"),y(2,pm,12,13,"ng-template",null,4,ke),_()),r&2){let i=Oe(3);p("contentTemplate",i)("selected",!0)("header",A(1,4,"LINE"))("borderHidden",!0)}}function um(r,n){if(r&1){let i=M();h(0,"div",36)(1,"div",52)(2,"span",33),P(3),T(4,"translate"),_(),h(5,"pu-dropdown",53),ce("ngModelChange",function(t){f(i);let o=d(4);return se(o.selectedFont,t)||(o.selectedFont=t),g(t)}),_()(),h(6,"div",52)(7,"span",33),P(8),T(9,"translate"),_(),h(10,"pu-dropdown",54),ce("ngModelChange",function(t){f(i);let o=d(4);return se(o.selectedFontSize,t)||(o.selectedFontSize=t),g(t)}),_()()()}if(r&2){let i=d(4);l(3),L(A(4,9,"STYLE")),l(2),p("size",i.isSmallWidthScreen?"small":"tiny")("options",i.fontOptions),ae("ngModel",i.selectedFont),l(3),L(A(9,11,"SIZE")),l(2),p("editable",!0)("size",i.isSmallWidthScreen?"small":"tiny")("options",i.fontsizeOptions),ae("ngModel",i.selectedFontSize)}}function hm(r,n){if(r&1){let i=M();h(0,"pu-color-palette",56),T(1,"translate"),T(2,"translate"),ce("ngModelChange",function(t){f(i);let o=d(5);return se(o.activatedFontTabColor,t)||(o.activatedFontTabColor=t),g(t)}),_()}if(r&2){let i=d(5);p("customColorLabel",A(1,4,"CUSTOM_COLOR"))("defaultColorLabel",A(2,6,"DEFAULT_COLOR"))("defaultColorPanelExpandedd",!0),ae("ngModel",i.activatedFontTabColor)}}function mm(r,n){if(r&1){let i=M();ue(0),h(1,"span",33),P(2),T(3,"translate"),_(),h(4,"div",45)(5,"div",46),I("click",function(){f(i);let t=d(4);return g(t.onFontTabColorClick(t.FontTabColor.FONT_COLOR))}),_()(),y(6,hm,3,8,"pu-color-palette",55),he()}if(r&2){let i=d(4);l(2),L(A(3,6,"COLOR")),l(2),G("selected",i.selectedFontTabColor===i.FontTabColor.FONT_COLOR),l(),Ye("background",i.fontColor===null?i.transparentBackground:i.fontColor),l(),p("ngIf",i.selectedFontTabColor!==null)}}function _m(r,n){if(r&1&&(h(0,"section",35),y(1,um,11,13,"div",51)(2,mm,7,8,"ng-container",14),_()),r&2){let i=d(3);l(),p("ngIf",i.hasAttributes(oe(2,hc))),l(),p("ngIf",i.hasAttributes(oe(3,mc)))}}function fm(r,n){if(r&1&&(h(0,"pu-accordion-tab",31),T(1,"translate"),y(2,_m,3,4,"ng-template",null,5,ke),_()),r&2){let i=Oe(3);p("contentTemplate",i)("selected",!0)("header",A(1,4,"TEXT_PROP"))("borderHidden",!0)}}function gm(r,n){if(r&1&&(h(0,"pu-accordion"),y(1,em,4,6,"pu-accordion-tab",30)(2,sm,4,6,"pu-accordion-tab",30)(3,dm,4,6,"pu-accordion-tab",30)(4,fm,4,6,"pu-accordion-tab",30),_()),r&2){let i=d();l(),p("ngIf",i.hasAttributes(oe(4,Uh))),l(),p("ngIf",i.hasAttributes(oe(5,dc))||i.hasAttributes(oe(6,uc))||i.hasAttributes(oe(7,Xr))),l(),p("ngIf",i.hasAttributes(oe(8,Bh))&&i.width>0),l(),p("ngIf",i.hasAttributes(oe(9,hc))||i.hasAttributes(oe(10,mc)))}}var Kr=(()=>{let n=class n{translatePipe;changeDetectorRef;annotService;subs;contentService;configsService;store$;unitPipe;get fontsizeOptions(){return D.fontsizeOptions}get activeTool(){return this._activeTool}set activeTool(e){this._activeTool=e,this.activeAttributes=S.deepClone(this.activeTool?.attributes),this.setProperties()}paperSize={height:"536px",width:"378px"};MinimumStrokeWidth=1;MaximumStrokeWidth=12;borderStyleOptions=[];opacityAsPercentageFormControl=new Ze;strokeWidthFormControl=new Ze;textBoxWidthFormControl=new Ze;textBoxHeightFormControl=new Ze;isSmallWidthScreen=Pe.isSmallWidth();selectedFontTabColor=null;attributeProxyMapper=null;customFontSizeOption=null;attributeKeyToSetterMap={opacity:"opacity",width:"width",FontSize:"fontSize",FontName:"fontName",FontColor:"fontColor",FillColor:"fillColor",StrokeColor:"strokeColor",borderStyle:"borderStyle",LE:["startLinecap","endLinecap"],textRect:"textRect"};get borderStyle(){return this.activeAttributes.borderStyle??={style:"solid",dashPattern:[]},this.activeAttributes.borderStyle}set borderStyle(e){this.activeAttributes.borderStyle.style=e.style,this.activeAttributes.borderStyle.dashPattern=e.dashPattern,this.modifyAttribute(this.activeTool,["borderStyle"],this.activeAttributes.borderStyle)}get selectedBorderStyle(){return this.borderStyleOptions.find(e=>{let t=e.value.style===this.borderStyle.style,o=e.value.dashPattern,s=this.borderStyle.dashPattern;if(t){if(Array.isArray(o)&&Array.isArray(s))return o.every((c,u)=>c===s[u]);if(!Array.isArray(o)&&!Array.isArray(s))return!0}return!1})}set selectedBorderStyle(e){this.borderStyle=e.value}get stringStrokeWidth(){return`${this.activeAttributes.width}`}set stringStrokeWidth(e){let t=parseInt(e);if(Number.isNaN(t)){this.strokeWidthFormControl.setValue(this.width);return}this.width=Math.min(Math.max(t,this.MinimumStrokeWidth),this.MaximumStrokeWidth)}get AnnotTool(){return F}get activatedColorTabColor(){switch(this.selectedColorTabColor){case Ft.FILL_COLOR:return this.fillColor;case Ft.STROKE_COLOR:return this.strokeColor;default:return null}}set activatedColorTabColor(e){switch(this.selectedColorTabColor){case Ft.FILL_COLOR:this.fillColor=e;break;case Ft.STROKE_COLOR:this.strokeColor=e;break;default:break}}get width(){return this.activeAttributes.width}set width(e){this.activeAttributes.width=e,this.modifyAttribute(this.activeTool,["width"],e),this.strokeWidthFormControl.setValue(this.activeAttributes.width)}get strokeColor(){return this.activeAttributes.StrokeColor??="#FFFFFF",this.activeAttributes.StrokeColor}set strokeColor(e){e===null?this.width=null:this.width<=0&&(this.width=1),this.activeAttributes.StrokeColor=e,this.modifyAttribute(this.activeTool,["StrokeColor"],e)}get fillColor(){return this.activeAttributes.FillColor===void 0&&(this.activeAttributes.FillColor="#FFFFFF"),this.activeAttributes.FillColor}set fillColor(e){this.activeAttributes.FillColor=e,this.modifyAttribute(this.activeTool,["FillColor"],e)}get ColorTabColor(){return Ft}get FontTabColor(){return Ci}get opacityAsPercentage(){return`${this.opacity&&Math.floor(this.opacity*100)}`}set opacityAsPercentage(e){let t=Number.parseInt(e);Number.isNaN(t)&&this.opacityAsPercentageFormControl.setValue(this.opacityAsPercentage),this.opacity=Math.min(Math.max(t/100,0),1)}get opacity(){return this.activeAttributes.opacity}set opacity(e){this.activeAttributes.opacity=e,this.opacityAsPercentageFormControl.setValue(this.opacityAsPercentage),this.modifyAttribute(this.activeTool,["opacity"],e)}get selectedStartLinecap(){return this.startLinecapOptions.find(e=>e.value===this.startLinecap)}set selectedStartLinecap(e){this.startLinecap=e.value}get startLinecap(){return this.activeAttributes.LE??=[],this.activeAttributes.LE[0]}set startLinecap(e){this.activeAttributes.LE[0]=e,this.modifyAttribute(this.activeTool,["LE"],this.activeAttributes.LE)}get selectedEndLinecap(){return this.endLinecapOptions.find(e=>e.value===this.endLinecap)}set selectedEndLinecap(e){this.endLinecap=e.value}get fontSize(){return this.activeAttributes.fontSize??=null,this.activeAttributes.fontSize}set fontSize(e){this.activeAttributes.fontSize=e,this.modifyAttribute(this.activeTool,["FontSize"],this.activeAttributes.fontSize)}get selectedFontSize(){let e=D.fontsizeOptions.find(t=>t.value===this.fontSize);return S.isDefined(e)?e:S.isDefined(this.customFontSizeOption)&&this.customFontSizeOption.value===this.fontSize?this.customFontSizeOption:S.isDefined(this.fontSize)?(this.customFontSizeOption={label:this.fontSize.toString(),value:this.fontSize},this.customFontSizeOption):null}set selectedFontSize(e){let t=Number(e.value);Number.isNaN(t)||(this.fontSize=t)}get endLinecap(){return this.activeAttributes.LE??=[],this.activeAttributes.LE[1]}set endLinecap(e){this.activeAttributes.LE[1]=e,this.modifyAttribute(this.activeTool,["LE"],this.activeAttributes.LE)}get fontName(){return this.activeAttributes.fontName??=null,this.activeAttributes.fontName}set fontName(e){this.activeAttributes.fontName=e,this.modifyAttribute(this.activeTool,["FontName"],this.activeAttributes.fontName)}get selectedFont(){return this.fontOptions.find(e=>e.value===this.fontName)??this.fontOptions[0]}set selectedFont(e){this.fontName=e.value}get fontColor(){return this.activeAttributes.FontColor??="#FFFFFF",this.activeAttributes.FontColor}set fontColor(e){this.activeAttributes.FontColor=e,this.modifyAttribute(this.activeTool,["FontColor"],this.activeAttributes.FontColor)}get activatedFontTabColor(){switch(this.selectedFontTabColor){case Ci.FONT_COLOR:return this.fontColor;default:return null}}set activatedFontTabColor(e){this.selectedFontTabColor===Ci.FONT_COLOR&&(this.fontColor=e)}get textBoxWidthAsLocalUnit(){let e=this.activeAttributes.textRect.right-this.activeAttributes.textRect.left;if(this.isCommonSize(e,void 0))return this.convertUnitAsLocalized("mmToPoint",e)}set textBoxWidthAsLocalUnit(e){let t=this.convertUnitAsLocalized("pointToMm",e);this.resizeTextRect(t,void 0),this.modifyAttribute(this.activeTool,["textRect"],this.activeAttributes.textRect)}get textBoxHeightAsLocaleUnit(){let e=this.activeAttributes.textRect.top-this.activeAttributes.textRect.bottom;if(this.isCommonSize(void 0,e))return this.convertUnitAsLocalized("mmToPoint",e)}set textBoxHeightAsLocaleUnit(e){let t=this.convertUnitAsLocalized("pointToMm",e);this.resizeTextRect(void 0,t),this.modifyAttribute(this.activeTool,["textRect"],this.activeAttributes.textRect)}get transparentBackground(){return D.getTransparentBackground()}tools;skipNoninteractiveChanges=!0;dirtyAnnots=[];toolMenuItems=[];fontOptions=[];language="ko";startLinecapOptions=[];endLinecapOptions=[];_activeTool;activeAttributes={};status=X.RENDER;selectedColorTabColor=null;constructor(e,t,o,s,c,u,C,N){this.translatePipe=e,this.changeDetectorRef=t,this.annotService=o,this.subs=s,this.contentService=c,this.configsService=u,this.store$=C,this.unitPipe=N,this.attributeProxyMapper=new No,this.toolMenuItems=[{lastUsed:0,menuState:"off",menuStyle:{},subtools:[{tool:F.INK,alt:this.translatePipe.transform("INK_TOOL"),iconClass:"papycon-pencil",use:!0},{tool:F.LINE,alt:this.translatePipe.transform("LINE_TOOL"),iconClass:"papycon-line",use:!0},{tool:F.SQUARE,alt:this.translatePipe.transform("SQUARE_TOOL"),iconClass:"papycon-square",use:!0},{tool:F.CIRCLE,alt:this.translatePipe.transform("CIRCLE_TOOL"),iconClass:"papycon-circle",use:!0},{tool:F.POLYGON,alt:this.translatePipe.transform("POLYGON_TOOL"),iconClass:"papycon-polygon",use:!0,id:k.getAnnotID(zt[F.POLYGON])},{tool:F.POLYLINE,alt:this.translatePipe.transform("POLYLINE_TOOL"),iconClass:"papycon-polyline",use:!0,id:k.getAnnotID(zt[F.POLYLINE])},{tool:F.CLOUD,alt:this.translatePipe.transform("POLYGON_CLOUD_TOOL"),iconClass:"papycon-revisioncloud",use:!0,id:k.getAnnotID(zt[F.CLOUD])}].filter(O=>O.use),get lastTool(){return this.subtools[this.lastUsed]},get tool(){return this.lastTool?.tool},get iconClass(){return this.lastTool?.iconClass},get alt(){return this.lastTool?.alt},priority:1,use:!0},{lastUsed:0,menuState:"off",menuStyle:{},subtools:[{tool:F.TEXT_FREE,alt:this.translatePipe.transform("FREE_TEXT_TOOL"),iconClass:"papycon-textbox",use:!0},{tool:F.TEXT_CALLOUT,alt:this.translatePipe.transform("FREE_TEXT_CALLOUT_TOOL"),iconClass:"papycon-callout2",use:!0,id:k.getAnnotID(zt[F.TEXT_CALLOUT])}].filter(O=>O.use),get lastTool(){return this.subtools[this.lastUsed]},get tool(){return this.lastTool?.tool},get iconClass(){return this.lastTool?.iconClass},get alt(){return this.lastTool?.alt},priority:1,use:!0},{tool:F.TEXT_POPUP,alt:this.translatePipe.transform("TEXT_TOOL"),iconClass:"papycon-memo3",use:!0,priority:2},{tool:F.STAMP,alt:this.translatePipe.transform("STAMP_TOOL"),iconClass:"papycon-stamp2",use:!0,priority:3},{lastUsed:0,menuState:"off",menuStyle:{},subtools:[{tool:F.HIGHLIGHT,alt:this.translatePipe.transform("HIGHLIGHT"),iconClass:"papycon-text-highlight",use:!0},{tool:F.STRIKE,alt:this.translatePipe.transform("STRIKEOUT"),iconClass:"papycon-text-strikeout",use:!0},{tool:F.UNDERLINE,alt:this.translatePipe.transform("UNDERLINE"),iconClass:"papycon-text-underline",use:!0}].filter(O=>O.use),get lastTool(){return this.subtools[this.lastUsed]},get tool(){return this.lastTool?.tool},get iconClass(){return this.lastTool?.iconClass},get alt(){return this.lastTool?.alt},priority:4,use:!0}]}ngOnInit(){this.getStampImage(),this.initTools(),this.initDropdownOptions(),this.initSubscriptions()}initVariables(){this.selectedColorTabColor=null,this.selectedFontTabColor=null,this.isFreeTextCallout()&&!this.dirtyAnnots.includes("FreeTextCallout")&&(this.textBoxWidthFormControl.setValue(this.textBoxWidthAsLocalUnit),this.textBoxHeightFormControl.setValue(this.textBoxHeightAsLocaleUnit))}getStampImage(){this.configsService.getStampImage()}initTools(){this.tools=Y.get(a.ANNOT_PROPERTIES),this.skipNoninteractiveChanges=!1}ngOnDestroy(){this.attributeProxyMapper=null}initSubscriptions(){this.subs.push(Pe.windowResize$.subscribe({next:()=>{this.isSmallWidthScreen=Pe.isSmallWidth(),this.changeDetectorRef.markForCheck()}}),Pe.windowMouseUp$.subscribe({next:()=>this.closeSubMenuItems()}),this.contentService.fontsResponse$.subscribe({next:e=>{this.fontOptions.splice(0),e.fontList.forEach(t=>{this.fontOptions.push({label:t.label[D.LANGUAGE_ID_MAP[this.language]]||t.label[0]||t.name,value:t.name,available:!0})}),this.fontOptions=this.fontOptions.slice().filter(t=>t.available),D.generateUnavailableFontOption(this.fontOptions,this.fontName,this.translatePipe),this.changeDetectorRef.markForCheck()}}),this.store$.pipe(Be("language")).subscribe({next:e=>{this.language=e}}),this.annotService.annotAttributeChange$.subscribe({next:()=>{Y.set(a.ANNOT_PROPERTIES,this.tools),this.initVariables()}}),this.configsService.configSaved$.subscribe({next:()=>{this.dirtyAnnots=[],this.changeDetectorRef.markForCheck()}}),this.textBoxWidthFormControl.valueChanges.pipe(St()).subscribe({next:e=>{this.textBoxWidthAsLocalUnit=e}}),this.textBoxHeightFormControl.valueChanges.pipe(St()).subscribe({next:e=>{this.textBoxHeightAsLocaleUnit=e}}))}closeSubMenuItems(){this.toolMenuItems.forEach(e=>{e.menuState="off"}),this.changeDetectorRef.markForCheck()}isFreeTextCallout(){return b.isFreeTextCallout(this.activeTool)}isActive(e){return this.activeTool?.type===zt[e.tool]?.type}isSelected(e){return this.activeTool?(e.id??zt[e.tool]?.type)===k.getAnnotID(this.activeTool):!1}initDropdownOptions(){this.startLinecapOptions.splice(0),this.endLinecapOptions.splice(0),this.borderStyleOptions.splice(0),Ot.linecapList.forEach(e=>{[this.startLinecapOptions,this.endLinecapOptions].forEach(t=>{t.push({label:e.label,value:e.value})})}),Ot.borderStyleList.forEach(e=>{this.borderStyleOptions.push({label:e.label,value:e.value})})}isNestedMenuItem(e){return"subtools"in e}isExpandable(e){return this.isNestedMenuItem(e)&&e.subtools.filter(t=>t.use).length>1}isDirty(e){let t=e.id??zt[e.tool]?.type;return this.dirtyAnnots.includes(t)}isPolygonGroup(e){return b.isPolygon(e)||b.isPolygonCloud(e)||b.isPolyLine(e)}isFreeTextGroup(e){return b.isFreeText(e)||b.isFreeTextCallout(e)}modifyAttribute(e,t,o){e&&(this.annotService.modifyAttribute(e,t,o),this.markAnnotDirtyStatus(e))}markAnnotDirtyStatus(e){let t=this.isPolygonGroup(e)||this.isFreeTextGroup(e)?k.getAnnotID(e):e.type;this.skipNoninteractiveChanges||this.dirtyAnnots.includes(t)||this.dirtyAnnots.push(t)}preventDragging(e){e.stopPropagation()}onFontTabColorClick(e){this.selectedFontTabColor=this.selectedFontTabColor===e?null:e}activateTool(e){this.skipNoninteractiveChanges=!0,this.closeSubMenuItems(),this.activeTool=this.tools.find(t=>t.annot.oid===zt[e].oid).annot,this.skipNoninteractiveChanges=!1}onExpanderClicked(e){e.menuState=e.menuState==="off"?"on":"off",this.toolMenuItems.forEach(t=>{!t.hasOwnProperty("subtools")||t===e||(t.menuState="off")})}hasAttributes(e){let t=this.activeTool,o=this.activeAttributes;return!S.isDefined(t)||!S.isDefined(o)?!1:e.every(s=>{let c=this.attributeProxyMapper.getUnflattenedKey(t?.type,s)??e,u=c[c.length-1];if(c.length>1){let C=o;for(let N=0;N<c.length-1;N++){if(C[c[N]]?.hasOwnProperty(u))return!0;C=C[c[N]]}}else if(o.hasOwnProperty(u))return!0;return!1})}setProperties(){let e=this,t=(s,c)=>{let u=e.attributeKeyToSetterMap[s];Array.isArray(u)?u.forEach((C,N)=>{e[C]=c[N]}):e[u]=c};Object.keys(this.attributeKeyToSetterMap).forEach(s=>{let c=this.activeTool,u=this.activeAttributes,C=this.attributeProxyMapper.getUnflattenedKey(c?.type,s)??[s],N=C[C.length-1];if(C.length>1){let O=u;for(let U=0;U<C.length-1;U++){if(O[C[U]]?.hasOwnProperty(N)){let z=s==="borderStyle"?O[C[U]]:O[C[U]][N];return t(s,z),!0}O=O[C[U]]}}else if(u.hasOwnProperty(N))return t(s,u[N]),!0;return!1})}onColorTabColorClick(e){this.selectedColorTabColor=this.selectedColorTabColor===e?null:e}get convertedUnit(){return this.unitPipe.transform(K.MILLIMETER)}isCommonSize(e,t){return(e?(this.activeAttributes.textRect.right-this.activeAttributes.textRect.left).toFixed(3)===e.toFixed(3):!0)&&(t?(this.activeAttributes.textRect.top-this.activeAttributes.textRect.bottom).toFixed(3)===t.toFixed(3):!0)}convertUnitAsLocalized(e,t){switch(e){case"mmToPoint":return this.unitPipe.isRegionUS()?this.unitPipe.convertToImperial(K.POINT,t):Ue.convert(K.POINT,K.MILLIMETER,t);case"pointToMm":return this.unitPipe.isRegionUS()?Ue.convert(wi[K.MILLIMETER],K.POINT,t):Ue.convert(K.MILLIMETER,K.POINT,t);default:return}}resizeTextRect(e,t){if(S.isDefined(e)){let o=e;o<Ne.annotation.resizeLimit.width&&(o=Ne.annotation.resizeLimit.width),this.activeAttributes.textRect.right=this.activeAttributes.textRect.left+o}if(S.isDefined(t)){let o=t;o<Ne.annotation.resizeLimit.height&&(o=Ne.annotation.resizeLimit.height);let s=this.activeAttributes.textRect.top-(this.activeAttributes.textRect.top-this.activeAttributes.textRect.bottom)/2;this.activeAttributes.textRect.top=s+o/2,this.activeAttributes.textRect.bottom=s-o/2}}isCommonFieldAttribute(e){let t=["Parent"];return this.isCommonAnnotAttribute(t.concat(e))}isCommonAnnotAttribute(e){let t=this.activeAttributes;return e.every(o=>t.hasOwnProperty(o)?(t=t[o],!0):!1)}};E(n,"\u0275fac",function(t){return new(t||n)(m(ee),m($),m(Ie),m(R),m(de),m(Rt),m(me),m(Ai))}),E(n,"\u0275cmp",H({type:n,selectors:[["sd-annot-property-config"]],standalone:!1,features:[j([R])],decls:12,vars:6,consts:[["emptyAnnotRef",""],["propertiesRef",""],["sizeContentRef",""],["colorContentRef",""],["lineContentRef",""],["textContentRef",""],[1,"container"],[1,"tool-panel"],[1,"tool-box"],[4,"ngFor","ngForOf"],[1,"preview-paper-panel"],[3,"ngStyle","annot"],[1,"property-panel"],[4,"ngIf","ngIfThen","ngIfElse"],[4,"ngIf"],[1,"tool-container"],[1,"tool-button",3,"click","title"],[1,"papycon",3,"ngClass"],["class","ep-text-button expand-button","color","dark",3,"click",4,"ngIf"],["class","active-indicator",3,"no-subtool",4,"ngIf"],["class","subtool-menu",4,"ngIf"],["color","dark",1,"ep-text-button","expand-button",3,"click"],[1,"papycon","papycon-chevron3-down"],[1,"active-indicator"],[1,"subtool-menu"],[1,"menu-container"],["class","ep-text-button","color","dark",3,"selected","dirty","title","click",4,"ngIf"],["color","dark",1,"ep-text-button",3,"click","title"],[1,"empty"],[1,"papycon","papycon-memo3"],[3,"contentTemplate","selected","header","borderHidden",4,"ngIf"],[3,"contentTemplate","selected","header","borderHidden"],[1,"flex","wrap","space-between","size"],[1,"property-title"],[3,"mousedown","width","max","puInputStep","suffix","formControl"],[1,"flex","column"],[1,"flex"],["class","flex column color-property",4,"ngIf"],[3,"nullable","customColorLabel","defaultColorLabel","defaultColorPanelExpandedd","ngModel","ngModelChange",4,"ngIf"],[1,"flex","space-between"],[1,"slider-value"],[1,"flex","align-center",3,"ngSubmit"],["tabindex","0",3,"ngModelChange","puStepApply","min","max","step","name","puInputStep","puStep","puAlterStep","ngModel"],["size","tiny",1,"slider-input",3,"blur","formControl"],[1,"flex","column","color-property"],[1,"color-picker-container"],[1,"color-rect",3,"click"],[3,"ngModelChange","nullable","customColorLabel","defaultColorLabel","defaultColorPanelExpandedd","ngModel"],["name","strokeWidth","tabindex","0",3,"ngModelChange","puStepApply","puInputStep","max","min","ngModel"],[3,"ngModelChange","isImageLabel","options","size","ngModel"],[3,"ngModelChange","mousedown","isImageLabel","options","size","ngModel"],["class","flex",4,"ngIf"],[1,"flex","column","font-property"],[1,"font-dropdown",3,"ngModelChange","size","options","ngModel"],[1,"font-size-dropdown",3,"ngModelChange","editable","size","options","ngModel"],[3,"customColorLabel","defaultColorLabel","defaultColorPanelExpandedd","ngModel","ngModelChange",4,"ngIf"],[3,"ngModelChange","customColorLabel","defaultColorLabel","defaultColorPanelExpandedd","ngModel"]],template:function(t,o){if(t&1&&(h(0,"div",6)(1,"div",7)(2,"section",8),y(3,Qh,2,1,"ng-container",9),_()(),h(4,"div",10),x(5,"sd-preview-paper",11),_(),h(6,"div",12),y(7,Zh,1,0,"ng-container",13)(8,qh,5,3,"ng-template",null,0,ke)(10,gm,5,11,"ng-template",null,1,ke),_()()),t&2){let s=Oe(9),c=Oe(11);l(3),p("ngForOf",o.toolMenuItems),l(2),p("ngStyle",o.paperSize)("annot",o.activeTool),l(2),p("ngIf",o.activeTool)("ngIfThen",c)("ngIfElse",s)}},styles:['[_nghost-%COMP%]{height:600px;padding:0 36px 40px}.container[_ngcontent-%COMP%]{display:flex;height:100%;border:1px solid #DADADA;border-radius:2px}.tool-panel[_ngcontent-%COMP%]{flex:0 0 60px;height:100%;border-right:1px solid #DADADA}.tool-panel[_ngcontent-%COMP%]   .tool-button[_ngcontent-%COMP%]{margin:10px}.tool-panel[_ngcontent-%COMP%]   .tool-button.dirty[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:after{content:"";position:absolute;left:100%;top:0;width:4px;height:4px;border-radius:4px;background-color:#f79f1a}.tool-panel[_ngcontent-%COMP%]   .tool-button.ep-text-button[_ngcontent-%COMP%]{width:24px;height:24px;border-width:0;outline-offset:-2px}.tool-panel[_ngcontent-%COMP%]   .tool-button.expandable[_ngcontent-%COMP%]{margin-right:0}.ep-text-button.dirty[_ngcontent-%COMP%]{position:relative}.ep-text-button.dirty[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:after{content:"";position:absolute;right:0;top:0;width:4px;height:4px;border-radius:4px;background-color:#f79f1a}.subtool-menu[_ngcontent-%COMP%]{box-shadow:0 4px 32px #6c6c6c1f;position:absolute;display:flex;height:44px;top:100%;left:-7px;align-items:center;box-sizing:border-box;padding:6px 12px;margin-top:5px;border:1px solid #DADADA;border-radius:2px;background-color:#fff;white-space:nowrap;z-index:3}.subtool-menu[_ngcontent-%COMP%]   .menu-container[_ngcontent-%COMP%]{display:flex;min-width:100%}.subtool-menu[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:30px;height:30px}.subtool-menu[_ngcontent-%COMP%]   button.selected[_ngcontent-%COMP%]{color:#fff;background-color:#f79f1a}.subtool-menu[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] + button[_ngcontent-%COMP%]{margin-left:12px}section.tool-box[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:16px 0}section.tool-box[_ngcontent-%COMP%]   .tool-container[_ngcontent-%COMP%]{position:relative;height:34px;display:flex;align-items:center}section.tool-box[_ngcontent-%COMP%]   .tool-container[_ngcontent-%COMP%]:not(:last-child){margin-bottom:20px}section.tool-box[_ngcontent-%COMP%]   .expand-button[_ngcontent-%COMP%]{border-width:0;outline-offset:-2px}section.tool-box[_ngcontent-%COMP%]   .expand-button[_ngcontent-%COMP%]   .papycon[_ngcontent-%COMP%]{transform:scale(.5);font-size:18px;line-height:48px;margin:-12px -7.5px;padding:0 6px;transform-origin:50% 50%}i[_ngcontent-%COMP%] + section.tool-box[_ngcontent-%COMP%]   .expand-button[_ngcontent-%COMP%]   .papycon[_ngcontent-%COMP%]{margin:-12px -8.5px;padding:0 8px}section.tool-box[_ngcontent-%COMP%]   .expand-button[_ngcontent-%COMP%]   .papycon.expanded[_ngcontent-%COMP%]{transform:scale(.5) rotate(-180deg)}section.tool-box[_ngcontent-%COMP%]   .active-indicator[_ngcontent-%COMP%]{position:absolute;left:10px;bottom:0;width:calc(100% - 20px);height:3px;background-color:#f79f1a;border-radius:2px}section.tool-box[_ngcontent-%COMP%]   .active-indicator.no-subtool[_ngcontent-%COMP%]{width:25px}.preview-paper-panel[_ngcontent-%COMP%]{width:540px;height:100%;background-color:#f4f4f4;display:flex;justify-content:center;align-items:center;position:relative}.property-panel[_ngcontent-%COMP%]{overflow:auto;width:252px;max-width:252px;height:100%;border-left:1px solid #DADADA}.empty[_ngcontent-%COMP%]{color:#6c6c6c;display:flex;flex-direction:column;justify-content:center;align-items:center;height:100%}.empty[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:38px;margin-bottom:5px}.empty[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:13px;line-height:22px}pu-accordion[_ngcontent-%COMP%]:last-child{padding-bottom:12px}pu-accordion.no-margin[_ngcontent-%COMP%]{margin:0}pu-accordion.no-border[_ngcontent-%COMP%]{border:none}.flex[_ngcontent-%COMP%]{display:flex}.flex.column[_ngcontent-%COMP%]{flex-direction:column}.flex.align-center[_ngcontent-%COMP%]{align-items:center}.flex.space-between[_ngcontent-%COMP%]{justify-content:space-between}.flex.wrap[_ngcontent-%COMP%]{flex-wrap:wrap}.property-title[_ngcontent-%COMP%]{font-size:12px;line-height:20px;font-family:NotoSans-Medium,sans-serif;color:#6c6c6c;margin-top:4px;margin-bottom:2px}.property-title.disabled[_ngcontent-%COMP%]{opacity:.5;-webkit-user-select:none;user-select:none}pu-accordion-tab[_ngcontent-%COMP%]{border-bottom:1px solid #DADADA}pu-accordion-tab[_ngcontent-%COMP%]   section[_ngcontent-%COMP%]{padding:0 12px}pu-accordion-tab[_ngcontent-%COMP%]   section[_ngcontent-%COMP%]:after{content:"";display:block;width:100%;height:12px}pu-dropdown[_ngcontent-%COMP%], pu-input[_ngcontent-%COMP%], pu-slider[_ngcontent-%COMP%]{margin-bottom:8px}pu-dropdown.no-margin[_ngcontent-%COMP%], pu-input.no-margin[_ngcontent-%COMP%], pu-slider.no-margin[_ngcontent-%COMP%]{margin-bottom:0}pu-slider[_ngcontent-%COMP%]{flex-shrink:1}.slider-value[_ngcontent-%COMP%]{font-size:13px;line-height:22px;font-family:NotoSans-Regular,sans-serif;color:#1e1e1e;display:none}.slider-input[_ngcontent-%COMP%]{width:38px;margin-left:8px;flex-shrink:0}.color-picker-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;border:1px solid #DADADA;border-radius:2px;box-sizing:border-box;padding:3px;margin-top:2px;width:30px;height:30px}.color-picker-container.disabled[_ngcontent-%COMP%]{opacity:.5;pointer-events:none;-webkit-user-select:none;user-select:none}.color-picker-container.selected[_ngcontent-%COMP%]{background-color:#f79f1a14;border:1px solid #F79F1A;box-shadow:0 0 6px #f79f1a}.color-picker-container[_ngcontent-%COMP%]   .color-rect[_ngcontent-%COMP%]{width:22px;height:22px;border-radius:2px;background-size:cover}.color-property[_ngcontent-%COMP%]{margin-left:8px}.color-property[_ngcontent-%COMP%]:first-child{margin-left:0}.font-property[_ngcontent-%COMP%]{margin-left:12px}.font-property[_ngcontent-%COMP%]:first-child{margin-left:0}.font-property[_ngcontent-%COMP%]   .font-dropdown[_ngcontent-%COMP%]{width:124px}.font-property[_ngcontent-%COMP%]   .font-size-dropdown[_ngcontent-%COMP%]{width:80px}.size[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin-right:12px;margin-top:8px}'],data:{animation:[Xi.expandSubTool()]},changeDetection:0}));let r=n;return r})();function Cm(r,n){r&1&&bi(0)}function Tm(r,n){r&1&&(h(0,"div",7)(1,"span"),P(2),T(3,"translate"),_(),x(4,"pu-input",8),T(5,"translate"),_(),h(6,"div",7)(7,"span"),P(8),T(9,"translate"),_(),x(10,"pu-input",9),T(11,"translate"),_()),r&2&&(l(2),L(A(3,4,"TOOL_NAME")),l(2),p("placeholder",A(5,6,"TOOL_NAME_PLACEHOLDER")),l(4),L(A(9,8,"TOOL_EVENT_NAME")),l(2),p("placeholder",A(11,10,"TOOL_EVENT_NAME_PLACEHOLDER")))}function Am(r,n){r&1&&(h(0,"div",7)(1,"span"),P(2),T(3,"translate"),_(),x(4,"pu-input",8),T(5,"translate"),_()),r&2&&(l(2),L(A(3,2,"GROUP_NAME")),l(2),p("placeholder",A(5,4,"GROUP_NAME_PLACEHOLDER")))}var Ke=function(r){return r.CREATE_TOOL="createTool",r.EDIT_TOOL="editTool",r.CREATE_CATEGORY="createCategory",r.EDIT_CATEGORY="editCategory",r}(Ke||{}),Cn=function(r){return r[r.TOOL=0]="TOOL",r[r.CATEGORY=1]="CATEGORY",r}(Cn||{}),dr=(()=>{let n=class n{contextMenuModalParam;translatePipe;modalService;portalRef;subscriptionService;formBuilder;loggingService;form;get TemplateType(){return Cn}get modalType(){return this.contextMenuModalParam.modalType}get templateType(){return this.modalType===Ke.CREATE_TOOL||this.modalType===Ke.EDIT_TOOL?Cn.TOOL:Cn.CATEGORY}get isConfirmButtonActive(){let{type:e,id:t,label:o,eventId:s}=this.form.getRawValue();switch(this.templateType){case Cn.TOOL:return S.isDefined(e&&t&&o&&s);case Cn.CATEGORY:return S.isDefined(e&&t&&o)}}get title(){switch(this.modalType){case Ke.CREATE_TOOL:return this.translatePipe.transform("ADD_CUSTOM_CONTEXT_MENU_ITEM");case Ke.EDIT_TOOL:return this.translatePipe.transform("EDIT_CUSTOM_CONTEXT_MENU_ITEM");case Ke.CREATE_CATEGORY:return this.translatePipe.transform("ADD_CUSTOM_CONTEXT_MENU_CATEGORY");case Ke.EDIT_CATEGORY:return this.translatePipe.transform("EDIT_CUSTOM_CONTEXT_MENU_CATEGORY")}}constructor(e,t,o,s,c,u,C){this.contextMenuModalParam=e,this.translatePipe=t,this.modalService=o,this.portalRef=s,this.subscriptionService=c,this.formBuilder=u,this.loggingService=C,this.form=this.formBuilder.group({type:this.formBuilder.nonNullable.control(""),id:this.formBuilder.nonNullable.control(xo()),label:this.formBuilder.nonNullable.control(""),eventId:this.formBuilder.nonNullable.control("")})}ngOnInit(){this.initFields(),this.initSubscription()}initFields(){let{type:e,id:t,label:o,data:s}=this.contextMenuModalParam.tool;switch(this.modalType){case Ke.EDIT_CATEGORY:case Ke.EDIT_TOOL:this.form.controls.type.setValue(e),this.form.controls.id.setValue(t),this.form.controls.label.setValue(o),this.form.controls.eventId.setValue(s?.eventId);break;case Ke.CREATE_TOOL:this.form.controls.type.setValue(Lt.ITEM);break;case Ke.CREATE_CATEGORY:this.form.controls.type.setValue(Lt.CATEGORY);break;default:this.loggingService.common("error",Ee.INVALID,'"modalType"',this.contextMenuModalParam);break}}initSubscription(){this.subscriptionService.push(Pe.windowKeyDown$.pipe(w(e=>e.key==="Escape"),w(()=>this.modalService.lastModal===this.portalRef)).subscribe({next:()=>this.closeModal()}))}closeModal(){this.portalRef.dispose()}onConfirmButtonClick(){let{type:e,id:t,label:o,eventId:s}=this.form.value;this.portalRef.dispose({contextMenu:{type:e,id:t,label:o,data:{eventId:s}},modalType:this.modalType})}};E(n,"\u0275fac",function(t){return new(t||n)(m(Hi),m(ee),m(bt),m(Kt),m(R),m(gi),m(ze))}),E(n,"\u0275cmp",H({type:n,selectors:[["sd-context-menu-modal"]],standalone:!1,features:[j([R])],decls:16,vars:14,consts:[["tool",""],["category",""],[1,"papycon","papycon-cross",3,"click"],[1,"container",3,"formGroup"],[4,"ngIf","ngIfThen","ngIfElse"],["size","small","color","white",1,"ep-button",3,"click"],["size","small","color","primary",1,"ep-button",3,"click","disabled"],[1,"input-container"],["formControlName","label","size","small",3,"placeholder"],["formControlName","eventId","size","small",3,"placeholder"]],template:function(t,o){if(t&1){let s=M();h(0,"h3"),P(1),h(2,"i",2),I("click",function(){return f(s),g(o.closeModal())}),_()(),h(3,"main",3),y(4,Cm,1,0,"ng-container",4)(5,Tm,12,12,"ng-template",null,0,ke)(7,Am,6,6,"ng-template",null,1,ke),_(),h(9,"footer")(10,"button",5),I("click",function(){return f(s),g(o.closeModal())}),P(11),T(12,"translate"),_(),h(13,"button",6),I("click",function(){return f(s),g(o.onConfirmButtonClick())}),P(14),T(15,"translate"),_()()}if(t&2){let s=Oe(6),c=Oe(8);l(),Re(" ",o.title," "),l(2),G("category",o.templateType===o.TemplateType.CATEGORY),p("formGroup",o.form),l(),p("ngIf",o.templateType===o.TemplateType.TOOL)("ngIfThen",s)("ngIfElse",c),l(7),L(A(12,10,"CANCEL")),l(2),p("disabled",!o.isConfirmButtonActive),l(),L(A(15,12,"OK"))}},styles:["h3[_ngcontent-%COMP%]{font-size:20px;line-height:28px;font-family:NotoSans-Medium,sans-serif;color:#1e1e1e;display:flex;margin:8px 0;justify-content:space-between;align-items:flex-start}h3[_ngcontent-%COMP%]   .papycon-cross[_ngcontent-%COMP%]{font-size:13px;line-height:22px;cursor:pointer;width:22px;height:22px;text-align:center;color:#6c6c6c;margin-right:0}main[_ngcontent-%COMP%]{width:412px;height:140px}main.category[_ngcontent-%COMP%]{height:57px}main[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1}main[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-family:NotoSans-Medium;font-size:13px;letter-spacing:-.5px;color:#6c6c6c}main[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   pu-input[_ngcontent-%COMP%]{height:40px}main[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   pu-input[_ngcontent-%COMP%]  input{padding:0 8px}main[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{border-radius:2px;border:solid 1.2px #DADADA;background-color:#fff;padding:8px;font-family:NotoSans-Regular;font-size:14px}main[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]:first-child{margin-top:16px}main[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]:last-child{margin-top:20px}footer[_ngcontent-%COMP%]{text-align:right;margin-top:20px}footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] + button[_ngcontent-%COMP%]{margin-left:12px}"],changeDetection:0}));let r=n;return r})();var Em=["puMenu"],Sm=["leftPanel"],_c=r=>({content:r,className:"with-icon"}),Im=r=>[r],xm=()=>[];function vm(r,n){if(r&1&&x(0,"i"),r&2){let i=d().$implicit;Gi(i.icon)}}function Om(r,n){if(r&1&&(h(0,"span"),P(1),T(2,"translate"),_()),r&2){let i=d().$implicit;l(),L(A(2,1,i.label))}}function bm(r,n){if(r&1){let i=M();h(0,"div",32),I("click",function(){let t=f(i).$implicit,o=d();return g(o.onToolClick(t))}),y(1,vm,1,2,"i",33)(2,Om,3,3,"span",34),_()}if(r&2){let i=n.$implicit,e=d();G("active",e.selectedLeftTool&&e.selectedLeftTool.id===i.id),l(),p("ngIf",i.icon),l(),p("ngIf",e.isString(i.label))}}var oi=function(r){return r.LEFT="left",r.RIGHT="right",r.UP="up",r.DOWN="down",r}(oi||{}),Qr=(()=>{let n=class n{modalService;changeDetectorRef;configsService;productService;translatePipe;subscriptionService;puMenuRef;leftPanelRef;_tools;get tools(){return this._tools}set tools(e){if(!e)return;let t=e.filter(s=>s.data?.isDefaultTool),o=e.filter(s=>!s.data?.isDefaultTool);this._tools=[...this.sortDefaultTools(t),...o],Y.set(a.AVAILABLE_CONTEXT_MENU_TOOLS,o)}_toolsInUse;get toolsInUse(){return this._toolsInUse}set toolsInUse(e){e&&(this._toolsInUse=e,Y.set(a.CONTEXT_MENU_TOOLS_IN_USE,this.toolsInUse),this.setPUMenus(this.toolsInUse))}menus;defaultTools=[];clickedButton=null;toolNumIncreased=!1;selectedRightTool=null;selectedLeftTool=null;additionalRightToolMenus=[];get shouldLeftButtonDisabled(){return this.selectedRightTool===null||this.selectedRightTool.type!==Lt.ITEM}get ContextMenuModalType(){return Ke}get noEditableItemOnRight(){return this.selectedRightTool===null||this.selectedRightTool.type===Lt.LINE||!!this.selectedRightTool.data?.isDefaultTool}constructor(e,t,o,s,c,u){this.modalService=e,this.changeDetectorRef=t,this.configsService=o,this.productService=s,this.translatePipe=c,this.subscriptionService=u,this.defaultTools=S.deepClone(Fs).filter(C=>{let N=["REDACTION","SELECT_ANNOT_TOOL"].map(O=>O.toString());return!this.productService.isStreamDocsVu||Qt.hasDefinedProp(C,"id")&&!N.includes(C.id)}),this.additionalRightToolMenus=[{label:"",items:[{label:this.translatePipe.transform("ADD_DIVISION_LINE"),command:()=>{let C={id:xo(),type:Lt.LINE,label:""};this.toolsInUse=[...this.toolsInUse,C],this.resetSelectedTools(),this.selectedRightTool=C,this.toolNumIncreased=!0}},{label:this.translatePipe.transform("ADD_CUSTOM_CONTEXT_MENU_CATEGORY"),command:()=>{this.showModal(Ke.CREATE_CATEGORY)}}]}]}ngOnInit(){this.tools=Y.get(a.AVAILABLE_CONTEXT_MENU_TOOLS),this.toolsInUse=Y.get(a.CONTEXT_MENU_TOOLS_IN_USE),this.setDefaultTools(),this.initSubscriptions()}onChildrenChanged(){let e;this.clickedButton===oi.LEFT?e=this.leftPanelScrollTarget:e=this.rightPanelScrollTarget,fe.runAsync(()=>this.setScrollTop(e))}initSubscriptions(){this.subscriptionService.push(this.configsService.resetClick$.subscribe({next:()=>{this.tools=this.defaultTools.filter(e=>!e.data?.isTextTool),this.toolsInUse=this.defaultTools.filter(e=>e.data?.isTextTool),this.changeDetectorRef.markForCheck()}}),this.configsService.cancelClick$.subscribe({next:()=>{this.changeDetectorRef.markForCheck()}}))}setDefaultTools(){let e=this.defaultTools.filter(t=>this.toolsInUse.every(o=>o.id!==t.id));this.tools=[...e,...this.tools]}sortDefaultTools(e){return e.sort((t,o)=>{let s=t.data?.index??Number.MAX_SAFE_INTEGER,c=o.data?.index??Number.MAX_SAFE_INTEGER;return s-c})}onToolClick(e){this.resetSelectedTools(),this.selectedLeftTool=e}setPUMenus(e){let t=e.map(o=>o.command?o:Qe(ge({},o),{label:o.type===Lt.LINE||o.type===Lt.CATEGORY?o.label:this.translatePipe.transform(o.label.toString()),command:(s,c)=>{this.resetSelectedTools();let u=this.toolsInUse.find(C=>C.id===c.id);u!==void 0&&(this.selectedRightTool=u)}}));this.menus=[{items:t}],this.toolsInUse.length===0||this.selectedRightTool}get leftPanelScrollTarget(){return this.leftPanelRef.element.nativeElement}get rightPanelScrollTarget(){return this.puMenuRef.element.nativeElement.firstChild}setScrollTop(e){let o=Number(e?.offsetHeight),s=Number(e?.scrollTop),c=s+o,u=this.getActiveElement(e.children);if(!u)return;let C=u.offsetTop,N=C+u.offsetHeight,O=u.offsetHeight,U=c-12<=N,z=C<=s;U&&this.clickedButton===oi.UP&&(e.scrollTop=N-o),U&&this.clickedButton===oi.DOWN&&(e.scrollTop=N-o),U&&this.toolNumIncreased&&(e.scrollTop=N-o+O),z&&this.clickedButton===oi.UP&&(e.scrollTop=C-12),z&&this.clickedButton===oi.DOWN&&(e.scrollTop=C-12),z&&this.toolNumIncreased&&(e.scrollTop=C-O-12),this.toolNumIncreased=!1,this.clickedButton=null}getActiveElement(e){let t=Array.from(e).findIndex(o=>Array.from(o.classList).includes("active"));return t===-1?null:e[t]}makeModalParams(e,t){let o={modalType:e,tool:{}};if(!t)return o;let{type:s,id:c,label:u,data:C}=t;switch(e){case Ke.CREATE_TOOL:break;case Ke.EDIT_TOOL:o.tool={type:s,id:c,label:u,data:{eventId:C?.eventId}};break;case Ke.CREATE_CATEGORY:break;case Ke.EDIT_CATEGORY:o.tool={type:s,id:c,label:u};break}return o}showModal(e,t){this.modalService.createModal(dr,this.makeModalParams(e,t)).addOnDisposeListener(o=>{if(!o||!S.isDefined(o.contextMenu))return;let s=(c,u)=>c.map(C=>C.id===u.id?u:C);switch(o.modalType){case Ke.CREATE_TOOL:this.tools=[...this.tools,o.contextMenu],this.selectedLeftTool=o.contextMenu,this.toolNumIncreased=!0,fe.runAsync(()=>this.setScrollTop(this.leftPanelScrollTarget));break;case Ke.EDIT_TOOL:this.tools=s(this.tools,o.contextMenu),this.toolsInUse=s(this.toolsInUse,o.contextMenu);break;case Ke.CREATE_CATEGORY:this.toolsInUse=[...this.toolsInUse,o.contextMenu],this.resetSelectedTools(),this.selectedRightTool=o.contextMenu,this.toolNumIncreased=!0;break;case Ke.EDIT_CATEGORY:this.toolsInUse=s(this.toolsInUse,o.contextMenu);break}this.changeDetectorRef.markForCheck()})}changeToolIndex(e,t){this.toolsInUse.splice(t,0,...this.toolsInUse.splice(e,1)),this.toolsInUse=[...this.toolsInUse]}onLeftButtonClick(){if(this.selectedRightTool===null)return;let e=this.selectedRightTool,t=this.toolsInUse.indexOf(e);this.tools=[...this.tools,e],this.toolsInUse.splice(t,1),this.toolsInUse=[...this.toolsInUse],this.resetSelectedTools(),this.selectedLeftTool=e,this.toolNumIncreased=!0,this.clickedButton=oi.LEFT}onRightButtonClick(){if(this.selectedLeftTool===null)return;let e=this.selectedLeftTool,t=this.tools.indexOf(e);this.toolsInUse=[...this.toolsInUse,e],this.tools.splice(t,1),this.tools=[...this.tools],this.resetSelectedTools(),this.selectedRightTool=e,this.toolNumIncreased=!0,this.clickedButton=oi.RIGHT}onUpButtonClick(){if(this.selectedRightTool===null)return;this.clickedButton=oi.UP;let e=this.toolsInUse.indexOf(this.selectedRightTool),t=e===0?this.toolsInUse.length-1:e-1;this.changeToolIndex(e,t)}onDownButtonClick(){if(this.selectedRightTool===null)return;this.clickedButton=oi.DOWN;let e=this.toolsInUse.indexOf(this.selectedRightTool),t=e===this.toolsInUse.length-1?0:e+1;this.changeToolIndex(e,t)}onPenClick(e){e?.type===Lt.CATEGORY&&this.showModal(this.ContextMenuModalType.EDIT_CATEGORY,e),e?.type===Lt.ITEM&&this.showModal(this.ContextMenuModalType.EDIT_TOOL,e)}onLeftMinusClick(e){this.modalService.createCommonModal({type:Rn.BASIC,icon:"papycon papycon-questionmark",title:this.translatePipe.transform("DELETE_WARNING"),content:`${e.label}`,confirmButton:!0,cancelButton:!0}).addOnDisposeListener(t=>{if(!t)return;let o=this.tools.indexOf(e);this.tools.splice(o,1),this.resetSelectedTools(),this.changeDetectorRef.markForCheck()})}onRightMinusClick(e){let t=o=>{let s=this.toolsInUse.indexOf(e);this.toolsInUse.splice(s,1),this.toolsInUse=[...this.toolsInUse],this.resetSelectedTools()};if(e.type!==Lt.ITEM){t(e);return}this.modalService.createCommonModal({type:Rn.BASIC,icon:"papycon papycon-questionmark",title:this.translatePipe.transform("DELETE_WARNING"),content:`${e.label}`,confirmButton:!0,cancelButton:!0}).addOnDisposeListener(o=>{o&&(t(e),this.changeDetectorRef.markForCheck())})}resetSelectedTools(){this.selectedLeftTool=null,this.selectedRightTool=null}isString(e){return typeof e=="string"}};E(n,"\u0275fac",function(t){return new(t||n)(m(bt),m($),m(Rt),m(Ki),m(ee),m(R))}),E(n,"\u0275cmp",H({type:n,selectors:[["sd-context-menu-config"]],viewQuery:function(t,o){if(t&1&&(te(Em,7,Xt),te(Sm,7,Xt)),t&2){let s;ie(s=ne())&&(o.puMenuRef=s.first),ie(s=ne())&&(o.leftPanelRef=s.first)}},standalone:!1,features:[j([R])],decls:53,vars:33,consts:[["leftPanel",""],["puMenu",""],["additionalRightToolMenuRef",""],[1,"context-menu-container"],[1,"left","box"],[1,"header"],[1,"label"],[1,"papycon","papycon-questionmark",3,"tooltip"],[1,"available-tools","panel"],[1,"tools"],["class","tool",3,"active","click",4,"ngFor","ngForOf"],["size","tiny",1,"ep-text-button",3,"click"],[1,"papycon","papycon-plus2"],["size","tiny",1,"ep-text-button",3,"click","disabled"],[1,"papycon","papycon-minus"],[1,"papycon","papycon-pen"],[1,"buttons","between-panels"],[1,"button-container"],["size","small","color","white",1,"ep-button",3,"click","disabled"],[1,"papycon","papycon-previous-symbol2"],[1,"papycon","papycon-next-symbol2"],[1,"right","box"],[1,"papycon","papycon-questionmark","tooltip-icon",3,"tooltip"],[1,"tools-in-use","panel"],[1,"menu-container"],[3,"childrenChanged","menus","selectedItem","isStatic","editable"],[1,"buttons","in-right-panel"],["color","white",1,"ep-button",3,"click","disabled"],[1,"papycon","papycon-up-symbol"],[1,"papycon","papycon-down-symbol"],[3,"menus"],["size","tiny",1,"ep-text-button","right-plus",3,"click"],[1,"tool",3,"click"],[3,"class",4,"ngIf"],[4,"ngIf"]],template:function(t,o){if(t&1){let s=M();h(0,"div",3)(1,"div",4)(2,"div",5)(3,"span",6),P(4),T(5,"translate"),_(),x(6,"i",7),T(7,"translate"),_(),h(8,"div",8)(9,"div",9,0),y(11,bm,3,4,"div",10),_(),h(12,"footer")(13,"button",11),I("click",function(){return f(s),g(o.showModal(o.ContextMenuModalType.CREATE_TOOL))}),x(14,"i",12),_(),h(15,"button",13),I("click",function(){return f(s),g(o.onLeftMinusClick(o.selectedLeftTool))}),x(16,"i",14),_(),h(17,"button",13),I("click",function(){return f(s),g(o.onPenClick(o.selectedLeftTool))}),x(18,"i",15),_()()()(),h(19,"div",16)(20,"div",17)(21,"button",18),I("click",function(){return f(s),g(o.onLeftButtonClick())}),x(22,"i",19),_()(),h(23,"div",17)(24,"button",18),I("click",function(){return f(s),g(o.onRightButtonClick())}),x(25,"i",20),_()()(),h(26,"div",21)(27,"div",5)(28,"span",6),P(29),T(30,"translate"),_(),x(31,"i",22),T(32,"translate"),_(),h(33,"div",23)(34,"div",24)(35,"pu-menu",25,1),I("childrenChanged",function(){return f(s),g(o.onChildrenChanged())}),_(),h(37,"div",26)(38,"div",17)(39,"button",27),I("click",function(){return f(s),g(o.onUpButtonClick())}),x(40,"i",28),_()(),h(41,"div",17)(42,"button",27),I("click",function(){return f(s),g(o.onDownButtonClick())}),x(43,"i",29),_()()()(),h(44,"footer"),x(45,"pu-menu",30,2),h(47,"button",31),I("click",function(){f(s);let u=Oe(46);return g(u.toggleMenu())}),x(48,"i",12),_(),h(49,"button",13),I("click",function(){return f(s),g(o.onRightMinusClick(o.selectedRightTool))}),x(50,"i",14),_(),h(51,"button",13),I("click",function(){return f(s),g(o.onPenClick(o.selectedRightTool))}),x(52,"i",15),_()()()()()}t&2&&(l(4),L(A(5,18,"TOOL_LIST")),l(2),p("tooltip",at(26,_c,A(7,20,"EDIT_TOOL_LIST_TOOLTIP"))),l(5),p("ngForOf",o.tools),l(4),p("disabled",!o.selectedLeftTool||(o.selectedLeftTool==null||o.selectedLeftTool.data==null?null:o.selectedLeftTool.data.isDefaultTool)),l(2),p("disabled",!o.selectedLeftTool||(o.selectedLeftTool==null||o.selectedLeftTool.data==null?null:o.selectedLeftTool.data.isDefaultTool)),l(4),p("disabled",o.shouldLeftButtonDisabled),l(3),p("disabled",!o.selectedLeftTool),l(5),L(A(30,22,"CUSTOM_TOOL_LIST")),l(2),p("tooltip",at(28,_c,A(32,24,"EDIT_CUSTOM_TOOL_LIST_TOOLTIP"))),l(4),p("menus",o.menus)("selectedItem",o.selectedRightTool?at(30,Im,o.selectedRightTool):oe(32,xm))("isStatic",!0)("editable",!0),l(4),p("disabled",o.selectedRightTool===null),l(3),p("disabled",o.selectedRightTool===null),l(3),p("menus",o.additionalRightToolMenus),l(4),p("disabled",o.selectedRightTool===null||(o.selectedRightTool.data==null?null:o.selectedRightTool.data.isDefaultTool)),l(2),p("disabled",o.noEditableItemOnRight))},styles:[".context-menu-container[_ngcontent-%COMP%]{box-sizing:border-box;display:flex;margin:5px 50px 70px}.context-menu-container[_ngcontent-%COMP%]   .tooltip[_ngcontent-%COMP%]{font-size:12px;line-height:20px;color:#fff;font-family:NotoSans-Regular,sans-serif;background-color:#363636;position:fixed;z-index:1;padding:14px 20px;border-radius:5px;white-space:pre}.context-menu-container[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%], .context-menu-container[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{display:flex;flex-direction:column}.context-menu-container[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%], .context-menu-container[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{height:18px;display:flex;align-items:center;justify-content:space-between;margin-bottom:10px}.context-menu-container[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%], .context-menu-container[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:13px;line-height:22px;font-family:NotoSans-Medium,sans-serif;color:#1e1e1e}.context-menu-container[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .papycon[_ngcontent-%COMP%], .context-menu-container[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .papycon[_ngcontent-%COMP%]{color:#6c6c6c;cursor:pointer}.context-menu-container[_ngcontent-%COMP%]   .panel[_ngcontent-%COMP%]{box-sizing:border-box;height:387px;border:1px solid #DADADA;border-radius:2px;display:flex;flex-direction:column}.context-menu-container[_ngcontent-%COMP%]   .panel[_ngcontent-%COMP%]   footer[_ngcontent-%COMP%]{box-sizing:border-box;flex:0 0 42px;display:flex;align-items:center;position:relative;width:100%;padding:0 8px;border-top:1px solid #DADADA;background-color:#fff}.context-menu-container[_ngcontent-%COMP%]   .panel[_ngcontent-%COMP%]   footer[_ngcontent-%COMP%]   pu-menu[_ngcontent-%COMP%]{bottom:35px;left:20px}.context-menu-container[_ngcontent-%COMP%]   .panel[_ngcontent-%COMP%]   footer[_ngcontent-%COMP%]   .ep-text-button[_ngcontent-%COMP%]{width:30px;height:30px;display:flex;align-items:center;justify-content:center}.context-menu-container[_ngcontent-%COMP%]   .panel[_ngcontent-%COMP%]   footer[_ngcontent-%COMP%]   .ep-text-button[_ngcontent-%COMP%]   .papycon[_ngcontent-%COMP%]{font-size:22px}.context-menu-container[_ngcontent-%COMP%]   .panel[_ngcontent-%COMP%]   footer[_ngcontent-%COMP%]   .ep-text-button[_ngcontent-%COMP%]:last-child{margin-left:auto}.context-menu-container[_ngcontent-%COMP%]   .panel[_ngcontent-%COMP%]   footer[_ngcontent-%COMP%]   .ep-text-button.right-plus[_ngcontent-%COMP%]{position:relative}.context-menu-container[_ngcontent-%COMP%]   .available-tools[_ngcontent-%COMP%]{padding-top:4px;width:238px}.context-menu-container[_ngcontent-%COMP%]   .tools-in-use[_ngcontent-%COMP%]{width:280px;background-color:#f4f4f4}.context-menu-container[_ngcontent-%COMP%]   .tools-in-use[_ngcontent-%COMP%]   .menu-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:relative;height:100%}.context-menu-container[_ngcontent-%COMP%]   .tools-in-use[_ngcontent-%COMP%]   .menu-container[_ngcontent-%COMP%]   pu-menu[_ngcontent-%COMP%]{position:relative;margin-right:25px;width:186px;min-height:218px;overflow:auto;max-height:308px}.context-menu-container[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{flex-wrap:wrap;display:flex;align-self:center}.context-menu-container[_ngcontent-%COMP%]   .buttons.between-panels[_ngcontent-%COMP%]{flex:1}.context-menu-container[_ngcontent-%COMP%]   .buttons.between-panels[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]{flex:1 0 100%}.context-menu-container[_ngcontent-%COMP%]   .buttons.between-panels[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:46px;height:44px}.context-menu-container[_ngcontent-%COMP%]   .buttons.between-panels[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-child{margin-bottom:28px}.context-menu-container[_ngcontent-%COMP%]   .buttons.in-right-panel[_ngcontent-%COMP%]{flex-direction:column;flex-wrap:nowrap;position:absolute;width:60px;right:0;top:128px}.context-menu-container[_ngcontent-%COMP%]   .buttons.in-right-panel[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:30px;height:30px}.context-menu-container[_ngcontent-%COMP%]   .buttons.in-right-panel[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-child{margin-bottom:12px}.context-menu-container[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]{display:flex;justify-content:center}.context-menu-container[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.context-menu-container[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;flex:0 0 338px;overflow:auto}.context-menu-container[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool[_ngcontent-%COMP%]{padding:0 12px;display:flex;box-sizing:border-box;width:100%;min-height:30px;align-items:center;cursor:pointer;-webkit-user-select:none;user-select:none}.context-menu-container[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool.active[_ngcontent-%COMP%]{border:1px solid #F79F1A;background-color:#f79f1a14}.context-menu-container[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:20px;margin-right:7px}.context-menu-container[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;line-height:24px;font-family:NotoSans-Regular,sans-serif}"],changeDetection:0}));let r=n;return r})();var tO=(()=>{let n=class n{static forRoot(){return{ngModule:n,providers:[Rt,Ea]}}};E(n,"\u0275fac",function(t){return new(t||n)}),E(n,"\u0275mod",ot({type:n})),E(n,"\u0275inj",nt({imports:[pc,Ls,rt,ji,kt,Lo,to,ro,so,ao,oo,lo,uo,mo,fo,xs,Os,$i,ms,Ka,Ia]}));let r=n;return r})();Le(Kr,[lr,je,De,Ce,_e,vn,lt,fi,wt,xn,Mn,eo,Jn,no,yn,Ht,co,_o,Pi],[ee]);Le(Aa,[ws,Ce,yi,Ri,En,lt,Pi,jo,Sa,Kr,Lr,Qr],[ee]);Le(Lr,[je,De,Ce,_e,lt,wt,As,yn,Ht,ho,vs,hi],[ee]);Le(Qr,[De,Ce,po,hi],[ee]);Le(dr,[Ce,lt,fi,Ht,On,bn],[ee]);Le(Xo,[_i,lt,fi,Ht,On,bn],[ee]);export{W as a,ha as b,ma as c,_a as d,wo as e,Rt as f,Aa as g,Ea as h,Sa as i,Ia as j,Fa as k,Gg as l,Vt as m,_0 as n,x0 as o,kr as p,hn as q,B0 as r,Ho as s,zo as t,lC as u,Ja as v,ec as w,pc as x,tO as y};
